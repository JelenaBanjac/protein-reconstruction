define(["@jupyter-widgets/base"],function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="https://unpkg.com/ipyvolume@0.5.2/dist/",n(n.s=18)}([function(t,e,n){var r="~"+n(12).version,i=n(38);t.exports={is_typedarray:function(t){return i(t)},is_arraybuffer:function(t){return ArrayBuffer.isView(t)},get_array_dimension:function(t){for(var e=0;void 0!==t[0];)t=t[0],e+=1;return e},semver_range:r,shader_fix:function(t){return"string"==typeof t?t:t.default}}},function(t,e,n){"use strict";function r(){}Object.defineProperty(e,"__esModule",{value:!0}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}),e.EventDispatcher=r,Object.assign(r.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}});var i="91";e.REVISION=i;e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};var a=0;e.CullFaceNone=a;var o=1;e.CullFaceBack=o;var s=2;e.CullFaceFront=s;e.CullFaceFrontBack=3;e.FrontFaceDirectionCW=0;e.FrontFaceDirectionCCW=1;e.BasicShadowMap=0;var c=1;e.PCFShadowMap=c;var l=2;e.PCFSoftShadowMap=l;var u=0;e.FrontSide=u;var h=1;e.BackSide=h;var f=2;e.DoubleSide=f;e.FlatShading=1;e.SmoothShading=2;var d=0;e.NoColors=d;var p=1;e.FaceColors=p;var m=2;e.VertexColors=m;var v=0;e.NoBlending=v;var g=1;e.NormalBlending=g;var y=2;e.AdditiveBlending=y;var _=3;e.SubtractiveBlending=_;var x=4;e.MultiplyBlending=x;var b=5;e.CustomBlending=b;var w=100;e.AddEquation=w;var M=101;e.SubtractEquation=M;var E=102;e.ReverseSubtractEquation=E;var T=103;e.MinEquation=T;var S=104;e.MaxEquation=S;var A=200;e.ZeroFactor=A;var R=201;e.OneFactor=R;var L=202;e.SrcColorFactor=L;var C=203;e.OneMinusSrcColorFactor=C;var P=204;e.SrcAlphaFactor=P;var O=205;e.OneMinusSrcAlphaFactor=O;var N=206;e.DstAlphaFactor=N;var I=207;e.OneMinusDstAlphaFactor=I;var z=208;e.DstColorFactor=z;var U=209;e.OneMinusDstColorFactor=U;var D=210;e.SrcAlphaSaturateFactor=D;var k=0;e.NeverDepth=k;var F=1;e.AlwaysDepth=F;var B=2;e.LessDepth=B;var j=3;e.LessEqualDepth=j;var H=4;e.EqualDepth=H;var G=5;e.GreaterEqualDepth=G;var V=6;e.GreaterDepth=V;var W=7;e.NotEqualDepth=W;var q=0;e.MultiplyOperation=q;var X=1;e.MixOperation=X;var Y=2;e.AddOperation=Y;var Z=0;e.NoToneMapping=Z;var J=1;e.LinearToneMapping=J;var Q=2;e.ReinhardToneMapping=Q;var K=3;e.Uncharted2ToneMapping=K;var $=4;e.CineonToneMapping=$;e.UVMapping=300;var tt=301;e.CubeReflectionMapping=tt;var et=302;e.CubeRefractionMapping=et;var nt=303;e.EquirectangularReflectionMapping=nt;var rt=304;e.EquirectangularRefractionMapping=rt;var it=305;e.SphericalReflectionMapping=it;var at=306;e.CubeUVReflectionMapping=at;var ot=307;e.CubeUVRefractionMapping=ot;var st=1e3;e.RepeatWrapping=st;var ct=1001;e.ClampToEdgeWrapping=ct;var lt=1002;e.MirroredRepeatWrapping=lt;var ut=1003;e.NearestFilter=ut;var ht=1004;e.NearestMipMapNearestFilter=ht;var ft=1005;e.NearestMipMapLinearFilter=ft;var dt=1006;e.LinearFilter=dt;var pt=1007;e.LinearMipMapNearestFilter=pt;var mt=1008;e.LinearMipMapLinearFilter=mt;var vt=1009;e.UnsignedByteType=vt;var gt=1010;e.ByteType=gt;var yt=1011;e.ShortType=yt;var _t=1012;e.UnsignedShortType=_t;var xt=1013;e.IntType=xt;var bt=1014;e.UnsignedIntType=bt;var wt=1015;e.FloatType=wt;var Mt=1016;e.HalfFloatType=Mt;var Et=1017;e.UnsignedShort4444Type=Et;var Tt=1018;e.UnsignedShort5551Type=Tt;var St=1019;e.UnsignedShort565Type=St;var At=1020;e.UnsignedInt248Type=At;var Rt=1021;e.AlphaFormat=Rt;var Lt=1022;e.RGBFormat=Lt;var Ct=1023;e.RGBAFormat=Ct;var Pt=1024;e.LuminanceFormat=Pt;var Ot=1025;e.LuminanceAlphaFormat=Ot;var Nt=Ct;e.RGBEFormat=Nt;var It=1026;e.DepthFormat=It;var zt=1027;e.DepthStencilFormat=zt;var Ut=33776;e.RGB_S3TC_DXT1_Format=Ut;var Dt=33777;e.RGBA_S3TC_DXT1_Format=Dt;var kt=33778;e.RGBA_S3TC_DXT3_Format=kt;var Ft=33779;e.RGBA_S3TC_DXT5_Format=Ft;var Bt=35840;e.RGB_PVRTC_4BPPV1_Format=Bt;var jt=35841;e.RGB_PVRTC_2BPPV1_Format=jt;var Ht=35842;e.RGBA_PVRTC_4BPPV1_Format=Ht;var Gt=35843;e.RGBA_PVRTC_2BPPV1_Format=Gt;var Vt=36196;e.RGB_ETC1_Format=Vt;var Wt=37808;e.RGBA_ASTC_4x4_Format=Wt;var qt=37809;e.RGBA_ASTC_5x4_Format=qt;var Xt=37810;e.RGBA_ASTC_5x5_Format=Xt;var Yt=37811;e.RGBA_ASTC_6x5_Format=Yt;var Zt=37812;e.RGBA_ASTC_6x6_Format=Zt;var Jt=37813;e.RGBA_ASTC_8x5_Format=Jt;var Qt=37814;e.RGBA_ASTC_8x6_Format=Qt;var Kt=37815;e.RGBA_ASTC_8x8_Format=Kt;var $t=37816;e.RGBA_ASTC_10x5_Format=$t;var te=37817;e.RGBA_ASTC_10x6_Format=te;var ee=37818;e.RGBA_ASTC_10x8_Format=ee;var ne=37819;e.RGBA_ASTC_10x10_Format=ne;var re=37820;e.RGBA_ASTC_12x10_Format=re;var ie=37821;e.RGBA_ASTC_12x12_Format=ie;e.LoopOnce=2200;var ae=2201;e.LoopRepeat=ae;e.LoopPingPong=2202;e.InterpolateDiscrete=2300;e.InterpolateLinear=2301;e.InterpolateSmooth=2302;var oe=2400;e.ZeroCurvatureEnding=oe;e.ZeroSlopeEnding=2401;e.WrapAroundEnding=2402;var se=0;e.TrianglesDrawMode=se;var ce=1;e.TriangleStripDrawMode=ce;var le=2;e.TriangleFanDrawMode=le;var ue=3e3;e.LinearEncoding=ue;var he=3001;e.sRGBEncoding=he;var fe=3007;e.GammaEncoding=fe;var de=3002;e.RGBEEncoding=de;e.LogLuvEncoding=3003;var pe=3004;e.RGBM7Encoding=pe;var me=3005;e.RGBM16Encoding=me;var ve=3006;e.RGBDEncoding=ve;var ge=3200;e.BasicDepthPacking=ge;var ye=3201;e.RGBADepthPacking=ye;var _e,xe,be,we,Me,Ee,Te,Se,Ae,Re={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16).toUpperCase();return function(){var e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&n]+t[n>>8&255]+"-"+t[n>>16&15|64]+t[n>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*Re.DEG2RAD},radToDeg:function(t){return t*Re.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};function Le(t,e){this.x=t||0,this.y=e||0}function Ce(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Pe(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}function Oe(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function Ne(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}e.Math=Re,e.Vector2=Le,Object.defineProperties(Le.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(Le.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:(_e=new Le,xe=new Le,function(t,e){return _e.set(t,t),xe.set(e,e),this.clamp(_e,xe)}),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,a=this.y-t.y;return this.x=i*n-a*r+t.x,this.y=i*r+a*n+t.y,this}}),e.Matrix4=Ce,Object.assign(Ce.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,a,o,s,c,l,u,h,f,d,p,m){var v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=r,v[1]=i,v[5]=a,v[9]=o,v[13]=s,v[2]=c,v[6]=l,v[10]=u,v[14]=h,v[3]=f,v[7]=d,v[11]=p,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Ce).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:(Se=new Oe,function(t){var e=this.elements,n=t.elements,r=1/Se.setFromMatrixColumn(t,0).length(),i=1/Se.setFromMatrixColumn(t,1).length(),a=1/Se.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[8]=n[8]*a,e[9]=n[9]*a,e[10]=n[10]*a,this}),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),c=Math.sin(r),l=Math.cos(i),u=Math.sin(i);if("XYZ"===t.order){var h=a*l,f=a*u,d=o*l,p=o*u;e[0]=s*l,e[4]=-s*u,e[8]=c,e[1]=f+d*c,e[5]=h-p*c,e[9]=-o*s,e[2]=p-h*c,e[6]=d+f*c,e[10]=a*s}else if("YXZ"===t.order){var m=s*l,v=s*u,g=c*l,y=c*u;e[0]=m+y*o,e[4]=g*o-v,e[8]=a*c,e[1]=a*u,e[5]=a*l,e[9]=-o,e[2]=v*o-g,e[6]=y+m*o,e[10]=a*s}else if("ZXY"===t.order){m=s*l,v=s*u,g=c*l,y=c*u;e[0]=m-y*o,e[4]=-a*u,e[8]=g+v*o,e[1]=v+g*o,e[5]=a*l,e[9]=y-m*o,e[2]=-a*c,e[6]=o,e[10]=a*s}else if("ZYX"===t.order){h=a*l,f=a*u,d=o*l,p=o*u;e[0]=s*l,e[4]=d*c-f,e[8]=h*c+p,e[1]=s*u,e[5]=p*c+h,e[9]=f*c-d,e[2]=-c,e[6]=o*s,e[10]=a*s}else if("YZX"===t.order){var _=a*s,x=a*c,b=o*s,w=o*c;e[0]=s*l,e[4]=w-_*u,e[8]=b*u+x,e[1]=u,e[5]=a*l,e[9]=-o*l,e[2]=-c*l,e[6]=x*u+b,e[10]=_-w*u}else if("XZY"===t.order){_=a*s,x=a*c,b=o*s,w=o*c;e[0]=s*l,e[4]=-u,e[8]=c*l,e[1]=_*u+w,e[5]=a*l,e[9]=x*u-b,e[2]=b*u-x,e[6]=o*l,e[10]=w*u+_}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,n=t._x,r=t._y,i=t._z,a=t._w,o=n+n,s=r+r,c=i+i,l=n*o,u=n*s,h=n*c,f=r*s,d=r*c,p=i*c,m=a*o,v=a*s,g=a*c;return e[0]=1-(f+p),e[4]=u-g,e[8]=h+v,e[1]=u+g,e[5]=1-(l+p),e[9]=d-m,e[2]=h-v,e[6]=d+m,e[10]=1-(l+f),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:(Me=new Oe,Ee=new Oe,Te=new Oe,function(t,e,n){var r=this.elements;return Te.subVectors(t,e),0===Te.lengthSq()&&(Te.z=1),Te.normalize(),Me.crossVectors(n,Te),0===Me.lengthSq()&&(1===Math.abs(n.z)?Te.x+=1e-4:Te.z+=1e-4,Te.normalize(),Me.crossVectors(n,Te)),Me.normalize(),Ee.crossVectors(Te,Me),r[0]=Me.x,r[4]=Ee.x,r[8]=Te.x,r[1]=Me.y,r[5]=Ee.y,r[9]=Te.y,r[2]=Me.z,r[6]=Ee.z,r[10]=Te.z,this}),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,a=n[0],o=n[4],s=n[8],c=n[12],l=n[1],u=n[5],h=n[9],f=n[13],d=n[2],p=n[6],m=n[10],v=n[14],g=n[3],y=n[7],_=n[11],x=n[15],b=r[0],w=r[4],M=r[8],E=r[12],T=r[1],S=r[5],A=r[9],R=r[13],L=r[2],C=r[6],P=r[10],O=r[14],N=r[3],I=r[7],z=r[11],U=r[15];return i[0]=a*b+o*T+s*L+c*N,i[4]=a*w+o*S+s*C+c*I,i[8]=a*M+o*A+s*P+c*z,i[12]=a*E+o*R+s*O+c*U,i[1]=l*b+u*T+h*L+f*N,i[5]=l*w+u*S+h*C+f*I,i[9]=l*M+u*A+h*P+f*z,i[13]=l*E+u*R+h*O+f*U,i[2]=d*b+p*T+m*L+v*N,i[6]=d*w+p*S+m*C+v*I,i[10]=d*M+p*A+m*P+v*z,i[14]=d*E+p*R+m*O+v*U,i[3]=g*b+y*T+_*L+x*N,i[7]=g*w+y*S+_*C+x*I,i[11]=g*M+y*A+_*P+x*z,i[15]=g*E+y*R+_*O+x*U,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(){var t=new Oe;return function(e){for(var n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix4(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],a=t[1],o=t[5],s=t[9],c=t[13],l=t[2],u=t[6],h=t[10],f=t[14];return t[3]*(+i*s*u-r*c*u-i*o*h+n*c*h+r*o*f-n*s*f)+t[7]*(+e*s*f-e*c*h+i*a*h-r*a*f+r*c*l-i*s*l)+t[11]*(+e*c*u-e*o*f-i*a*u+n*a*f+i*o*l-n*c*l)+t[15]*(-r*o*l-e*s*u+e*o*h+r*a*u-n*a*h+n*s*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var n=this.elements,r=t.elements,i=r[0],a=r[1],o=r[2],s=r[3],c=r[4],l=r[5],u=r[6],h=r[7],f=r[8],d=r[9],p=r[10],m=r[11],v=r[12],g=r[13],y=r[14],_=r[15],x=d*y*h-g*p*h+g*u*m-l*y*m-d*u*_+l*p*_,b=v*p*h-f*y*h-v*u*m+c*y*m+f*u*_-c*p*_,w=f*g*h-v*d*h+v*l*m-c*g*m-f*l*_+c*d*_,M=v*d*u-f*g*u-v*l*p+c*g*p+f*l*y-c*d*y,E=i*x+a*b+o*w+s*M;if(0===E){var T="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(T);return console.warn(T),this.identity()}var S=1/E;return n[0]=x*S,n[1]=(g*p*s-d*y*s-g*o*m+a*y*m+d*o*_-a*p*_)*S,n[2]=(l*y*s-g*u*s+g*o*h-a*y*h-l*o*_+a*u*_)*S,n[3]=(d*u*s-l*p*s-d*o*h+a*p*h+l*o*m-a*u*m)*S,n[4]=b*S,n[5]=(f*y*s-v*p*s+v*o*m-i*y*m-f*o*_+i*p*_)*S,n[6]=(v*u*s-c*y*s-v*o*h+i*y*h+c*o*_-i*u*_)*S,n[7]=(c*p*s-f*u*s+f*o*h-i*p*h-c*o*m+i*u*m)*S,n[8]=w*S,n[9]=(v*d*s-f*g*s-v*a*m+i*g*m+f*a*_-i*d*_)*S,n[10]=(c*g*s-v*l*s+v*a*h-i*g*h-c*a*_+i*l*_)*S,n[11]=(f*l*s-c*d*s-f*a*h+i*d*h+c*a*m-i*l*m)*S,n[12]=M*S,n[13]=(f*g*o-v*d*o+v*a*p-i*g*p-f*a*y+i*d*y)*S,n[14]=(v*l*o-c*g*o-v*a*u+i*g*u+c*a*y-i*l*y)*S,n[15]=(c*d*o-f*l*o+f*a*u-i*d*u-c*a*p+i*l*p)*S,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,a=t.x,o=t.y,s=t.z,c=i*a,l=i*o;return this.set(c*a+n,c*o-r*s,c*s+r*o,0,c*o+r*s,l*o+n,l*s-r*a,0,c*s-r*o,l*s+r*a,i*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){return this.makeRotationFromQuaternion(e),this.scale(n),this.setPosition(t),this},decompose:(be=new Oe,we=new Ce,function(t,e,n){var r=this.elements,i=be.set(r[0],r[1],r[2]).length(),a=be.set(r[4],r[5],r[6]).length(),o=be.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],we.copy(this);var s=1/i,c=1/a,l=1/o;return we.elements[0]*=s,we.elements[1]*=s,we.elements[2]*=s,we.elements[4]*=c,we.elements[5]*=c,we.elements[6]*=c,we.elements[8]*=l,we.elements[9]*=l,we.elements[10]*=l,e.setFromRotationMatrix(we),n.x=i,n.y=a,n.z=o,this}),makePerspective:function(t,e,n,r,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*i/(e-t),c=2*i/(n-r),l=(e+t)/(e-t),u=(n+r)/(n-r),h=-(a+i)/(a-i),f=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=c,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=f,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(t,e,n,r,i,a){var o=this.elements,s=1/(e-t),c=1/(n-r),l=1/(a-i),u=(e+t)*s,h=(n+r)*c,f=(a+i)*l;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*l,o[14]=-f,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}),e.Quaternion=Pe,Object.assign(Pe,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,a,o){var s=n[r+0],c=n[r+1],l=n[r+2],u=n[r+3],h=i[a+0],f=i[a+1],d=i[a+2],p=i[a+3];if(u!==p||s!==h||c!==f||l!==d){var m=1-o,v=s*h+c*f+l*d+u*p,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var _=Math.sqrt(y),x=Math.atan2(_,v*g);m=Math.sin(m*x)/_,o=Math.sin(o*x)/_}var b=o*g;if(s=s*m+h*b,c=c*m+f*b,l=l*m+d*b,u=u*m+p*b,m===1-o){var w=1/Math.sqrt(s*s+c*c+l*l+u*u);s*=w,c*=w,l*=w,u*=w}}t[e]=s,t[e+1]=c,t[e+2]=l,t[e+3]=u}}),Object.defineProperties(Pe.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(Pe.prototype,{set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,a=t.order,o=Math.cos,s=Math.sin,c=o(n/2),l=o(r/2),u=o(i/2),h=s(n/2),f=s(r/2),d=s(i/2);return"XYZ"===a?(this._x=h*l*u+c*f*d,this._y=c*f*u-h*l*d,this._z=c*l*d+h*f*u,this._w=c*l*u-h*f*d):"YXZ"===a?(this._x=h*l*u+c*f*d,this._y=c*f*u-h*l*d,this._z=c*l*d-h*f*u,this._w=c*l*u+h*f*d):"ZXY"===a?(this._x=h*l*u-c*f*d,this._y=c*f*u+h*l*d,this._z=c*l*d+h*f*u,this._w=c*l*u-h*f*d):"ZYX"===a?(this._x=h*l*u-c*f*d,this._y=c*f*u+h*l*d,this._z=c*l*d-h*f*u,this._w=c*l*u+h*f*d):"YZX"===a?(this._x=h*l*u+c*f*d,this._y=c*f*u+h*l*d,this._z=c*l*d-h*f*u,this._w=c*l*u-h*f*d):"XZY"===a&&(this._x=h*l*u-c*f*d,this._y=c*f*u-h*l*d,this._z=c*l*d+h*f*u,this._w=c*l*u+h*f*d),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],a=n[8],o=n[1],s=n[5],c=n[9],l=n[2],u=n[6],h=n[10],f=r+s+h;return f>0?(e=.5/Math.sqrt(f+1),this._w=.25/e,this._x=(u-c)*e,this._y=(a-l)*e,this._z=(o-i)*e):r>s&&r>h?(e=2*Math.sqrt(1+r-s-h),this._w=(u-c)/e,this._x=.25*e,this._y=(i+o)/e,this._z=(a+l)/e):s>h?(e=2*Math.sqrt(1+s-r-h),this._w=(a-l)/e,this._x=(i+o)/e,this._y=.25*e,this._z=(c+u)/e):(e=2*Math.sqrt(1+h-r-s),this._w=(o-i)/e,this._x=(a+l)/e,this._y=(c+u)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e=new Oe;return function(n,r){return void 0===e&&(e=new Oe),(t=n.dot(r)+1)<1e-6?(t=0,Math.abs(n.x)>Math.abs(n.z)?e.set(-n.y,n.x,0):e.set(0,-n.z,n.y)):e.crossVectors(n,r),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize()}}(),inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,a=t._w,o=e._x,s=e._y,c=e._z,l=e._w;return this._x=n*l+a*o+r*c-i*s,this._y=r*l+a*s+i*o-n*c,this._z=i*l+a*c+n*s-r*o,this._w=a*l-n*o-r*s-i*c,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*t._w+n*t._x+r*t._y+i*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=Math.sqrt(1-o*o);if(Math.abs(s)<.001)return this._w=.5*(a+this._w),this._x=.5*(n+this._x),this._y=.5*(r+this._y),this._z=.5*(i+this._z),this;var c=Math.atan2(s,o),l=Math.sin((1-e)*c)/s,u=Math.sin(e*c)/s;return this._w=a*l+this._w*u,this._x=n*l+this._x*u,this._y=r*l+this._y*u,this._z=i*l+this._z*u,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),e.Vector3=Oe,Object.assign(Oe.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:(Ae=new Pe,function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Ae.setFromEuler(t))}),applyAxisAngle:function(){var t=new Pe;return function(e,n){return this.applyQuaternion(t.setFromAxisAngle(e,n))}}(),applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,a=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*a,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,a=t.y,o=t.z,s=t.w,c=s*e+a*r-o*n,l=s*n+o*e-i*r,u=s*r+i*n-a*e,h=-i*e-a*n-o*r;return this.x=c*s+h*-i+l*-o-u*-a,this.y=l*s+h*-a+u*-i-c*-o,this.z=u*s+h*-o+c*-a-l*-i,this},project:function(){var t=new Ce;return function(e){return t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyMatrix4(t)}}(),unproject:function(){var t=new Ce;return function(e){return t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyMatrix4(t)}}(),transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t=new Oe,e=new Oe;return function(n,r){return t.set(n,n,n),e.set(r,r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,a=e.x,o=e.y,s=e.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t=new Oe;return function(e){return t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t=new Oe;return function(e){return this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(Re.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),e.Matrix3=Ne,Object.assign(Ne.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,a,o,s,c){var l=this.elements;return l[0]=t,l[1]=r,l[2]=o,l[3]=e,l[4]=i,l[5]=s,l[6]=n,l[7]=a,l[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(){var t=new Oe;return function(e){for(var n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix3(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,a=n[0],o=n[3],s=n[6],c=n[1],l=n[4],u=n[7],h=n[2],f=n[5],d=n[8],p=r[0],m=r[3],v=r[6],g=r[1],y=r[4],_=r[7],x=r[2],b=r[5],w=r[8];return i[0]=a*p+o*g+s*x,i[3]=a*m+o*y+s*b,i[6]=a*v+o*_+s*w,i[1]=c*p+l*g+u*x,i[4]=c*m+l*y+u*b,i[7]=c*v+l*_+u*w,i[2]=h*p+f*g+d*x,i[5]=h*m+f*y+d*b,i[8]=h*v+f*_+d*w,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],c=t[7],l=t[8];return e*a*l-e*o*c-n*i*l+n*o*s+r*i*c-r*a*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=t.elements,r=this.elements,i=n[0],a=n[1],o=n[2],s=n[3],c=n[4],l=n[5],u=n[6],h=n[7],f=n[8],d=f*c-l*h,p=l*u-f*s,m=h*s-c*u,v=i*d+a*p+o*m;if(0===v){var g="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(g);return console.warn(g),this.identity()}var y=1/v;return r[0]=d*y,r[1]=(o*h-f*a)*y,r[2]=(l*a-o*c)*y,r[3]=p*y,r[4]=(f*i-o*u)*y,r[5]=(o*s-l*i)*y,r[6]=m*y,r[7]=(a*u-h*i)*y,r[8]=(c*i-a*s)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,a,o){var s=Math.cos(i),c=Math.sin(i);this.set(n*s,n*c,-n*(s*a+c*o)+a+t,-r*c,r*s,-r*(-c*a+s*o)+o+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],a=r[3],o=r[6],s=r[1],c=r[4],l=r[7];return r[0]=e*i+n*s,r[3]=e*a+n*c,r[6]=e*o+n*l,r[1]=-n*i+e*s,r[4]=-n*a+e*c,r[7]=-n*o+e*l,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var Ie,ze,Ue,De,ke,Fe,Be=0;function je(t,e,n,r,i,a,o,s,c,l){Object.defineProperty(this,"id",{value:Be++}),this.uuid=Re.generateUUID(),this.name="",this.image=void 0!==t?t:je.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:je.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:ct,this.wrapT=void 0!==r?r:ct,this.magFilter=void 0!==i?i:dt,this.minFilter=void 0!==a?a:mt,this.anisotropy=void 0!==c?c:1,this.format=void 0!==o?o:Ct,this.type=void 0!==s?s:vt,this.offset=new Le(0,0),this.repeat=new Le(1,1),this.center=new Le(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ne,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:ue,this.version=0,this.onUpdate=null}function He(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}function Ge(t,e,n){this.width=t,this.height=e,this.scissor=new He(0,0,t,e),this.scissorTest=!1,this.viewport=new He(0,0,t,e),void 0===(n=n||{}).minFilter&&(n.minFilter=dt),this.texture=new je(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function Ve(t,e,n){Ge.call(this,t,e,n),this.activeCubeFace=0,this.activeMipMapLevel=0}function We(t,e,n,r,i,a,o,s,c,l,u,h){je.call(this,null,a,o,s,c,l,r,i,u,h),this.image={data:t,width:e,height:n},this.magFilter=void 0!==c?c:ut,this.minFilter=void 0!==l?l:ut,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function qe(t,e){this.min=void 0!==t?t:new Oe(1/0,1/0,1/0),this.max=void 0!==e?e:new Oe(-1/0,-1/0,-1/0)}function Xe(t,e){this.center=void 0!==t?t:new Oe,this.radius=void 0!==e?e:0}function Ye(t,e){this.normal=void 0!==t?t:new Oe(1,0,0),this.constant=void 0!==e?e:0}function Ze(t,e,n,r,i,a){this.planes=[void 0!==t?t:new Ye,void 0!==e?e:new Ye,void 0!==n?n:new Ye,void 0!==r?r:new Ye,void 0!==i?i:new Ye,void 0!==a?a:new Ye]}e.Texture=je,je.DEFAULT_IMAGE=void 0,je.DEFAULT_MAPPING=300,je.prototype=Object.assign(Object.create(r.prototype),{constructor:je,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var r=this.image;void 0===r.uuid&&(r.uuid=Re.generateUUID()),e||void 0!==t.images[r.uuid]||(t.images[r.uuid]={uuid:r.uuid,url:function(t){var e;if(t instanceof HTMLCanvasElement)e=t;else{(e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=t.width,e.height=t.height;var n=e.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height)}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}(r)}),n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300===this.mapping){if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case st:t.x=t.x-Math.floor(t.x);break;case ct:t.x=t.x<0?0:1;break;case lt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case st:t.y=t.y-Math.floor(t.y);break;case ct:t.y=t.y<0?0:1;break;case lt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}}),Object.defineProperty(je.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),e.Vector4=He,Object.assign(He.prototype,{isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,a=t.elements;return this.x=a[0]*e+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*e+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*e+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*e+a[7]*n+a[11]*r+a[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r,i,a=t.elements,o=a[0],s=a[4],c=a[8],l=a[1],u=a[5],h=a[9],f=a[2],d=a[6],p=a[10];if(Math.abs(s-l)<.01&&Math.abs(c-f)<.01&&Math.abs(h-d)<.01){if(Math.abs(s+l)<.1&&Math.abs(c+f)<.1&&Math.abs(h+d)<.1&&Math.abs(o+u+p-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(o+1)/2,v=(u+1)/2,g=(p+1)/2,y=(s+l)/4,_=(c+f)/4,x=(h+d)/4;return m>v&&m>g?m<.01?(n=0,r=.707106781,i=.707106781):(r=y/(n=Math.sqrt(m)),i=_/n):v>g?v<.01?(n=.707106781,r=0,i=.707106781):(n=y/(r=Math.sqrt(v)),i=x/r):g<.01?(n=.707106781,r=.707106781,i=0):(n=_/(i=Math.sqrt(g)),r=x/i),this.set(n,r,i,e),this}var b=Math.sqrt((d-h)*(d-h)+(c-f)*(c-f)+(l-s)*(l-s));return Math.abs(b)<.001&&(b=1),this.x=(d-h)/b,this.y=(c-f)/b,this.z=(l-s)/b,this.w=Math.acos((o+u+p-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(n,r){return void 0===t&&(t=new He,e=new He),t.set(n,n,n,n),e.set(r,r,r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),e.WebGLRenderTarget=Ge,Ge.prototype=Object.assign(Object.create(r.prototype),{constructor:Ge,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),e.WebGLRenderTargetCube=Ve,Ve.prototype=Object.create(Ge.prototype),Ve.prototype.constructor=Ve,Ve.prototype.isWebGLRenderTargetCube=!0,e.DataTexture=We,We.prototype=Object.create(je.prototype),We.prototype.constructor=We,We.prototype.isDataTexture=!0,e.Box3=qe,Object.assign(qe.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,c=t.length;s<c;s+=3){var l=t[s],u=t[s+1],h=t[s+2];l<e&&(e=l),u<n&&(n=u),h<r&&(r=h),l>i&&(i=l),u>a&&(a=u),h>o&&(o=h)}return this.min.set(e,n,r),this.max.set(i,a,o),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,c=t.count;s<c;s++){var l=t.getX(s),u=t.getY(s),h=t.getZ(s);l<e&&(e=l),u<n&&(n=u),h<r&&(r=h),l>i&&(i=l),u>a&&(a=u),h>o&&(o=h)}return this.min.set(e,n,r),this.max.set(i,a,o),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new Oe;return function(e,n){var r=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Oe),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Oe),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(){var t,e,n,r=new Oe;function i(i){var a=i.geometry;if(void 0!==a)if(a.isGeometry){var o=a.vertices;for(e=0,n=o.length;e<n;e++)r.copy(o[e]),r.applyMatrix4(i.matrixWorld),t.expandByPoint(r)}else if(a.isBufferGeometry){var s=a.attributes.position;if(void 0!==s)for(e=0,n=s.count;e<n;e++)r.fromBufferAttribute(s,e).applyMatrix4(i.matrixWorld),t.expandByPoint(r)}}return function(e){return t=this,e.updateMatrixWorld(!0),e.traverse(i),this}}(),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Oe),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:(ze=new Oe,function(t){return this.clampPoint(t.center,ze),ze.distanceToSquared(t.center)<=t.radius*t.radius}),intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=t.constant&&n>=t.constant},intersectsTriangle:function(){var t=new Oe,e=new Oe,n=new Oe,r=new Oe,i=new Oe,a=new Oe,o=new Oe,s=new Oe,c=new Oe,l=new Oe;function u(r){var i,a;for(i=0,a=r.length-3;i<=a;i+=3){o.fromArray(r,i);var s=c.x*Math.abs(o.x)+c.y*Math.abs(o.y)+c.z*Math.abs(o.z),l=t.dot(o),u=e.dot(o),h=n.dot(o);if(Math.max(-Math.max(l,u,h),Math.min(l,u,h))>s)return!1}return!0}return function(o){if(this.isEmpty())return!1;this.getCenter(s),c.subVectors(this.max,s),t.subVectors(o.a,s),e.subVectors(o.b,s),n.subVectors(o.c,s),r.subVectors(e,t),i.subVectors(n,e),a.subVectors(t,n);var h=[0,-r.z,r.y,0,-i.z,i.y,0,-a.z,a.y,r.z,0,-r.x,i.z,0,-i.x,a.z,0,-a.x,-r.y,r.x,0,-i.y,i.x,0,-a.y,a.x,0];return!!u(h)&&(!!u(h=[1,0,0,0,1,0,0,0,1])&&(l.crossVectors(r,i),u(h=[l.x,l.y,l.z])))}}(),clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Oe),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new Oe;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new Oe;return function(e){return void 0===e&&(console.warn("THREE.Box3: .getBoundingSphere() target is now required"),e=new Xe),this.getCenter(e.center),e.radius=.5*this.getSize(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:(Ie=[new Oe,new Oe,new Oe,new Oe,new Oe,new Oe,new Oe,new Oe],function(t){return this.isEmpty()?this:(Ie[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Ie[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Ie[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Ie[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Ie[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Ie[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Ie[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Ie[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Ie),this)}),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),e.Sphere=Xe,Object.assign(Xe.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:(Ue=new qe,function(t,e){var n=this.center;void 0!==e?n.copy(e):Ue.setFromPoints(t).getCenter(n);for(var r=0,i=0,a=t.length;i<a;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new Oe),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new qe),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),e.Plane=Ye,Object.assign(Ye.prototype,{set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new Oe,e=new Oe;return function(n,r,i){var a=t.subVectors(i,r).cross(e.subVectors(n,r)).normalize();return this.setFromNormalAndCoplanarPoint(a,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new Oe),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(){var t=new Oe;return function(e,n){void 0===n&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new Oe);var r=e.delta(t),i=this.normal.dot(r);if(0===i)return 0===this.distanceToPoint(e.start)?n.copy(e.start):void 0;var a=-(e.start.dot(this.normal)+this.constant)/i;return a<0||a>1?void 0:n.copy(r).multiplyScalar(a).add(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new Oe),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new Oe,e=new Ne;return function(n,r){var i=r||e.getNormalMatrix(n),a=this.coplanarPoint(t).applyMatrix4(n),o=this.normal.applyMatrix3(i).normalize();return this.constant=-a.dot(o),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}),e.Frustum=Ze,Object.assign(Ze.prototype,{set:function(t,e,n,r,i,a){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e=this.planes,n=t.elements,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],c=n[5],l=n[6],u=n[7],h=n[8],f=n[9],d=n[10],p=n[11],m=n[12],v=n[13],g=n[14],y=n[15];return e[0].setComponents(o-r,u-s,p-h,y-m).normalize(),e[1].setComponents(o+r,u+s,p+h,y+m).normalize(),e[2].setComponents(o+i,u+c,p+f,y+v).normalize(),e[3].setComponents(o-i,u-c,p-f,y-v).normalize(),e[4].setComponents(o-a,u-l,p-d,y-g).normalize(),e[5].setComponents(o+a,u+l,p+d,y+g).normalize(),this},intersectsObject:(Fe=new Xe,function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Fe.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Fe)}),intersectsSprite:function(){var t=new Xe;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,n=t.center,r=-t.radius,i=0;i<6;i++){if(e[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:(De=new Oe,ke=new Oe,function(t){for(var e=this.planes,n=0;n<6;n++){var r=e[n];De.x=r.normal.x>0?t.min.x:t.max.x,ke.x=r.normal.x>0?t.max.x:t.min.x,De.y=r.normal.y>0?t.min.y:t.max.y,ke.y=r.normal.y>0?t.max.y:t.min.y,De.z=r.normal.z>0?t.min.z:t.max.z,ke.z=r.normal.z>0?t.max.z:t.min.z;var i=r.distanceToPoint(De),a=r.distanceToPoint(ke);if(i<0&&a<0)return!1}return!0}),containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}});var Je={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",lights_pars_maps:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"};e.ShaderChunk=Je;var Qe={merge:function(t){for(var e={},n=0;n<t.length;n++){var r=this.clone(t[n]);for(var i in r)e[i]=r[i]}return e},clone:function(t){var e={};for(var n in t)for(var r in e[n]={},t[n]){var i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}return e}};e.UniformsUtils=Qe;var Ke,$e={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function tn(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}e.Color=tn,Object.assign(tn.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(){function t(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}return function(e,n,r){if(e=Re.euclideanModulo(e,1),n=Re.clamp(n,0,1),r=Re.clamp(r,0,1),0===n)this.r=this.g=this.b=r;else{var i=r<=.5?r*(1+n):r+n-r*n,a=2*r-i;this.r=t(a,i,e+1/3),this.g=t(a,i,e),this.b=t(a,i,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,i=n[1],a=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,c=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(o,s,c)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var l,u=(l=n[1]).length;if(3===u)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}t&&t.length>0&&(void 0!==(l=$e[t])?this.setHex(l):console.warn("THREE.Color: Unknown color "+t));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(){var t=this.r,e=this.g,n=this.b;return this.r=t*t,this.g=e*e,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,n,r=this.r,i=this.g,a=this.b,o=Math.max(r,i,a),s=Math.min(r,i,a),c=(s+o)/2;if(s===o)e=0,n=0;else{var l=o-s;switch(n=c<=.5?l/(o+s):l/(2-o-s),o){case r:e=(i-a)/l+(i<a?6:0);break;case i:e=(a-r)/l+2;break;case a:e=(r-i)/l+4}e/=6}return t.h=e,t.s=n,t.l=c,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:(Ke={},function(t,e,n){return this.getHSL(Ke),Ke.h+=t,Ke.s+=e,Ke.l+=n,this.setHSL(Ke.h,Ke.s,Ke.l),this}),add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}});var en={common:{diffuse:{value:new tn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ne},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Le(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new tn(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new tn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new Ne}}};e.UniformsLib=en;var nn,rn={basic:{uniforms:Qe.merge([en.common,en.specularmap,en.envmap,en.aomap,en.lightmap,en.fog]),vertexShader:Je.meshbasic_vert,fragmentShader:Je.meshbasic_frag},lambert:{uniforms:Qe.merge([en.common,en.specularmap,en.envmap,en.aomap,en.lightmap,en.emissivemap,en.fog,en.lights,{emissive:{value:new tn(0)}}]),vertexShader:Je.meshlambert_vert,fragmentShader:Je.meshlambert_frag},phong:{uniforms:Qe.merge([en.common,en.specularmap,en.envmap,en.aomap,en.lightmap,en.emissivemap,en.bumpmap,en.normalmap,en.displacementmap,en.gradientmap,en.fog,en.lights,{emissive:{value:new tn(0)},specular:{value:new tn(1118481)},shininess:{value:30}}]),vertexShader:Je.meshphong_vert,fragmentShader:Je.meshphong_frag},standard:{uniforms:Qe.merge([en.common,en.envmap,en.aomap,en.lightmap,en.emissivemap,en.bumpmap,en.normalmap,en.displacementmap,en.roughnessmap,en.metalnessmap,en.fog,en.lights,{emissive:{value:new tn(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Je.meshphysical_vert,fragmentShader:Je.meshphysical_frag},points:{uniforms:Qe.merge([en.points,en.fog]),vertexShader:Je.points_vert,fragmentShader:Je.points_frag},dashed:{uniforms:Qe.merge([en.common,en.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Je.linedashed_vert,fragmentShader:Je.linedashed_frag},depth:{uniforms:Qe.merge([en.common,en.displacementmap]),vertexShader:Je.depth_vert,fragmentShader:Je.depth_frag},normal:{uniforms:Qe.merge([en.common,en.bumpmap,en.normalmap,en.displacementmap,{opacity:{value:1}}]),vertexShader:Je.normal_vert,fragmentShader:Je.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Je.cube_vert,fragmentShader:Je.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Je.equirect_vert,fragmentShader:Je.equirect_frag},distanceRGBA:{uniforms:Qe.merge([en.common,en.displacementmap,{referencePosition:{value:new Oe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Je.distanceRGBA_vert,fragmentShader:Je.distanceRGBA_frag},shadow:{uniforms:Qe.merge([en.lights,en.fog,{color:{value:new tn(0)},opacity:{value:1}}]),vertexShader:Je.shadow_vert,fragmentShader:Je.shadow_frag}};function an(t){var e=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),e.get(t)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);var r=e.get(n);r&&(t.deleteBuffer(r.buffer),e.delete(n))},update:function(n,r){n.isInterleavedBufferAttribute&&(n=n.data);var i=e.get(n);void 0===i?e.set(n,function(e,n){var r=e.array,i=e.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW,a=t.createBuffer();t.bindBuffer(n,a),t.bufferData(n,r,i),e.onUploadCallback();var o=t.FLOAT;return r instanceof Float32Array?o=t.FLOAT:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?o=t.UNSIGNED_SHORT:r instanceof Int16Array?o=t.SHORT:r instanceof Uint32Array?o=t.UNSIGNED_INT:r instanceof Int32Array?o=t.INT:r instanceof Int8Array?o=t.BYTE:r instanceof Uint8Array&&(o=t.UNSIGNED_BYTE),{buffer:a,type:o,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(n,r)):i.version<n.version&&(function(e,n,r){var i=n.array,a=n.updateRange;t.bindBuffer(r,e),!1===n.dynamic?t.bufferData(r,i,t.STATIC_DRAW):-1===a.count?t.bufferSubData(r,0,i):0===a.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(r,a.offset*i.BYTES_PER_ELEMENT,i.subarray(a.offset,a.offset+a.count)),a.count=-1)}(i.buffer,n,r),i.version=n.version)}}}function on(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||on.DefaultOrder}function sn(){this.mask=1}e.ShaderLib=rn,rn.physical={uniforms:Qe.merge([rn.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Je.meshphysical_vert,fragmentShader:Je.meshphysical_frag},e.Euler=on,on.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],on.DefaultOrder="XYZ",Object.defineProperties(on.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(on.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=Re.clamp,i=t.elements,a=i[0],o=i[4],s=i[8],c=i[1],l=i[5],u=i[9],h=i[2],f=i[6],d=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(f,l),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(s,d),this._z=Math.atan2(c,l)):(this._y=Math.atan2(-h,a),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(f,-1,1)),Math.abs(f)<.99999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(c,a))):"ZYX"===e?(this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(f,d),this._z=Math.atan2(c,a)):(this._x=0,this._z=Math.atan2(-o,l))):"YZX"===e?(this._z=Math.asin(r(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-h,a)):(this._x=0,this._y=Math.atan2(s,d))):"XZY"===e?(this._z=Math.asin(-r(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(f,l),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-u,d),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new Ce;return function(e,n,r){return t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,n,r)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:(nn=new Pe,function(t){return nn.setFromEuler(this),this.setFromQuaternion(nn,t)}),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Oe(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),e.Layers=sn,Object.assign(sn.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!=(this.mask&t.mask)}});var cn,ln,un,hn,fn=0;function dn(){Object.defineProperty(this,"id",{value:fn++}),this.uuid=Re.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=dn.DefaultUp.clone();var t=new Oe,e=new on,n=new Pe,r=new Oe(1,1,1);e.onChange(function(){n.setFromEuler(e,!1)}),n.onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:r},modelViewMatrix:{value:new Ce},normalMatrix:{value:new Ne}}),this.matrix=new Ce,this.matrixWorld=new Ce,this.matrixAutoUpdate=dn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new sn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function pn(){dn.call(this),this.type="Camera",this.matrixWorldInverse=new Ce,this.projectionMatrix=new Ce}function mn(t,e,n,r,i,a){pn.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=void 0!==i?i:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function vn(t,e,n,r,i,a){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new Oe,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new tn,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==a?a:0}e.Object3D=dn,dn.DefaultUp=new Oe(0,1,0),dn.DefaultMatrixAutoUpdate=!0,dn.prototype=Object.assign(Object.create(r.prototype),{constructor:dn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:(hn=new Pe,function(t,e){return hn.setFromAxisAngle(t,e),this.quaternion.multiply(hn),this}),rotateOnWorldAxis:function(){var t=new Pe;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.premultiply(t),this}}(),rotateX:function(){var t=new Oe(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new Oe(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new Oe(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new Oe;return function(e,n){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translateX:function(){var t=new Oe(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new Oe(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new Oe(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:(un=new Ce,function(t){return t.applyMatrix4(un.getInverse(this.matrixWorld))}),lookAt:function(){var t=new Ce,e=new Oe;return function(n,r,i){n.isVector3?e.copy(n):e.set(n,r,i),this.isCamera?t.lookAt(this.position,e,this.up):t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Oe),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(cn=new Oe,ln=new Oe,function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new Pe),this.updateMatrixWorld(!0),this.matrixWorld.decompose(cn,t,ln),t}),getWorldScale:function(){var t=new Oe,e=new Pe;return function(n){return void 0===n&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),n=new Oe),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,n),n}}(),getWorldDirection:function(){var t=new Pe;return function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Oe),this.getWorldQuaternion(t),e.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},toJSON:function(t){var e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.matrix=this.matrix.toArray(),void 0!==this.geometry){r.geometry=i(t.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,c=o.length;s<c;s++){var l=o[s];i(t.shapes,l)}else i(t.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var u=[];for(s=0,c=this.material.length;s<c;s++)u.push(i(t.materials,this.material[s]));r.material=u}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(t).object)}if(e){var h=m(t.geometries),f=m(t.materials),d=m(t.textures),p=m(t.images);o=m(t.shapes);h.length>0&&(n.geometries=h),f.length>0&&(n.materials=f),d.length>0&&(n.textures=d),p.length>0&&(n.images=p),o.length>0&&(n.shapes=o)}return n.object=r,n;function m(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var r=t.children[n];this.add(r.clone())}return this}}),e.Camera=pn,pn.prototype=Object.assign(Object.create(dn.prototype),{constructor:pn,isCamera:!0,copy:function(t,e){return dn.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},getWorldDirection:function(){var t=new Pe;return function(e){return void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Oe),this.getWorldQuaternion(t),e.set(0,0,-1).applyQuaternion(t)}}(),updateMatrixWorld:function(t){dn.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),e.OrthographicCamera=mn,mn.prototype=Object.assign(Object.create(pn.prototype),{constructor:mn,isOrthographicCamera:!0,copy:function(t,e){return pn.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-t,a=n+t,o=r+e,s=r-e;if(null!==this.view&&this.view.enabled){var c=this.zoom/(this.view.width/this.view.fullWidth),l=this.zoom/(this.view.height/this.view.fullHeight),u=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;a=(i+=u*(this.view.offsetX/c))+u*(this.view.width/c),s=(o-=h*(this.view.offsetY/l))-h*(this.view.height/l)}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far)},toJSON:function(t){var e=dn.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),e.Face3=vn,Object.assign(vn.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var gn,yn,_n=0;function xn(){Object.defineProperty(this,"id",{value:_n+=2}),this.uuid=Re.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function bn(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function wn(t,e,n){bn.call(this,new Int8Array(t),e,n)}function Mn(t,e,n){bn.call(this,new Uint8Array(t),e,n)}function En(t,e,n){bn.call(this,new Uint8ClampedArray(t),e,n)}function Tn(t,e,n){bn.call(this,new Int16Array(t),e,n)}function Sn(t,e,n){bn.call(this,new Uint16Array(t),e,n)}function An(t,e,n){bn.call(this,new Int32Array(t),e,n)}function Rn(t,e,n){bn.call(this,new Uint32Array(t),e,n)}function Ln(t,e,n){bn.call(this,new Float32Array(t),e,n)}function Cn(t,e,n){bn.call(this,new Float64Array(t),e,n)}function Pn(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function On(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}e.Geometry=xn,xn.prototype=Object.assign(Object.create(r.prototype),{constructor:xn,isGeometry:!0,applyMatrix:function(t){for(var e=(new Ne).getNormalMatrix(t),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(t)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(e).normalize();for(var a=0,o=i.vertexNormals.length;a<o;a++)i.vertexNormals[a].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t=new Ce;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new Ce;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new Ce;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new Ce;return function(e,n,r){return t.makeTranslation(e,n,r),this.applyMatrix(t),this}}(),scale:function(){var t=new Ce;return function(e,n,r){return t.makeScale(e,n,r),this.applyMatrix(t),this}}(),lookAt:(yn=new dn,function(t){yn.lookAt(t),yn.updateMatrix(),this.applyMatrix(yn.matrix)}),fromBufferGeometry:function(t){var e=this,n=null!==t.index?t.index.array:void 0,r=t.attributes,i=r.position.array,a=void 0!==r.normal?r.normal.array:void 0,o=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,c=void 0!==r.uv2?r.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var l=[],u=[],h=[],f=0,d=0;f<i.length;f+=3,d+=2)e.vertices.push(new Oe(i[f],i[f+1],i[f+2])),void 0!==a&&l.push(new Oe(a[f],a[f+1],a[f+2])),void 0!==o&&e.colors.push(new tn(o[f],o[f+1],o[f+2])),void 0!==s&&u.push(new Le(s[d],s[d+1])),void 0!==c&&h.push(new Le(c[d],c[d+1]));function p(t,n,r,i){var f=new vn(t,n,r,void 0!==a?[l[t].clone(),l[n].clone(),l[r].clone()]:[],void 0!==o?[e.colors[t].clone(),e.colors[n].clone(),e.colors[r].clone()]:[],i);e.faces.push(f),void 0!==s&&e.faceVertexUvs[0].push([u[t].clone(),u[n].clone(),u[r].clone()]),void 0!==c&&e.faceVertexUvs[1].push([h[t].clone(),h[n].clone(),h[r].clone()])}var m=t.groups;if(m.length>0)for(f=0;f<m.length;f++)for(var v=m[f],g=v.start,y=(d=g,g+v.count);d<y;d+=3)void 0!==n?p(n[d],n[d+1],n[d+2],v.materialIndex):p(d,d+1,d+2,v.materialIndex);else if(void 0!==n)for(f=0;f<n.length;f+=3)p(n[f],n[f+1],n[f+2]);else for(f=0;f<i.length/3;f+=3)p(f,f+1,f+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:(gn=new Oe,function(){return this.computeBoundingBox(),this.boundingBox.getCenter(gn).negate(),this.translate(gn.x,gn.y,gn.z),this}),normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,r=new Ce;return r.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var t=new Oe,e=new Oe,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],a=this.vertices[i.a],o=this.vertices[i.b],s=this.vertices[i.c];t.subVectors(s,o),e.subVectors(a,o),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){var e,n,r,i,a,o;for(void 0===t&&(t=!0),o=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)o[e]=new Oe;if(t){var s,c,l,u=new Oe,h=new Oe;for(r=0,i=this.faces.length;r<i;r++)a=this.faces[r],s=this.vertices[a.a],c=this.vertices[a.b],l=this.vertices[a.c],u.subVectors(l,c),h.subVectors(s,c),u.cross(h),o[a.a].add(u),o[a.b].add(u),o[a.c].add(u)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)o[(a=this.faces[r]).a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(e=0,n=this.vertices.length;e<n;e++)o[e].normalize();for(r=0,i=this.faces.length;r<i;r++){var f=(a=this.faces[r]).vertexNormals;3===f.length?(f[0].copy(o[a.a]),f[1].copy(o[a.b]),f[2].copy(o[a.c])):(f[0]=o[a.a].clone(),f[1]=o[a.b].clone(),f[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var r=(n=this.faces[t]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,e=i.vertexNormals.length;t<e;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var a=new xn;for(a.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var o=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)c=new Oe,l={a:new Oe,b:new Oe,c:new Oe},o.push(c),s.push(l)}var c,l,u=this.morphNormals[t];for(a.vertices=this.morphTargets[t].vertices,a.computeFaceNormals(),a.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],c=u.faceNormals[n],l=u.vertexNormals[n],c.copy(i.normal),l.a.copy(i.vertexNormals[0]),l.b.copy(i.vertexNormals[1]),l.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new qe),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Xe),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t&&t.isGeometry){var r,i=this.vertices.length,a=this.vertices,o=t.vertices,s=this.faces,c=t.faces,l=this.faceVertexUvs[0],u=t.faceVertexUvs[0],h=this.colors,f=t.colors;void 0===n&&(n=0),void 0!==e&&(r=(new Ne).getNormalMatrix(e));for(var d=0,p=o.length;d<p;d++){var m=o[d].clone();void 0!==e&&m.applyMatrix4(e),a.push(m)}for(d=0,p=f.length;d<p;d++)h.push(f[d].clone());for(d=0,p=c.length;d<p;d++){var v,g,y,_=c[d],x=_.vertexNormals,b=_.vertexColors;(v=new vn(_.a+i,_.b+i,_.c+i)).normal.copy(_.normal),void 0!==r&&v.normal.applyMatrix3(r).normalize();for(var w=0,M=x.length;w<M;w++)g=x[w].clone(),void 0!==r&&g.applyMatrix3(r).normalize(),v.vertexNormals.push(g);v.color.copy(_.color);for(w=0,M=b.length;w<M;w++)y=b[w],v.vertexColors.push(y.clone());v.materialIndex=_.materialIndex+n,s.push(v)}for(d=0,p=u.length;d<p;d++){var E=u[d],T=[];if(void 0!==E){for(w=0,M=E.length;w<M;w++)T.push(E[w].clone());l.push(T)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,n,r,i,a,o,s,c={},l=[],u=[],h=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)t=this.vertices[n],void 0===c[e=Math.round(t.x*h)+"_"+Math.round(t.y*h)+"_"+Math.round(t.z*h)]?(c[e]=n,l.push(this.vertices[n]),u[n]=l.length-1):u[n]=u[c[e]];var f=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=u[i.a],i.b=u[i.b],i.c=u[i.c],a=[i.a,i.b,i.c];for(var d=0;d<3;d++)if(a[d]===a[(d+1)%3]){f.push(n);break}}for(n=f.length-1;n>=0;n--){var p=f[n];for(this.faces.splice(p,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(p,1)}var m=this.vertices.length-l.length;return this.vertices=l,m},setFromPoints:function(t){this.vertices=[];for(var e=0,n=t.length;e<n;e++){var r=t[e];this.vertices.push(new Oe(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var r,i,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];a&&a.length===e&&(r=[]),o&&o.length===e&&(i=[]);for(n=0;n<e;n++){var s=t[n]._id;r&&r.push(a[s]),i&&i.push(o[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}for(var r=[],i=0;i<this.vertices.length;i++){var a=this.vertices[i];r.push(a.x,a.y,a.z)}var o=[],s=[],c={},l=[],u={},h=[],f={};for(i=0;i<this.faces.length;i++){var d=this.faces[i],p=void 0!==this.faceVertexUvs[0][i],m=d.normal.length()>0,v=d.vertexNormals.length>0,g=1!==d.color.r||1!==d.color.g||1!==d.color.b,y=d.vertexColors.length>0,_=0;if(_=M(_,0,0),_=M(_,1,!0),_=M(_,2,!1),_=M(_,3,p),_=M(_,4,m),_=M(_,5,v),_=M(_,6,g),_=M(_,7,y),o.push(_),o.push(d.a,d.b,d.c),o.push(d.materialIndex),p){var x=this.faceVertexUvs[0][i];o.push(S(x[0]),S(x[1]),S(x[2]))}if(m&&o.push(E(d.normal)),v){var b=d.vertexNormals;o.push(E(b[0]),E(b[1]),E(b[2]))}if(g&&o.push(T(d.color)),y){var w=d.vertexColors;o.push(T(w[0]),T(w[1]),T(w[2]))}}function M(t,e,n){return n?t|1<<e:t&~(1<<e)}function E(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==c[e]?c[e]:(c[e]=s.length/3,s.push(t.x,t.y,t.z),c[e])}function T(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==u[e]?u[e]:(u[e]=l.length,l.push(t.getHex()),u[e])}function S(t){var e=t.x.toString()+t.y.toString();return void 0!==f[e]?f[e]:(f[e]=h.length/2,h.push(t.x,t.y),f[e])}return t.data={},t.data.vertices=r,t.data.normals=s,l.length>0&&(t.data.colors=l),h.length>0&&(t.data.uvs=[h]),t.data.faces=o,t},clone:function(){return(new xn).copy(this)},copy:function(t){var e,n,r,i,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,n=s.length;e<n;e++)this.vertices.push(s[e].clone());var c=t.colors;for(e=0,n=c.length;e<n;e++)this.colors.push(c[e].clone());var l=t.faces;for(e=0,n=l.length;e<n;e++)this.faces.push(l[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var u=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),r=0,i=u.length;r<i;r++){var h=u[r],f=[];for(a=0,o=h.length;a<o;a++){var d=h[a];f.push(d.clone())}this.faceVertexUvs[e].push(f)}}var p=t.morphTargets;for(e=0,n=p.length;e<n;e++){var m={};if(m.name=p[e].name,void 0!==p[e].vertices)for(m.vertices=[],r=0,i=p[e].vertices.length;r<i;r++)m.vertices.push(p[e].vertices[r].clone());if(void 0!==p[e].normals)for(m.normals=[],r=0,i=p[e].normals.length;r<i;r++)m.normals.push(p[e].normals[r].clone());this.morphTargets.push(m)}var v=t.morphNormals;for(e=0,n=v.length;e<n;e++){var g={};if(void 0!==v[e].vertexNormals)for(g.vertexNormals=[],r=0,i=v[e].vertexNormals.length;r<i;r++){var y=v[e].vertexNormals[r],_={};_.a=y.a.clone(),_.b=y.b.clone(),_.c=y.c.clone(),g.vertexNormals.push(_)}if(void 0!==v[e].faceNormals)for(g.faceNormals=[],r=0,i=v[e].faceNormals.length;r<i;r++)g.faceNormals.push(v[e].faceNormals[r].clone());this.morphNormals.push(g)}var x=t.skinWeights;for(e=0,n=x.length;e<n;e++)this.skinWeights.push(x[e].clone());var b=t.skinIndices;for(e=0,n=b.length;e<n;e++)this.skinIndices.push(b[e].clone());var w=t.lineDistances;for(e=0,n=w.length;e<n;e++)this.lineDistances.push(w[e]);var M=t.boundingBox;null!==M&&(this.boundingBox=M.clone());var E=t.boundingSphere;return null!==E&&(this.boundingSphere=E.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),e.BufferAttribute=bn,Object.defineProperty(bn.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(bn.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.itemSize:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new tn),e[n++]=a.r,e[n++]=a.g,e[n++]=a.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new Le),e[n++]=a.x,e[n++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new Oe),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new He),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z,e[n++]=a.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),e.Int8BufferAttribute=wn,wn.prototype=Object.create(bn.prototype),wn.prototype.constructor=wn,e.Uint8BufferAttribute=Mn,Mn.prototype=Object.create(bn.prototype),Mn.prototype.constructor=Mn,e.Uint8ClampedBufferAttribute=En,En.prototype=Object.create(bn.prototype),En.prototype.constructor=En,e.Int16BufferAttribute=Tn,Tn.prototype=Object.create(bn.prototype),Tn.prototype.constructor=Tn,e.Uint16BufferAttribute=Sn,Sn.prototype=Object.create(bn.prototype),Sn.prototype.constructor=Sn,e.Int32BufferAttribute=An,An.prototype=Object.create(bn.prototype),An.prototype.constructor=An,e.Uint32BufferAttribute=Rn,Rn.prototype=Object.create(bn.prototype),Rn.prototype.constructor=Rn,e.Float32BufferAttribute=Ln,Ln.prototype=Object.create(bn.prototype),Ln.prototype.constructor=Ln,e.Float64BufferAttribute=Cn,Cn.prototype=Object.create(bn.prototype),Cn.prototype.constructor=Cn,Object.assign(Pn.prototype,{computeGroups:function(t){for(var e,n=[],r=void 0,i=t.faces,a=0;a<i.length;a++){var o=i[a];o.materialIndex!==r&&(r=o.materialIndex,void 0!==e&&(e.count=3*a-e.start,n.push(e)),e={start:3*a,materialIndex:r})}void 0!==e&&(e.count=3*a-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,r=t.vertices,i=t.faceVertexUvs,a=i[0]&&i[0].length>0,o=i[1]&&i[1].length>0,s=t.morphTargets,c=s.length;if(c>0){e=[];for(var l=0;l<c;l++)e[l]=[];this.morphTargets.position=e}var u,h=t.morphNormals,f=h.length;if(f>0){u=[];for(l=0;l<f;l++)u[l]=[];this.morphTargets.normal=u}var d=t.skinIndices,p=t.skinWeights,m=d.length===r.length,v=p.length===r.length;for(l=0;l<n.length;l++){var g=n[l];this.vertices.push(r[g.a],r[g.b],r[g.c]);var y=g.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var _=g.normal;this.normals.push(_,_,_)}var x,b=g.vertexColors;if(3===b.length)this.colors.push(b[0],b[1],b[2]);else{var w=g.color;this.colors.push(w,w,w)}if(!0===a)void 0!==(x=i[0][l])?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new Le,new Le,new Le));if(!0===o)void 0!==(x=i[1][l])?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new Le,new Le,new Le));for(var M=0;M<c;M++){var E=s[M].vertices;e[M].push(E[g.a],E[g.b],E[g.c])}for(M=0;M<f;M++){var T=h[M].vertexNormals[l];u[M].push(T.a,T.b,T.c)}m&&this.skinIndices.push(d[g.a],d[g.b],d[g.c]),v&&this.skinWeights.push(p[g.a],p[g.b],p[g.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}});var Nn=1;function In(){Object.defineProperty(this,"id",{value:Nn+=2}),this.uuid=Re.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function zn(t,e,n,r,i,a){xn.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:a},this.fromBufferGeometry(new Un(t,e,n,r,i,a)),this.mergeVertices()}function Un(t,e,n,r,i,a){In.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};var o=this;t=t||1,e=e||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1,a=Math.floor(a)||1;var s=[],c=[],l=[],u=[],h=0,f=0;function d(t,e,n,r,i,a,d,p,m,v,g){var y,_,x=a/m,b=d/v,w=a/2,M=d/2,E=p/2,T=m+1,S=v+1,A=0,R=0,L=new Oe;for(_=0;_<S;_++){var C=_*b-M;for(y=0;y<T;y++){var P=y*x-w;L[t]=P*r,L[e]=C*i,L[n]=E,c.push(L.x,L.y,L.z),L[t]=0,L[e]=0,L[n]=p>0?1:-1,l.push(L.x,L.y,L.z),u.push(y/m),u.push(1-_/v),A+=1}}for(_=0;_<v;_++)for(y=0;y<m;y++){var O=h+y+T*_,N=h+y+T*(_+1),I=h+(y+1)+T*(_+1),z=h+(y+1)+T*_;s.push(O,N,z),s.push(N,I,z),R+=6}o.addGroup(f,R,g),f+=R,h+=A}d("z","y","x",-1,-1,n,e,t,a,i,0),d("z","y","x",1,-1,n,e,-t,a,i,1),d("x","z","y",1,1,t,n,e,r,a,2),d("x","z","y",1,-1,t,n,-e,r,a,3),d("x","y","z",1,-1,t,e,n,r,i,4),d("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(s),this.addAttribute("position",new Ln(c,3)),this.addAttribute("normal",new Ln(l,3)),this.addAttribute("uv",new Ln(u,2))}function Dn(t,e,n,r){xn.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new kn(t,e,n,r)),this.mergeVertices()}function kn(t,e,n,r){In.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};var i,a,o=(t=t||1)/2,s=(e=e||1)/2,c=Math.floor(n)||1,l=Math.floor(r)||1,u=c+1,h=l+1,f=t/c,d=e/l,p=[],m=[],v=[],g=[];for(a=0;a<h;a++){var y=a*d-s;for(i=0;i<u;i++){var _=i*f-o;m.push(_,-y,0),v.push(0,0,1),g.push(i/c),g.push(1-a/l)}}for(a=0;a<l;a++)for(i=0;i<c;i++){var x=i+u*a,b=i+u*(a+1),w=i+1+u*(a+1),M=i+1+u*a;p.push(x,b,M),p.push(b,w,M)}this.setIndex(p),this.addAttribute("position",new Ln(m,3)),this.addAttribute("normal",new Ln(v,3)),this.addAttribute("uv",new Ln(g,2))}e.BufferGeometry=In,In.prototype=Object.assign(Object.create(r.prototype),{constructor:In,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(On(t)>65535?Rn:Sn)(t,1):this.index=t},addAttribute:function(t,e){return e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(e)):(this.attributes[t]=e,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new bn(arguments[1],arguments[2])))},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var n=this.attributes.normal;void 0!==n&&((new Ne).getNormalMatrix(t).applyToBufferAttribute(n),n.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t=new Ce;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new Ce;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new Ce;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new Ce;return function(e,n,r){return t.makeTranslation(e,n,r),this.applyMatrix(t),this}}(),scale:function(){var t=new Ce;return function(e,n,r){return t.makeScale(e,n,r),this.applyMatrix(t),this}}(),lookAt:function(){var t=new dn;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){var t=new Oe;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(t).negate(),this.translate(t.x,t.y,t.z),this}}(),setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var n=new Ln(3*e.vertices.length,3),r=new Ln(3*e.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(e.vertices)),this.addAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var i=new Ln(e.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];e.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new Ln(e,3)),this},updateFromObject:function(t){var e,n=t.geometry;if(t.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(n.vertices),e.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(n.normals),e.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(n.colors),e.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(n.uvs),e.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(n.lineDistances),e.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Pn).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new bn(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.addAttribute("normal",new bn(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var r=new Float32Array(3*t.colors.length);this.addAttribute("color",new bn(r,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var i=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new bn(i,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var a=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new bn(a,2).copyVector2sArray(t.uvs2))}for(var o in this.groups=t.groups,t.morphTargets){for(var s=[],c=t.morphTargets[o],l=0,u=c.length;l<u;l++){var h=c[l],f=new Ln(3*h.length,3);s.push(f.copyVector3sArray(h))}this.morphAttributes[o]=s}if(t.skinIndices.length>0){var d=new Ln(4*t.skinIndices.length,4);this.addAttribute("skinIndex",d.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var p=new Ln(4*t.skinWeights.length,4);this.addAttribute("skinWeight",p.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new qe);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new qe,e=new Oe;return function(){null===this.boundingSphere&&(this.boundingSphere=new Xe);var n=this.attributes.position;if(n){var r=this.boundingSphere.center;t.setFromBufferAttribute(n),t.getCenter(r);for(var i=0,a=0,o=n.count;a<o;a++)e.x=n.getX(a),e.y=n.getY(a),e.z=n.getZ(a),i=Math.max(i,r.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,n=this.groups;if(e.position){var r=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new bn(new Float32Array(r.length),3));else for(var i=e.normal.array,a=0,o=i.length;a<o;a++)i[a]=0;var s,c,l,u=e.normal.array,h=new Oe,f=new Oe,d=new Oe,p=new Oe,m=new Oe;if(t){var v=t.array;0===n.length&&this.addGroup(0,v.length);for(var g=0,y=n.length;g<y;++g){var _=n[g],x=_.start;for(a=x,o=x+_.count;a<o;a+=3)s=3*v[a+0],c=3*v[a+1],l=3*v[a+2],h.fromArray(r,s),f.fromArray(r,c),d.fromArray(r,l),p.subVectors(d,f),m.subVectors(h,f),p.cross(m),u[s]+=p.x,u[s+1]+=p.y,u[s+2]+=p.z,u[c]+=p.x,u[c+1]+=p.y,u[c+2]+=p.z,u[l]+=p.x,u[l+1]+=p.y,u[l+2]+=p.z}}else for(a=0,o=r.length;a<o;a+=9)h.fromArray(r,a),f.fromArray(r,a+3),d.fromArray(r,a+6),p.subVectors(d,f),m.subVectors(h,f),p.cross(m),u[a]=p.x,u[a+1]=p.y,u[a+2]=p.z,u[a+3]=p.x,u[a+4]=p.y,u[a+5]=p.z,u[a+6]=p.x,u[a+7]=p.y,u[a+8]=p.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,a=t.attributes[r],o=a.array,s=0,c=a.itemSize*e;s<o.length;s++,c++)i[c]=o[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){var t=new Oe;return function(){for(var e=this.attributes.normal,n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.normalize(),e.setXYZ(n,t.x,t.y,t.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new In,e=this.index.array,n=this.attributes;for(var r in n){for(var i=n[r],a=i.array,o=i.itemSize,s=new a.constructor(e.length*o),c=0,l=0,u=0,h=e.length;u<h;u++){c=e[u]*o;for(var f=0;f<o;f++)s[l++]=a[c++]}t.addAttribute(r,new bn(s,o))}var d=this.groups;for(u=0,h=d.length;u<h;u++){var p=d[u];t.addGroup(p.start,p.count,p.materialIndex)}return t},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var r=this.index;if(null!==r){var i=Array.prototype.slice.call(r.array);t.data.index={type:r.array.constructor.name,array:i}}var a=this.attributes;for(var n in a){var o=a[n];i=Array.prototype.slice.call(o.array);t.data.attributes[n]={itemSize:o.itemSize,type:o.array.constructor.name,array:i,normalized:o.normalized}}var s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));var c=this.boundingSphere;return null!==c&&(t.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),t},clone:function(){return(new In).copy(this)},copy:function(t){var e,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone());var a=t.attributes;for(e in a){var o=a[e];this.addAttribute(e,o.clone())}var s=t.morphAttributes;for(e in s){var c=[],l=s[e];for(n=0,r=l.length;n<r;n++)c.push(l[n].clone());this.morphAttributes[e]=c}var u=t.groups;for(n=0,r=u.length;n<r;n++){var h=u[n];this.addGroup(h.start,h.count,h.materialIndex)}var f=t.boundingBox;null!==f&&(this.boundingBox=f.clone());var d=t.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),e.BoxGeometry=zn,e.CubeGeometry=zn,zn.prototype=Object.create(xn.prototype),zn.prototype.constructor=zn,e.BoxBufferGeometry=Un,Un.prototype=Object.create(In.prototype),Un.prototype.constructor=Un,e.PlaneGeometry=Dn,Dn.prototype=Object.create(xn.prototype),Dn.prototype.constructor=Dn,e.PlaneBufferGeometry=kn,kn.prototype=Object.create(In.prototype),kn.prototype.constructor=kn;var Fn,Bn,jn,Hn,Gn,Vn,Wn,qn=0;function Xn(){Object.defineProperty(this,"id",{value:qn++}),this.uuid=Re.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=g,this.side=u,this.flatShading=!1,this.vertexColors=d,this.opacity=1,this.transparent=!1,this.blendSrc=P,this.blendDst=O,this.blendEquation=w,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=j,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function Yn(t){Xn.call(this),this.type="MeshBasicMaterial",this.color=new tn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=q,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function Zn(t){Xn.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Jn(t,e){this.origin=void 0!==t?t:new Oe,this.direction=void 0!==e?e:new Oe}function Qn(t,e){this.start=void 0!==t?t:new Oe,this.end=void 0!==e?e:new Oe}function Kn(t,e,n){this.a=void 0!==t?t:new Oe,this.b=void 0!==e?e:new Oe,this.c=void 0!==n?n:new Oe}function $n(t,e){dn.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new In,this.material=void 0!==e?e:new Yn({color:16777215*Math.random()}),this.drawMode=se,this.updateMorphTargets()}function tr(t,e,n,r){var i,a,o,s=new tn(0),c=0;function l(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,r)}return{getClearColor:function(){return s},setClearColor:function(t,e){s.set(t),l(s,c=void 0!==e?e:1)},getClearAlpha:function(){return c},setClearAlpha:function(t){l(s,c=t)},render:function(e,r,u,f){var d=r.background;null===d?l(s,c):d&&d.isColor&&(l(d,1),f=!0),(t.autoClear||f)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),d&&d.isCubeTexture?(void 0===o&&((o=new $n(new Un(1,1,1),new Zn({uniforms:rn.cube.uniforms,vertexShader:rn.cube.vertexShader,fragmentShader:rn.cube.fragmentShader,side:h,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),o.geometry.removeAttribute("uv"),o.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},n.update(o.geometry)),o.material.uniforms.tCube.value=d,e.push(o,o.geometry,o.material,0,null)):d&&d.isTexture&&(void 0===i&&(i=new mn(-1,1,1,-1,0,1),a=new $n(new kn(2,2),new Yn({depthTest:!1,depthWrite:!1,fog:!1})),n.update(a.geometry)),a.material.map=d,t.renderBufferDirect(i,null,a.geometry,a.material,a,null))}}}function er(t,e,n){var r;this.setMode=function(t){r=t},this.render=function(e,i){t.drawArrays(r,e,i),n.update(i,r)},this.renderInstances=function(t,i,a){var o=e.get("ANGLE_instanced_arrays");if(null!==o){var s=t.attributes.position;s.isInterleavedBufferAttribute?(a=s.data.count,o.drawArraysInstancedANGLE(r,0,a,t.maxInstancedCount)):o.drawArraysInstancedANGLE(r,i,a,t.maxInstancedCount),n.update(a,r,t.maxInstancedCount)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}function nr(t,e,n){var r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var a=void 0!==n.precision?n.precision:"highp",o=i(a);o!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",o,"instead."),a=o);var s=!0===n.logarithmicDepthBuffer,c=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),l=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),u=t.getParameter(t.MAX_TEXTURE_SIZE),h=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),f=t.getParameter(t.MAX_VERTEX_ATTRIBS),d=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),p=t.getParameter(t.MAX_VARYING_VECTORS),m=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),v=l>0,g=!!e.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==r)return r;var n=e.get("EXT_texture_filter_anisotropic");return r=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:s,maxTextures:c,maxVertexTextures:l,maxTextureSize:u,maxCubemapSize:h,maxAttributes:f,maxVertexUniforms:d,maxVaryings:p,maxFragmentUniforms:m,vertexTextures:v,floatFragmentTextures:g,floatVertexTextures:v&&g}}function rr(){var t=this,e=null,n=0,r=!1,i=!1,a=new Ye,o=new Ne,s={value:null,needsUpdate:!1};function c(){s.value!==e&&(s.value=e,s.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function l(e,n,r,i){var c=null!==e?e.length:0,l=null;if(0!==c){if(l=s.value,!0!==i||null===l){var u=r+4*c,h=n.matrixWorldInverse;o.getNormalMatrix(h),(null===l||l.length<u)&&(l=new Float32Array(u));for(var f=0,d=r;f!==c;++f,d+=4)a.copy(e[f]).applyMatrix4(h,o),a.normal.toArray(l,d),l[d+3]=a.constant}s.value=l,s.needsUpdate=!0}return t.numPlanes=c,l}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(t,i,a){var o=0!==t.length||i||0!==n||r;return r=i,e=l(t,a,0),n=t.length,o},this.beginShadows=function(){i=!0,l(null)},this.endShadows=function(){i=!1,c()},this.setState=function(t,a,o,u,h,f){if(!r||null===t||0===t.length||i&&!o)i?l(null):c();else{var d=i?0:n,p=4*d,m=h.clippingState||null;s.value=m,m=l(t,u,p,f);for(var v=0;v!==p;++v)m[v]=e[v];h.clippingState=m,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=d}}}function ir(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":r=t.getExtension("WEBGL_compressed_texture_etc1");break;default:r=t.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=r,r}}}function ar(t,e,n){var r={},i={};function a(t){var o=t.target,s=r[o.id];for(var c in null!==s.index&&e.remove(s.index),s.attributes)e.remove(s.attributes[c]);o.removeEventListener("dispose",a),delete r[o.id];var l=i[o.id];l&&(e.remove(l),delete i[o.id]),(l=i[s.id])&&(e.remove(l),delete i[s.id]),n.memory.geometries--}return{get:function(t,e){var i=r[e.id];return i||(e.addEventListener("dispose",a),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new In).setFromObject(t)),i=e._bufferGeometry),r[e.id]=i,n.memory.geometries++,i)},update:function(n){var r=n.index,i=n.attributes;for(var a in null!==r&&e.update(r,t.ELEMENT_ARRAY_BUFFER),i)e.update(i[a],t.ARRAY_BUFFER);var o=n.morphAttributes;for(var a in o)for(var s=o[a],c=0,l=s.length;c<l;c++)e.update(s[c],t.ARRAY_BUFFER)},getWireframeAttribute:function(n){var r=i[n.id];if(r)return r;var a,o=[],s=n.index,c=n.attributes;if(null!==s)for(var l=0,u=(a=s.array).length;l<u;l+=3){var h=a[l+0],f=a[l+1],d=a[l+2];o.push(h,f,f,d,d,h)}else for(l=0,u=(a=c.position.array).length/3-1;l<u;l+=3)h=l+0,f=l+1,d=l+2,o.push(h,f,f,d,d,h);return r=new(On(o)>65535?Rn:Sn)(o,1),e.update(r,t.ELEMENT_ARRAY_BUFFER),i[n.id]=r,r}}}function or(t,e,n){var r,i,a;this.setMode=function(t){r=t},this.setIndex=function(t){i=t.type,a=t.bytesPerElement},this.render=function(e,o){t.drawElements(r,o,i,e*a),n.update(o,r)},this.renderInstances=function(t,o,s){var c=e.get("ANGLE_instanced_arrays");null!==c?(c.drawElementsInstancedANGLE(r,s,i,o*a,t.maxInstancedCount),n.update(s,r,t.maxInstancedCount)):console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}function sr(t){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(n,r,i){switch(i=i||1,e.calls++,r){case t.TRIANGLES:e.triangles+=i*(n/3);break;case t.TRIANGLE_STRIP:case t.TRIANGLE_FAN:e.triangles+=i*(n-2);break;case t.LINES:e.lines+=i*(n/2);break;case t.LINE_STRIP:e.lines+=i*(n-1);break;case t.LINE_LOOP:e.lines+=i*n;break;case t.POINTS:e.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function cr(t,e){return Math.abs(e[1])-Math.abs(t[1])}function lr(t){var e={},n=new Float32Array(8);return{update:function(r,i,a,o){var s=r.morphTargetInfluences,c=s.length,l=e[i.id];if(void 0===l){l=[];for(var u=0;u<c;u++)l[u]=[u,0];e[i.id]=l}var h=a.morphTargets&&i.morphAttributes.position,f=a.morphNormals&&i.morphAttributes.normal;for(u=0;u<c;u++)0!==(d=l[u])[1]&&(h&&i.removeAttribute("morphTarget"+u),f&&i.removeAttribute("morphNormal"+u));for(u=0;u<c;u++)(d=l[u])[0]=u,d[1]=s[u];for(l.sort(cr),u=0;u<8;u++){var d;if(d=l[u]){var p=d[0],m=d[1];if(m){h&&i.addAttribute("morphTarget"+u,h[p]),f&&i.addAttribute("morphNormal"+u,f[p]),n[u]=m;continue}}n[u]=0}o.getUniforms().setValue(t,"morphTargetInfluences",n)}}}function ur(t,e){var n={};return{update:function(r){var i=e.render.frame,a=r.geometry,o=t.get(r,a);return n[o.id]!==i&&(a.isGeometry&&o.updateFromObject(r),t.update(o),n[o.id]=i),o},dispose:function(){n={}}}}function hr(t,e,n,r,i,a,o,s,c,l){t=void 0!==t?t:[],e=void 0!==e?e:tt,je.call(this,t,e,n,r,i,a,o,s,c,l),this.flipY=!1}e.Material=Xn,Xn.prototype=Object.assign(Object.create(r.prototype),{constructor:Xn,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n)if("shading"!==e){var r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]="overdraw"===e?Number(n):n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==g&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==u&&(n.side=this.side),this.vertexColors!==d&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,0!==this.rotation&&(n.rotation=this.rotation),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){var i=r(t.textures),a=r(t.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,n=null;if(null!==e){var r=e.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.shadowSide=t.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),e.MeshBasicMaterial=Yn,Yn.prototype=Object.create(Xn.prototype),Yn.prototype.constructor=Yn,Yn.prototype.isMeshBasicMaterial=!0,Yn.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},e.ShaderMaterial=Zn,Zn.prototype=Object.create(Xn.prototype),Zn.prototype.constructor=Zn,Zn.prototype.isShaderMaterial=!0,Zn.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Qe.clone(t.uniforms),this.defines=t.defines,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},Zn.prototype.toJSON=function(t){var e=Xn.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},e.Ray=Jn,Object.assign(Jn.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new Oe),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new Oe;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new Oe),e.subVectors(t,this.origin);var n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new Oe;return function(e){var n=t.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(n).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:(Bn=new Oe,jn=new Oe,Hn=new Oe,function(t,e,n,r){Bn.copy(t).add(e).multiplyScalar(.5),jn.copy(e).sub(t).normalize(),Hn.copy(this.origin).sub(Bn);var i,a,o,s,c=.5*t.distanceTo(e),l=-this.direction.dot(jn),u=Hn.dot(this.direction),h=-Hn.dot(jn),f=Hn.lengthSq(),d=Math.abs(1-l*l);if(d>0)if(a=l*u-h,s=c*d,(i=l*h-u)>=0)if(a>=-s)if(a<=s){var p=1/d;o=(i*=p)*(i+l*(a*=p)+2*u)+a*(l*i+a+2*h)+f}else a=c,o=-(i=Math.max(0,-(l*a+u)))*i+a*(a+2*h)+f;else a=-c,o=-(i=Math.max(0,-(l*a+u)))*i+a*(a+2*h)+f;else a<=-s?o=-(i=Math.max(0,-(-l*c+u)))*i+(a=i>0?-c:Math.min(Math.max(-c,-h),c))*(a+2*h)+f:a<=s?(i=0,o=(a=Math.min(Math.max(-c,-h),c))*(a+2*h)+f):o=-(i=Math.max(0,-(l*c+u)))*i+(a=i>0?c:Math.min(Math.max(-c,-h),c))*(a+2*h)+f;else a=l>0?-c:c,o=-(i=Math.max(0,-(l*a+u)))*i+a*(a+2*h)+f;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(jn).multiplyScalar(a).add(Bn),o}),intersectSphere:function(){var t=new Oe;return function(e,n){t.subVectors(e.center,this.origin);var r=t.dot(this.direction),i=t.dot(t)-r*r,a=e.radius*e.radius;if(i>a)return null;var o=Math.sqrt(a-i),s=r-o,c=r+o;return s<0&&c<0?null:s<0?this.at(c,n):this.at(s,n)}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,r,i,a,o,s,c=1/this.direction.x,l=1/this.direction.y,u=1/this.direction.z,h=this.origin;return c>=0?(n=(t.min.x-h.x)*c,r=(t.max.x-h.x)*c):(n=(t.max.x-h.x)*c,r=(t.min.x-h.x)*c),l>=0?(i=(t.min.y-h.y)*l,a=(t.max.y-h.y)*l):(i=(t.max.y-h.y)*l,a=(t.min.y-h.y)*l),n>a||i>r?null:((i>n||n!=n)&&(n=i),(a<r||r!=r)&&(r=a),u>=0?(o=(t.min.z-h.z)*u,s=(t.max.z-h.z)*u):(o=(t.max.z-h.z)*u,s=(t.min.z-h.z)*u),n>s||o>r?null:((o>n||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))},intersectsBox:(Fn=new Oe,function(t){return null!==this.intersectBox(t,Fn)}),intersectTriangle:function(){var t=new Oe,e=new Oe,n=new Oe,r=new Oe;return function(i,a,o,s,c){e.subVectors(a,i),n.subVectors(o,i),r.crossVectors(e,n);var l,u=this.direction.dot(r);if(u>0){if(s)return null;l=1}else{if(!(u<0))return null;l=-1,u=-u}t.subVectors(this.origin,i);var h=l*this.direction.dot(n.crossVectors(t,n));if(h<0)return null;var f=l*this.direction.dot(e.cross(t));if(f<0)return null;if(h+f>u)return null;var d=-l*t.dot(r);return d<0?null:this.at(d/u,c)}}(),applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),e.Line3=Qn,Object.assign(Qn.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new Oe),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new Oe),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new Oe),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:(Gn=new Oe,Vn=new Oe,function(t,e){Gn.subVectors(t,this.start),Vn.subVectors(this.end,this.start);var n=Vn.dot(Vn),r=Vn.dot(Gn)/n;return e&&(r=Re.clamp(r,0,1)),r}),closestPointToPoint:function(t,e,n){var r=this.closestPointToPointParameter(t,e);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Oe),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),e.Triangle=Kn,Object.assign(Kn,{getNormal:(Wn=new Oe,function(t,e,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Oe),r.subVectors(n,e),Wn.subVectors(t,e),r.cross(Wn);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}),getBarycoord:function(){var t=new Oe,e=new Oe,n=new Oe;return function(r,i,a,o,s){t.subVectors(o,i),e.subVectors(a,i),n.subVectors(r,i);var c=t.dot(t),l=t.dot(e),u=t.dot(n),h=e.dot(e),f=e.dot(n),d=c*h-l*l;if(void 0===s&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),s=new Oe),0===d)return s.set(-2,-1,-1);var p=1/d,m=(h*u-l*f)*p,v=(c*f-l*u)*p;return s.set(1-m-v,v,m)}}(),containsPoint:function(){var t=new Oe;return function(e,n,r,i){return Kn.getBarycoord(e,n,r,i,t),t.x>=0&&t.y>=0&&t.x+t.y<=1}}()}),Object.assign(Kn.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){var t=new Oe,e=new Oe;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new Oe),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return Kn.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Oe),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return Kn.getBarycoord(t,this.a,this.b,this.c,e)},containsPoint:function(t){return Kn.containsPoint(t,this.a,this.b,this.c)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(){var t=new Ye,e=[new Qn,new Qn,new Qn],n=new Oe,r=new Oe;return function(i,a){void 0===a&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),a=new Oe);var o=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(i,n),!0===this.containsPoint(n))a.copy(n);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var s=0;s<e.length;s++){e[s].closestPointToPoint(n,!0,r);var c=n.distanceToSquared(r);c<o&&(o=c,a.copy(r))}}return a}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),e.Mesh=$n,$n.prototype=Object.assign(Object.create(dn.prototype),{constructor:$n,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return dn.prototype.copy.call(this,t),this.drawMode=t.drawMode,void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,a=Object.keys(i);if(a.length>0){var o=i[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=o.length;t<e;t++)n=o[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;if(void 0!==s&&s.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=s.length;t<e;t++)n=s[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}},raycast:function(){var t=new Ce,e=new Jn,n=new Xe,r=new Oe,i=new Oe,a=new Oe,o=new Oe,s=new Oe,c=new Oe,l=new Le,u=new Le,d=new Le,p=new Oe,m=new Oe,v=new Oe;function g(t,e,n,r,i,a,o){return Kn.getBarycoord(t,e,n,r,p),i.multiplyScalar(p.x),a.multiplyScalar(p.y),o.multiplyScalar(p.z),i.add(a).add(o),i.clone()}function y(t,e,n,r,i,a,o,s){if(null===(e.side===h?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,e.side!==f,s)))return null;v.copy(s),v.applyMatrix4(t.matrixWorld);var c=n.ray.origin.distanceTo(v);return c<n.near||c>n.far?null:{distance:c,point:v.clone(),object:t}}function _(t,e,n,o,s,c,h,f){r.fromBufferAttribute(o,c),i.fromBufferAttribute(o,h),a.fromBufferAttribute(o,f);var p=y(t,t.material,e,n,r,i,a,m);if(p){s&&(l.fromBufferAttribute(s,c),u.fromBufferAttribute(s,h),d.fromBufferAttribute(s,f),p.uv=g(m,r,i,a,l,u,d));var v=new vn(c,h,f);Kn.getNormal(r,i,a,v.normal),p.face=v,p.faceIndex=c}return p}return function(h,f){var p,v=this.geometry,x=this.material,b=this.matrixWorld;if(void 0!==x&&(null===v.boundingSphere&&v.computeBoundingSphere(),n.copy(v.boundingSphere),n.applyMatrix4(b),!1!==h.ray.intersectsSphere(n)&&(t.getInverse(b),e.copy(h.ray).applyMatrix4(t),null===v.boundingBox||!1!==e.intersectsBox(v.boundingBox))))if(v.isBufferGeometry){var w,M,E,T,S,A=v.index,R=v.attributes.position,L=v.attributes.uv;if(null!==A)for(T=0,S=A.count;T<S;T+=3)w=A.getX(T),M=A.getX(T+1),E=A.getX(T+2),(p=_(this,h,e,R,L,w,M,E))&&(p.faceIndex=Math.floor(T/3),f.push(p));else if(void 0!==R)for(T=0,S=R.count;T<S;T+=3)(p=_(this,h,e,R,L,w=T,M=T+1,E=T+2))&&(p.index=w,f.push(p))}else if(v.isGeometry){var C,P,O,N,I=Array.isArray(x),z=v.vertices,U=v.faces,D=v.faceVertexUvs[0];D.length>0&&(N=D);for(var k=0,F=U.length;k<F;k++){var B=U[k],j=I?x[B.materialIndex]:x;if(void 0!==j){if(C=z[B.a],P=z[B.b],O=z[B.c],!0===j.morphTargets){var H=v.morphTargets,G=this.morphTargetInfluences;r.set(0,0,0),i.set(0,0,0),a.set(0,0,0);for(var V=0,W=H.length;V<W;V++){var q=G[V];if(0!==q){var X=H[V].vertices;r.addScaledVector(o.subVectors(X[B.a],C),q),i.addScaledVector(s.subVectors(X[B.b],P),q),a.addScaledVector(c.subVectors(X[B.c],O),q)}}r.add(C),i.add(P),a.add(O),C=r,P=i,O=a}if(p=y(this,j,h,e,C,P,O,m)){if(N&&N[k]){var Y=N[k];l.copy(Y[0]),u.copy(Y[1]),d.copy(Y[2]),p.uv=g(m,C,P,O,l,u,d)}p.face=B,p.faceIndex=k,f.push(p)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),e.CubeTexture=hr,hr.prototype=Object.create(je.prototype),hr.prototype.constructor=hr,hr.prototype.isCubeTexture=!0,Object.defineProperty(hr.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var fr=new je,dr=new hr;function pr(){this.seq=[],this.map={}}var mr=[],vr=[],gr=new Float32Array(16),yr=new Float32Array(9);function _r(t,e,n){var r=t[0];if(r<=0||r>0)return t;var i=e*n,a=mr[i];if(void 0===a&&(a=new Float32Array(i),mr[i]=a),0!==e){r.toArray(a,0);for(var o=1,s=0;o!==e;++o)s+=n,t[o].toArray(a,s)}return a}function xr(t,e){var n=vr[e];void 0===n&&(n=new Int32Array(e),vr[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocTextureUnit();return n}function br(t,e){t.uniform1f(this.addr,e)}function wr(t,e){t.uniform1i(this.addr,e)}function Mr(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function Er(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function Tr(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function Sr(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function Ar(t,e){void 0===e.elements?t.uniformMatrix3fv(this.addr,!1,e):(yr.set(e.elements),t.uniformMatrix3fv(this.addr,!1,yr))}function Rr(t,e){void 0===e.elements?t.uniformMatrix4fv(this.addr,!1,e):(gr.set(e.elements),t.uniformMatrix4fv(this.addr,!1,gr))}function Lr(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTexture2D(e||fr,r)}function Cr(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTextureCube(e||dr,r)}function Pr(t,e){t.uniform2iv(this.addr,e)}function Or(t,e){t.uniform3iv(this.addr,e)}function Nr(t,e){t.uniform4iv(this.addr,e)}function Ir(t,e){t.uniform1fv(this.addr,e)}function zr(t,e){t.uniform1iv(this.addr,e)}function Ur(t,e){t.uniform2fv(this.addr,_r(e,this.size,2))}function Dr(t,e){t.uniform3fv(this.addr,_r(e,this.size,3))}function kr(t,e){t.uniform4fv(this.addr,_r(e,this.size,4))}function Fr(t,e){t.uniformMatrix2fv(this.addr,!1,_r(e,this.size,4))}function Br(t,e){t.uniformMatrix3fv(this.addr,!1,_r(e,this.size,9))}function jr(t,e){t.uniformMatrix4fv(this.addr,!1,_r(e,this.size,16))}function Hr(t,e,n){var r=e.length,i=xr(n,r);t.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.setTexture2D(e[a]||fr,i[a])}function Gr(t,e,n){var r=e.length,i=xr(n,r);t.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.setTextureCube(e[a]||dr,i[a])}function Vr(t,e,n){this.id=t,this.addr=n,this.setValue=function(t){switch(t){case 5126:return br;case 35664:return Mr;case 35665:return Er;case 35666:return Tr;case 35674:return Sr;case 35675:return Ar;case 35676:return Rr;case 35678:case 36198:return Lr;case 35680:return Cr;case 5124:case 35670:return wr;case 35667:case 35671:return Pr;case 35668:case 35672:return Or;case 35669:case 35673:return Nr}}(e.type)}function Wr(t,e,n){this.id=t,this.addr=n,this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Ir;case 35664:return Ur;case 35665:return Dr;case 35666:return kr;case 35674:return Fr;case 35675:return Br;case 35676:return jr;case 35678:return Hr;case 35680:return Gr;case 5124:case 35670:return zr;case 35667:case 35671:return Pr;case 35668:case 35672:return Or;case 35669:case 35673:return Nr}}(e.type)}function qr(t){this.id=t,pr.call(this)}qr.prototype.setValue=function(t,e){for(var n=this.seq,r=0,i=n.length;r!==i;++r){var a=n[r];a.setValue(t,e[a.id])}};var Xr=/([\w\d_]+)(\])?(\[|\.)?/g;function Yr(t,e){t.seq.push(e),t.map[e.id]=e}function Zr(t,e,n){var r=t.name,i=r.length;for(Xr.lastIndex=0;;){var a=Xr.exec(r),o=Xr.lastIndex,s=a[1],c="]"===a[2],l=a[3];if(c&&(s|=0),void 0===l||"["===l&&o+2===i){Yr(n,void 0===l?new Vr(s,t,e):new Wr(s,t,e));break}var u=n.map[s];void 0===u&&Yr(n,u=new qr(s)),n=u}}function Jr(t,e,n){pr.call(this),this.renderer=n;for(var r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),i=0;i<r;++i){var a=t.getActiveUniform(e,i),o=a.name;Zr(a,t.getUniformLocation(e,o),this)}}function Qr(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),!1===t.getShaderParameter(r,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(r),function(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(n)),r}Jr.prototype.setValue=function(t,e,n){var r=this.map[e];void 0!==r&&r.setValue(t,n,this.renderer)},Jr.prototype.setOptional=function(t,e,n){var r=e[n];void 0!==r&&this.setValue(t,n,r)},Jr.upload=function(t,e,n,r){for(var i=0,a=e.length;i!==a;++i){var o=e[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(t,s.value,r)}},Jr.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var a=t[r];a.id in e&&n.push(a)}return n};var Kr=0;function $r(t){switch(t){case ue:return["Linear","( value )"];case he:return["sRGB","( value )"];case de:return["RGBE","( value )"];case pe:return["RGBM","( value, 7.0 )"];case me:return["RGBM","( value, 16.0 )"];case ve:return["RGBD","( value, 256.0 )"];case fe:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function ti(t,e){var n=$r(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function ei(t,e){var n;switch(e){case J:n="Linear";break;case Q:n="Reinhard";break;case K:n="Uncharted2";break;case $:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function ni(t){return""!==t}function ri(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function ii(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function ai(t){return t.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(t,e){var n=Je[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return ai(n)})}function oi(t){return t.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,e,n,r){for(var i="",a=parseInt(e);a<parseInt(n);a++)i+=r.replace(/\[ i \]/g,"[ "+a+" ]");return i})}function si(t,e,n,r,i,a){var o=t.context,s=r.defines,u=i.vertexShader,h=i.fragmentShader,f="SHADOWMAP_TYPE_BASIC";a.shadowMapType===c?f="SHADOWMAP_TYPE_PCF":a.shadowMapType===l&&(f="SHADOWMAP_TYPE_PCF_SOFT");var d="ENVMAP_TYPE_CUBE",p="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(a.envMap){switch(r.envMap.mapping){case tt:case et:d="ENVMAP_TYPE_CUBE";break;case at:case ot:d="ENVMAP_TYPE_CUBE_UV";break;case nt:case rt:d="ENVMAP_TYPE_EQUIREC";break;case it:d="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case et:case rt:p="ENVMAP_MODE_REFRACTION"}switch(r.combine){case q:m="ENVMAP_BLENDING_MULTIPLY";break;case X:m="ENVMAP_BLENDING_MIX";break;case Y:m="ENVMAP_BLENDING_ADD"}}var v,g,y,_,x,b=t.gammaFactor>0?t.gammaFactor:1,w=function(t,e,n){return[(t=t||{}).derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ni).join("\n")}(r.extensions,a,e),M=function(t){var e=[];for(var n in t){var r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(s),E=o.createProgram();r.isRawShaderMaterial?((v=[M].filter(ni).join("\n")).length>0&&(v+="\n"),(g=[w,M].filter(ni).join("\n")).length>0&&(g+="\n")):(v=["precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+i.name,M,a.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+b,"#define MAX_BONES "+a.maxBones,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+p:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexColors?"#define USE_COLOR":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&!1===a.flatShading?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+f:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ni).join("\n"),g=[w,"precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+i.name,M,a.alphaTest?"#define ALPHATEST "+a.alphaTest:"","#define GAMMA_FACTOR "+b,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+d:"",a.envMap?"#define "+p:"",a.envMap?"#define "+m:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexColors?"#define USE_COLOR":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+f:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",a.envMap&&e.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",a.toneMapping!==Z?"#define TONE_MAPPING":"",a.toneMapping!==Z?Je.tonemapping_pars_fragment:"",a.toneMapping!==Z?ei("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",a.outputEncoding||a.mapEncoding||a.envMapEncoding||a.emissiveMapEncoding?Je.encodings_pars_fragment:"",a.mapEncoding?ti("mapTexelToLinear",a.mapEncoding):"",a.envMapEncoding?ti("envMapTexelToLinear",a.envMapEncoding):"",a.emissiveMapEncoding?ti("emissiveMapTexelToLinear",a.emissiveMapEncoding):"",a.outputEncoding?(y="linearToOutputTexel",_=a.outputEncoding,x=$r(_),"vec4 "+y+"( vec4 value ) { return LinearTo"+x[0]+x[1]+"; }"):"",a.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(ni).join("\n")),u=ii(u=ri(u=ai(u),a),a),h=ii(h=ri(h=ai(h),a),a);var T=v+(u=oi(u)),S=g+(h=oi(h)),A=Qr(o,o.VERTEX_SHADER,T),R=Qr(o,o.FRAGMENT_SHADER,S);o.attachShader(E,A),o.attachShader(E,R),void 0!==r.index0AttributeName?o.bindAttribLocation(E,0,r.index0AttributeName):!0===a.morphTargets&&o.bindAttribLocation(E,0,"position"),o.linkProgram(E);var L,C,P=o.getProgramInfoLog(E).trim(),O=o.getShaderInfoLog(A).trim(),N=o.getShaderInfoLog(R).trim(),I=!0,z=!0;return!1===o.getProgramParameter(E,o.LINK_STATUS)?(I=!1,console.error("THREE.WebGLProgram: shader error: ",o.getError(),"gl.VALIDATE_STATUS",o.getProgramParameter(E,o.VALIDATE_STATUS),"gl.getProgramInfoLog",P,O,N)):""!==P?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",P):""!==O&&""!==N||(z=!1),z&&(this.diagnostics={runnable:I,material:r,programLog:P,vertexShader:{log:O,prefix:v},fragmentShader:{log:N,prefix:g}}),o.deleteShader(A),o.deleteShader(R),this.getUniforms=function(){return void 0===L&&(L=new Jr(o,E,t)),L},this.getAttributes=function(){return void 0===C&&(C=function(t,e){for(var n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var a=t.getActiveAttrib(e,i).name;n[a]=t.getAttribLocation(e,a)}return n}(o,E)),C},this.destroy=function(){o.deleteProgram(E),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Kr++,this.code=n,this.usedTimes=1,this.program=E,this.vertexShader=A,this.fragmentShader=R,this}function ci(t,e,n){var r=[],i={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},a=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function o(t,e){var n;return t?t.isTexture?n=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=t.texture.encoding):n=ue,n===ue&&e&&(n=fe),n}this.getParameters=function(e,r,a,s,c,l,u){var d=i[e.type],p=u.isSkinnedMesh?function(t){var e=t.skeleton.bones;if(n.floatVertexTextures)return 1024;var r=n.maxVertexUniforms,i=Math.floor((r-20)/4),a=Math.min(i,e.length);return a<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+a+"."),0):a}(u):0,m=n.precision;null!==e.precision&&(m=n.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",m,"instead.");var v=t.getRenderTarget();return{shaderID:d,precision:m,supportsVertexTextures:n.vertexTextures,outputEncoding:o(v?v.texture:null,t.gammaOutput),map:!!e.map,mapEncoding:o(e.map,t.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:o(e.envMap,t.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===at||e.envMap.mapping===ot),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:o(e.emissiveMap,t.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!s,useFog:e.fog,fogExp:s&&s.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:e.skinning&&p>0,maxBones:p,useVertexTexture:n.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numRectAreaLights:r.rectArea.length,numHemiLights:r.hemi.length,numClippingPlanes:c,numClipIntersection:l,dithering:e.dithering,shadowMapEnabled:t.shadowMap.enabled&&u.receiveShadow&&a.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===f,flipSided:e.side===h,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,n){var r=[];if(n.shaderID?r.push(n.shaderID):(r.push(e.fragmentShader),r.push(e.vertexShader)),void 0!==e.defines)for(var i in e.defines)r.push(i),r.push(e.defines[i]);for(var o=0;o<a.length;o++)r.push(n[a[o]]);return r.push(e.onBeforeCompile.toString()),r.push(t.gammaOutput),r.join()},this.acquireProgram=function(n,i,a,o){for(var s,c=0,l=r.length;c<l;c++){var u=r[c];if(u.code===o){++(s=u).usedTimes;break}}return void 0===s&&(s=new si(t,e,o,n,i,a),r.push(s)),s},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}function li(){var t=new WeakMap;return{get:function(e){var n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}}function ui(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function hi(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function fi(){var t=[],e=0,n=[],r=[];return{opaque:n,transparent:r,init:function(){e=0,n.length=0,r.length=0},push:function(i,a,o,s,c){var l=t[e];void 0===l?(l={id:i.id,object:i,geometry:a,material:o,program:o.program,renderOrder:i.renderOrder,z:s,group:c},t[e]=l):(l.id=i.id,l.object=i,l.geometry=a,l.material=o,l.program=o.program,l.renderOrder=i.renderOrder,l.z=s,l.group=c),(!0===o.transparent?r:n).push(l),e++},sort:function(){n.length>1&&n.sort(ui),r.length>1&&r.sort(hi)}}}function di(){var t={};return{get:function(e,n){var r=e.id+","+n.id,i=t[r];return void 0===i&&(i=new fi,t[r]=i),i},dispose:function(){t={}}}}function pi(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new Oe,color:new tn,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Le};break;case"SpotLight":n={position:new Oe,direction:new Oe,color:new tn,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Le};break;case"PointLight":n={position:new Oe,color:new tn,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Le,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new Oe,skyColor:new tn,groundColor:new tn};break;case"RectAreaLight":n={color:new tn,position:new Oe,halfWidth:new Oe,halfHeight:new Oe}}return t[e.id]=n,n}}}var mi,vi,gi,yi,_i,xi,bi,wi,Mi=0;function Ei(){var t=new pi,e={id:Mi++,hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},n=new Oe,r=new Ce,i=new Ce;return{setup:function(a,o,s){for(var c=0,l=0,u=0,h=0,f=0,d=0,p=0,m=0,v=s.matrixWorldInverse,g=0,y=a.length;g<y;g++){var _=a[g],x=_.color,b=_.intensity,w=_.distance,M=_.shadow&&_.shadow.map?_.shadow.map.texture:null;if(_.isAmbientLight)c+=x.r*b,l+=x.g*b,u+=x.b*b;else if(_.isDirectionalLight){if((T=t.get(_)).color.copy(_.color).multiplyScalar(_.intensity),T.direction.setFromMatrixPosition(_.matrixWorld),n.setFromMatrixPosition(_.target.matrixWorld),T.direction.sub(n),T.direction.transformDirection(v),T.shadow=_.castShadow,_.castShadow){var E=_.shadow;T.shadowBias=E.bias,T.shadowRadius=E.radius,T.shadowMapSize=E.mapSize}e.directionalShadowMap[h]=M,e.directionalShadowMatrix[h]=_.shadow.matrix,e.directional[h]=T,h++}else if(_.isSpotLight)(T=t.get(_)).position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(v),T.color.copy(x).multiplyScalar(b),T.distance=w,T.direction.setFromMatrixPosition(_.matrixWorld),n.setFromMatrixPosition(_.target.matrixWorld),T.direction.sub(n),T.direction.transformDirection(v),T.coneCos=Math.cos(_.angle),T.penumbraCos=Math.cos(_.angle*(1-_.penumbra)),T.decay=0===_.distance?0:_.decay,T.shadow=_.castShadow,_.castShadow&&(E=_.shadow,T.shadowBias=E.bias,T.shadowRadius=E.radius,T.shadowMapSize=E.mapSize),e.spotShadowMap[d]=M,e.spotShadowMatrix[d]=_.shadow.matrix,e.spot[d]=T,d++;else if(_.isRectAreaLight)(T=t.get(_)).color.copy(x).multiplyScalar(b),T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(v),i.identity(),r.copy(_.matrixWorld),r.premultiply(v),i.extractRotation(r),T.halfWidth.set(.5*_.width,0,0),T.halfHeight.set(0,.5*_.height,0),T.halfWidth.applyMatrix4(i),T.halfHeight.applyMatrix4(i),e.rectArea[p]=T,p++;else if(_.isPointLight)(T=t.get(_)).position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(v),T.color.copy(_.color).multiplyScalar(_.intensity),T.distance=_.distance,T.decay=0===_.distance?0:_.decay,T.shadow=_.castShadow,_.castShadow&&(E=_.shadow,T.shadowBias=E.bias,T.shadowRadius=E.radius,T.shadowMapSize=E.mapSize,T.shadowCameraNear=E.camera.near,T.shadowCameraFar=E.camera.far),e.pointShadowMap[f]=M,e.pointShadowMatrix[f]=_.shadow.matrix,e.point[f]=T,f++;else if(_.isHemisphereLight){var T;(T=t.get(_)).direction.setFromMatrixPosition(_.matrixWorld),T.direction.transformDirection(v),T.direction.normalize(),T.skyColor.copy(_.color).multiplyScalar(b),T.groundColor.copy(_.groundColor).multiplyScalar(b),e.hemi[m]=T,m++}}e.ambient[0]=c,e.ambient[1]=l,e.ambient[2]=u,e.directional.length=h,e.spot.length=d,e.rectArea.length=p,e.point.length=f,e.hemi.length=m,e.hash=e.id+","+h+","+f+","+d+","+p+","+m+","+o.length},state:e}}function Ti(){var t=new Ei,e=[],n=[],r=[];return{init:function(){e.length=0,n.length=0,r.length=0},state:{lightsArray:e,shadowsArray:n,spritesArray:r,lights:t},setupLights:function(r){t.setup(e,n,r)},pushLight:function(t){e.push(t)},pushShadow:function(t){n.push(t)},pushSprite:function(t){r.push(t)}}}function Si(){var t={};return{get:function(e,n){var r=e.id+","+n.id,i=t[r];return void 0===i&&(i=new Ti,t[r]=i),i},dispose:function(){t={}}}}function Ai(t){Xn.call(this),this.type="MeshDepthMaterial",this.depthPacking=ge,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function Ri(t){Xn.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Oe,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(t)}function Li(t,e,n){for(var r=new Ze,i=new Ce,a=new Le,o=new Le(n,n),s=new Oe,l=new Oe,d=1,p=2,m=1+(d|p),v=new Array(m),g=new Array(m),y={},_={0:h,1:u,2:f},x=[new Oe(1,0,0),new Oe(-1,0,0),new Oe(0,0,1),new Oe(0,0,-1),new Oe(0,1,0),new Oe(0,-1,0)],b=[new Oe(0,1,0),new Oe(0,1,0),new Oe(0,1,0),new Oe(0,1,0),new Oe(0,0,1),new Oe(0,0,-1)],w=[new He,new He,new He,new He,new He,new He],M=0;M!==m;++M){var E=0!=(M&d),T=0!=(M&p),S=new Ai({depthPacking:ye,morphTargets:E,skinning:T});v[M]=S;var A=new Ri({morphTargets:E,skinning:T});g[M]=A}var R=this;function L(e,n,r,i,a,o){var s=e.geometry,c=null,l=v,u=e.customDepthMaterial;if(r&&(l=g,u=e.customDistanceMaterial),u)c=u;else{var h=!1;n.morphTargets&&(s&&s.isBufferGeometry?h=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(h=s.morphTargets&&s.morphTargets.length>0)),e.isSkinnedMesh&&!1===n.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e);var f=e.isSkinnedMesh&&n.skinning,m=0;h&&(m|=d),f&&(m|=p),c=l[m]}if(t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var x=c.uuid,b=n.uuid,w=y[x];void 0===w&&(w={},y[x]=w);var M=w[b];void 0===M&&(M=c.clone(),w[b]=M),c=M}return c.visible=n.visible,c.wireframe=n.wireframe,c.side=null!=n.shadowSide?n.shadowSide:_[n.side],c.clipShadows=n.clipShadows,c.clippingPlanes=n.clippingPlanes,c.clipIntersection=n.clipIntersection,c.wireframeLinewidth=n.wireframeLinewidth,c.linewidth=n.linewidth,r&&c.isMeshDistanceMaterial&&(c.referencePosition.copy(i),c.nearDistance=a,c.farDistance=o),c}function C(n,i,a,o){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&n.castShadow&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var s=e.update(n),c=n.material;if(Array.isArray(c))for(var u=s.groups,h=0,f=u.length;h<f;h++){var d=u[h],p=c[d.materialIndex];if(p&&p.visible){var m=L(n,p,o,l,a.near,a.far);t.renderBufferDirect(a,null,s,m,n,d)}}else if(c.visible){m=L(n,c,o,l,a.near,a.far);t.renderBufferDirect(a,null,s,m,n,null)}}for(var v=n.children,g=0,y=v.length;g<y;g++)C(v[g],i,a,o)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=c,this.render=function(e,n,c){if(!1!==R.enabled&&(!1!==R.autoUpdate||!1!==R.needsUpdate)&&0!==e.length){var u,h=t.context,f=t.state;f.disable(h.BLEND),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(var d=0,p=e.length;d<p;d++){var m=e[d],v=m.shadow,g=m&&m.isPointLight;if(void 0!==v){var y=v.camera;if(a.copy(v.mapSize),a.min(o),g){var _=a.x,M=a.y;w[0].set(2*_,M,_,M),w[1].set(0,M,_,M),w[2].set(3*_,M,_,M),w[3].set(_,M,_,M),w[4].set(3*_,0,_,M),w[5].set(_,0,_,M),a.x*=4,a.y*=2}if(null===v.map){var E={minFilter:ut,magFilter:ut,format:Ct};v.map=new Ge(a.x,a.y,E),v.map.texture.name=m.name+".shadowMap",y.updateProjectionMatrix()}v.isSpotLightShadow&&v.update(m);var T=v.map,S=v.matrix;l.setFromMatrixPosition(m.matrixWorld),y.position.copy(l),g?(u=6,S.makeTranslation(-l.x,-l.y,-l.z)):(u=1,s.setFromMatrixPosition(m.target.matrixWorld),y.lookAt(s),y.updateMatrixWorld(),S.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),S.multiply(y.projectionMatrix),S.multiply(y.matrixWorldInverse)),t.setRenderTarget(T),t.clear();for(var A=0;A<u;A++){if(g){s.copy(y.position),s.add(x[A]),y.up.copy(b[A]),y.lookAt(s),y.updateMatrixWorld();var L=w[A];f.viewport(L)}i.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse),r.setFromMatrix(i),C(n,c,y,g)}}else console.warn("THREE.WebGLShadowMap:",m,"has no shadow.")}R.needsUpdate=!1}}}function Ci(t,e,n,r,i,a,o,s,c){je.call(this,t,e,n,r,i,a,o,s,c),this.needsUpdate=!0}function Pi(t,e,n,r,i){var a,o,s,c,l,u,h=new Oe,f=new Pe,d=new Oe;function p(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),n=new Uint16Array([0,1,2,0,2,3]);a=e.createBuffer(),o=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,o),e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW),s=function(){var t=e.createProgram(),n=e.createShader(e.VERTEX_SHADER),r=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(n,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 center;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = ( position - center ) * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n")),e.shaderSource(r,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n")),e.compileShader(n),e.compileShader(r),e.attachShader(t,n),e.attachShader(t,r),e.linkProgram(t),t}(),c={position:e.getAttribLocation(s,"position"),uv:e.getAttribLocation(s,"uv")},l={uvOffset:e.getUniformLocation(s,"uvOffset"),uvScale:e.getUniformLocation(s,"uvScale"),rotation:e.getUniformLocation(s,"rotation"),center:e.getUniformLocation(s,"center"),scale:e.getUniformLocation(s,"scale"),color:e.getUniformLocation(s,"color"),map:e.getUniformLocation(s,"map"),opacity:e.getUniformLocation(s,"opacity"),modelViewMatrix:e.getUniformLocation(s,"modelViewMatrix"),projectionMatrix:e.getUniformLocation(s,"projectionMatrix"),fogType:e.getUniformLocation(s,"fogType"),fogDensity:e.getUniformLocation(s,"fogDensity"),fogNear:e.getUniformLocation(s,"fogNear"),fogFar:e.getUniformLocation(s,"fogFar"),fogColor:e.getUniformLocation(s,"fogColor"),fogDepth:e.getUniformLocation(s,"fogDepth"),alphaTest:e.getUniformLocation(s,"alphaTest")};var r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");r.width=8,r.height=8;var h=r.getContext("2d");h.fillStyle="white",h.fillRect(0,0,8,8),u=new Ci(r)}function m(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}this.render=function(i,v,g){if(0!==i.length){void 0===s&&p(),n.useProgram(s),n.initAttributes(),n.enableAttribute(c.position),n.enableAttribute(c.uv),n.disableUnusedAttributes(),n.disable(e.CULL_FACE),n.enable(e.BLEND),e.bindBuffer(e.ARRAY_BUFFER,a),e.vertexAttribPointer(c.position,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(c.uv,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,o),e.uniformMatrix4fv(l.projectionMatrix,!1,g.projectionMatrix.elements),n.activeTexture(e.TEXTURE0),e.uniform1i(l.map,0);var y=0,_=0,x=v.fog;x?(e.uniform3f(l.fogColor,x.color.r,x.color.g,x.color.b),x.isFog?(e.uniform1f(l.fogNear,x.near),e.uniform1f(l.fogFar,x.far),e.uniform1i(l.fogType,1),y=1,_=1):x.isFogExp2&&(e.uniform1f(l.fogDensity,x.density),e.uniform1i(l.fogType,2),y=2,_=2)):(e.uniform1i(l.fogType,0),y=0,_=0);for(var b=0,w=i.length;b<w;b++){(T=i[b]).modelViewMatrix.multiplyMatrices(g.matrixWorldInverse,T.matrixWorld),T.z=-T.modelViewMatrix.elements[14]}i.sort(m);var M=[],E=[];for(b=0,w=i.length;b<w;b++){var T,S=(T=i[b]).material;if(!1!==S.visible){T.onBeforeRender(t,v,g,void 0,S,void 0),e.uniform1f(l.alphaTest,S.alphaTest),e.uniformMatrix4fv(l.modelViewMatrix,!1,T.modelViewMatrix.elements),T.matrixWorld.decompose(h,f,d),M[0]=d.x,M[1]=d.y,E[0]=T.center.x-.5,E[1]=T.center.y-.5;var A=0;v.fog&&S.fog&&(A=_),y!==A&&(e.uniform1i(l.fogType,A),y=A),null!==S.map?(e.uniform2f(l.uvOffset,S.map.offset.x,S.map.offset.y),e.uniform2f(l.uvScale,S.map.repeat.x,S.map.repeat.y)):(e.uniform2f(l.uvOffset,0,0),e.uniform2f(l.uvScale,1,1)),e.uniform1f(l.opacity,S.opacity),e.uniform3f(l.color,S.color.r,S.color.g,S.color.b),e.uniform1f(l.rotation,S.rotation),e.uniform2fv(l.center,E),e.uniform2fv(l.scale,M),n.setBlending(S.blending,S.blendEquation,S.blendSrc,S.blendDst,S.blendEquationAlpha,S.blendSrcAlpha,S.blendDstAlpha,S.premultipliedAlpha),n.buffers.depth.setTest(S.depthTest),n.buffers.depth.setMask(S.depthWrite),n.buffers.color.setMask(S.colorWrite),r.setTexture2D(S.map||u,0),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),T.onAfterRender(t,v,g,void 0,S,void 0)}}n.enable(e.CULL_FACE),n.reset()}}}function Oi(t,e,n){var r=new function(){var e=!1,n=new He,r=null,i=new He(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,a,o,s){!0===s&&(e*=o,r*=o,a*=o),n.set(e,r,a,o),!1===i.equals(n)&&(t.clearColor(e,r,a,o),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},i=new function(){var e=!1,n=null,r=null,i=null;return{setTest:function(e){e?et(t.DEPTH_TEST):nt(t.DEPTH_TEST)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case k:t.depthFunc(t.NEVER);break;case F:t.depthFunc(t.ALWAYS);break;case B:t.depthFunc(t.LESS);break;case j:t.depthFunc(t.LEQUAL);break;case H:t.depthFunc(t.EQUAL);break;case G:t.depthFunc(t.GEQUAL);break;case V:t.depthFunc(t.GREATER);break;case W:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},c=new function(){var e=!1,n=null,r=null,i=null,a=null,o=null,s=null,c=null,l=null;return{setTest:function(e){e?et(t.STENCIL_TEST):nt(t.STENCIL_TEST)},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,o){r===e&&i===n&&a===o||(t.stencilFunc(e,n,o),r=e,i=n,a=o)},setOp:function(e,n,r){o===e&&s===n&&c===r||(t.stencilOp(e,n,r),o=e,s=n,c=r)},setLocked:function(t){e=t},setClear:function(e){l!==e&&(t.clearStencil(e),l=e)},reset:function(){e=!1,n=null,r=null,i=null,a=null,o=null,s=null,c=null,l=null}}},l=t.getParameter(t.MAX_VERTEX_ATTRIBS),u=new Uint8Array(l),d=new Uint8Array(l),p=new Uint8Array(l),m={},w=null,M=null,E=null,T=null,S=null,A=null,R=null,L=null,C=null,P=!1,O=null,N=null,I=null,z=null,U=null,D=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),q=!1,X=0,Y=t.getParameter(t.VERSION);-1!==Y.indexOf("WebGL")?(X=parseFloat(/^WebGL\ ([0-9])/.exec(Y)[1]),q=X>=1):-1!==Y.indexOf("OpenGL ES")&&(X=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(Y)[1]),q=X>=2);var Z=null,J={},Q=new He,K=new He;function $(e,n,r){var i=new Uint8Array(4),a=t.createTexture();t.bindTexture(e,a),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(var o=0;o<r;o++)t.texImage2D(n+o,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,i);return a}var tt={};function et(e){!0!==m[e]&&(t.enable(e),m[e]=!0)}function nt(e){!1!==m[e]&&(t.disable(e),m[e]=!1)}function rt(e,r,i,a,o,s,c,l){if(e!==v?et(t.BLEND):nt(t.BLEND),e!==b){if(e!==E||l!==P)switch(e){case y:l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE));break;case _:l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR));break;case x:l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR));break;default:l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA))}T=null,S=null,A=null,R=null,L=null,C=null}else o=o||r,s=s||i,c=c||a,r===T&&o===R||(t.blendEquationSeparate(n.convert(r),n.convert(o)),T=r,R=o),i===S&&a===A&&s===L&&c===C||(t.blendFuncSeparate(n.convert(i),n.convert(a),n.convert(s),n.convert(c)),S=i,A=a,L=s,C=c);E=e,P=l}function it(e){O!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),O=e)}function at(e){e!==a?(et(t.CULL_FACE),e!==N&&(e===o?t.cullFace(t.BACK):e===s?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):nt(t.CULL_FACE),N=e}function ot(e,n,r){e?(et(t.POLYGON_OFFSET_FILL),z===n&&U===r||(t.polygonOffset(n,r),z=n,U=r)):nt(t.POLYGON_OFFSET_FILL)}function st(e){void 0===e&&(e=t.TEXTURE0+D-1),Z!==e&&(t.activeTexture(e),Z=e)}return tt[t.TEXTURE_2D]=$(t.TEXTURE_2D,t.TEXTURE_2D,1),tt[t.TEXTURE_CUBE_MAP]=$(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),r.setClear(0,0,0,1),i.setClear(1),c.setClear(0),et(t.DEPTH_TEST),i.setFunc(j),it(!1),at(o),et(t.CULL_FACE),et(t.BLEND),rt(g),{buffers:{color:r,depth:i,stencil:c},initAttributes:function(){for(var t=0,e=u.length;t<e;t++)u[t]=0},enableAttribute:function(n){u[n]=1,0===d[n]&&(t.enableVertexAttribArray(n),d[n]=1),0!==p[n]&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,0),p[n]=0)},enableAttributeAndDivisor:function(n,r){u[n]=1,0===d[n]&&(t.enableVertexAttribArray(n),d[n]=1),p[n]!==r&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,r),p[n]=r)},disableUnusedAttributes:function(){for(var e=0,n=d.length;e!==n;++e)d[e]!==u[e]&&(t.disableVertexAttribArray(e),d[e]=0)},enable:et,disable:nt,getCompressedTextureFormats:function(){if(null===w&&(w=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")||e.get("WEBGL_compressed_texture_astc")))for(var n=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),r=0;r<n.length;r++)w.push(n[r]);return w},useProgram:function(e){return M!==e&&(t.useProgram(e),M=e,!0)},setBlending:rt,setMaterial:function(e,n){e.side===f?nt(t.CULL_FACE):et(t.CULL_FACE);var a=e.side===h;n&&(a=!a),it(a),!0===e.transparent?rt(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):rt(v),i.setFunc(e.depthFunc),i.setTest(e.depthTest),i.setMask(e.depthWrite),r.setMask(e.colorWrite),ot(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:it,setCullFace:at,setLineWidth:function(e){e!==I&&(q&&t.lineWidth(e),I=e)},setPolygonOffset:ot,setScissorTest:function(e){e?et(t.SCISSOR_TEST):nt(t.SCISSOR_TEST)},activeTexture:st,bindTexture:function(e,n){null===Z&&st();var r=J[Z];void 0===r&&(r={type:void 0,texture:void 0},J[Z]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||tt[e]),r.type=e,r.texture=n)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===Q.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),Q.copy(e))},viewport:function(e){!1===K.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),K.copy(e))},reset:function(){for(var e=0;e<d.length;e++)1===d[e]&&(t.disableVertexAttribArray(e),d[e]=0);m={},w=null,Z=null,J={},M=null,E=null,O=null,N=null,r.reset(),i.reset(),c.reset()}}}function Ni(t,e,n,r,i,a,o){var s,c="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext,l={};function u(t,e){if(t.width>e||t.height>e){if("data"in t)return void console.warn("THREE.WebGLRenderer: image in DataTexture is too big ("+t.width+"x"+t.height+").");var n=e/Math.max(t.width,t.height),r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return r.width=Math.floor(t.width*n),r.height=Math.floor(t.height*n),r.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,r.width,r.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+r.width+"x"+r.height,t),r}return t}function h(t){return Re.isPowerOfTwo(t.width)&&Re.isPowerOfTwo(t.height)}function f(t,e){return t.generateMipmaps&&e&&t.minFilter!==ut&&t.minFilter!==dt}function d(e,n,i,a){t.generateMipmap(e),r.get(n).__maxMipLevel=Math.log2(Math.max(i,a))}function p(e){return e===ut||e===ht||e===ft?t.NEAREST:t.LINEAR}function m(e){var n=e.target;n.removeEventListener("dispose",m),function(e){var n=r.get(e);if(e.image&&n.__image__webglTextureCube)t.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture)}r.remove(e)}(n),n.isVideoTexture&&delete l[n.id],o.memory.textures--}function v(e){var n=e.target;n.removeEventListener("dispose",v),function(e){var n=r.get(e),i=r.get(e.texture);if(!e)return;void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLRenderTargetCube)for(var a=0;a<6;a++)t.deleteFramebuffer(n.__webglFramebuffer[a]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[a]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer);r.remove(e.texture),r.remove(e)}(n),o.memory.textures--}function g(e,p){var v=r.get(e);if(e.isVideoTexture&&function(t){var e=t.id,n=o.render.frame;l[e]!==n&&(l[e]=n,t.update())}(e),e.version>0&&v.__version!==e.version){var g=e.image;if(void 0===g)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==g.complete)return void function(e,r,l){void 0===e.__webglInit&&(e.__webglInit=!0,r.addEventListener("dispose",m),e.__webglTexture=t.createTexture(),o.memory.textures++);n.activeTexture(t.TEXTURE0+l),n.bindTexture(t.TEXTURE_2D,e.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,r.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,r.unpackAlignment);var p=u(r.image,i.maxTextureSize);(function(t){return t.wrapS!==ct||t.wrapT!==ct||t.minFilter!==ut&&t.minFilter!==dt})(r)&&!1===h(p)&&(p=function(t){return t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageBitmap?(void 0===s&&(s=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),s.width=Re.floorPowerOfTwo(t.width),s.height=Re.floorPowerOfTwo(t.height),s.getContext("2d").drawImage(t,0,0,s.width,s.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+t.width+"x"+t.height+"). Resized to "+s.width+"x"+s.height,t),s):t}(p));var v=h(p),g=a.convert(r.format),_=a.convert(r.type);y(t.TEXTURE_2D,r,v);var x,b=r.mipmaps;if(r.isDepthTexture){var w=t.DEPTH_COMPONENT;if(r.type===wt){if(!c)throw new Error("Float Depth Texture only supported in WebGL2.0");w=t.DEPTH_COMPONENT32F}else c&&(w=t.DEPTH_COMPONENT16);r.format===It&&w===t.DEPTH_COMPONENT&&r.type!==_t&&r.type!==bt&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=_t,_=a.convert(r.type)),r.format===zt&&(w=t.DEPTH_STENCIL,r.type!==At&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=At,_=a.convert(r.type))),n.texImage2D(t.TEXTURE_2D,0,w,p.width,p.height,0,g,_,null)}else if(r.isDataTexture)if(b.length>0&&v){for(var M=0,E=b.length;M<E;M++)x=b[M],n.texImage2D(t.TEXTURE_2D,M,g,x.width,x.height,0,g,_,x.data);r.generateMipmaps=!1,e.__maxMipLevel=b.length-1}else n.texImage2D(t.TEXTURE_2D,0,g,p.width,p.height,0,g,_,p.data),e.__maxMipLevel=0;else if(r.isCompressedTexture){for(var M=0,E=b.length;M<E;M++)x=b[M],r.format!==Ct&&r.format!==Lt?n.getCompressedTextureFormats().indexOf(g)>-1?n.compressedTexImage2D(t.TEXTURE_2D,M,g,x.width,x.height,0,x.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(t.TEXTURE_2D,M,g,x.width,x.height,0,g,_,x.data);e.__maxMipLevel=b.length-1}else if(b.length>0&&v){for(var M=0,E=b.length;M<E;M++)x=b[M],n.texImage2D(t.TEXTURE_2D,M,g,g,_,x);r.generateMipmaps=!1,e.__maxMipLevel=b.length-1}else n.texImage2D(t.TEXTURE_2D,0,g,g,_,p),e.__maxMipLevel=0;f(r,v)&&d(t.TEXTURE_2D,r,p.width,p.height);e.__version=r.version,r.onUpdate&&r.onUpdate(r)}(v,e,p);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}n.activeTexture(t.TEXTURE0+p),n.bindTexture(t.TEXTURE_2D,v.__webglTexture)}function y(n,o,s){var c;if(s?(t.texParameteri(n,t.TEXTURE_WRAP_S,a.convert(o.wrapS)),t.texParameteri(n,t.TEXTURE_WRAP_T,a.convert(o.wrapT)),t.texParameteri(n,t.TEXTURE_MAG_FILTER,a.convert(o.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,a.convert(o.minFilter))):(t.texParameteri(n,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(n,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),o.wrapS===ct&&o.wrapT===ct||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",o),t.texParameteri(n,t.TEXTURE_MAG_FILTER,p(o.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,p(o.minFilter)),o.minFilter!==ut&&o.minFilter!==dt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",o)),c=e.get("EXT_texture_filter_anisotropic")){if(o.type===wt&&null===e.get("OES_texture_float_linear"))return;if(o.type===Mt&&null===e.get("OES_texture_half_float_linear"))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(t.texParameterf(n,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function _(e,i,o,s){var c=a.convert(i.texture.format),l=a.convert(i.texture.type);n.texImage2D(s,0,c,i.width,i.height,0,c,l,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,o,s,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function x(e,n){t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer&&!n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):n.depthBuffer&&n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,n.width,n.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}function b(e){var n=r.get(e),i=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(t.FRAMEBUFFER,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),g(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===It)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,i,0);else{if(n.depthTexture.format!==zt)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,i,0)}}(n.__webglFramebuffer,e)}else if(i){n.__webglDepthbuffer=[];for(var a=0;a<6;a++)t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer[a]),n.__webglDepthbuffer[a]=t.createRenderbuffer(),x(n.__webglDepthbuffer[a],e)}else t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),x(n.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}this.setTexture2D=g,this.setTextureCube=function(e,s){var c=r.get(e);if(6===e.image.length)if(e.version>0&&c.__version!==e.version){c.__image__webglTextureCube||(e.addEventListener("dispose",m),c.__image__webglTextureCube=t.createTexture(),o.memory.textures++),n.activeTexture(t.TEXTURE0+s),n.bindTexture(t.TEXTURE_CUBE_MAP,c.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var l=e&&e.isCompressedTexture,p=e.image[0]&&e.image[0].isDataTexture,v=[],g=0;g<6;g++)v[g]=l||p?p?e.image[g].image:e.image[g]:u(e.image[g],i.maxCubemapSize);var _=v[0],x=h(_),b=a.convert(e.format),w=a.convert(e.type);for(y(t.TEXTURE_CUBE_MAP,e,x),g=0;g<6;g++)if(l)for(var M,E=v[g].mipmaps,T=0,S=E.length;T<S;T++)M=E[T],e.format!==Ct&&e.format!==Lt?n.getCompressedTextureFormats().indexOf(b)>-1?n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,T,b,M.width,M.height,0,M.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,T,b,M.width,M.height,0,b,w,M.data);else p?n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,b,v[g].width,v[g].height,0,b,w,v[g].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,b,b,w,v[g]);c.__maxMipLevel=l?E.length-1:0,f(e,x)&&d(t.TEXTURE_CUBE_MAP,e,_.width,_.height),c.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(t.TEXTURE0+s),n.bindTexture(t.TEXTURE_CUBE_MAP,c.__image__webglTextureCube)},this.setTextureCubeDynamic=function(e,i){n.activeTexture(t.TEXTURE0+i),n.bindTexture(t.TEXTURE_CUBE_MAP,r.get(e).__webglTexture)},this.setupRenderTarget=function(e){var i=r.get(e),a=r.get(e.texture);e.addEventListener("dispose",v),a.__webglTexture=t.createTexture(),o.memory.textures++;var s=!0===e.isWebGLRenderTargetCube,c=h(e);if(s){i.__webglFramebuffer=[];for(var l=0;l<6;l++)i.__webglFramebuffer[l]=t.createFramebuffer()}else i.__webglFramebuffer=t.createFramebuffer();if(s){for(n.bindTexture(t.TEXTURE_CUBE_MAP,a.__webglTexture),y(t.TEXTURE_CUBE_MAP,e.texture,c),l=0;l<6;l++)_(i.__webglFramebuffer[l],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+l);f(e.texture,c)&&d(t.TEXTURE_CUBE_MAP,e.texture,e.width,e.height),n.bindTexture(t.TEXTURE_CUBE_MAP,null)}else n.bindTexture(t.TEXTURE_2D,a.__webglTexture),y(t.TEXTURE_2D,e.texture,c),_(i.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),f(e.texture,c)&&d(t.TEXTURE_2D,e.texture,e.width,e.height),n.bindTexture(t.TEXTURE_2D,null);e.depthBuffer&&b(e)},this.updateRenderTargetMipmap=function(e){var i=e.texture;if(f(i,h(e))){var a=e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,o=r.get(i).__webglTexture;n.bindTexture(a,o),d(a,i,e.width,e.height),n.bindTexture(a,null)}}}function Ii(t,e){return{convert:function(n){var r;if(n===st)return t.REPEAT;if(n===ct)return t.CLAMP_TO_EDGE;if(n===lt)return t.MIRRORED_REPEAT;if(n===ut)return t.NEAREST;if(n===ht)return t.NEAREST_MIPMAP_NEAREST;if(n===ft)return t.NEAREST_MIPMAP_LINEAR;if(n===dt)return t.LINEAR;if(n===pt)return t.LINEAR_MIPMAP_NEAREST;if(n===mt)return t.LINEAR_MIPMAP_LINEAR;if(n===vt)return t.UNSIGNED_BYTE;if(n===Et)return t.UNSIGNED_SHORT_4_4_4_4;if(n===Tt)return t.UNSIGNED_SHORT_5_5_5_1;if(n===St)return t.UNSIGNED_SHORT_5_6_5;if(n===gt)return t.BYTE;if(n===yt)return t.SHORT;if(n===_t)return t.UNSIGNED_SHORT;if(n===xt)return t.INT;if(n===bt)return t.UNSIGNED_INT;if(n===wt)return t.FLOAT;if(n===Mt&&null!==(r=e.get("OES_texture_half_float")))return r.HALF_FLOAT_OES;if(n===Rt)return t.ALPHA;if(n===Lt)return t.RGB;if(n===Ct)return t.RGBA;if(n===Pt)return t.LUMINANCE;if(n===Ot)return t.LUMINANCE_ALPHA;if(n===It)return t.DEPTH_COMPONENT;if(n===zt)return t.DEPTH_STENCIL;if(n===w)return t.FUNC_ADD;if(n===M)return t.FUNC_SUBTRACT;if(n===E)return t.FUNC_REVERSE_SUBTRACT;if(n===A)return t.ZERO;if(n===R)return t.ONE;if(n===L)return t.SRC_COLOR;if(n===C)return t.ONE_MINUS_SRC_COLOR;if(n===P)return t.SRC_ALPHA;if(n===O)return t.ONE_MINUS_SRC_ALPHA;if(n===N)return t.DST_ALPHA;if(n===I)return t.ONE_MINUS_DST_ALPHA;if(n===z)return t.DST_COLOR;if(n===U)return t.ONE_MINUS_DST_COLOR;if(n===D)return t.SRC_ALPHA_SATURATE;if((n===Ut||n===Dt||n===kt||n===Ft)&&null!==(r=e.get("WEBGL_compressed_texture_s3tc"))){if(n===Ut)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Dt)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===kt)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Ft)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((n===Bt||n===jt||n===Ht||n===Gt)&&null!==(r=e.get("WEBGL_compressed_texture_pvrtc"))){if(n===Bt)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===jt)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Ht)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Gt)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===Vt&&null!==(r=e.get("WEBGL_compressed_texture_etc1")))return r.COMPRESSED_RGB_ETC1_WEBGL;if((n===Wt||n===qt||n===Xt||n===Yt||n===Zt||n===Jt||n===Qt||n===Kt||n===$t||n===te||n===ee||n===ne||n===re||n===ie)&&null!==(r=e.get("WEBGL_compressed_texture_astc")))return n;if((n===T||n===S)&&null!==(r=e.get("EXT_blend_minmax"))){if(n===T)return r.MIN_EXT;if(n===S)return r.MAX_EXT}return n===At&&null!==(r=e.get("WEBGL_depth_texture"))?r.UNSIGNED_INT_24_8_WEBGL:0}}}function zi(t,e,n,r){pn.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Ui(t){zi.call(this),this.cameras=t||[]}function Di(t){var e=this,n=null,r=null,i=null,a=new Ce,o=new Ce;"undefined"!=typeof window&&"VRFrameData"in window&&(r=new window.VRFrameData);var s=new Ce,c=new Pe,l=new Oe,u=new zi;u.bounds=new He(0,0,.5,1),u.layers.enable(1);var h=new zi;h.bounds=new He(.5,0,.5,1),h.layers.enable(2);var f,d,p=new Ui([u,h]);function m(){if(null!==n&&n.isPresenting){var r=n.getEyeParameters("left"),i=r.renderWidth,a=r.renderHeight;d=t.getPixelRatio(),f=t.getSize(),t.setDrawingBufferSize(2*i,a,1)}else e.enabled&&t.setDrawingBufferSize(f.width,f.height,d)}p.layers.enable(1),p.layers.enable(2),"undefined"!=typeof window&&window.addEventListener("vrdisplaypresentchange",m,!1),this.enabled=!1,this.userHeight=1.6,this.getDevice=function(){return n},this.setDevice=function(t){void 0!==t&&(n=t)},this.setPoseTarget=function(t){void 0!==t&&(i=t)},this.getCamera=function(t){if(null===n)return t;n.depthNear=t.near,n.depthFar=t.far,n.getFrameData(r);var f=n.stageParameters;f?a.fromArray(f.sittingToStandingTransform):a.makeTranslation(0,e.userHeight,0);var d=r.pose,m=null!==i?i:t;if(m.matrix.copy(a),m.matrix.decompose(m.position,m.quaternion,m.scale),null!==d.orientation&&(c.fromArray(d.orientation),m.quaternion.multiply(c)),null!==d.position&&(c.setFromRotationMatrix(a),l.fromArray(d.position),l.applyQuaternion(c),m.position.add(l)),m.updateMatrixWorld(),!1===n.isPresenting)return t;u.near=t.near,h.near=t.near,u.far=t.far,h.far=t.far,p.matrixWorld.copy(t.matrixWorld),p.matrixWorldInverse.copy(t.matrixWorldInverse),u.matrixWorldInverse.fromArray(r.leftViewMatrix),h.matrixWorldInverse.fromArray(r.rightViewMatrix),o.getInverse(a),u.matrixWorldInverse.multiply(o),h.matrixWorldInverse.multiply(o);var v=m.parent;null!==v&&(s.getInverse(v.matrixWorld),u.matrixWorldInverse.multiply(s),h.matrixWorldInverse.multiply(s)),u.matrixWorld.getInverse(u.matrixWorldInverse),h.matrixWorld.getInverse(h.matrixWorldInverse),u.projectionMatrix.fromArray(r.leftProjectionMatrix),h.projectionMatrix.fromArray(r.rightProjectionMatrix),p.projectionMatrix.copy(u.projectionMatrix);var g=n.getLayers();if(g.length){var y=g[0];null!==y.leftBounds&&4===y.leftBounds.length&&u.bounds.fromArray(y.leftBounds),null!==y.rightBounds&&4===y.rightBounds.length&&h.bounds.fromArray(y.rightBounds)}return p},this.getStandingMatrix=function(){return a},this.submitFrame=function(){n&&n.isPresenting&&n.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",m)}}function ki(t){console.log("THREE.WebGLRenderer",i);var e=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==t.context?t.context:null,r=void 0!==t.alpha&&t.alpha,a=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,s=void 0!==t.antialias&&t.antialias,c=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,u=void 0!==t.powerPreference?t.powerPreference:"default",h=null,f=null;this.domElement=e,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=J,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var p,m,v,g,y,_,x,b,w,M,E,T,S,A,R,L,C,P,O,N=this,I=!1,z=null,U=null,D=-1,k="",F=null,B=null,j=new He,H=new He,G=null,V=0,W=e.width,q=e.height,X=1,Y=new He(0,0,W,q),Z=new He(0,0,W,q),Q=!1,K=new Ze,$=new rr,tt=!1,et=!1,nt=new Ce,rt=new Oe;function it(){return null===z?X:1}try{var at={alpha:r,depth:a,stencil:o,antialias:s,premultipliedAlpha:c,preserveDrawingBuffer:l,powerPreference:u};if(e.addEventListener("webglcontextlost",lt,!1),e.addEventListener("webglcontextrestored",ut,!1),null===(p=n||e.getContext("webgl",at)||e.getContext("experimental-webgl",at)))throw null!==e.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===p.getShaderPrecisionFormat&&(p.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){console.error("THREE.WebGLRenderer: "+t.message)}function ot(){(m=new ir(p)).get("WEBGL_depth_texture"),m.get("OES_texture_float"),m.get("OES_texture_float_linear"),m.get("OES_texture_half_float"),m.get("OES_texture_half_float_linear"),m.get("OES_standard_derivatives"),m.get("OES_element_index_uint"),m.get("ANGLE_instanced_arrays"),O=new Ii(p,m),v=new nr(p,m,t),(g=new Oi(p,m,O)).scissor(H.copy(Z).multiplyScalar(X)),g.viewport(j.copy(Y).multiplyScalar(X)),y=new sr(p),_=new li,x=new Ni(p,m,g,_,v,O,y),b=new an(p),w=new ar(p,b,y),M=new ur(w,y),R=new lr(p),E=new ci(N,m,v),T=new di,S=new Si,A=new tr(N,g,w,c),L=new er(p,m,y),C=new or(p,m,y),P=new Pi(N,p,g,x,v),y.programs=E.programs,N.context=p,N.capabilities=v,N.extensions=m,N.properties=_,N.renderLists=T,N.state=g,N.info=y}ot();var st=new Di(N);this.vr=st;var ct=new Li(N,M,v.maxTextureSize);function lt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),I=!0}function ut(){console.log("THREE.WebGLRenderer: Context Restored."),I=!1,ot()}function ht(t){var e=t.target;e.removeEventListener("dispose",ht),function(t){ft(t),_.remove(t)}(e)}function ft(t){var e=_.get(t).program;t.program=void 0,void 0!==e&&E.releaseProgram(e)}this.shadowMap=ct,this.getContext=function(){return p},this.getContextAttributes=function(){return p.getContextAttributes()},this.forceContextLoss=function(){var t=m.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=m.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(t){void 0!==t&&(X=t,this.setSize(W,q,!1))},this.getSize=function(){return{width:W,height:q}},this.setSize=function(t,n,r){var i=st.getDevice();i&&i.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(W=t,q=n,e.width=t*X,e.height=n*X,!1!==r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(){return{width:W*X,height:q*X}},this.setDrawingBufferSize=function(t,n,r){W=t,q=n,X=r,e.width=t*r,e.height=n*r,this.setViewport(0,0,t,n)},this.getCurrentViewport=function(){return j},this.setViewport=function(t,e,n,r){Y.set(t,q-e-r,n,r),g.viewport(j.copy(Y).multiplyScalar(X))},this.setScissor=function(t,e,n,r){Z.set(t,q-e-r,n,r),g.scissor(H.copy(Z).multiplyScalar(X))},this.setScissorTest=function(t){g.setScissorTest(Q=t)},this.getClearColor=function(){return A.getClearColor()},this.setClearColor=function(){A.setClearColor.apply(A,arguments)},this.getClearAlpha=function(){return A.getClearAlpha()},this.setClearAlpha=function(){A.setClearAlpha.apply(A,arguments)},this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=p.COLOR_BUFFER_BIT),(void 0===e||e)&&(r|=p.DEPTH_BUFFER_BIT),(void 0===n||n)&&(r|=p.STENCIL_BUFFER_BIT),p.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,n,r){this.setRenderTarget(t),this.clear(e,n,r)},this.dispose=function(){e.removeEventListener("webglcontextlost",lt,!1),e.removeEventListener("webglcontextrestored",ut,!1),T.dispose(),S.dispose(),_.dispose(),M.dispose(),st.dispose(),gt()},this.renderBufferImmediate=function(t,e,n){g.initAttributes();var r=_.get(t);t.hasPositions&&!r.position&&(r.position=p.createBuffer()),t.hasNormals&&!r.normal&&(r.normal=p.createBuffer()),t.hasUvs&&!r.uv&&(r.uv=p.createBuffer()),t.hasColors&&!r.color&&(r.color=p.createBuffer());var i=e.getAttributes();if(t.hasPositions&&(p.bindBuffer(p.ARRAY_BUFFER,r.position),p.bufferData(p.ARRAY_BUFFER,t.positionArray,p.DYNAMIC_DRAW),g.enableAttribute(i.position),p.vertexAttribPointer(i.position,3,p.FLOAT,!1,0,0)),t.hasNormals){if(p.bindBuffer(p.ARRAY_BUFFER,r.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&!n.isMeshNormalMaterial&&!0===n.flatShading)for(var a=0,o=3*t.count;a<o;a+=9){var s=t.normalArray,c=(s[a+0]+s[a+3]+s[a+6])/3,l=(s[a+1]+s[a+4]+s[a+7])/3,u=(s[a+2]+s[a+5]+s[a+8])/3;s[a+0]=c,s[a+1]=l,s[a+2]=u,s[a+3]=c,s[a+4]=l,s[a+5]=u,s[a+6]=c,s[a+7]=l,s[a+8]=u}p.bufferData(p.ARRAY_BUFFER,t.normalArray,p.DYNAMIC_DRAW),g.enableAttribute(i.normal),p.vertexAttribPointer(i.normal,3,p.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(p.bindBuffer(p.ARRAY_BUFFER,r.uv),p.bufferData(p.ARRAY_BUFFER,t.uvArray,p.DYNAMIC_DRAW),g.enableAttribute(i.uv),p.vertexAttribPointer(i.uv,2,p.FLOAT,!1,0,0)),t.hasColors&&n.vertexColors!==d&&(p.bindBuffer(p.ARRAY_BUFFER,r.color),p.bufferData(p.ARRAY_BUFFER,t.colorArray,p.DYNAMIC_DRAW),g.enableAttribute(i.color),p.vertexAttribPointer(i.color,3,p.FLOAT,!1,0,0)),g.disableUnusedAttributes(),p.drawArrays(p.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,r,i,a){var o=i.isMesh&&i.matrixWorld.determinant()<0;g.setMaterial(r,o);var s=Tt(t,e,r,i),c=n.id+"_"+s.id+"_"+(!0===r.wireframe),l=!1;c!==k&&(k=c,l=!0),i.morphTargetInfluences&&(R.update(i,n,r,s),l=!0);var u,h=n.index,f=n.attributes.position,d=1;!0===r.wireframe&&(h=w.getWireframeAttribute(n),d=2);var v=L;null!==h&&(u=b.get(h),(v=C).setIndex(u)),l&&(!function(t,e,n,r){if(n&&n.isInstancedBufferGeometry&&null===m.get("ANGLE_instanced_arrays"))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===r&&(r=0);g.initAttributes();var i=n.attributes,a=e.getAttributes(),o=t.defaultAttributeValues;for(var s in a){var c=a[s];if(c>=0){var l=i[s];if(void 0!==l){var u=l.normalized,h=l.itemSize,f=b.get(l);if(void 0===f)continue;var d=f.buffer,v=f.type,y=f.bytesPerElement;if(l.isInterleavedBufferAttribute){var _=l.data,x=_.stride,w=l.offset;_&&_.isInstancedInterleavedBuffer?(g.enableAttributeAndDivisor(c,_.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=_.meshPerAttribute*_.count)):g.enableAttribute(c),p.bindBuffer(p.ARRAY_BUFFER,d),p.vertexAttribPointer(c,h,v,u,x*y,(r*x+w)*y)}else l.isInstancedBufferAttribute?(g.enableAttributeAndDivisor(c,l.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=l.meshPerAttribute*l.count)):g.enableAttribute(c),p.bindBuffer(p.ARRAY_BUFFER,d),p.vertexAttribPointer(c,h,v,u,0,r*h*y)}else if(void 0!==o){var M=o[s];if(void 0!==M)switch(M.length){case 2:p.vertexAttrib2fv(c,M);break;case 3:p.vertexAttrib3fv(c,M);break;case 4:p.vertexAttrib4fv(c,M);break;default:p.vertexAttrib1fv(c,M)}}}}g.disableUnusedAttributes()}(r,s,n),null!==h&&p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,u.buffer));var y=1/0;null!==h?y=h.count:void 0!==f&&(y=f.count);var _=n.drawRange.start*d,x=n.drawRange.count*d,M=null!==a?a.start*d:0,E=null!==a?a.count*d:1/0,T=Math.max(_,M),S=Math.min(y,_+x,M+E)-1,A=Math.max(0,S-T+1);if(0!==A){if(i.isMesh)if(!0===r.wireframe)g.setLineWidth(r.wireframeLinewidth*it()),v.setMode(p.LINES);else switch(i.drawMode){case se:v.setMode(p.TRIANGLES);break;case ce:v.setMode(p.TRIANGLE_STRIP);break;case le:v.setMode(p.TRIANGLE_FAN)}else if(i.isLine){var P=r.linewidth;void 0===P&&(P=1),g.setLineWidth(P*it()),i.isLineSegments?v.setMode(p.LINES):i.isLineLoop?v.setMode(p.LINE_LOOP):v.setMode(p.LINE_STRIP)}else i.isPoints&&v.setMode(p.POINTS);n&&n.isInstancedBufferGeometry?n.maxInstancedCount>0&&v.renderInstances(n,T,A):v.render(T,A)}},this.compile=function(t,e){(f=S.get(t,e)).init(),t.traverse(function(t){t.isLight&&(f.pushLight(t),t.castShadow&&f.pushShadow(t))}),f.setupLights(e),t.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var n=0;n<e.material.length;n++)Et(e.material[n],t.fog,e);else Et(e.material,t.fog,e)})};var dt,pt=!1,mt=null;function gt(){pt=!1}function yt(){var t=st.getDevice();t&&t.isPresenting?t.requestAnimationFrame(_t):window.requestAnimationFrame(_t)}function _t(t){!1!==pt&&(mt(t),yt())}function xt(t,e,n,r){for(var i=0,a=t.length;i<a;i++){var o=t[i],s=o.object,c=o.geometry,l=void 0===r?o.material:r,u=o.group;if(n.isArrayCamera){B=n;for(var h=n.cameras,f=0,d=h.length;f<d;f++){var p=h[f];if(s.layers.test(p.layers)){var m=p.bounds,v=m.x*W,y=m.y*q,_=m.z*W,x=m.w*q;g.viewport(j.set(v,y,_,x).multiplyScalar(X)),bt(s,e,p,c,l,u)}}}else B=null,bt(s,e,n,c,l,u)}}function bt(t,e,n,r,i,a){if(t.onBeforeRender(N,e,n,r,i,a),f=S.get(e,B||n),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var o=t.isMesh&&t.matrixWorld.determinant()<0;g.setMaterial(i,o);var s=Tt(n,e.fog,i,t);k="",function(t,e,n){t.render(function(t){N.renderBufferImmediate(t,e,n)})}(t,s,i)}else N.renderBufferDirect(n,e.fog,r,i,t,a);t.onAfterRender(N,e,n,r,i,a),f=S.get(e,B||n)}function Et(t,e,n){var r=_.get(t),i=f.state.lights,a=f.state.shadowsArray,o=E.getParameters(t,i.state,a,e,$.numPlanes,$.numIntersection,n),s=E.getProgramCode(t,o),c=r.program,l=!0;if(void 0===c)t.addEventListener("dispose",ht);else if(c.code!==s)ft(t);else if(r.lightsHash!==i.state.hash)_.update(t,"lightsHash",i.state.hash),l=!1;else{if(void 0!==o.shaderID)return;l=!1}if(l){if(o.shaderID){var u=rn[o.shaderID];r.shader={name:t.type,uniforms:Qe.clone(u.uniforms),vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}}else r.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.onBeforeCompile(r.shader,N),c=E.acquireProgram(t,r.shader,o,s),r.program=c,t.program=c}var h=c.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var d=0;d<N.maxMorphTargets;d++)h["morphTarget"+d]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(d=0;d<N.maxMorphNormals;d++)h["morphNormal"+d]>=0&&t.numSupportedMorphNormals++}var p=r.shader.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=$.numPlanes,r.numIntersection=$.numIntersection,p.clippingPlanes=$.uniform),r.fog=e,r.lightsHash=i.state.hash,t.lights&&(p.ambientLightColor.value=i.state.ambient,p.directionalLights.value=i.state.directional,p.spotLights.value=i.state.spot,p.rectAreaLights.value=i.state.rectArea,p.pointLights.value=i.state.point,p.hemisphereLights.value=i.state.hemi,p.directionalShadowMap.value=i.state.directionalShadowMap,p.directionalShadowMatrix.value=i.state.directionalShadowMatrix,p.spotShadowMap.value=i.state.spotShadowMap,p.spotShadowMatrix.value=i.state.spotShadowMatrix,p.pointShadowMap.value=i.state.pointShadowMap,p.pointShadowMatrix.value=i.state.pointShadowMatrix);var m=r.program.getUniforms(),v=Jr.seqWithValue(m.seq,p);r.uniformsList=v}function Tt(t,e,n,r){V=0;var i=_.get(n),a=f.state.lights;if(tt&&(et||t!==F)){var o=t===F&&n.id===D;$.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,i,o)}!1===n.needsUpdate&&(void 0===i.program?n.needsUpdate=!0:n.fog&&i.fog!==e?n.needsUpdate=!0:n.lights&&i.lightsHash!==a.state.hash?n.needsUpdate=!0:void 0===i.numClippingPlanes||i.numClippingPlanes===$.numPlanes&&i.numIntersection===$.numIntersection||(n.needsUpdate=!0)),n.needsUpdate&&(Et(n,e,r),n.needsUpdate=!1);var s,c,l=!1,u=!1,h=!1,d=i.program,m=d.getUniforms(),y=i.shader.uniforms;if(g.useProgram(d.program)&&(l=!0,u=!0,h=!0),n.id!==D&&(D=n.id,u=!0),l||t!==F){if(m.setValue(p,"projectionMatrix",t.projectionMatrix),v.logarithmicDepthBuffer&&m.setValue(p,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),F!==(B||t)&&(F=B||t,u=!0,h=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var x=m.map.cameraPosition;void 0!==x&&x.setValue(p,rt.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&m.setValue(p,"viewMatrix",t.matrixWorldInverse)}if(n.skinning){m.setOptional(p,r,"bindMatrix"),m.setOptional(p,r,"bindMatrixInverse");var b=r.skeleton;if(b){var w=b.bones;if(v.floatVertexTextures){if(void 0===b.boneTexture){var M=Math.sqrt(4*w.length);M=Re.ceilPowerOfTwo(M),M=Math.max(M,4);var E=new Float32Array(M*M*4);E.set(b.boneMatrices);var T=new We(E,M,M,Ct,wt);T.needsUpdate=!0,b.boneMatrices=E,b.boneTexture=T,b.boneTextureSize=M}m.setValue(p,"boneTexture",b.boneTexture),m.setValue(p,"boneTextureSize",b.boneTextureSize)}else m.setOptional(p,b,"boneMatrices")}}return u&&(m.setValue(p,"toneMappingExposure",N.toneMappingExposure),m.setValue(p,"toneMappingWhitePoint",N.toneMappingWhitePoint),n.lights&&(c=h,(s=y).ambientLightColor.needsUpdate=c,s.directionalLights.needsUpdate=c,s.pointLights.needsUpdate=c,s.spotLights.needsUpdate=c,s.rectAreaLights.needsUpdate=c,s.hemisphereLights.needsUpdate=c),e&&n.fog&&function(t,e){t.fogColor.value=e.color,e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}(y,e),n.isMeshBasicMaterial?St(y,n):n.isMeshLambertMaterial?(St(y,n),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(y,n)):n.isMeshPhongMaterial?(St(y,n),n.isMeshToonMaterial?function(t,e){At(t,e),e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(y,n):At(y,n)):n.isMeshStandardMaterial?(St(y,n),n.isMeshPhysicalMaterial?function(t,e){t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness,Rt(t,e)}(y,n):Rt(y,n)):n.isMeshDepthMaterial?(St(y,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(y,n)):n.isMeshDistanceMaterial?(St(y,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(y,n)):n.isMeshNormalMaterial?(St(y,n),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale);e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale));e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(y,n)):n.isLineBasicMaterial?(function(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}(y,n),n.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(y,n)):n.isPointsMaterial?function(t,e){if(t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*X,t.scale.value=.5*q,t.map.value=e.map,null!==e.map){if(!0===e.map.matrixAutoUpdate){var n=e.map.offset,r=e.map.repeat,i=e.map.rotation,a=e.map.center;e.map.matrix.setUvTransform(n.x,n.y,r.x,r.y,i,a.x,a.y)}t.uvTransform.value.copy(e.map.matrix)}}(y,n):n.isShadowMaterial&&(y.color.value=n.color,y.opacity.value=n.opacity),void 0!==y.ltc_1&&(y.ltc_1.value=en.LTC_1),void 0!==y.ltc_2&&(y.ltc_2.value=en.LTC_2),Jr.upload(p,i.uniformsList,y,N)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Jr.upload(p,i.uniformsList,y,N),n.uniformsNeedUpdate=!1),m.setValue(p,"modelViewMatrix",r.modelViewMatrix),m.setValue(p,"normalMatrix",r.normalMatrix),m.setValue(p,"modelMatrix",r.matrixWorld),d}function St(t,e){var n;if(t.opacity.value=e.opacity,e.color&&(t.diffuse.value=e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=_.get(e.envMap).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?n=e.map:e.specularMap?n=e.specularMap:e.displacementMap?n=e.displacementMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.roughnessMap?n=e.roughnessMap:e.metalnessMap?n=e.metalnessMap:e.alphaMap?n=e.alphaMap:e.emissiveMap&&(n=e.emissiveMap),void 0!==n){if(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate){var r=n.offset,i=n.repeat,a=n.rotation,o=n.center;n.matrix.setUvTransform(r.x,r.y,i.x,i.y,a,o.x,o.y)}t.uvTransform.value.copy(n.matrix)}}function At(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function Rt(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}this.animate=function(t){null!==(mt=t)?pt||(yt(),pt=!0):gt()},this.render=function(t,e,n,r){if(e&&e.isCamera){if(!I){k="",D=-1,F=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),st.enabled&&(e=st.getCamera(e)),(f=S.get(t,e)).init(),t.onBeforeRender(N,t,e,n),nt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),K.setFromMatrix(nt),et=this.localClippingEnabled,tt=$.init(this.clippingPlanes,et,e),(h=T.get(t,e)).init(),function t(e,n,r){if(!1===e.visible)return;var i=e.layers.test(n.layers);if(i)if(e.isLight)f.pushLight(e),e.castShadow&&f.pushShadow(e);else if(e.isSprite)e.frustumCulled&&!K.intersectsSprite(e)||f.pushSprite(e);else if(e.isImmediateRenderObject)r&&rt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(nt),h.push(e,null,e.material,rt.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.update(),!e.frustumCulled||K.intersectsObject(e))){r&&rt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(nt);var a=M.update(e),o=e.material;if(Array.isArray(o))for(var s=a.groups,c=0,l=s.length;c<l;c++){var u=s[c],d=o[u.materialIndex];d&&d.visible&&h.push(e,a,d,rt.z,u)}else o.visible&&h.push(e,a,o,rt.z,null)}var p=e.children;for(var c=0,l=p.length;c<l;c++)t(p[c],n,r)}(t,e,N.sortObjects),!0===N.sortObjects&&h.sort(),tt&&$.beginShadows();var i=f.state.shadowsArray;ct.render(i,t,e),f.setupLights(e),tt&&$.endShadows(),this.info.autoReset&&this.info.reset(),void 0===n&&(n=null),this.setRenderTarget(n),A.render(h,t,e,r);var a=h.opaque,o=h.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;a.length&&xt(a,t,e,s),o.length&&xt(o,t,e,s)}else a.length&&xt(a,t,e),o.length&&xt(o,t,e);var c=f.state.spritesArray;P.render(c,t,e),n&&x.updateRenderTargetMipmap(n),g.buffers.depth.setTest(!0),g.buffers.depth.setMask(!0),g.buffers.color.setMask(!0),g.setPolygonOffset(!1),t.onAfterRender(N,t,e),st.enabled&&st.submitFrame(),h=null,f=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.allocTextureUnit=function(){var t=V;return t>=v.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+t+" texture units while this GPU supports only "+v.maxTextures),V+=1,t},this.setTexture2D=(dt=!1,function(t,e){t&&t.isWebGLRenderTarget&&(dt||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),dt=!0),t=t.texture),x.setTexture2D(t,e)}),this.setTexture=function(){var t=!1;return function(e,n){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),x.setTexture2D(e,n)}}(),this.setTextureCube=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?x.setTextureCube(e,n):x.setTextureCubeDynamic(e,n)}}(),this.getRenderTarget=function(){return z},this.setRenderTarget=function(t){z=t,t&&void 0===_.get(t).__webglFramebuffer&&x.setupRenderTarget(t);var e=null,n=!1;if(t){var r=_.get(t).__webglFramebuffer;t.isWebGLRenderTargetCube?(e=r[t.activeCubeFace],n=!0):e=r,j.copy(t.viewport),H.copy(t.scissor),G=t.scissorTest}else j.copy(Y).multiplyScalar(X),H.copy(Z).multiplyScalar(X),G=Q;if(U!==e&&(p.bindFramebuffer(p.FRAMEBUFFER,e),U=e),g.viewport(j),g.scissor(H),g.setScissorTest(G),n){var i=_.get(t.texture);p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,i.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,n,r,i,a){if(t&&t.isWebGLRenderTarget){var o=_.get(t).__webglFramebuffer;if(o){var s=!1;o!==U&&(p.bindFramebuffer(p.FRAMEBUFFER,o),s=!0);try{var c=t.texture,l=c.format,u=c.type;if(l!==Ct&&O.convert(l)!==p.getParameter(p.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(u===vt||O.convert(u)===p.getParameter(p.IMPLEMENTATION_COLOR_READ_TYPE)||u===wt&&(m.get("OES_texture_float")||m.get("WEBGL_color_buffer_float"))||u===Mt&&m.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");p.checkFramebufferStatus(p.FRAMEBUFFER)===p.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&p.readPixels(e,n,r,i,O.convert(l),O.convert(u),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&p.bindFramebuffer(p.FRAMEBUFFER,U)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,n){var r=e.image.width,i=e.image.height,a=O.convert(e.format);this.setTexture2D(e,0),p.copyTexImage2D(p.TEXTURE_2D,n||0,a,t.x,t.y,r,i,0)},this.copyTextureToTexture=function(t,e,n,r){var i=e.image.width,a=e.image.height,o=O.convert(n.format),s=O.convert(n.type),c=e.isDataTexture?e.image.data:e.image;this.setTexture2D(n,0),p.texSubImage2D(p.TEXTURE_2D,r||0,t.x,t.y,i,a,o,s,c)}}function Fi(t,e){this.name="",this.color=new tn(t),this.density=void 0!==e?e:25e-5}function Bi(t,e,n){this.name="",this.color=new tn(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function ji(){dn.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function Hi(t){Xn.call(this),this.type="SpriteMaterial",this.color=new tn(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(t)}function Gi(t){dn.call(this),this.type="Sprite",this.material=void 0!==t?t:new Hi,this.center=new Le(.5,.5)}function Vi(){dn.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Wi(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Ce)}}function qi(){dn.call(this),this.type="Bone"}function Xi(t,e){$n.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ce,this.bindMatrixInverse=new Ce;var n=new Wi(this.initBones());this.bind(n,this.matrixWorld),this.normalizeSkinWeights()}function Yi(t){Xn.call(this),this.type="LineBasicMaterial",this.color=new tn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function Zi(t,e,n){if(1===n)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new Ji(t,e);dn.call(this),this.type="Line",this.geometry=void 0!==t?t:new In,this.material=void 0!==e?e:new Yi({color:16777215*Math.random()})}function Ji(t,e){Zi.call(this,t,e),this.type="LineSegments"}function Qi(t,e){Zi.call(this,t,e),this.type="LineLoop"}function Ki(t){Xn.call(this),this.type="PointsMaterial",this.color=new tn(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function $i(t,e){dn.call(this),this.type="Points",this.geometry=void 0!==t?t:new In,this.material=void 0!==e?e:new Ki({color:16777215*Math.random()})}function ta(){dn.call(this),this.type="Group"}function ea(t,e,n,r,i,a,o,s,c){je.call(this,t,e,n,r,i,a,o,s,c),this.generateMipmaps=!1}function na(t,e,n,r,i,a,o,s,c,l,u,h){je.call(this,null,a,o,s,c,l,r,i,u,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function ra(t,e,n,r,i,a,o,s,c,l){if((l=void 0!==l?l:It)!==It&&l!==zt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&l===It&&(n=_t),void 0===n&&l===zt&&(n=At),je.call(this,null,r,i,a,o,s,l,n,c),this.image={width:t,height:e},this.magFilter=void 0!==o?o:ut,this.minFilter=void 0!==s?s:ut,this.flipY=!1,this.generateMipmaps=!1}function ia(t){In.call(this),this.type="WireframeGeometry";var e,n,r,i,a,o,s,c,l,u,h=[],f=[0,0],d={},p=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(e=0,r=m.length;e<r;e++){var v=m[e];for(n=0;n<3;n++)s=v[p[n]],c=v[p[(n+1)%3]],f[0]=Math.min(s,c),f[1]=Math.max(s,c),void 0===d[l=f[0]+","+f[1]]&&(d[l]={index1:f[0],index2:f[1]})}for(l in d)o=d[l],u=t.vertices[o.index1],h.push(u.x,u.y,u.z),u=t.vertices[o.index2],h.push(u.x,u.y,u.z)}else if(t&&t.isBufferGeometry){var g,y,_,x,b,w,M;if(u=new Oe,null!==t.index){for(g=t.attributes.position,y=t.index,0===(_=t.groups).length&&(_=[{start:0,count:y.count,materialIndex:0}]),i=0,a=_.length;i<a;++i)for(e=b=(x=_[i]).start,r=b+x.count;e<r;e+=3)for(n=0;n<3;n++)s=y.getX(e+n),c=y.getX(e+(n+1)%3),f[0]=Math.min(s,c),f[1]=Math.max(s,c),void 0===d[l=f[0]+","+f[1]]&&(d[l]={index1:f[0],index2:f[1]});for(l in d)o=d[l],u.fromBufferAttribute(g,o.index1),h.push(u.x,u.y,u.z),u.fromBufferAttribute(g,o.index2),h.push(u.x,u.y,u.z)}else for(e=0,r=(g=t.attributes.position).count/3;e<r;e++)for(n=0;n<3;n++)w=3*e+n,u.fromBufferAttribute(g,w),h.push(u.x,u.y,u.z),M=3*e+(n+1)%3,u.fromBufferAttribute(g,M),h.push(u.x,u.y,u.z)}this.addAttribute("position",new Ln(h,3))}function aa(t,e,n){xn.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new oa(t,e,n)),this.mergeVertices()}function oa(t,e,n){In.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var r,i,a=[],o=[],s=[],c=[],l=new Oe,u=new Oe,h=new Oe,f=new Oe,d=new Oe,p=e+1;for(r=0;r<=n;r++){var m=r/n;for(i=0;i<=e;i++){var v=i/e;t(v,m,u),o.push(u.x,u.y,u.z),v-1e-5>=0?(t(v-1e-5,m,h),f.subVectors(u,h)):(t(v+1e-5,m,h),f.subVectors(h,u)),m-1e-5>=0?(t(v,m-1e-5,h),d.subVectors(u,h)):(t(v,m+1e-5,h),d.subVectors(h,u)),l.crossVectors(f,d).normalize(),s.push(l.x,l.y,l.z),c.push(v,m)}}for(r=0;r<n;r++)for(i=0;i<e;i++){var g=r*p+i,y=r*p+i+1,_=(r+1)*p+i+1,x=(r+1)*p+i;a.push(g,y,x),a.push(y,_,x)}this.setIndex(a),this.addAttribute("position",new Ln(o,3)),this.addAttribute("normal",new Ln(s,3)),this.addAttribute("uv",new Ln(c,2))}function sa(t,e,n,r){xn.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new ca(t,e,n,r)),this.mergeVertices()}function ca(t,e,n,r){In.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1;var i=[],a=[];function o(t,e,n,r){var i,a,o=Math.pow(2,r),c=[];for(i=0;i<=o;i++){c[i]=[];var l=t.clone().lerp(n,i/o),u=e.clone().lerp(n,i/o),h=o-i;for(a=0;a<=h;a++)c[i][a]=0===a&&i===o?l:l.clone().lerp(u,a/h)}for(i=0;i<o;i++)for(a=0;a<2*(o-i)-1;a++){var f=Math.floor(a/2);a%2==0?(s(c[i][f+1]),s(c[i+1][f]),s(c[i][f])):(s(c[i][f+1]),s(c[i+1][f+1]),s(c[i+1][f]))}}function s(t){i.push(t.x,t.y,t.z)}function c(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function l(t,e,n,r){r<0&&1===t.x&&(a[e]=t.x-1),0===n.x&&0===n.z&&(a[e]=r/2/Math.PI+.5)}function u(t){return Math.atan2(t.z,-t.x)}!function(t){for(var n=new Oe,r=new Oe,i=new Oe,a=0;a<e.length;a+=3)c(e[a+0],n),c(e[a+1],r),c(e[a+2],i),o(n,r,i,t)}(r=r||0),function(t){for(var e=new Oe,n=0;n<i.length;n+=3)e.x=i[n+0],e.y=i[n+1],e.z=i[n+2],e.normalize().multiplyScalar(t),i[n+0]=e.x,i[n+1]=e.y,i[n+2]=e.z}(n),function(){for(var t=new Oe,e=0;e<i.length;e+=3){t.x=i[e+0],t.y=i[e+1],t.z=i[e+2];var n=u(t)/2/Math.PI+.5,r=(o=t,Math.atan2(-o.y,Math.sqrt(o.x*o.x+o.z*o.z))/Math.PI+.5);a.push(n,1-r)}var o;(function(){for(var t=new Oe,e=new Oe,n=new Oe,r=new Oe,o=new Le,s=new Le,c=new Le,h=0,f=0;h<i.length;h+=9,f+=6){t.set(i[h+0],i[h+1],i[h+2]),e.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),o.set(a[f+0],a[f+1]),s.set(a[f+2],a[f+3]),c.set(a[f+4],a[f+5]),r.copy(t).add(e).add(n).divideScalar(3);var d=u(r);l(o,f+0,t,d),l(s,f+2,e,d),l(c,f+4,n,d)}})(),function(){for(var t=0;t<a.length;t+=6){var e=a[t+0],n=a[t+2],r=a[t+4],i=Math.max(e,n,r),o=Math.min(e,n,r);i>.9&&o<.1&&(e<.2&&(a[t+0]+=1),n<.2&&(a[t+2]+=1),r<.2&&(a[t+4]+=1))}}()}(),this.addAttribute("position",new Ln(i,3)),this.addAttribute("normal",new Ln(i.slice(),3)),this.addAttribute("uv",new Ln(a,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function la(t,e){xn.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new ua(t,e)),this.mergeVertices()}function ua(t,e){ca.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ha(t,e){xn.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new fa(t,e)),this.mergeVertices()}function fa(t,e){ca.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function da(t,e){xn.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new pa(t,e)),this.mergeVertices()}function pa(t,e){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];ca.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ma(t,e){xn.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new va(t,e)),this.mergeVertices()}function va(t,e){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];ca.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ga(t,e,n,r,i,a){xn.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new ya(t,e,n,r,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function ya(t,e,n,r,i){In.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},e=e||64,n=n||1,r=r||8,i=i||!1;var a=t.computeFrenetFrames(e,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;var o,s,c=new Oe,l=new Oe,u=new Le,h=new Oe,f=[],d=[],p=[],m=[];function v(i){h=t.getPointAt(i/e,h);var o=a.normals[i],u=a.binormals[i];for(s=0;s<=r;s++){var p=s/r*Math.PI*2,m=Math.sin(p),v=-Math.cos(p);l.x=v*o.x+m*u.x,l.y=v*o.y+m*u.y,l.z=v*o.z+m*u.z,l.normalize(),d.push(l.x,l.y,l.z),c.x=h.x+n*l.x,c.y=h.y+n*l.y,c.z=h.z+n*l.z,f.push(c.x,c.y,c.z)}}!function(){for(o=0;o<e;o++)v(o);v(!1===i?e:0),function(){for(o=0;o<=e;o++)for(s=0;s<=r;s++)u.x=o/e,u.y=s/r,p.push(u.x,u.y)}(),function(){for(s=1;s<=e;s++)for(o=1;o<=r;o++){var t=(r+1)*(s-1)+(o-1),n=(r+1)*s+(o-1),i=(r+1)*s+o,a=(r+1)*(s-1)+o;m.push(t,n,a),m.push(n,i,a)}}()}(),this.setIndex(m),this.addAttribute("position",new Ln(f,3)),this.addAttribute("normal",new Ln(d,3)),this.addAttribute("uv",new Ln(p,2))}function _a(t,e,n,r,i,a,o){xn.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new xa(t,e,n,r,i,a)),this.mergeVertices()}function xa(t,e,n,r,i,a){In.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:a},t=t||1,e=e||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,a=a||3;var o,s,c=[],l=[],u=[],h=[],f=new Oe,d=new Oe,p=new Oe,m=new Oe,v=new Oe,g=new Oe,y=new Oe;for(o=0;o<=n;++o){var _=o/n*i*Math.PI*2;for(A(_,i,a,t,p),A(_+.01,i,a,t,m),g.subVectors(m,p),y.addVectors(m,p),v.crossVectors(g,y),y.crossVectors(v,g),v.normalize(),y.normalize(),s=0;s<=r;++s){var x=s/r*Math.PI*2,b=-e*Math.cos(x),w=e*Math.sin(x);f.x=p.x+(b*y.x+w*v.x),f.y=p.y+(b*y.y+w*v.y),f.z=p.z+(b*y.z+w*v.z),l.push(f.x,f.y,f.z),d.subVectors(f,p).normalize(),u.push(d.x,d.y,d.z),h.push(o/n),h.push(s/r)}}for(s=1;s<=n;s++)for(o=1;o<=r;o++){var M=(r+1)*(s-1)+(o-1),E=(r+1)*s+(o-1),T=(r+1)*s+o,S=(r+1)*(s-1)+o;c.push(M,E,S),c.push(E,T,S)}function A(t,e,n,r,i){var a=Math.cos(t),o=Math.sin(t),s=n/e*t,c=Math.cos(s);i.x=r*(2+c)*.5*a,i.y=r*(2+c)*o*.5,i.z=r*Math.sin(s)*.5}this.setIndex(c),this.addAttribute("position",new Ln(l,3)),this.addAttribute("normal",new Ln(u,3)),this.addAttribute("uv",new Ln(h,2))}function ba(t,e,n,r,i){xn.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new wa(t,e,n,r,i)),this.mergeVertices()}function wa(t,e,n,r,i){In.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},t=t||1,e=e||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var a,o,s=[],c=[],l=[],u=[],h=new Oe,f=new Oe,d=new Oe;for(a=0;a<=n;a++)for(o=0;o<=r;o++){var p=o/r*i,m=a/n*Math.PI*2;f.x=(t+e*Math.cos(m))*Math.cos(p),f.y=(t+e*Math.cos(m))*Math.sin(p),f.z=e*Math.sin(m),c.push(f.x,f.y,f.z),h.x=t*Math.cos(p),h.y=t*Math.sin(p),d.subVectors(f,h).normalize(),l.push(d.x,d.y,d.z),u.push(o/r),u.push(a/n)}for(a=1;a<=n;a++)for(o=1;o<=r;o++){var v=(r+1)*a+o-1,g=(r+1)*(a-1)+o-1,y=(r+1)*(a-1)+o,_=(r+1)*a+o;s.push(v,g,_),s.push(g,y,_)}this.setIndex(s),this.addAttribute("position",new Ln(c,3)),this.addAttribute("normal",new Ln(l,3)),this.addAttribute("uv",new Ln(u,2))}e.MeshDepthMaterial=Ai,Ai.prototype=Object.create(Xn.prototype),Ai.prototype.constructor=Ai,Ai.prototype.isMeshDepthMaterial=!0,Ai.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},e.MeshDistanceMaterial=Ri,Ri.prototype=Object.create(Xn.prototype),Ri.prototype.constructor=Ri,Ri.prototype.isMeshDistanceMaterial=!0,Ri.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},e.CanvasTexture=Ci,Ci.prototype=Object.create(je.prototype),Ci.prototype.constructor=Ci,e.WebGLUtils=Ii,e.PerspectiveCamera=zi,zi.prototype=Object.assign(Object.create(pn.prototype),{constructor:zi,isPerspectiveCamera:!0,copy:function(t,e){return pn.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*Re.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*Re.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*Re.RAD2DEG*Math.atan(Math.tan(.5*Re.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,a){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*Re.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/o,e-=a.offsetY*n/s,r*=a.width/o,n*=a.height/s}var c=this.filmOffset;0!==c&&(i+=t*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far)},toJSON:function(t){var e=dn.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),e.ArrayCamera=Ui,Ui.prototype=Object.assign(Object.create(zi.prototype),{constructor:Ui,isArrayCamera:!0}),e.WebGLRenderer=ki,e.FogExp2=Fi,Fi.prototype.isFogExp2=!0,Fi.prototype.clone=function(){return new Fi(this.color.getHex(),this.density)},Fi.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},e.Fog=Bi,Bi.prototype.isFog=!0,Bi.prototype.clone=function(){return new Bi(this.color.getHex(),this.near,this.far)},Bi.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},e.Scene=ji,ji.prototype=Object.assign(Object.create(dn.prototype),{constructor:ji,copy:function(t,e){return dn.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=dn.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}),e.SpriteMaterial=Hi,Hi.prototype=Object.create(Xn.prototype),Hi.prototype.constructor=Hi,Hi.prototype.isSpriteMaterial=!0,Hi.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},e.Sprite=Gi,Gi.prototype=Object.assign(Object.create(dn.prototype),{constructor:Gi,isSprite:!0,raycast:(mi=new Oe,vi=new Oe,gi=new Oe,function(t,e){vi.setFromMatrixPosition(this.matrixWorld),t.ray.closestPointToPoint(vi,mi),gi.setFromMatrixScale(this.matrixWorld);var n=gi.x*gi.y/4;if(!(vi.distanceToSquared(mi)>n)){var r=t.ray.origin.distanceTo(mi);r<t.near||r>t.far||e.push({distance:r,point:mi.clone(),face:null,object:this})}}),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return dn.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}}),e.LOD=Vi,Vi.prototype=Object.assign(Object.create(dn.prototype),{constructor:Vi,copy:function(t){dn.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,r=e.length;n<r;n++){var i=e[n];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,r=0;r<n.length&&!(e<n[r].distance);r++);n.splice(r,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object},raycast:(yi=new Oe,function(t,e){yi.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(yi);this.getObjectForDistance(n).raycast(t,e)}),update:function(){var t=new Oe,e=new Oe;return function(n){var r=this.levels;if(r.length>1){t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var i=t.distanceTo(e);r[0].object.visible=!0;for(var a=1,o=r.length;a<o&&i>=r[a].distance;a++)r[a-1].object.visible=!1,r[a].object.visible=!0;for(;a<o;a++)r[a].object.visible=!1}}}(),toJSON:function(t){var e=dn.prototype.toJSON.call(this,t);e.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var a=n[r];e.object.levels.push({object:a.object.uuid,distance:a.distance})}return e}}),e.Skeleton=Wi,Object.assign(Wi.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new Ce;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n;for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:(_i=new Ce,xi=new Ce,function(){for(var t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,a=t.length;i<a;i++){var o=t[i]?t[i].matrixWorld:xi;_i.multiplyMatrices(o,e[i]),_i.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)}),clone:function(){return new Wi(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,n=this.bones.length;e<n;e++){var r=this.bones[e];if(r.name===t)return r}}}),e.Bone=qi,qi.prototype=Object.assign(Object.create(dn.prototype),{constructor:qi,isBone:!0}),e.SkinnedMesh=Xi,Xi.prototype=Object.assign(Object.create($n.prototype),{constructor:Xi,isSkinnedMesh:!0,initBones:function(){var t,e,n,r,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(n=0,r=this.geometry.bones.length;n<r;n++)e=this.geometry.bones[n],t=new qi,i.push(t),t.name=e.name,t.position.fromArray(e.pos),t.quaternion.fromArray(e.rotq),void 0!==e.scl&&t.scale.fromArray(e.scl);for(n=0,r=this.geometry.bones.length;n<r;n++)-1!==(e=this.geometry.bones[n]).parent&&null!==e.parent&&void 0!==i[e.parent]?i[e.parent].add(i[n]):this.add(i[n])}return this.updateMatrixWorld(!0),i},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var t,e;if(this.geometry&&this.geometry.isGeometry)for(e=0;e<this.geometry.skinWeights.length;e++){var n=this.geometry.skinWeights[e];(t=1/n.manhattanLength())!==1/0?n.multiplyScalar(t):n.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var r=new He,i=this.geometry.attributes.skinWeight;for(e=0;e<i.count;e++)r.x=i.getX(e),r.y=i.getY(e),r.z=i.getZ(e),r.w=i.getW(e),(t=1/r.manhattanLength())!==1/0?r.multiplyScalar(t):r.set(1,0,0,0),i.setXYZW(e,r.x,r.y,r.z,r.w)}},updateMatrixWorld:function(t){$n.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),e.LineBasicMaterial=Yi,Yi.prototype=Object.create(Xn.prototype),Yi.prototype.constructor=Yi,Yi.prototype.isLineBasicMaterial=!0,Yi.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},e.Line=Zi,Zi.prototype=Object.assign(Object.create(dn.prototype),{constructor:Zi,isLine:!0,computeLineDistances:(bi=new Oe,wi=new Oe,function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,n=[0],r=1,i=e.count;r<i;r++)bi.fromBufferAttribute(e,r-1),wi.fromBufferAttribute(e,r),n[r]=n[r-1],n[r]+=bi.distanceTo(wi);t.addAttribute("lineDistance",new THREE.Float32BufferAttribute(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){var a=t.vertices;for((n=t.lineDistances)[0]=0,r=1,i=a.length;r<i;r++)n[r]=n[r-1],n[r]+=a[r-1].distanceTo(a[r])}return this}),raycast:function(){var t=new Ce,e=new Jn,n=new Xe;return function(r,i){var a=r.linePrecision,o=a*a,s=this.geometry,c=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),n.copy(s.boundingSphere),n.applyMatrix4(c),!1!==r.ray.intersectsSphere(n)){t.getInverse(c),e.copy(r.ray).applyMatrix4(t);var l=new Oe,u=new Oe,h=new Oe,f=new Oe,d=this&&this.isLineSegments?2:1;if(s.isBufferGeometry){var p=s.index,m=s.attributes.position.array;if(null!==p)for(var v=p.array,g=0,y=v.length-1;g<y;g+=d){var _=v[g],x=v[g+1];if(l.fromArray(m,3*_),u.fromArray(m,3*x),!(e.distanceSqToSegment(l,u,f,h)>o))f.applyMatrix4(this.matrixWorld),(M=r.ray.origin.distanceTo(f))<r.near||M>r.far||i.push({distance:M,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this})}else for(g=0,y=m.length/3-1;g<y;g+=d){if(l.fromArray(m,3*g),u.fromArray(m,3*g+3),!(e.distanceSqToSegment(l,u,f,h)>o))f.applyMatrix4(this.matrixWorld),(M=r.ray.origin.distanceTo(f))<r.near||M>r.far||i.push({distance:M,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this})}}else if(s.isGeometry){var b=s.vertices,w=b.length;for(g=0;g<w-1;g+=d){var M;if(!(e.distanceSqToSegment(b[g],b[g+1],f,h)>o))f.applyMatrix4(this.matrixWorld),(M=r.ray.origin.distanceTo(f))<r.near||M>r.far||i.push({distance:M,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),e.LineSegments=Ji,Ji.prototype=Object.assign(Object.create(Zi.prototype),{constructor:Ji,isLineSegments:!0,computeLineDistances:function(){var t=new Oe,e=new Oe;return function(){var n=this.geometry;if(n.isBufferGeometry)if(null===n.index){for(var r=n.attributes.position,i=[],a=0,o=r.count;a<o;a+=2)t.fromBufferAttribute(r,a),e.fromBufferAttribute(r,a+1),i[a]=0===a?0:i[a-1],i[a+1]=i[a]+t.distanceTo(e);n.addAttribute("lineDistance",new THREE.Float32BufferAttribute(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){var s=n.vertices;for(i=n.lineDistances,a=0,o=s.length;a<o;a+=2)t.copy(s[a]),e.copy(s[a+1]),i[a]=0===a?0:i[a-1],i[a+1]=i[a]+t.distanceTo(e)}return this}}()}),e.LineLoop=Qi,Qi.prototype=Object.assign(Object.create(Zi.prototype),{constructor:Qi,isLineLoop:!0}),e.PointsMaterial=Ki,Ki.prototype=Object.create(Xn.prototype),Ki.prototype.constructor=Ki,Ki.prototype.isPointsMaterial=!0,Ki.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},e.Points=$i,$i.prototype=Object.assign(Object.create(dn.prototype),{constructor:$i,isPoints:!0,raycast:function(){var t=new Ce,e=new Jn,n=new Xe;return function(r,i){var a=this,o=this.geometry,s=this.matrixWorld,c=r.params.Points.threshold;if(null===o.boundingSphere&&o.computeBoundingSphere(),n.copy(o.boundingSphere),n.applyMatrix4(s),n.radius+=c,!1!==r.ray.intersectsSphere(n)){t.getInverse(s),e.copy(r.ray).applyMatrix4(t);var l=c/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,h=new Oe,f=new Oe;if(o.isBufferGeometry){var d=o.index,p=o.attributes.position.array;if(null!==d)for(var m=d.array,v=0,g=m.length;v<g;v++){var y=m[v];h.fromArray(p,3*y),b(h,y)}else{v=0;for(var _=p.length/3;v<_;v++)h.fromArray(p,3*v),b(h,v)}}else{var x=o.vertices;for(v=0,_=x.length;v<_;v++)b(x[v],v)}}function b(t,n){var o=e.distanceSqToPoint(t);if(o<u){e.closestPointToPoint(t,f),f.applyMatrix4(s);var c=r.ray.origin.distanceTo(f);if(c<r.near||c>r.far)return;i.push({distance:c,distanceToRay:Math.sqrt(o),point:f.clone(),index:n,face:null,object:a})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),e.Group=ta,ta.prototype=Object.assign(Object.create(dn.prototype),{constructor:ta,isGroup:!0}),e.VideoTexture=ea,ea.prototype=Object.assign(Object.create(je.prototype),{constructor:ea,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),e.CompressedTexture=na,na.prototype=Object.create(je.prototype),na.prototype.constructor=na,na.prototype.isCompressedTexture=!0,e.DepthTexture=ra,ra.prototype=Object.create(je.prototype),ra.prototype.constructor=ra,ra.prototype.isDepthTexture=!0,e.WireframeGeometry=ia,ia.prototype=Object.create(In.prototype),ia.prototype.constructor=ia,e.ParametricGeometry=aa,aa.prototype=Object.create(xn.prototype),aa.prototype.constructor=aa,e.ParametricBufferGeometry=oa,oa.prototype=Object.create(In.prototype),oa.prototype.constructor=oa,e.PolyhedronGeometry=sa,sa.prototype=Object.create(xn.prototype),sa.prototype.constructor=sa,e.PolyhedronBufferGeometry=ca,ca.prototype=Object.create(In.prototype),ca.prototype.constructor=ca,e.TetrahedronGeometry=la,la.prototype=Object.create(xn.prototype),la.prototype.constructor=la,e.TetrahedronBufferGeometry=ua,ua.prototype=Object.create(ca.prototype),ua.prototype.constructor=ua,e.OctahedronGeometry=ha,ha.prototype=Object.create(xn.prototype),ha.prototype.constructor=ha,e.OctahedronBufferGeometry=fa,fa.prototype=Object.create(ca.prototype),fa.prototype.constructor=fa,e.IcosahedronGeometry=da,da.prototype=Object.create(xn.prototype),da.prototype.constructor=da,e.IcosahedronBufferGeometry=pa,pa.prototype=Object.create(ca.prototype),pa.prototype.constructor=pa,e.DodecahedronGeometry=ma,ma.prototype=Object.create(xn.prototype),ma.prototype.constructor=ma,e.DodecahedronBufferGeometry=va,va.prototype=Object.create(ca.prototype),va.prototype.constructor=va,e.TubeGeometry=ga,ga.prototype=Object.create(xn.prototype),ga.prototype.constructor=ga,e.TubeBufferGeometry=ya,ya.prototype=Object.create(In.prototype),ya.prototype.constructor=ya,e.TorusKnotGeometry=_a,_a.prototype=Object.create(xn.prototype),_a.prototype.constructor=_a,e.TorusKnotBufferGeometry=xa,xa.prototype=Object.create(In.prototype),xa.prototype.constructor=xa,e.TorusGeometry=ba,ba.prototype=Object.create(xn.prototype),ba.prototype.constructor=ba,e.TorusBufferGeometry=wa,wa.prototype=Object.create(In.prototype),wa.prototype.constructor=wa;var Ma=function(t,e,n){n=n||2;var r,i,a,o,s,c,l,u=e&&e.length,h=u?e[0]*n:t.length,f=Ea(t,0,h,n,!0),d=[];if(!f)return d;if(u&&(f=function(t,e,n,r){var i,a,o,s,c,l=[];for(i=0,a=e.length;i<a;i++)o=e[i]*r,s=i<a-1?e[i+1]*r:t.length,(c=Ea(t,o,s,r,!1))===c.next&&(c.steiner=!0),l.push(Ia(c));for(l.sort(Pa),i=0;i<l.length;i++)Oa(l[i],n),n=Ta(n,n.next);return n}(t,e,f,n)),t.length>80*n){r=a=t[0],i=o=t[1];for(var p=n;p<h;p+=n)(s=t[p])<r&&(r=s),(c=t[p+1])<i&&(i=c),s>a&&(a=s),c>o&&(o=c);l=0!==(l=Math.max(a-r,o-i))?1/l:0}return Sa(f,d,n,r,i,l),d};function Ea(t,e,n,r,i){var a,o;if(i===function(t,e,n,r){for(var i=0,a=e,o=n-r;a<n;a+=r)i+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return i}(t,e,n,r)>0)for(a=e;a<n;a+=r)o=Ha(a,t[a],t[a+1],o);else for(a=n-r;a>=e;a-=r)o=Ha(a,t[a],t[a+1],o);return o&&ka(o,o.next)&&(Ga(o),o=o.next),o}function Ta(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!ka(r,r.next)&&0!==Da(r.prev,r,r.next))r=r.next;else{if(Ga(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function Sa(t,e,n,r,i,a,o){if(t){!o&&a&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=Na(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,a,o,s,c,l=1;do{for(n=t,t=null,a=null,o=0;n;){for(o++,r=n,s=0,e=0;e<l&&(s++,r=r.nextZ);e++);for(c=l;s>0||c>0&&r;)0!==s&&(0===c||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,c--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;n=r}a.nextZ=null,l*=2}while(o>1)}(i)}(t,r,i,a);for(var s,c,l=t;t.prev!==t.next;)if(s=t.prev,c=t.next,a?Ra(t,r,i,a):Aa(t))e.push(s.i/n),e.push(t.i/n),e.push(c.i/n),Ga(t),t=c.next,l=c.next;else if((t=c)===l){o?1===o?Sa(t=La(t,e,n),e,n,r,i,a,2):2===o&&Ca(t,e,n,r,i,a):Sa(Ta(t),e,n,r,i,a,1);break}}}function Aa(t){var e=t.prev,n=t,r=t.next;if(Da(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(za(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Da(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Ra(t,e,n,r){var i=t.prev,a=t,o=t.next;if(Da(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,c=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,l=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,u=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,h=Na(s,c,e,n,r),f=Na(l,u,e,n,r),d=t.nextZ;d&&d.z<=f;){if(d!==t.prev&&d!==t.next&&za(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&Da(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=t.prevZ;d&&d.z>=h;){if(d!==t.prev&&d!==t.next&&za(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&Da(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}function La(t,e,n){var r=t;do{var i=r.prev,a=r.next.next;!ka(i,a)&&Fa(i,r,r.next,a)&&Ba(i,a)&&Ba(a,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(a.i/n),Ga(r),Ga(r.next),r=t=a),r=r.next}while(r!==t);return r}function Ca(t,e,n,r,i,a){var o=t;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Ua(o,s)){var c=ja(o,s);return o=Ta(o,o.next),c=Ta(c,c.next),Sa(o,e,n,r,i,a),void Sa(c,e,n,r,i,a)}s=s.next}o=o.next}while(o!==t)}function Pa(t,e){return t.x-e.x}function Oa(t,e){if(e=function(t,e){var n,r=e,i=t.x,a=t.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>o){if(o=s,s===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===o)return n.prev;var c,l=n,u=n.x,h=n.y,f=1/0;r=n.next;for(;r!==l;)i>=r.x&&r.x>=u&&i!==r.x&&za(a<h?i:o,a,u,h,a<h?o:i,a,r.x,r.y)&&((c=Math.abs(a-r.y)/(i-r.x))<f||c===f&&r.x>n.x)&&Ba(r,t)&&(n=r,f=c),r=r.next;return n}(t,e)){var n=ja(e,t);Ta(n,n.next)}}function Na(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ia(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function za(t,e,n,r,i,a,o,s){return(i-o)*(e-s)-(t-o)*(a-s)>=0&&(t-o)*(r-s)-(n-o)*(e-s)>=0&&(n-o)*(a-s)-(i-o)*(r-s)>=0}function Ua(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Fa(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&Ba(t,e)&&Ba(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function Da(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function ka(t,e){return t.x===e.x&&t.y===e.y}function Fa(t,e,n,r){return!!(ka(t,e)&&ka(n,r)||ka(t,r)&&ka(n,e))||Da(t,e,n)>0!=Da(t,e,r)>0&&Da(n,r,t)>0!=Da(n,r,e)>0}function Ba(t,e){return Da(t.prev,t,t.next)<0?Da(t,e,t.next)>=0&&Da(t,t.prev,e)>=0:Da(t,e,t.prev)<0||Da(t,t.next,e)<0}function ja(t,e){var n=new Va(t.i,t.x,t.y),r=new Va(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function Ha(t,e,n,r){var i=new Va(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Ga(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Va(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Wa={area:function(t){for(var e=t.length,n=0,r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},isClockWise:function(t){return Wa.area(t)<0},triangulateShape:function(t,e){var n=[],r=[],i=[];qa(t),Xa(n,t);var a=t.length;e.forEach(qa);for(var o=0;o<e.length;o++)r.push(a),a+=e[o].length,Xa(n,e[o]);var s=Ma(n,r);for(o=0;o<s.length;o+=3)i.push(s.slice(o,o+3));return i}};function qa(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Xa(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function Ya(t,e){xn.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Za(t,e)),this.mergeVertices()}function Za(t,e){void 0!==t&&(In.call(this),this.type="ExtrudeBufferGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeVertexNormals())}function Ja(t,e){xn.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Qa(t,e)),this.mergeVertices()}function Qa(t,e){var n=(e=e||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new xn;var r=n.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Za.call(this,r,e),this.type="TextBufferGeometry"}function Ka(t,e,n,r,i,a,o){xn.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new $a(t,e,n,r,i,a,o)),this.mergeVertices()}function $a(t,e,n,r,i,a,o){In.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI;var s,c,l=(a=void 0!==a?a:0)+(o=void 0!==o?o:Math.PI),u=0,h=[],f=new Oe,d=new Oe,p=[],m=[],v=[],g=[];for(c=0;c<=n;c++){var y=[],_=c/n;for(s=0;s<=e;s++){var x=s/e;f.x=-t*Math.cos(r+x*i)*Math.sin(a+_*o),f.y=t*Math.cos(a+_*o),f.z=t*Math.sin(r+x*i)*Math.sin(a+_*o),m.push(f.x,f.y,f.z),d.set(f.x,f.y,f.z).normalize(),v.push(d.x,d.y,d.z),g.push(x,1-_),y.push(u++)}h.push(y)}for(c=0;c<n;c++)for(s=0;s<e;s++){var b=h[c][s+1],w=h[c][s],M=h[c+1][s],E=h[c+1][s+1];(0!==c||a>0)&&p.push(b,w,E),(c!==n-1||l<Math.PI)&&p.push(w,M,E)}this.setIndex(p),this.addAttribute("position",new Ln(m,3)),this.addAttribute("normal",new Ln(v,3)),this.addAttribute("uv",new Ln(g,2))}function to(t,e,n,r,i,a){xn.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},this.fromBufferGeometry(new eo(t,e,n,r,i,a)),this.mergeVertices()}function eo(t,e,n,r,i,a){In.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},t=t||.5,e=e||1,i=void 0!==i?i:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var o,s,c,l=[],u=[],h=[],f=[],d=t,p=(e-t)/(r=void 0!==r?Math.max(1,r):1),m=new Oe,v=new Le;for(s=0;s<=r;s++){for(c=0;c<=n;c++)o=i+c/n*a,m.x=d*Math.cos(o),m.y=d*Math.sin(o),u.push(m.x,m.y,m.z),h.push(0,0,1),v.x=(m.x/e+1)/2,v.y=(m.y/e+1)/2,f.push(v.x,v.y);d+=p}for(s=0;s<r;s++){var g=s*(n+1);for(c=0;c<n;c++){var y=o=c+g,_=o+n+1,x=o+n+2,b=o+1;l.push(y,_,b),l.push(_,x,b)}}this.setIndex(l),this.addAttribute("position",new Ln(u,3)),this.addAttribute("normal",new Ln(h,3)),this.addAttribute("uv",new Ln(f,2))}function no(t,e,n,r){xn.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new ro(t,e,n,r)),this.mergeVertices()}function ro(t,e,n,r){In.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=Re.clamp(r,0,2*Math.PI);var i,a,o,s=[],c=[],l=[],u=1/e,h=new Oe,f=new Le;for(a=0;a<=e;a++){var d=n+a*u*r,p=Math.sin(d),m=Math.cos(d);for(o=0;o<=t.length-1;o++)h.x=t[o].x*p,h.y=t[o].y,h.z=t[o].x*m,c.push(h.x,h.y,h.z),f.x=a/e,f.y=o/(t.length-1),l.push(f.x,f.y)}for(a=0;a<e;a++)for(o=0;o<t.length-1;o++){var v=i=o+a*t.length,g=i+t.length,y=i+t.length+1,_=i+1;s.push(v,g,_),s.push(g,y,_)}if(this.setIndex(s),this.addAttribute("position",new Ln(c,3)),this.addAttribute("uv",new Ln(l,2)),this.computeVertexNormals(),r===2*Math.PI){var x=this.attributes.normal.array,b=new Oe,w=new Oe,M=new Oe;for(i=e*t.length*3,a=0,o=0;a<t.length;a++,o+=3)b.x=x[o+0],b.y=x[o+1],b.z=x[o+2],w.x=x[i+o+0],w.y=x[i+o+1],w.z=x[i+o+2],M.addVectors(b,w).normalize(),x[o+0]=x[i+o+0]=M.x,x[o+1]=x[i+o+1]=M.y,x[o+2]=x[i+o+2]=M.z}}function io(t,e){xn.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new ao(t,e)),this.mergeVertices()}function ao(t,e){In.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var n=[],r=[],i=[],a=[],o=0,s=0;if(!1===Array.isArray(t))l(t);else for(var c=0;c<t.length;c++)l(t[c]),this.addGroup(o,s,c),o+=s,s=0;function l(t){var o,c,l,u=r.length/3,h=t.extractPoints(e),f=h.shape,d=h.holes;if(!1===Wa.isClockWise(f))for(f=f.reverse(),o=0,c=d.length;o<c;o++)l=d[o],!0===Wa.isClockWise(l)&&(d[o]=l.reverse());var p=Wa.triangulateShape(f,d);for(o=0,c=d.length;o<c;o++)l=d[o],f=f.concat(l);for(o=0,c=f.length;o<c;o++){var m=f[o];r.push(m.x,m.y,0),i.push(0,0,1),a.push(m.x,m.y)}for(o=0,c=p.length;o<c;o++){var v=p[o],g=v[0]+u,y=v[1]+u,_=v[2]+u;n.push(g,y,_),s+=3}}this.setIndex(n),this.addAttribute("position",new Ln(r,3)),this.addAttribute("normal",new Ln(i,3)),this.addAttribute("uv",new Ln(a,2))}function oo(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}function so(t,e){In.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var n,r,i,a,o=[],s=Math.cos(Re.DEG2RAD*e),c=[0,0],l={},u=["a","b","c"];t.isBufferGeometry?(a=new xn).fromBufferGeometry(t):a=t.clone(),a.mergeVertices(),a.computeFaceNormals();for(var h=a.vertices,f=a.faces,d=0,p=f.length;d<p;d++)for(var m=f[d],v=0;v<3;v++)n=m[u[v]],r=m[u[(v+1)%3]],c[0]=Math.min(n,r),c[1]=Math.max(n,r),void 0===l[i=c[0]+","+c[1]]?l[i]={index1:c[0],index2:c[1],face1:d,face2:void 0}:l[i].face2=d;for(i in l){var g=l[i];if(void 0===g.face2||f[g.face1].normal.dot(f[g.face2].normal)<=s){var y=h[g.index1];o.push(y.x,y.y,y.z),y=h[g.index2],o.push(y.x,y.y,y.z)}}this.addAttribute("position",new Ln(o,3))}function co(t,e,n,r,i,a,o,s){xn.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new lo(t,e,n,r,i,a,o,s)),this.mergeVertices()}function lo(t,e,n,r,i,a,o,s){In.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s};var c=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI;var l=[],u=[],h=[],f=[],d=0,p=[],m=n/2,v=0;function g(n){var i,a,p,g=new Le,y=new Oe,_=0,x=!0===n?t:e,b=!0===n?1:-1;for(a=d,i=1;i<=r;i++)u.push(0,m*b,0),h.push(0,b,0),f.push(.5,.5),d++;for(p=d,i=0;i<=r;i++){var w=i/r*s+o,M=Math.cos(w),E=Math.sin(w);y.x=x*E,y.y=m*b,y.z=x*M,u.push(y.x,y.y,y.z),h.push(0,b,0),g.x=.5*M+.5,g.y=.5*E*b+.5,f.push(g.x,g.y),d++}for(i=0;i<r;i++){var T=a+i,S=p+i;!0===n?l.push(S,S+1,T):l.push(S+1,S,T),_+=3}c.addGroup(v,_,!0===n?1:2),v+=_}!function(){var a,g,y=new Oe,_=new Oe,x=0,b=(e-t)/n;for(g=0;g<=i;g++){var w=[],M=g/i,E=M*(e-t)+t;for(a=0;a<=r;a++){var T=a/r,S=T*s+o,A=Math.sin(S),R=Math.cos(S);_.x=E*A,_.y=-M*n+m,_.z=E*R,u.push(_.x,_.y,_.z),y.set(A,b,R).normalize(),h.push(y.x,y.y,y.z),f.push(T,1-M),w.push(d++)}p.push(w)}for(a=0;a<r;a++)for(g=0;g<i;g++){var L=p[g][a],C=p[g+1][a],P=p[g+1][a+1],O=p[g][a+1];l.push(L,C,O),l.push(C,P,O),x+=6}c.addGroup(v,x,0),v+=x}(),!1===a&&(t>0&&g(!0),e>0&&g(!1)),this.setIndex(l),this.addAttribute("position",new Ln(u,3)),this.addAttribute("normal",new Ln(h,3)),this.addAttribute("uv",new Ln(f,2))}function uo(t,e,n,r,i,a,o){co.call(this,0,t,e,n,r,i,a,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function ho(t,e,n,r,i,a,o){lo.call(this,0,t,e,n,r,i,a,o),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function fo(t,e,n,r){xn.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new po(t,e,n,r)),this.mergeVertices()}function po(t,e,n,r){In.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,a,o=[],s=[],c=[],l=[],u=new Oe,h=new Le;for(s.push(0,0,0),c.push(0,0,1),l.push(.5,.5),a=0,i=3;a<=e;a++,i+=3){var f=n+a/e*r;u.x=t*Math.cos(f),u.y=t*Math.sin(f),s.push(u.x,u.y,u.z),c.push(0,0,1),h.x=(s[i]/t+1)/2,h.y=(s[i+1]/t+1)/2,l.push(h.x,h.y)}for(i=1;i<=e;i++)o.push(i,i+1,0);this.setIndex(o),this.addAttribute("position",new Ln(s,3)),this.addAttribute("normal",new Ln(c,3)),this.addAttribute("uv",new Ln(l,2))}e.ShapeUtils=Wa,e.ExtrudeGeometry=Ya,Ya.prototype=Object.create(xn.prototype),Ya.prototype.constructor=Ya,e.ExtrudeBufferGeometry=Za,Za.prototype=Object.create(In.prototype),Za.prototype.constructor=Za,Za.prototype.getArrays=function(){var t=this.getAttribute("position"),e=t?Array.prototype.slice.call(t.array):[],n=this.getAttribute("uv"),r=n?Array.prototype.slice.call(n.array):[],i=this.index;return{position:e,uv:r,index:i?Array.prototype.slice.call(i.array):[]}},Za.prototype.addShapeList=function(t,e){var n=t.length;e.arrays=this.getArrays();for(var r=0;r<n;r++){var i=t[r];this.addShape(i,e)}this.setIndex(e.arrays.index),this.addAttribute("position",new Ln(e.arrays.position,3)),this.addAttribute("uv",new Ln(e.arrays.uv,2))},Za.prototype.addShape=function(t,e){var n,r,i,a,o,s,c,l,u=e.arrays?e.arrays:this.getArrays(),h=u.position,f=u.index,d=u.uv,p=[],m=void 0!==e.amount?e.amount:100,v=void 0!==e.bevelThickness?e.bevelThickness:6,g=void 0!==e.bevelSize?e.bevelSize:v-2,y=void 0!==e.bevelSegments?e.bevelSegments:3,_=void 0===e.bevelEnabled||e.bevelEnabled,x=void 0!==e.curveSegments?e.curveSegments:12,b=void 0!==e.steps?e.steps:1,w=e.extrudePath,M=!1,E=void 0!==e.UVGenerator?e.UVGenerator:Ya.WorldUVGenerator;w&&(n=w.getSpacedPoints(b),M=!0,_=!1,r=void 0!==e.frames?e.frames:w.computeFrenetFrames(b,!1),i=new Oe,a=new Oe,o=new Oe),_||(y=0,v=0,g=0);var T=this,S=t.extractPoints(x),A=S.shape,R=S.holes;if(!Wa.isClockWise(A))for(A=A.reverse(),c=0,l=R.length;c<l;c++)s=R[c],Wa.isClockWise(s)&&(R[c]=s.reverse());var L=Wa.triangulateShape(A,R),C=A;for(c=0,l=R.length;c<l;c++)s=R[c],A=A.concat(s);function P(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}var O,N,I,z,U,D,k=A.length,F=L.length;function B(t,e,n){var r,i,a,o=t.x-e.x,s=t.y-e.y,c=n.x-t.x,l=n.y-t.y,u=o*o+s*s,h=o*l-s*c;if(Math.abs(h)>Number.EPSILON){var f=Math.sqrt(u),d=Math.sqrt(c*c+l*l),p=e.x-s/f,m=e.y+o/f,v=((n.x-l/d-p)*l-(n.y+c/d-m)*c)/(o*l-s*c),g=(r=p+o*v-t.x)*r+(i=m+s*v-t.y)*i;if(g<=2)return new Le(r,i);a=Math.sqrt(g/2)}else{var y=!1;o>Number.EPSILON?c>Number.EPSILON&&(y=!0):o<-Number.EPSILON?c<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(l)&&(y=!0),y?(r=-s,i=o,a=Math.sqrt(u)):(r=o,i=s,a=Math.sqrt(u/2))}return new Le(r/a,i/a)}for(var j=[],H=0,G=C.length,V=G-1,W=H+1;H<G;H++,V++,W++)V===G&&(V=0),W===G&&(W=0),j[H]=B(C[H],C[V],C[W]);var q,X,Y=[],Z=j.concat();for(c=0,l=R.length;c<l;c++){for(s=R[c],q=[],H=0,V=(G=s.length)-1,W=H+1;H<G;H++,V++,W++)V===G&&(V=0),W===G&&(W=0),q[H]=B(s[H],s[V],s[W]);Y.push(q),Z=Z.concat(q)}for(O=0;O<y;O++){for(I=O/y,z=v*Math.cos(I*Math.PI/2),N=g*Math.sin(I*Math.PI/2),H=0,G=C.length;H<G;H++)Q((U=P(C[H],j[H],N)).x,U.y,-z);for(c=0,l=R.length;c<l;c++)for(s=R[c],q=Y[c],H=0,G=s.length;H<G;H++)Q((U=P(s[H],q[H],N)).x,U.y,-z)}for(N=g,H=0;H<k;H++)U=_?P(A[H],Z[H],N):A[H],M?(a.copy(r.normals[0]).multiplyScalar(U.x),i.copy(r.binormals[0]).multiplyScalar(U.y),o.copy(n[0]).add(a).add(i),Q(o.x,o.y,o.z)):Q(U.x,U.y,0);for(X=1;X<=b;X++)for(H=0;H<k;H++)U=_?P(A[H],Z[H],N):A[H],M?(a.copy(r.normals[X]).multiplyScalar(U.x),i.copy(r.binormals[X]).multiplyScalar(U.y),o.copy(n[X]).add(a).add(i),Q(o.x,o.y,o.z)):Q(U.x,U.y,m/b*X);for(O=y-1;O>=0;O--){for(I=O/y,z=v*Math.cos(I*Math.PI/2),N=g*Math.sin(I*Math.PI/2),H=0,G=C.length;H<G;H++)Q((U=P(C[H],j[H],N)).x,U.y,m+z);for(c=0,l=R.length;c<l;c++)for(s=R[c],q=Y[c],H=0,G=s.length;H<G;H++)U=P(s[H],q[H],N),M?Q(U.x,U.y+n[b-1].y,n[b-1].x+z):Q(U.x,U.y,m+z)}function J(t,e){var n,r;for(H=t.length;--H>=0;){n=H,(r=H-1)<0&&(r=t.length-1);var i=0,a=b+2*y;for(i=0;i<a;i++){var o=k*i,s=k*(i+1);$(e+n+o,e+r+o,e+r+s,e+n+s)}}}function Q(t,e,n){p.push(t),p.push(e),p.push(n)}function K(t,e,n){tt(t),tt(e),tt(n);var r=h.length/3,i=E.generateTopUV(T,h,r-3,r-2,r-1);et(i[0]),et(i[1]),et(i[2])}function $(t,e,n,r){tt(t),tt(e),tt(r),tt(e),tt(n),tt(r);var i=h.length/3,a=E.generateSideWallUV(T,h,i-6,i-3,i-2,i-1);et(a[0]),et(a[1]),et(a[3]),et(a[1]),et(a[2]),et(a[3])}function tt(t){f.push(h.length/3),h.push(p[3*t+0]),h.push(p[3*t+1]),h.push(p[3*t+2])}function et(t){d.push(t.x),d.push(t.y)}!function(){var t=h.length/3;if(_){var e=0,n=k*e;for(H=0;H<F;H++)K((D=L[H])[2]+n,D[1]+n,D[0]+n);for(n=k*(e=b+2*y),H=0;H<F;H++)K((D=L[H])[0]+n,D[1]+n,D[2]+n)}else{for(H=0;H<F;H++)K((D=L[H])[2],D[1],D[0]);for(H=0;H<F;H++)K((D=L[H])[0]+k*b,D[1]+k*b,D[2]+k*b)}T.addGroup(t,h.length/3-t,0)}(),function(){var t=h.length/3,e=0;for(J(C,e),e+=C.length,c=0,l=R.length;c<l;c++)J(s=R[c],e),e+=s.length;T.addGroup(t,h.length/3-t,1)}(),e.arrays||(this.setIndex(f),this.addAttribute("position",new Ln(h,3)),this.addAttribute("uv",new Ln(d,2)))},Ya.WorldUVGenerator={generateTopUV:function(t,e,n,r,i){var a=e[3*n],o=e[3*n+1],s=e[3*r],c=e[3*r+1],l=e[3*i],u=e[3*i+1];return[new Le(a,o),new Le(s,c),new Le(l,u)]},generateSideWallUV:function(t,e,n,r,i,a){var o=e[3*n],s=e[3*n+1],c=e[3*n+2],l=e[3*r],u=e[3*r+1],h=e[3*r+2],f=e[3*i],d=e[3*i+1],p=e[3*i+2],m=e[3*a],v=e[3*a+1],g=e[3*a+2];return Math.abs(s-u)<.01?[new Le(o,1-c),new Le(l,1-h),new Le(f,1-p),new Le(m,1-g)]:[new Le(s,1-c),new Le(u,1-h),new Le(d,1-p),new Le(v,1-g)]}},e.TextGeometry=Ja,Ja.prototype=Object.create(xn.prototype),Ja.prototype.constructor=Ja,e.TextBufferGeometry=Qa,Qa.prototype=Object.create(Za.prototype),Qa.prototype.constructor=Qa,e.SphereGeometry=Ka,Ka.prototype=Object.create(xn.prototype),Ka.prototype.constructor=Ka,e.SphereBufferGeometry=$a,$a.prototype=Object.create(In.prototype),$a.prototype.constructor=$a,e.RingGeometry=to,to.prototype=Object.create(xn.prototype),to.prototype.constructor=to,e.RingBufferGeometry=eo,eo.prototype=Object.create(In.prototype),eo.prototype.constructor=eo,e.LatheGeometry=no,no.prototype=Object.create(xn.prototype),no.prototype.constructor=no,e.LatheBufferGeometry=ro,ro.prototype=Object.create(In.prototype),ro.prototype.constructor=ro,e.ShapeGeometry=io,io.prototype=Object.create(xn.prototype),io.prototype.constructor=io,io.prototype.toJSON=function(){var t=xn.prototype.toJSON.call(this);return oo(this.parameters.shapes,t)},e.ShapeBufferGeometry=ao,ao.prototype=Object.create(In.prototype),ao.prototype.constructor=ao,ao.prototype.toJSON=function(){var t=In.prototype.toJSON.call(this);return oo(this.parameters.shapes,t)},e.EdgesGeometry=so,so.prototype=Object.create(In.prototype),so.prototype.constructor=so,e.CylinderGeometry=co,co.prototype=Object.create(xn.prototype),co.prototype.constructor=co,e.CylinderBufferGeometry=lo,lo.prototype=Object.create(In.prototype),lo.prototype.constructor=lo,e.ConeGeometry=uo,uo.prototype=Object.create(co.prototype),uo.prototype.constructor=uo,e.ConeBufferGeometry=ho,ho.prototype=Object.create(lo.prototype),ho.prototype.constructor=ho,e.CircleGeometry=fo,fo.prototype=Object.create(xn.prototype),fo.prototype.constructor=fo,e.CircleBufferGeometry=po,po.prototype=Object.create(In.prototype),po.prototype.constructor=po;var mo=Object.freeze({WireframeGeometry:ia,ParametricGeometry:aa,ParametricBufferGeometry:oa,TetrahedronGeometry:la,TetrahedronBufferGeometry:ua,OctahedronGeometry:ha,OctahedronBufferGeometry:fa,IcosahedronGeometry:da,IcosahedronBufferGeometry:pa,DodecahedronGeometry:ma,DodecahedronBufferGeometry:va,PolyhedronGeometry:sa,PolyhedronBufferGeometry:ca,TubeGeometry:ga,TubeBufferGeometry:ya,TorusKnotGeometry:_a,TorusKnotBufferGeometry:xa,TorusGeometry:ba,TorusBufferGeometry:wa,TextGeometry:Ja,TextBufferGeometry:Qa,SphereGeometry:Ka,SphereBufferGeometry:$a,RingGeometry:to,RingBufferGeometry:eo,PlaneGeometry:Dn,PlaneBufferGeometry:kn,LatheGeometry:no,LatheBufferGeometry:ro,ShapeGeometry:io,ShapeBufferGeometry:ao,ExtrudeGeometry:Ya,ExtrudeBufferGeometry:Za,EdgesGeometry:so,ConeGeometry:uo,ConeBufferGeometry:ho,CylinderGeometry:co,CylinderBufferGeometry:lo,CircleGeometry:fo,CircleBufferGeometry:po,BoxGeometry:zn,BoxBufferGeometry:Un});function vo(t){Xn.call(this),this.type="ShadowMaterial",this.color=new tn(0),this.transparent=!0,this.setValues(t)}function go(t){Zn.call(this,t),this.type="RawShaderMaterial"}function yo(t){Xn.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new tn(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Le(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function _o(t){yo.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function xo(t){Xn.call(this),this.type="MeshPhongMaterial",this.color=new tn(16777215),this.specular=new tn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Le(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=q,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function bo(t){xo.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function wo(t){Xn.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Le(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Mo(t){Xn.call(this),this.type="MeshLambertMaterial",this.color=new tn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=q,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Eo(t){Yi.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}e.ShadowMaterial=vo,vo.prototype=Object.create(Xn.prototype),vo.prototype.constructor=vo,vo.prototype.isShadowMaterial=!0,vo.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.color.copy(t.color),this},e.RawShaderMaterial=go,go.prototype=Object.create(Zn.prototype),go.prototype.constructor=go,go.prototype.isRawShaderMaterial=!0,e.MeshStandardMaterial=yo,yo.prototype=Object.create(Xn.prototype),yo.prototype.constructor=yo,yo.prototype.isMeshStandardMaterial=!0,yo.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},e.MeshPhysicalMaterial=_o,_o.prototype=Object.create(yo.prototype),_o.prototype.constructor=_o,_o.prototype.isMeshPhysicalMaterial=!0,_o.prototype.copy=function(t){return yo.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},e.MeshPhongMaterial=xo,xo.prototype=Object.create(Xn.prototype),xo.prototype.constructor=xo,xo.prototype.isMeshPhongMaterial=!0,xo.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},e.MeshToonMaterial=bo,bo.prototype=Object.create(xo.prototype),bo.prototype.constructor=bo,bo.prototype.isMeshToonMaterial=!0,bo.prototype.copy=function(t){return xo.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},e.MeshNormalMaterial=wo,wo.prototype=Object.create(Xn.prototype),wo.prototype.constructor=wo,wo.prototype.isMeshNormalMaterial=!0,wo.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},e.MeshLambertMaterial=Mo,Mo.prototype=Object.create(Xn.prototype),Mo.prototype.constructor=Mo,Mo.prototype.isMeshLambertMaterial=!0,Mo.prototype.copy=function(t){return Xn.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},e.LineDashedMaterial=Eo,Eo.prototype=Object.create(Yi.prototype),Eo.prototype.constructor=Eo,Eo.prototype.isLineDashedMaterial=!0,Eo.prototype.copy=function(t){return Yi.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var To=Object.freeze({ShadowMaterial:vo,SpriteMaterial:Hi,RawShaderMaterial:go,ShaderMaterial:Zn,PointsMaterial:Ki,MeshPhysicalMaterial:_o,MeshStandardMaterial:yo,MeshPhongMaterial:xo,MeshToonMaterial:bo,MeshNormalMaterial:wo,MeshLambertMaterial:Mo,MeshDepthMaterial:Ai,MeshDistanceMaterial:Ri,MeshBasicMaterial:Yn,LineDashedMaterial:Eo,LineBasicMaterial:Yi,Material:Xn}),So={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function Ao(t,e,n){var r=this,i=!1,a=0,o=0,s=void 0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){o++,!1===i&&void 0!==r.onStart&&r.onStart(t,a,o),i=!0},this.itemEnd=function(t){a++,void 0!==r.onProgress&&r.onProgress(t,a,o),a===o&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this}}e.Cache=So,e.LoadingManager=Ao;var Ro=new Ao;e.DefaultLoadingManager=Ro;var Lo={};function Co(t){this.manager=void 0!==t?t:Ro}function Po(t){this.manager=void 0!==t?t:Ro,this._parser=null}function Oo(t){this.manager=void 0!==t?t:Ro,this._parser=null}function No(t){this.manager=void 0!==t?t:Ro}function Io(t){this.manager=void 0!==t?t:Ro}function zo(t){this.manager=void 0!==t?t:Ro}function Uo(){this.type="Curve",this.arcLengthDivisions=200}function Do(t,e,n,r,i,a,o,s){Uo.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function ko(t,e,n,r,i,a){Do.call(this,t,e,n,n,r,i,a),this.type="ArcCurve"}function Fo(){var t=0,e=0,n=0,r=0;function i(i,a,o,s){t=i,e=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(t,e,n,r,a){i(e,n,a*(n-t),a*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,a,o,s){var c=(e-t)/a-(n-t)/(a+o)+(n-e)/o,l=(n-e)/o-(r-e)/(o+s)+(r-n)/s;i(e,n,c*=o,l*=o)},calc:function(i){var a=i*i;return t+e*i+n*a+r*(a*i)}}}e.FileLoader=Co,Object.assign(Co.prototype,{load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,a=So.get(t);if(void 0!==a)return i.manager.itemStart(t),setTimeout(function(){e&&e(a),i.manager.itemEnd(t)},0),a;if(void 0===Lo[t]){var o=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){var s=o[1],c=!!o[2],l=o[3];l=window.decodeURIComponent(l),c&&(l=window.atob(l));try{var u,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var f=new Uint8Array(l.length),d=0;d<l.length;d++)f[d]=l.charCodeAt(d);u="blob"===h?new Blob([f.buffer],{type:s}):f.buffer;break;case"document":var p=new DOMParser;u=p.parseFromString(l,s);break;case"json":u=JSON.parse(l);break;default:u=l}window.setTimeout(function(){e&&e(u),i.manager.itemEnd(t)},0)}catch(e){window.setTimeout(function(){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)},0)}}else{Lo[t]=[],Lo[t].push({onLoad:e,onProgress:n,onError:r});var m=new XMLHttpRequest;for(var v in m.open("GET",t,!0),m.addEventListener("load",function(e){var n=this.response;So.add(t,n);var r=Lo[t];if(delete Lo[t],200===this.status){for(var a=0,o=r.length;a<o;a++){(s=r[a]).onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else if(0===this.status){console.warn("THREE.FileLoader: HTTP Status 0 received.");for(a=0,o=r.length;a<o;a++){(s=r[a]).onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else{for(a=0,o=r.length;a<o;a++){var s;(s=r[a]).onError&&s.onError(e)}i.manager.itemEnd(t),i.manager.itemError(t)}},!1),m.addEventListener("progress",function(e){for(var n=Lo[t],r=0,i=n.length;r<i;r++){var a=n[r];a.onProgress&&a.onProgress(e)}},!1),m.addEventListener("error",function(e){var n=Lo[t];delete Lo[t];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(e)}i.manager.itemEnd(t),i.manager.itemError(t)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(v,this.requestHeader[v]);m.send(null)}return i.manager.itemStart(t),m}Lo[t].push({onLoad:e,onProgress:n,onError:r})},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),e.CompressedTextureLoader=Po,Object.assign(Po.prototype,{load:function(t,e,n,r){var i=this,a=[],o=new na;o.image=a;var s=new Co(this.manager);function c(c){s.load(t[c],function(t){var n=i._parser(t,!0);a[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(l+=1)&&(1===n.mipmapCount&&(o.minFilter=dt),o.format=n.format,o.needsUpdate=!0,e&&e(o))},n,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(t))for(var l=0,u=0,h=t.length;u<h;++u)c(u);else s.load(t,function(t){var n=i._parser(t,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){a[s]={mipmaps:[]};for(var c=0;c<n.mipmapCount;c++)a[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+c]),a[s].format=n.format,a[s].width=n.width,a[s].height=n.height}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=dt),o.format=n.format,o.needsUpdate=!0,e&&e(o)},n,r);return o},setPath:function(t){return this.path=t,this}}),e.DataTextureLoader=Oo,Object.assign(Oo.prototype,{load:function(t,e,n,r){var i=this,a=new We,o=new Co(this.manager);return o.setResponseType("arraybuffer"),o.load(t,function(t){var n=i._parser(t);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:ct,a.wrapT=void 0!==n.wrapT?n.wrapT:ct,a.magFilter=void 0!==n.magFilter?n.magFilter:dt,a.minFilter=void 0!==n.minFilter?n.minFilter:mt,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps),1===n.mipmapCount&&(a.minFilter=dt),a.needsUpdate=!0,e&&e(a,n))},n,r),a}}),e.ImageLoader=No,Object.assign(No.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,a=So.get(t);if(void 0!==a)return i.manager.itemStart(t),setTimeout(function(){e&&e(a),i.manager.itemEnd(t)},0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");return o.addEventListener("load",function(){So.add(t,this),e&&e(this),i.manager.itemEnd(t)},!1),o.addEventListener("error",function(e){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)},!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(t),o.src=t,o},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),e.CubeTextureLoader=Io,Object.assign(Io.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){var i=new hr,a=new No(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(n){a.load(t[n],function(t){i.images[n]=t,6===++o&&(i.needsUpdate=!0,e&&e(i))},void 0,r)}for(var c=0;c<t.length;++c)s(c);return i},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),e.TextureLoader=zo,Object.assign(zo.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){var i=new je,a=new No(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(t,function(n){i.image=n;var r=t.search(/\.(jpg|jpeg)$/)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?Lt:Ct,i.needsUpdate=!0,void 0!==e&&e(i)},n,r),i},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),e.Curve=Uo,Object.assign(Uo.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,r=[],i=this.getPoint(0),a=0;for(r.push(0),n=1;n<=t;n++)a+=(e=this.getPoint(n/t)).distanceTo(i),r.push(a),i=e;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,r=this.getLengths(),i=0,a=r.length;n=e||t*r[a-1];for(var o,s=0,c=a-1;s<=c;)if((o=r[i=Math.floor(s+(c-s)/2)]-n)<0)s=i+1;else{if(!(o>0)){c=i;break}c=i-1}if(r[i=c]===n)return i/(a-1);var l=r[i];return(i+(n-l)/(r[i+1]-l))/(a-1)},getTangent:function(t){var e=t-1e-4,n=t+1e-4;e<0&&(e=0),n>1&&(n=1);var r=this.getPoint(e);return this.getPoint(n).clone().sub(r).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var n,r,i,a=new Oe,o=[],s=[],c=[],l=new Oe,u=new Ce;for(n=0;n<=t;n++)r=n/t,o[n]=this.getTangentAt(r),o[n].normalize();s[0]=new Oe,c[0]=new Oe;var h=Number.MAX_VALUE,f=Math.abs(o[0].x),d=Math.abs(o[0].y),p=Math.abs(o[0].z);for(f<=h&&(h=f,a.set(1,0,0)),d<=h&&(h=d,a.set(0,1,0)),p<=h&&a.set(0,0,1),l.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],l),c[0].crossVectors(o[0],s[0]),n=1;n<=t;n++)s[n]=s[n-1].clone(),c[n]=c[n-1].clone(),l.crossVectors(o[n-1],o[n]),l.length()>Number.EPSILON&&(l.normalize(),i=Math.acos(Re.clamp(o[n-1].dot(o[n]),-1,1)),s[n].applyMatrix4(u.makeRotationAxis(l,i))),c[n].crossVectors(o[n],s[n]);if(!0===e)for(i=Math.acos(Re.clamp(s[0].dot(s[t]),-1,1)),i/=t,o[0].dot(l.crossVectors(s[0],s[t]))>0&&(i=-i),n=1;n<=t;n++)s[n].applyMatrix4(u.makeRotationAxis(o[n],i*n)),c[n].crossVectors(o[n],s[n]);return{tangents:o,normals:s,binormals:c}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),e.EllipseCurve=Do,Do.prototype=Object.create(Uo.prototype),Do.prototype.constructor=Do,Do.prototype.isEllipseCurve=!0,Do.prototype.getPoint=function(t,e){for(var n=e||new Le,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);var o=this.aStartAngle+t*i,s=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var l=Math.cos(this.aRotation),u=Math.sin(this.aRotation),h=s-this.aX,f=c-this.aY;s=h*l-f*u+this.aX,c=h*u+f*l+this.aY}return n.set(s,c)},Do.prototype.copy=function(t){return Uo.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Do.prototype.toJSON=function(){var t=Uo.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Do.prototype.fromJSON=function(t){return Uo.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},e.ArcCurve=ko,ko.prototype=Object.create(Do.prototype),ko.prototype.constructor=ko,ko.prototype.isArcCurve=!0;var Bo=new Oe,jo=new Fo,Ho=new Fo,Go=new Fo;function Vo(t,e,n,r){Uo.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=r||.5}function Wo(t,e,n,r,i){var a=.5*(r-e),o=.5*(i-n),s=t*t;return(2*n-2*r+a+o)*(t*s)+(-3*n+3*r-2*a-o)*s+a*t+n}function qo(t,e,n,r){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)}function Xo(t,e,n,r,i){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)}function Yo(t,e,n,r){Uo.call(this),this.type="CubicBezierCurve",this.v0=t||new Le,this.v1=e||new Le,this.v2=n||new Le,this.v3=r||new Le}function Zo(t,e,n,r){Uo.call(this),this.type="CubicBezierCurve3",this.v0=t||new Oe,this.v1=e||new Oe,this.v2=n||new Oe,this.v3=r||new Oe}function Jo(t,e){Uo.call(this),this.type="LineCurve",this.v1=t||new Le,this.v2=e||new Le}function Qo(t,e){Uo.call(this),this.type="LineCurve3",this.v1=t||new Oe,this.v2=e||new Oe}function Ko(t,e,n){Uo.call(this),this.type="QuadraticBezierCurve",this.v0=t||new Le,this.v1=e||new Le,this.v2=n||new Le}function $o(t,e,n){Uo.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new Oe,this.v1=e||new Oe,this.v2=n||new Oe}function ts(t){Uo.call(this),this.type="SplineCurve",this.points=t||[]}e.CatmullRomCurve3=Vo,Vo.prototype=Object.create(Uo.prototype),Vo.prototype.constructor=Vo,Vo.prototype.isCatmullRomCurve3=!0,Vo.prototype.getPoint=function(t,e){var n,r,i,a,o=e||new Oe,s=this.points,c=s.length,l=(c-(this.closed?0:1))*t,u=Math.floor(l),h=l-u;if(this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/s.length)+1)*s.length:0===h&&u===c-1&&(u=c-2,h=1),this.closed||u>0?n=s[(u-1)%c]:(Bo.subVectors(s[0],s[1]).add(s[0]),n=Bo),r=s[u%c],i=s[(u+1)%c],this.closed||u+2<c?a=s[(u+2)%c]:(Bo.subVectors(s[c-1],s[c-2]).add(s[c-1]),a=Bo),"centripetal"===this.curveType||"chordal"===this.curveType){var f="chordal"===this.curveType?.5:.25,d=Math.pow(n.distanceToSquared(r),f),p=Math.pow(r.distanceToSquared(i),f),m=Math.pow(i.distanceToSquared(a),f);p<1e-4&&(p=1),d<1e-4&&(d=p),m<1e-4&&(m=p),jo.initNonuniformCatmullRom(n.x,r.x,i.x,a.x,d,p,m),Ho.initNonuniformCatmullRom(n.y,r.y,i.y,a.y,d,p,m),Go.initNonuniformCatmullRom(n.z,r.z,i.z,a.z,d,p,m)}else"catmullrom"===this.curveType&&(jo.initCatmullRom(n.x,r.x,i.x,a.x,this.tension),Ho.initCatmullRom(n.y,r.y,i.y,a.y,this.tension),Go.initCatmullRom(n.z,r.z,i.z,a.z,this.tension));return o.set(jo.calc(h),Ho.calc(h),Go.calc(h)),o},Vo.prototype.copy=function(t){Uo.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Vo.prototype.toJSON=function(){var t=Uo.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Vo.prototype.fromJSON=function(t){Uo.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new Oe).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},e.CubicBezierCurve=Yo,Yo.prototype=Object.create(Uo.prototype),Yo.prototype.constructor=Yo,Yo.prototype.isCubicBezierCurve=!0,Yo.prototype.getPoint=function(t,e){var n=e||new Le,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(Xo(t,r.x,i.x,a.x,o.x),Xo(t,r.y,i.y,a.y,o.y)),n},Yo.prototype.copy=function(t){return Uo.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Yo.prototype.toJSON=function(){var t=Uo.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Yo.prototype.fromJSON=function(t){return Uo.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},e.CubicBezierCurve3=Zo,Zo.prototype=Object.create(Uo.prototype),Zo.prototype.constructor=Zo,Zo.prototype.isCubicBezierCurve3=!0,Zo.prototype.getPoint=function(t,e){var n=e||new Oe,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(Xo(t,r.x,i.x,a.x,o.x),Xo(t,r.y,i.y,a.y,o.y),Xo(t,r.z,i.z,a.z,o.z)),n},Zo.prototype.copy=function(t){return Uo.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Zo.prototype.toJSON=function(){var t=Uo.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Zo.prototype.fromJSON=function(t){return Uo.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},e.LineCurve=Jo,Jo.prototype=Object.create(Uo.prototype),Jo.prototype.constructor=Jo,Jo.prototype.isLineCurve=!0,Jo.prototype.getPoint=function(t,e){var n=e||new Le;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},Jo.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Jo.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Jo.prototype.copy=function(t){return Uo.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Jo.prototype.toJSON=function(){var t=Uo.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Jo.prototype.fromJSON=function(t){return Uo.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},e.LineCurve3=Qo,Qo.prototype=Object.create(Uo.prototype),Qo.prototype.constructor=Qo,Qo.prototype.isLineCurve3=!0,Qo.prototype.getPoint=function(t,e){var n=e||new Oe;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},Qo.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Qo.prototype.copy=function(t){return Uo.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Qo.prototype.toJSON=function(){var t=Uo.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Qo.prototype.fromJSON=function(t){return Uo.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},e.QuadraticBezierCurve=Ko,Ko.prototype=Object.create(Uo.prototype),Ko.prototype.constructor=Ko,Ko.prototype.isQuadraticBezierCurve=!0,Ko.prototype.getPoint=function(t,e){var n=e||new Le,r=this.v0,i=this.v1,a=this.v2;return n.set(qo(t,r.x,i.x,a.x),qo(t,r.y,i.y,a.y)),n},Ko.prototype.copy=function(t){return Uo.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Ko.prototype.toJSON=function(){var t=Uo.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Ko.prototype.fromJSON=function(t){return Uo.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},e.QuadraticBezierCurve3=$o,$o.prototype=Object.create(Uo.prototype),$o.prototype.constructor=$o,$o.prototype.isQuadraticBezierCurve3=!0,$o.prototype.getPoint=function(t,e){var n=e||new Oe,r=this.v0,i=this.v1,a=this.v2;return n.set(qo(t,r.x,i.x,a.x),qo(t,r.y,i.y,a.y),qo(t,r.z,i.z,a.z)),n},$o.prototype.copy=function(t){return Uo.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},$o.prototype.toJSON=function(){var t=Uo.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},$o.prototype.fromJSON=function(t){return Uo.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},e.SplineCurve=ts,ts.prototype=Object.create(Uo.prototype),ts.prototype.constructor=ts,ts.prototype.isSplineCurve=!0,ts.prototype.getPoint=function(t,e){var n=e||new Le,r=this.points,i=(r.length-1)*t,a=Math.floor(i),o=i-a,s=r[0===a?a:a-1],c=r[a],l=r[a>r.length-2?r.length-1:a+1],u=r[a>r.length-3?r.length-1:a+2];return n.set(Wo(o,s.x,c.x,l.x,u.x),Wo(o,s.y,c.y,l.y,u.y)),n},ts.prototype.copy=function(t){Uo.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this},ts.prototype.toJSON=function(){var t=Uo.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t},ts.prototype.fromJSON=function(t){Uo.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new Le).fromArray(r))}return this};var es=Object.freeze({ArcCurve:ko,CatmullRomCurve3:Vo,CubicBezierCurve:Yo,CubicBezierCurve3:Zo,EllipseCurve:Do,LineCurve:Jo,LineCurve3:Qo,QuadraticBezierCurve:Ko,QuadraticBezierCurve3:$o,SplineCurve:ts});function ns(){Uo.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function rs(t){ns.call(this),this.type="Path",this.currentPoint=new Le,t&&this.setFromPoints(t)}function is(t){rs.call(this,t),this.uuid=Re.generateUUID(),this.type="Shape",this.holes=[]}function as(t,e){dn.call(this),this.type="Light",this.color=new tn(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function os(t,e,n){as.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(dn.DefaultUp),this.updateMatrix(),this.groundColor=new tn(e)}function ss(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new Le(512,512),this.map=null,this.matrix=new Ce}function cs(){ss.call(this,new zi(50,1,.5,500))}function ls(t,e,n,r,i,a){as.call(this,t,e),this.type="SpotLight",this.position.copy(dn.DefaultUp),this.updateMatrix(),this.target=new dn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==a?a:1,this.shadow=new cs}function us(t,e,n,r){as.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new ss(new zi(90,1,.5,500))}function hs(){ss.call(this,new mn(-5,5,5,-5,.5,500))}function fs(t,e){as.call(this,t,e),this.type="DirectionalLight",this.position.copy(dn.DefaultUp),this.updateMatrix(),this.target=new dn,this.shadow=new hs}function ds(t,e){as.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function ps(t,e,n,r){as.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function ms(t,e,n,r){Ss.call(this,t,e,n,r)}function vs(t,e,n){Ss.call(this,t,e,n)}function gs(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function ys(t,e,n,r){gs.call(this,t,e,n,r)}function _s(t,e,n,r){Ss.call(this,t,e,n,r)}function xs(t,e,n,r){Ss.call(this,t,e,n,r)}function bs(t,e,n,r){Ss.call(this,t,e,n,r)}function ws(t,e,n,r){gs.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Ms(t,e,n,r){gs.call(this,t,e,n,r)}function Es(t,e,n,r){gs.call(this,t,e,n,r)}e.CurvePath=ns,ns.prototype=Object.assign(Object.create(Uo.prototype),{constructor:ns,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Jo(e,t))},getPoint:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=e){var i=n[r]-e,a=this.curves[r],o=a.getLength(),s=0===o?0:1-i/o;return a.getPointAt(s)}r++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],r=0,i=this.curves;r<i.length;r++)for(var a=i[r],o=a&&a.isEllipseCurve?2*t:a&&a.isLineCurve?1:a&&a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o),c=0;c<s.length;c++){var l=s[c];e&&e.equals(l)||(n.push(l),e=l)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){Uo.prototype.copy.call(this,t),this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=Uo.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,n=this.curves.length;e<n;e++){var r=this.curves[e];t.curves.push(r.toJSON())}return t},fromJSON:function(t){Uo.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push((new es[r.type]).fromJSON(r))}return this}}),e.Path=rs,rs.prototype=Object.assign(Object.create(ns.prototype),{constructor:rs,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var n=new Jo(this.currentPoint.clone(),new Le(t,e));this.curves.push(n),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,n,r){var i=new Ko(this.currentPoint.clone(),new Le(t,e),new Le(n,r));this.curves.push(i),this.currentPoint.set(n,r)},bezierCurveTo:function(t,e,n,r,i,a){var o=new Yo(this.currentPoint.clone(),new Le(t,e),new Le(n,r),new Le(i,a));this.curves.push(o),this.currentPoint.set(i,a)},splineThru:function(t){var e=new ts([this.currentPoint.clone()].concat(t));this.curves.push(e),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;this.absarc(t+o,e+s,n,r,i,a)},absarc:function(t,e,n,r,i,a){this.absellipse(t,e,n,n,r,i,a)},ellipse:function(t,e,n,r,i,a,o,s){var c=this.currentPoint.x,l=this.currentPoint.y;this.absellipse(t+c,e+l,n,r,i,a,o,s)},absellipse:function(t,e,n,r,i,a,o,s){var c=new Do(t,e,n,r,i,a,o,s);if(this.curves.length>0){var l=c.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(c);var u=c.getPoint(1);this.currentPoint.copy(u)},copy:function(t){return ns.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=ns.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return ns.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),e.Shape=is,is.prototype=Object.assign(Object.create(rs.prototype),{constructor:is,getPointsHoles:function(t){for(var e=[],n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){rs.prototype.copy.call(this,t),this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push(r.clone())}return this},toJSON:function(){var t=rs.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,n=this.holes.length;e<n;e++){var r=this.holes[e];t.holes.push(r.toJSON())}return t},fromJSON:function(t){rs.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push((new rs).fromJSON(r))}return this}}),e.Light=as,as.prototype=Object.assign(Object.create(dn.prototype),{constructor:as,isLight:!0,copy:function(t){return dn.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=dn.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),e.HemisphereLight=os,os.prototype=Object.assign(Object.create(as.prototype),{constructor:os,isHemisphereLight:!0,copy:function(t){return as.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),e.LightShadow=ss,Object.assign(ss.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),e.SpotLightShadow=cs,cs.prototype=Object.assign(Object.create(ss.prototype),{constructor:cs,isSpotLightShadow:!0,update:function(t){var e=this.camera,n=2*Re.RAD2DEG*t.angle,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix())}}),e.SpotLight=ls,ls.prototype=Object.assign(Object.create(as.prototype),{constructor:ls,isSpotLight:!0,copy:function(t){return as.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),e.PointLight=us,us.prototype=Object.assign(Object.create(as.prototype),{constructor:us,isPointLight:!0,copy:function(t){return as.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),e.DirectionalLightShadow=hs,hs.prototype=Object.assign(Object.create(ss.prototype),{constructor:hs}),e.DirectionalLight=fs,fs.prototype=Object.assign(Object.create(as.prototype),{constructor:fs,isDirectionalLight:!0,copy:function(t){return as.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),e.AmbientLight=ds,ds.prototype=Object.assign(Object.create(as.prototype),{constructor:ds,isAmbientLight:!0}),e.RectAreaLight=ps,ps.prototype=Object.assign(Object.create(as.prototype),{constructor:ps,isRectAreaLight:!0,copy:function(t){return as.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=as.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),e.StringKeyframeTrack=ms,ms.prototype=Object.assign(Object.create(Ss.prototype),{constructor:ms,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),e.BooleanKeyframeTrack=vs,vs.prototype=Object.assign(Object.create(Ss.prototype),{constructor:vs,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),e.Interpolant=gs,Object.assign(gs.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var a;n:{r:if(!(t<r)){for(var o=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===o)break;if(i=r,t<(r=e[++n]))break e}a=e.length;break n}if(t>=i)break t;var s=e[1];t<s&&(n=2,i=s);for(o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===o)break;if(r=i,t>=(i=e[--n-1]))break e}a=n,n=0}for(;n<a;){var c=n+a>>>1;t<e[c]?a=c:n=c+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,a=0;a!==r;++a)e[a]=n[i+a];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(gs.prototype,{beforeStart_:gs.prototype.copySampleValue_,afterEnd_:gs.prototype.copySampleValue_}),e.QuaternionLinearInterpolant=ys,ys.prototype=Object.assign(Object.create(gs.prototype),{constructor:ys,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,c=(n-e)/(r-e),l=s+o;s!==l;s+=4)Pe.slerpFlat(i,0,a,s-o,a,s,c);return i}}),e.QuaternionKeyframeTrack=_s,_s.prototype=Object.assign(Object.create(Ss.prototype),{constructor:_s,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new ys(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),e.ColorKeyframeTrack=xs,xs.prototype=Object.assign(Object.create(Ss.prototype),{constructor:xs,ValueTypeName:"color"}),e.NumberKeyframeTrack=bs,bs.prototype=Object.assign(Object.create(Ss.prototype),{constructor:bs,ValueTypeName:"number"}),e.CubicInterpolant=ws,ws.prototype=Object.assign(Object.create(gs.prototype),{constructor:ws,DefaultSettings_:{endingStart:oe,endingEnd:oe},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,a=t+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:i=t,o=2*e-n;break;case 2402:o=e+r[i=r.length-2]-r[i+1];break;default:i=t,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:a=t,s=2*n-e;break;case 2402:a=1,s=n+r[1]-r[0];break;default:a=t-1,s=e}var c=.5*(n-e),l=this.valueSize;this._weightPrev=c/(e-o),this._weightNext=c/(s-n),this._offsetPrev=i*l,this._offsetNext=a*l},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,c=s-o,l=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,f=this._weightNext,d=(n-e)/(r-e),p=d*d,m=p*d,v=-h*m+2*h*p-h*d,g=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*d+1,y=(-1-f)*m+(1.5+f)*p+.5*d,_=f*m-f*p,x=0;x!==o;++x)i[x]=v*a[l+x]+g*a[c+x]+y*a[s+x]+_*a[u+x];return i}}),e.LinearInterpolant=Ms,Ms.prototype=Object.assign(Object.create(gs.prototype),{constructor:Ms,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,c=s-o,l=(n-e)/(r-e),u=1-l,h=0;h!==o;++h)i[h]=a[c+h]*u+a[s+h]*l;return i}}),e.DiscreteInterpolant=Es,Es.prototype=Object.assign(Object.create(gs.prototype),{constructor:Es,interpolate_:function(t){return this.copySampleValue_(t-1)}});var Ts={arraySlice:function(t,e,n){return Ts.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),r=0;r!==e;++r)n[r]=r;return n.sort(function(e,n){return t[e]-t[n]}),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*e,c=0;c!==e;++c)i[o++]=t[s+c];return i},flattenJSON:function(t,e,n,r){for(var i=1,a=t[0];void 0!==a&&void 0===a[r];)a=t[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[r])&&(e.push(a.time),n.push.apply(n,o)),a=t[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[r])&&(e.push(a.time),o.toArray(n,n.length)),a=t[i++]}while(void 0!==a);else do{void 0!==(o=a[r])&&(e.push(a.time),n.push(o)),a=t[i++]}while(void 0!==a)}}};function Ss(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Ts.convertArray(e,this.TimeBufferType),this.values=Ts.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation),this.validate(),this.optimize()}function As(t,e,n,r){Ss.call(this,t,e,n,r)}function Rs(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=Re.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function Ls(t){this.manager=void 0!==t?t:Ro,this.textures={}}function Cs(t){this.manager=void 0!==t?t:Ro}e.AnimationUtils=Ts,e.KeyframeTrack=Ss,Object.assign(Ss,{parse:function(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=Ss._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var n=[],r=[];Ts.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:Ts.convertArray(t.times,Array),values:Ts.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return bs;case"vector":case"vector2":case"vector3":case"vector4":return As;case"color":return xs;case"quaternion":return _s;case"bool":case"boolean":return vs;case"string":return ms}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}}),Object.assign(Ss.prototype,{constructor:Ss,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new Es(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Ms(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new ws(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0!==e)this.createInterpolant=e;else{var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",n)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<t;)++i;for(;-1!==a&&n[a]>e;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=Ts.arraySlice(n,i,a),this.values=Ts.arraySlice(this.values,i*o,a*o)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),t=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),t=!1;break}a=s}if(void 0!==r&&Ts.isTypedArray(r)){o=0;for(var c=r.length;o!==c;++o){var l=r[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l),t=!1;break}}}return t},optimize:function(){for(var t=this.times,e=this.values,n=this.getValueSize(),r=2302===this.getInterpolation(),i=1,a=t.length-1,o=1;o<a;++o){var s=!1,c=t[o];if(c!==t[o+1]&&(1!==o||c!==c[0]))if(r)s=!0;else for(var l=o*n,u=l-n,h=l+n,f=0;f!==n;++f){var d=e[l+f];if(d!==e[u+f]||d!==e[h+f]){s=!0;break}}if(s){if(o!==i){t[i]=t[o];var p=o*n,m=i*n;for(f=0;f!==n;++f)e[m+f]=e[p+f]}++i}}if(a>0){t[i]=t[a];for(p=a*n,m=i*n,f=0;f!==n;++f)e[m+f]=e[p+f];++i}return i!==t.length&&(this.times=Ts.arraySlice(t,0,i),this.values=Ts.arraySlice(e,0,i*n)),this}}),e.VectorKeyframeTrack=As,As.prototype=Object.assign(Object.create(Ss.prototype),{constructor:As,ValueTypeName:"vector"}),e.AnimationClip=Rs,Object.assign(Rs,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,a=n.length;i!==a;++i)e.push(Ss.parse(n[i]).scale(r));return new Rs(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e},i=0,a=n.length;i!==a;++i)e.push(Ss.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,a=[],o=0;o<i;o++){var s=[],c=[];s.push((o+i-1)%i,o,(o+1)%i),c.push(0,1,0);var l=Ts.getKeyframeOrder(s);s=Ts.sortedArray(s,1,l),c=Ts.sortedArray(c,1,l),r||0!==s[0]||(s.push(i),c.push(c[0])),a.push(new bs(".morphTargetInfluences["+e[o].name+"]",s,c).scale(1/n))}return new Rs(t,-1,a)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var r=t;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=t.length;a<o;a++){var s=t[a],c=s.name.match(i);if(c&&c.length>1){var l=r[h=c[1]];l||(r[h]=l=[]),l.push(s)}}var u=[];for(var h in r)u.push(Rs.CreateFromMorphTargetSequence(h,r[h],e,n));return u},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var a=[],o=[];Ts.flattenJSON(n,a,o,r),0!==a.length&&i.push(new t(e,a,o))}},r=[],i=t.name||"default",a=t.length||-1,o=t.fps||30,s=t.hierarchy||[],c=0;c<s.length;c++){var l=s[c].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var u={},h=0;h<l.length;h++)if(l[h].morphTargets)for(var f=0;f<l[h].morphTargets.length;f++)u[l[h].morphTargets[f]]=-1;for(var d in u){var p=[],m=[];for(f=0;f!==l[h].morphTargets.length;++f){var v=l[h];p.push(v.time),m.push(v.morphTarget===d?1:0)}r.push(new bs(".morphTargetInfluence["+d+"]",p,m))}a=u.length*(o||1)}else{var g=".bones["+e[c].name+"]";n(As,g+".position",l,"pos",r),n(_s,g+".quaternion",l,"rot",r),n(As,g+".scale",l,"scl",r)}}return 0===r.length?null:new Rs(i,a,r)}}),Object.assign(Rs.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}this.duration=t},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}}),e.MaterialLoader=Ls,Object.assign(Ls.prototype,{load:function(t,e,n,r){var i=this;new Co(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},setTextures:function(t){this.textures=t},parse:function(t){var e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var r=new To[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearCoat&&(r.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(r.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(r.uniforms=t.uniforms),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(r.vertexColors=t.vertexColors),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap),r.transparent=!0),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalScale){var i=t.normalScale;!1===Array.isArray(i)&&(i=[i,i]),r.normalScale=(new Le).fromArray(i)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),r}}),e.BufferGeometryLoader=Cs,Object.assign(Cs.prototype,{load:function(t,e,n,r){var i=this;new Co(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},parse:function(t){var e=new In,n=t.data.index;if(void 0!==n){var r=new zs[n.type](n.array);e.setIndex(new bn(r,1))}var i=t.data.attributes;for(var a in i){var o=i[a];r=new zs[o.type](o.array);e.addAttribute(a,new bn(r,o.itemSize,o.normalized))}var s=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==s)for(var c=0,l=s.length;c!==l;++c){var u=s[c];e.addGroup(u.start,u.count,u.materialIndex)}var h=t.data.boundingSphere;if(void 0!==h){var f=new Oe;void 0!==h.center&&f.fromArray(h.center),e.boundingSphere=new Xe(f,h.radius)}return e}});var Ps,Os,Ns,Is,zs={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Us(){}e.Loader=Us,Us.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,n=0,r=e.length;n<r;n+=2){var i=e[n],a=e[n+1];if(i.test(t))return a}return null}},Object.assign(Us.prototype,{crossOrigin:void 0,onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(t,e,n){for(var r=[],i=0;i<t.length;++i)r[i]=this.createMaterial(t[i],e,n);return r},createMaterial:(Ps={NoBlending:v,NormalBlending:g,AdditiveBlending:y,SubtractiveBlending:_,MultiplyBlending:x,CustomBlending:b},Os=new tn,Ns=new zo,Is=new Ls,function(t,e,n){var r={};function i(t,i,a,o,s){var c,l=e+t,u=Us.Handlers.get(l);null!==u?c=u.load(l):(Ns.setCrossOrigin(n),c=Ns.load(l)),void 0!==i&&(c.repeat.fromArray(i),1!==i[0]&&(c.wrapS=st),1!==i[1]&&(c.wrapT=st)),void 0!==a&&c.offset.fromArray(a),void 0!==o&&("repeat"===o[0]&&(c.wrapS=st),"mirror"===o[0]&&(c.wrapS=lt),"repeat"===o[1]&&(c.wrapT=st),"mirror"===o[1]&&(c.wrapT=lt)),void 0!==s&&(c.anisotropy=s);var h=Re.generateUUID();return r[h]=c,h}var a={uuid:Re.generateUUID(),type:"MeshLambertMaterial"};for(var o in t){var s=t[o];switch(o){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":a.name=s;break;case"blending":a.blending=Ps[s];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",o,"is no longer supported.");break;case"colorDiffuse":a.color=Os.fromArray(s).getHex();break;case"colorSpecular":a.specular=Os.fromArray(s).getHex();break;case"colorEmissive":a.emissive=Os.fromArray(s).getHex();break;case"specularCoef":a.shininess=s;break;case"shading":"basic"===s.toLowerCase()&&(a.type="MeshBasicMaterial"),"phong"===s.toLowerCase()&&(a.type="MeshPhongMaterial"),"standard"===s.toLowerCase()&&(a.type="MeshStandardMaterial");break;case"mapDiffuse":a.map=i(s,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":a.emissiveMap=i(s,t.mapEmissiveRepeat,t.mapEmissiveOffset,t.mapEmissiveWrap,t.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":a.lightMap=i(s,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":a.aoMap=i(s,t.mapAORepeat,t.mapAOOffset,t.mapAOWrap,t.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":a.bumpMap=i(s,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy);break;case"mapBumpScale":a.bumpScale=s;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":a.normalMap=i(s,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy);break;case"mapNormalFactor":a.normalScale=s;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":a.specularMap=i(s,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":a.metalnessMap=i(s,t.mapMetalnessRepeat,t.mapMetalnessOffset,t.mapMetalnessWrap,t.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":a.roughnessMap=i(s,t.mapRoughnessRepeat,t.mapRoughnessOffset,t.mapRoughnessWrap,t.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":a.alphaMap=i(s,t.mapAlphaRepeat,t.mapAlphaOffset,t.mapAlphaWrap,t.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":a.side=h;break;case"doubleSided":a.side=f;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),a.opacity=s;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":a[o]=s;break;case"vertexColors":!0===s&&(a.vertexColors=m),"face"===s&&(a.vertexColors=p);break;default:console.error("THREE.Loader.createMaterial: Unsupported",o,s)}}return"MeshBasicMaterial"===a.type&&delete a.emissive,"MeshPhongMaterial"!==a.type&&delete a.specular,a.opacity<1&&(a.transparent=!0),Is.setTextures(r),Is.parse(a)})});var Ds={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);return decodeURIComponent(escape(e))},extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")}};function ks(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:Ro,this.withCredentials=!1}function Fs(t){this.manager=void 0!==t?t:Ro,this.texturePath=""}e.LoaderUtils=Ds,e.JSONLoader=ks,Object.assign(ks.prototype,{load:function(t,e,n,r){var i=this,a=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Ds.extractUrlBase(t),o=new Co(this.manager);o.setWithCredentials(this.withCredentials),o.load(t,function(n){var r=JSON.parse(n),o=r.metadata;if(void 0!==o){var s=o.type;if(void 0!==s&&"object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.")}var c=i.parse(r,a);e(c.geometry,c.materials)},n,r)},setTexturePath:function(t){this.texturePath=t},parse:function(){return function(t,e){void 0!==t.data&&(t=t.data),void 0!==t.scale?t.scale=1/t.scale:t.scale=1;var n=new xn;return function(t,e){function n(t,e){return t&1<<e}var r,i,a,o,s,c,l,u,h,f,d,p,m,v,g,y,_,x,b,w,M,E,T,S,A,R=t.faces,L=t.vertices,C=t.normals,P=t.colors,O=t.scale,N=0;if(void 0!==t.uvs){for(r=0;r<t.uvs.length;r++)t.uvs[r].length&&N++;for(r=0;r<N;r++)e.faceVertexUvs[r]=[]}for(o=0,s=L.length;o<s;)(x=new Oe).x=L[o++]*O,x.y=L[o++]*O,x.z=L[o++]*O,e.vertices.push(x);for(o=0,s=R.length;o<s;)if(d=n(f=R[o++],0),p=n(f,1),m=n(f,3),v=n(f,4),g=n(f,5),y=n(f,6),_=n(f,7),d){if((w=new vn).a=R[o],w.b=R[o+1],w.c=R[o+3],(M=new vn).a=R[o+1],M.b=R[o+2],M.c=R[o+3],o+=4,p&&(h=R[o++],w.materialIndex=h,M.materialIndex=h),a=e.faces.length,m)for(r=0;r<N;r++)for(S=t.uvs[r],e.faceVertexUvs[r][a]=[],e.faceVertexUvs[r][a+1]=[],i=0;i<4;i++)A=new Le(S[2*(u=R[o++])],S[2*u+1]),2!==i&&e.faceVertexUvs[r][a].push(A),0!==i&&e.faceVertexUvs[r][a+1].push(A);if(v&&(l=3*R[o++],w.normal.set(C[l++],C[l++],C[l]),M.normal.copy(w.normal)),g)for(r=0;r<4;r++)l=3*R[o++],T=new Oe(C[l++],C[l++],C[l]),2!==r&&w.vertexNormals.push(T),0!==r&&M.vertexNormals.push(T);if(y&&(E=P[c=R[o++]],w.color.setHex(E),M.color.setHex(E)),_)for(r=0;r<4;r++)E=P[c=R[o++]],2!==r&&w.vertexColors.push(new tn(E)),0!==r&&M.vertexColors.push(new tn(E));e.faces.push(w),e.faces.push(M)}else{if((b=new vn).a=R[o++],b.b=R[o++],b.c=R[o++],p&&(h=R[o++],b.materialIndex=h),a=e.faces.length,m)for(r=0;r<N;r++)for(S=t.uvs[r],e.faceVertexUvs[r][a]=[],i=0;i<3;i++)A=new Le(S[2*(u=R[o++])],S[2*u+1]),e.faceVertexUvs[r][a].push(A);if(v&&(l=3*R[o++],b.normal.set(C[l++],C[l++],C[l])),g)for(r=0;r<3;r++)l=3*R[o++],T=new Oe(C[l++],C[l++],C[l]),b.vertexNormals.push(T);if(y&&(c=R[o++],b.color.setHex(P[c])),_)for(r=0;r<3;r++)c=R[o++],b.vertexColors.push(new tn(P[c]));e.faces.push(b)}}(t,n),function(t,e){var n=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var r=0,i=t.skinWeights.length;r<i;r+=n){var a=t.skinWeights[r],o=n>1?t.skinWeights[r+1]:0,s=n>2?t.skinWeights[r+2]:0,c=n>3?t.skinWeights[r+3]:0;e.skinWeights.push(new He(a,o,s,c))}if(t.skinIndices)for(r=0,i=t.skinIndices.length;r<i;r+=n){var l=t.skinIndices[r],u=n>1?t.skinIndices[r+1]:0,h=n>2?t.skinIndices[r+2]:0,f=n>3?t.skinIndices[r+3]:0;e.skinIndices.push(new He(l,u,h,f))}e.bones=t.bones,e.bones&&e.bones.length>0&&(e.skinWeights.length!==e.skinIndices.length||e.skinIndices.length!==e.vertices.length)&&console.warn("When skinning, number of vertices ("+e.vertices.length+"), skinIndices ("+e.skinIndices.length+"), and skinWeights ("+e.skinWeights.length+") should match.")}(t,n),function(t,e){var n=t.scale;if(void 0!==t.morphTargets)for(var r=0,i=t.morphTargets.length;r<i;r++){e.morphTargets[r]={},e.morphTargets[r].name=t.morphTargets[r].name,e.morphTargets[r].vertices=[];for(var a=e.morphTargets[r].vertices,o=t.morphTargets[r].vertices,s=0,c=o.length;s<c;s+=3){var l=new Oe;l.x=o[s]*n,l.y=o[s+1]*n,l.z=o[s+2]*n,a.push(l)}}if(void 0!==t.morphColors&&t.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var u=e.faces,h=t.morphColors[0].colors;for(r=0,i=u.length;r<i;r++)u[r].color.fromArray(h,3*r)}}(t,n),function(t,e){var n=[],r=[];void 0!==t.animation&&r.push(t.animation),void 0!==t.animations&&(t.animations.length?r=r.concat(t.animations):r.push(t.animations));for(var i=0;i<r.length;i++){var a=Rs.parseAnimation(r[i],e.bones);a&&n.push(a)}if(e.morphTargets){var o=Rs.CreateClipsFromMorphTargetSequences(e.morphTargets,10);n=n.concat(o)}n.length>0&&(e.animations=n)}(t,n),n.computeFaceNormals(),n.computeBoundingSphere(),void 0===t.materials||0===t.materials.length?{geometry:n}:{geometry:n,materials:Us.prototype.initMaterials(t.materials,e,this.crossOrigin)}}}()}),e.ObjectLoader=Fs,Object.assign(Fs.prototype,{load:function(t,e,n,r){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var i=this;new Co(i.manager).load(t,function(n){var a=null;try{a=JSON.parse(n)}catch(e){return void 0!==r&&r(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?i.parse(a,e):console.error("THREE.ObjectLoader: Can't load "+t+". Use THREE.JSONLoader instead.")},n,r)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var n=this.parseShape(t.shapes),r=this.parseGeometries(t.geometries,n),i=this.parseImages(t.images,function(){void 0!==e&&e(s)}),a=this.parseTextures(t.textures,i),o=this.parseMaterials(t.materials,a),s=this.parseObject(t.object,r,o);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var n=0,r=t.length;n<r;n++){var i=(new is).fromJSON(t[n]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var n={};if(void 0!==t)for(var r=new ks,i=new Cs,a=0,o=t.length;a<o;a++){var s,c=t[a];switch(c.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new mo[c.type](c.width,c.height,c.widthSegments,c.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new mo[c.type](c.width,c.height,c.depth,c.widthSegments,c.heightSegments,c.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new mo[c.type](c.radius,c.segments,c.thetaStart,c.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new mo[c.type](c.radiusTop,c.radiusBottom,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new mo[c.type](c.radius,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new mo[c.type](c.radius,c.widthSegments,c.heightSegments,c.phiStart,c.phiLength,c.thetaStart,c.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new mo[c.type](c.radius,c.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new mo[c.type](c.innerRadius,c.outerRadius,c.thetaSegments,c.phiSegments,c.thetaStart,c.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new mo[c.type](c.radius,c.tube,c.radialSegments,c.tubularSegments,c.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new mo[c.type](c.radius,c.tube,c.tubularSegments,c.radialSegments,c.p,c.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new mo[c.type](c.points,c.segments,c.phiStart,c.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new mo[c.type](c.vertices,c.indices,c.radius,c.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":var l=[];for(a=0,o=c.shapes.length;a<o;a++){var u=e[c.shapes[a]];l.push(u)}s=new mo[c.type](l,c.curveSegments);break;case"BufferGeometry":s=i.parse(c);break;case"Geometry":s=r.parse(c,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+c.type+'"');continue}s.uuid=c.uuid,void 0!==c.name&&(s.name=c.name),n[c.uuid]=s}return n},parseMaterials:function(t,e){var n={};if(void 0!==t){var r=new Ls;r.setTextures(e);for(var i=0,a=t.length;i<a;i++){var o=t[i];if("MultiMaterial"===o.type){for(var s=[],c=0;c<o.materials.length;c++)s.push(r.parse(o.materials[c]));n[o.uuid]=s}else n[o.uuid]=r.parse(o)}}return n},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var r=Rs.parse(t[n]);e.push(r)}return e},parseImages:function(t,e){var n=this,r={};function i(t){return n.manager.itemStart(t),a.load(t,function(){n.manager.itemEnd(t)},void 0,function(){n.manager.itemEnd(t),n.manager.itemError(t)})}if(void 0!==t&&t.length>0){var a=new No(new Ao(e));a.setCrossOrigin(this.crossOrigin);for(var o=0,s=t.length;o<s;o++){var c=t[o],l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:n.texturePath+c.url;r[c.uuid]=i(l)}}return r},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={};if(void 0!==t)for(var i=0,a=t.length;i<a;i++){var o=t[i];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===e[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=new je(e[o.image]);s.needsUpdate=!0,s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=n(o.mapping,js)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=n(o.wrap[0],Hs),s.wrapT=n(o.wrap[1],Hs)),void 0!==o.format&&(s.format=o.format),void 0!==o.minFilter&&(s.minFilter=n(o.minFilter,Gs)),void 0!==o.magFilter&&(s.magFilter=n(o.magFilter,Gs)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),r[o.uuid]=s}return r},parseObject:function(t,e,n){var r;function i(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function a(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,i=t.length;r<i;r++){var a=t[r];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),e.push(n[a])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}switch(t.type){case"Scene":r=new ji,void 0!==t.background&&Number.isInteger(t.background)&&(r.background=new tn(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?r.fog=new Bi(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(r.fog=new Fi(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":r=new zi(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"OrthographicCamera":r=new mn(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"AmbientLight":r=new ds(t.color,t.intensity);break;case"DirectionalLight":r=new fs(t.color,t.intensity);break;case"PointLight":r=new us(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":r=new ps(t.color,t.intensity,t.width,t.height);break;case"SpotLight":r=new ls(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":r=new os(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=i(t.geometry),s=a(t.material);r=o.bones&&o.bones.length>0?new Xi(o,s):new $n(o,s);break;case"LOD":r=new Vi;break;case"Line":r=new Zi(i(t.geometry),a(t.material),t.mode);break;case"LineLoop":r=new Qi(i(t.geometry),a(t.material));break;case"LineSegments":r=new Ji(i(t.geometry),a(t.material));break;case"PointCloud":case"Points":r=new $i(i(t.geometry),a(t.material));break;case"Sprite":r=new Gi(a(t.material));break;case"Group":r=new ta;break;default:r=new dn}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(r.matrix.fromArray(t.matrix),r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.quaternion&&r.quaternion.fromArray(t.quaternion),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(r.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(r.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&r.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(r.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.frustumCulled&&(r.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(r.renderOrder=t.renderOrder),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.children)for(var c=t.children,l=0;l<c.length;l++)r.add(this.parseObject(c[l],e,n));if("LOD"===t.type)for(var u=t.levels,h=0;h<u.length;h++){var f=u[h],d=r.getObjectByProperty("uuid",f.object);void 0!==d&&r.addLevel(d,f.distance)}return r}});var Bs,js={UVMapping:300,CubeReflectionMapping:tt,CubeRefractionMapping:et,EquirectangularReflectionMapping:nt,EquirectangularRefractionMapping:rt,SphericalReflectionMapping:it,CubeUVReflectionMapping:at,CubeUVRefractionMapping:ot},Hs={RepeatWrapping:st,ClampToEdgeWrapping:ct,MirroredRepeatWrapping:lt},Gs={NearestFilter:ut,NearestMipMapNearestFilter:ht,NearestMipMapLinearFilter:ft,LinearFilter:dt,LinearMipMapNearestFilter:pt,LinearMipMapLinearFilter:mt};function Vs(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==t?t:Ro,this.options=void 0}function Ws(){this.type="ShapePath",this.subPaths=[],this.currentPath=null}function qs(t){this.type="Font",this.data=t}function Xs(t,e,n,r,i,a){var o=a.glyphs[t]||a.glyphs["?"];if(o){var s,c,l,u,h,f,d,p,m=new Ws;if(o.o)for(var v=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),g=0,y=v.length;g<y;){switch(v[g++]){case"m":s=v[g++]*n+r,c=v[g++]*n+i,m.moveTo(s,c);break;case"l":s=v[g++]*n+r,c=v[g++]*n+i,m.lineTo(s,c);break;case"q":l=v[g++]*n+r,u=v[g++]*n+i,h=v[g++]*n+r,f=v[g++]*n+i,m.quadraticCurveTo(h,f,l,u);break;case"b":l=v[g++]*n+r,u=v[g++]*n+i,h=v[g++]*n+r,f=v[g++]*n+i,d=v[g++]*n+r,p=v[g++]*n+i,m.bezierCurveTo(h,f,d,p,l,u)}}return{offsetX:o.ha*n,path:m}}}function Ys(t){this.manager=void 0!==t?t:Ro}e.ImageBitmapLoader=Vs,Vs.prototype={constructor:Vs,setOptions:function(t){return this.options=t,this},load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var i=this,a=So.get(t);if(void 0!==a)return i.manager.itemStart(t),setTimeout(function(){e&&e(a),i.manager.itemEnd(t)},0),a;fetch(t).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,i.options)}).then(function(n){So.add(t,n),e&&e(n),i.manager.itemEnd(t)}).catch(function(e){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)})},setCrossOrigin:function(){return this},setPath:function(t){return this.path=t,this}},e.ShapePath=Ws,Object.assign(Ws.prototype,{moveTo:function(t,e){this.currentPath=new rs,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,n,r){this.currentPath.quadraticCurveTo(t,e,n,r)},bezierCurveTo:function(t,e,n,r,i,a){this.currentPath.bezierCurveTo(t,e,n,r,i,a)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function n(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],a=new is;a.curves=i.curves,e.push(a)}return e}function r(t,e){for(var n=e.length,r=!1,i=n-1,a=0;a<n;i=a++){var o=e[i],s=e[a],c=s.x-o.x,l=s.y-o.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(o=e[a],c=-c,s=e[i],l=-l),t.y<o.y||t.y>s.y)continue;if(t.y===o.y){if(t.x===o.x)return!0}else{var u=l*(t.x-o.x)-c*(t.y-o.y);if(0===u)return!0;if(u<0)continue;r=!r}}else{if(t.y!==o.y)continue;if(s.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=s.x)return!0}}return r}var i=Wa.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===e)return n(a);var o,s,c,l=[];if(1===a.length)return s=a[0],(c=new is).curves=s.curves,l.push(c),l;var u=!i(a[0].getPoints());u=t?!u:u;var h,f,d=[],p=[],m=[],v=0;p[v]=void 0,m[v]=[];for(var g=0,y=a.length;g<y;g++)o=i(h=(s=a[g]).getPoints()),(o=t?!o:o)?(!u&&p[v]&&v++,p[v]={s:new is,p:h},p[v].s.curves=s.curves,u&&v++,m[v]=[]):m[v].push({h:s,p:h[0]});if(!p[0])return n(a);if(p.length>1){for(var _=!1,x=[],b=0,w=p.length;b<w;b++)d[b]=[];for(b=0,w=p.length;b<w;b++)for(var M=m[b],E=0;E<M.length;E++){for(var T=M[E],S=!0,A=0;A<p.length;A++)r(T.p,p[A].p)&&(b!==A&&x.push({froms:b,tos:A,hole:E}),S?(S=!1,d[A].push(T)):_=!0);S&&d[b].push(T)}x.length>0&&(_||(m=d))}g=0;for(var R=p.length;g<R;g++){c=p[g].s,l.push(c);for(var L=0,C=(f=m[g]).length;L<C;L++)c.holes.push(f[L].h)}return l}}),e.Font=qs,Object.assign(qs.prototype,{isFont:!0,generateShapes:function(t,e,n){void 0===e&&(e=100),void 0===n&&(n=4);for(var r=[],i=function(t,e,n,r){for(var i=String(t).split(""),a=e/r.resolution,o=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*a,s=[],c=0,l=0,u=0;u<i.length;u++){var h=i[u];if("\n"===h)c=0,l-=o;else{var f=Xs(h,n,a,c,l,r);c+=f.offsetX,s.push(f.path)}}return s}(t,e,n,this.data),a=0,o=i.length;a<o;a++)Array.prototype.push.apply(r,i[a].toShapes());return r}}),e.FontLoader=Ys,Object.assign(Ys.prototype,{load:function(t,e,n,r){var i=this,a=new Co(this.manager);a.setPath(this.path),a.load(t,function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var r=i.parse(n);e&&e(r)},n,r)},parse:function(t){return new qs(t)},setPath:function(t){return this.path=t,this}});var Zs,Js,Qs,Ks,$s,tc,ec,nc,rc,ic,ac={getContext:function(){return void 0===Bs&&(Bs=new(window.AudioContext||window.webkitAudioContext)),Bs},setContext:function(t){Bs=t}};function oc(t){this.manager=void 0!==t?t:Ro}function sc(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new zi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new zi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function cc(t,e,n){dn.call(this),this.type="CubeCamera";var r=new zi(90,1,t,e);r.up.set(0,-1,0),r.lookAt(new Oe(1,0,0)),this.add(r);var i=new zi(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new Oe(-1,0,0)),this.add(i);var a=new zi(90,1,t,e);a.up.set(0,0,1),a.lookAt(new Oe(0,1,0)),this.add(a);var o=new zi(90,1,t,e);o.up.set(0,0,-1),o.lookAt(new Oe(0,-1,0)),this.add(o);var s=new zi(90,1,t,e);s.up.set(0,-1,0),s.lookAt(new Oe(0,0,1)),this.add(s);var c=new zi(90,1,t,e);c.up.set(0,-1,0),c.lookAt(new Oe(0,0,-1)),this.add(c);var l={format:Lt,magFilter:dt,minFilter:dt};this.renderTarget=new Ve(n,n,l),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,l=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,t.render(e,r,n),n.activeCubeFace=1,t.render(e,i,n),n.activeCubeFace=2,t.render(e,a,n),n.activeCubeFace=3,t.render(e,o,n),n.activeCubeFace=4,t.render(e,s,n),n.texture.generateMipmaps=l,n.activeCubeFace=5,t.render(e,c,n),t.setRenderTarget(null)},this.clear=function(t,e,n,r){for(var i=this.renderTarget,a=0;a<6;a++)i.activeCubeFace=a,t.setRenderTarget(i),t.clear(e,n,r);t.setRenderTarget(null)}}function lc(){dn.call(this),this.type="AudioListener",this.context=ac.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function uc(t){dn.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function hc(t){uc.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function fc(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function dc(t,e,n){this.binding=t,this.valueSize=n;var r,i=Float64Array;switch(e){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}e.AudioContext=ac,e.AudioLoader=oc,Object.assign(oc.prototype,{load:function(t,e,n,r){var i=new Co(this.manager);i.setResponseType("arraybuffer"),i.load(t,function(t){ac.getContext().decodeAudioData(t,function(t){e(t)})},n,r)}}),e.StereoCamera=sc,Object.assign(sc.prototype,{update:(rc=new Ce,ic=new Ce,function(t){if(Zs!==this||Js!==t.focus||Qs!==t.fov||Ks!==t.aspect*this.aspect||$s!==t.near||tc!==t.far||ec!==t.zoom||nc!==this.eyeSep){Zs=this,Js=t.focus,Qs=t.fov,Ks=t.aspect*this.aspect,$s=t.near,tc=t.far,ec=t.zoom;var e,n,r=t.projectionMatrix.clone(),i=(nc=this.eyeSep/2)*$s/Js,a=$s*Math.tan(Re.DEG2RAD*Qs*.5)/ec;ic.elements[12]=-nc,rc.elements[12]=nc,e=-a*Ks+i,n=a*Ks+i,r.elements[0]=2*$s/(n-e),r.elements[8]=(n+e)/(n-e),this.cameraL.projectionMatrix.copy(r),e=-a*Ks-i,n=a*Ks-i,r.elements[0]=2*$s/(n-e),r.elements[8]=(n+e)/(n-e),this.cameraR.projectionMatrix.copy(r)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(ic),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(rc)})}),e.CubeCamera=cc,cc.prototype=Object.create(dn.prototype),cc.prototype.constructor=cc,e.AudioListener=lc,lc.prototype=Object.assign(Object.create(dn.prototype),{constructor:lc,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:function(){var t=new Oe,e=new Pe,n=new Oe,r=new Oe;return function(i){dn.prototype.updateMatrixWorld.call(this,i);var a=this.context.listener,o=this.up;this.matrixWorld.decompose(t,e,n),r.set(0,0,-1).applyQuaternion(e),a.positionX?(a.positionX.setValueAtTime(t.x,this.context.currentTime),a.positionY.setValueAtTime(t.y,this.context.currentTime),a.positionZ.setValueAtTime(t.z,this.context.currentTime),a.forwardX.setValueAtTime(r.x,this.context.currentTime),a.forwardY.setValueAtTime(r.y,this.context.currentTime),a.forwardZ.setValueAtTime(r.z,this.context.currentTime),a.upX.setValueAtTime(o.x,this.context.currentTime),a.upY.setValueAtTime(o.y,this.context.currentTime),a.upZ.setValueAtTime(o.z,this.context.currentTime)):(a.setPosition(t.x,t.y,t.z),a.setOrientation(r.x,r.y,r.z,o.x,o.y,o.z))}}()}),e.Audio=uc,uc.prototype=Object.assign(Object.create(dn.prototype),{constructor:uc,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,t.start(this.startTime,this.offset),this.isPlaying=!0,this.source=t,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this}}),e.PositionalAudio=hc,hc.prototype=Object.assign(Object.create(uc.prototype),{constructor:hc,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new Oe;return function(e){dn.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),e.AudioAnalyser=fc,Object.assign(fc.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),e.PropertyMixer=dc,Object.assign(dc.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==r;++o)n[i+o]=n[o];a=e}else{var s=e/(a+=e);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=a},apply:function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,i<1){var o=3*e;this._mixBufferRegion(n,r,o,1-i,e)}for(var s=e,c=e+e;s!==c;++s)if(n[s]!==n[s+e]){a.setValue(n,r);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,r=3*n;t.getValue(e,r);for(var i=n,a=r;i!==a;++i)e[i]=e[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,n,r,i){if(r>=.5)for(var a=0;a!==i;++a)t[e+a]=t[n+a]},_slerp:function(t,e,n,r){Pe.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var a=1-r,o=0;o!==i;++o){var s=e+o;t[s]=t[s]*a+t[n+o]*r}}});var pc,mc,vc,gc,yc,_c,xc,bc,wc,Mc,Ec,Tc,Sc;function Ac(t,e,n){var r=n||Rc.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function Rc(t,e,n){this.path=e,this.parsedPath=n||Rc.parseTrackName(e),this.node=Rc.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function Lc(){this.uuid=Re.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function Cc(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var r=e.tracks,i=r.length,a=new Array(i),o={endingStart:oe,endingEnd:oe},s=0;s!==i;++s){var c=r[s].createInterpolant(null);a[s]=c,c.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ae,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Pc(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Oc(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function Nc(){In.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Ic(t,e,n,r){this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function zc(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Uc(t,e,n){zc.call(this,t,e),this.meshPerAttribute=n||1}function Dc(t,e,n){bn.call(this,t,e),this.meshPerAttribute=n||1}function kc(t,e,n,r){this.ray=new Jn(t,e),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Fc(t,e){return t.distance-e.distance}function Bc(t,e,n,r){if(!1!==t.visible&&(t.raycast(e,n),!0===r))for(var i=t.children,a=0,o=i.length;a<o;a++)Bc(i[a],e,n,!0)}function jc(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Hc(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function Gc(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}function Vc(t,e){this.min=void 0!==t?t:new Le(1/0,1/0),this.max=void 0!==e?e:new Le(-1/0,-1/0)}function Wc(t){dn.call(this),this.material=t,this.render=function(){}}function qc(t,e,n,r){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==n?n:16711680,a=void 0!==r?r:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=3*s.faces.length:s&&s.isBufferGeometry&&(o=s.attributes.normal.count);var c=new In,l=new Ln(2*o*3,3);c.addAttribute("position",l),Ji.call(this,c,new Yi({color:i,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function Xc(t,e){dn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var n=new In,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,a=1;i<32;i++,a++){var o=i/32*Math.PI*2,s=a/32*Math.PI*2;r.push(Math.cos(o),Math.sin(o),1,Math.cos(s),Math.sin(s),1)}n.addAttribute("position",new Ln(r,3));var c=new Yi({fog:!1});this.cone=new Ji(n,c),this.add(this.cone),this.update()}function Yc(t){for(var e=function t(e){var n=[];e&&e.isBone&&n.push(e);for(var r=0;r<e.children.length;r++)n.push.apply(n,t(e.children[r]));return n}(t),n=new In,r=[],i=[],a=new tn(0,0,1),o=new tn(0,1,0),s=0;s<e.length;s++){var c=e[s];c.parent&&c.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}n.addAttribute("position",new Ln(r,3)),n.addAttribute("color",new Ln(i,3));var l=new Yi({vertexColors:m,depthTest:!1,depthWrite:!1,transparent:!0});Ji.call(this,n,l),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function Zc(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n;var r=new $a(e,4,2),i=new Yn({wireframe:!0,fog:!1});$n.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Jc(t,e){dn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;var n=new Yi({fog:!1}),r=new In;r.addAttribute("position",new bn(new Float32Array(15),3)),this.line=new Zi(r,n),this.add(this.line),this.update()}function Qc(t,e,n){dn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new fa(e);r.rotateY(.5*Math.PI),this.material=new Yn({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=m);var i=r.getAttribute("position"),a=new Float32Array(3*i.count);r.addAttribute("color",new bn(a,3)),this.add(new $n(r,this.material)),this.update()}function Kc(t,e,n,r){t=t||10,e=e||10,n=new tn(void 0!==n?n:4473924),r=new tn(void 0!==r?r:8947848);for(var i=e/2,a=t/e,o=t/2,s=[],c=[],l=0,u=0,h=-o;l<=e;l++,h+=a){s.push(-o,0,h,o,0,h),s.push(h,0,-o,h,0,o);var f=l===i?n:r;f.toArray(c,u),u+=3,f.toArray(c,u),u+=3,f.toArray(c,u),u+=3,f.toArray(c,u),u+=3}var d=new In;d.addAttribute("position",new Ln(s,3)),d.addAttribute("color",new Ln(c,3));var p=new Yi({vertexColors:m});Ji.call(this,d,p)}function $c(t,e,n,r,i,a){t=t||10,e=e||16,n=n||8,r=r||64,i=new tn(void 0!==i?i:4473924),a=new tn(void 0!==a?a:8947848);var o,s,c,l,u,h,f,d=[],p=[];for(l=0;l<=e;l++)c=l/e*(2*Math.PI),o=Math.sin(c)*t,s=Math.cos(c)*t,d.push(0,0,0),d.push(o,0,s),f=1&l?i:a,p.push(f.r,f.g,f.b),p.push(f.r,f.g,f.b);for(l=0;l<=n;l++)for(f=1&l?i:a,h=t-t/n*l,u=0;u<r;u++)c=u/r*(2*Math.PI),o=Math.sin(c)*h,s=Math.cos(c)*h,d.push(o,0,s),p.push(f.r,f.g,f.b),c=(u+1)/r*(2*Math.PI),o=Math.sin(c)*h,s=Math.cos(c)*h,d.push(o,0,s),p.push(f.r,f.g,f.b);var v=new In;v.addAttribute("position",new Ln(d,3)),v.addAttribute("color",new Ln(p,3));var g=new Yi({vertexColors:m});Ji.call(this,v,g)}function tl(t,e,n,r){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==n?n:16776960,a=void 0!==r?r:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var c=new In,l=new Ln(2*o*3,3);c.addAttribute("position",l),Ji.call(this,c,new Yi({color:i,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function el(t,e,n){dn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);var r=new In;r.addAttribute("position",new Ln([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new Yi({fog:!1});this.lightPlane=new Zi(r,i),this.add(this.lightPlane),(r=new In).addAttribute("position",new Ln([0,0,0,0,0,1],3)),this.targetLine=new Zi(r,i),this.add(this.targetLine),this.update()}function nl(t){var e=new In,n=new Yi({color:16777215,vertexColors:p}),r=[],i=[],a={},o=new tn(16755200),s=new tn(16711680),c=new tn(43775),l=new tn(16777215),u=new tn(3355443);function h(t,e,n){f(t,n),f(e,n)}function f(t,e){r.push(0,0,0),i.push(e.r,e.g,e.b),void 0===a[t]&&(a[t]=[]),a[t].push(r.length/3-1)}h("n1","n2",o),h("n2","n4",o),h("n4","n3",o),h("n3","n1",o),h("f1","f2",o),h("f2","f4",o),h("f4","f3",o),h("f3","f1",o),h("n1","f1",o),h("n2","f2",o),h("n3","f3",o),h("n4","f4",o),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",c),h("u2","u3",c),h("u3","u1",c),h("c","t",l),h("p","c",u),h("cn1","cn2",u),h("cn3","cn4",u),h("cf1","cf2",u),h("cf3","cf4",u),e.addAttribute("position",new Ln(r,3)),e.addAttribute("color",new Ln(i,3)),Ji.call(this,e,n),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function rl(t,e){this.object=t,void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new In;i.setIndex(new bn(n,1)),i.addAttribute("position",new bn(r,3)),Ji.call(this,i,new Yi({color:e})),this.matrixAutoUpdate=!1,this.update()}function il(t,e){this.type="Box3Helper",this.box=t;var n=void 0!==e?e:16776960,r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new In;i.setIndex(new bn(r,1)),i.addAttribute("position",new Ln([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Ji.call(this,i,new Yi({color:n})),this.geometry.computeBoundingSphere()}function al(t,e,n){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var r=void 0!==n?n:16776960,i=new In;i.addAttribute("position",new Ln([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),Zi.call(this,i,new Yi({color:r}));var a=new In;a.addAttribute("position",new Ln([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new $n(a,new Yn({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}function ol(t,e,n,r,i,a){dn.call(this),void 0===r&&(r=16776960),void 0===n&&(n=1),void 0===i&&(i=.2*n),void 0===a&&(a=.2*i),void 0===Mc&&((Mc=new In).addAttribute("position",new Ln([0,0,0,0,1,0],3)),(Ec=new lo(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new Zi(Mc,new Yi({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new $n(Ec,new Yn({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,a)}function sl(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new In;n.addAttribute("position",new Ln(e,3)),n.addAttribute("color",new Ln([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new Yi({vertexColors:m});Ji.call(this,n,r)}Object.assign(Ac.prototype,{getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),e.PropertyBinding=Rc,Object.assign(Rc,{Composite:Ac,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new Rc.Composite(t,e,n):new Rc(t,e,n)},sanitizeNodeName:(wc=new RegExp("[\\[\\]\\.:\\/]","g"),function(t){return t.replace(/\s/g,"_").replace(wc,"")}),parseTrackName:(pc="[^\\[\\]\\.:\\/]",mc="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",vc=/((?:WC+[\/:])*)/.source.replace("WC",pc),gc=/(WCOD+)?/.source.replace("WCOD",mc),yc=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",pc),_c=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",pc),xc=new RegExp("^"+vc+gc+yc+_c+"$"),bc=["material","materials","bones"],function(t){var e=xc.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==bc.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}),findNode:function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e)return i;var a=r(i.children);if(a)return a}return null},i=r(t.children);if(i)return i}return null}}),Object.assign(Rc.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=Rc.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var a=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var o=0;o<t.length;o++)if(t[o].name===a){a=o;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==a){if(void 0===t[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[a]}}var s=t[r];if(void 0!==s){var c=this.Versioning.None;void 0!==t.needsUpdate?(c=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var l=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(t.geometry.morphAttributes.position[o].name===i){i=o;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(t.geometry.morphTargets[o].name===i){i=o;break}}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}else{var u=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+r+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Rc.prototype,{_getValue_unbound:Rc.prototype.getValue,_setValue_unbound:Rc.prototype.setValue}),e.AnimationObjectGroup=Lc,Object.assign(Lc.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,c=void 0,l=0,u=arguments.length;l!==u;++l){var h=arguments[l],f=h.uuid,d=r[f];if(void 0===d){d=e++,r[f]=d,t.push(h);for(var p=0,m=s;p!==m;++p)o[p].push(new Rc(h,i[p],a[p]))}else if(d<n){c=t[d];var v=--n,g=t[v];r[g.uuid]=d,t[d]=g,r[f]=v,t[v]=h;for(p=0,m=s;p!==m;++p){var y=o[p],_=y[v],x=y[d];y[d]=_,void 0===x&&(x=new Rc(h,i[p],a[p])),y[v]=x}}else t[d]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],c=s.uuid,l=n[c];if(void 0!==l&&l>=e){var u=e++,h=t[u];n[h.uuid]=l,t[l]=h,n[c]=u,t[u]=s;for(var f=0,d=i;f!==d;++f){var p=r[f],m=p[u],v=p[l];p[l]=m,p[u]=v}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,a=i.length,o=0,s=arguments.length;o!==s;++o){var c=arguments[o].uuid,l=r[c];if(void 0!==l)if(delete r[c],l<n){var u=--n,h=t[u],f=t[g=--e];r[h.uuid]=l,t[l]=h,r[f.uuid]=u,t[u]=f,t.pop();for(var d=0,p=a;d!==p;++d){var m=(y=i[d])[u],v=y[g];y[l]=m,y[u]=v,y.pop()}}else{var g;r[(f=t[g=--e]).uuid]=l,t[l]=f,t.pop();for(d=0,p=a;d!==p;++d){var y;(y=i[d])[l]=y[g],y.pop()}}}this.nCachedObjects_=n},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,r=n[t],i=this._bindings;if(void 0!==r)return i[r];var a=this._paths,o=this._parsedPaths,s=this._objects,c=s.length,l=this.nCachedObjects_,u=new Array(c);r=i.length,n[t]=r,a.push(t),o.push(e),i.push(u);for(var h=l,f=s.length;h!==f;++h){var d=s[h];u[h]=new Rc(d,t,e)}return u},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];e[t[o]]=n,a[n]=s,a.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}}),Object.assign(Cc.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,a=i/r,o=r/i;t.warp(1,a,e),this.warp(o,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,c=a.sampleValues;return s[0]=i,s[1]=i+n,c[0]=t/o,c[1]=e/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var a=(t-i)*n;if(a<0||0===n)return;this._startTime=null,e=n*a}e*=this._updateTimeScale(t);var o=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var c=this._interpolants,l=this._propertyBindings,u=0,h=c.length;u!==h;++u)c[u].evaluate(o),l[u].accumulate(r,s)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var n=this._clip.duration,r=this.loop,i=this._loopCount;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{var a=2202===r;if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),e>=n||e<0){var o=Math.floor(e/n);e-=n*o,i+=Math.abs(o);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){var c=t<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}if(a&&1==(1&i))return this.time=e,n-e}return this.time=e,e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=t?this.zeroSlopeAtStart?2401:oe:2402,r.endingEnd=e?this.zeroSlopeAtEnd?2401:oe:2402)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=e,o[1]=i+t,s[1]=n,this}}),e.AnimationMixer=Pc,Pc.prototype=Object.assign(Object.create(r.prototype),{constructor:Pc,_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,a=t._propertyBindings,o=t._interpolants,s=n.uuid,c=this._bindingsByRootAndName,l=c[s];void 0===l&&(l={},c[s]=l);for(var u=0;u!==i;++u){var h=r[u],f=h.name,d=l[f];if(void 0!==d)a[u]=d;else{if(void 0!==(d=a[u])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,f));continue}var p=e&&e._propertyBindings[u].binding.parsedPath;++(d=new dc(Rc.create(n,f,p),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(d,s,f),a[u]=d}o[u].resultBuffer=d.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,a=i[e];if(void 0===a)a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=a;else{var o=a.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=r.length,r.push(t),a.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,c=s[s.length-1],l=t._byClipCacheIndex;c._byClipCacheIndex=l,s[l]=c,s.pop(),t._byClipCacheIndex=null,delete o.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],a=this._bindings;void 0===i&&(i={},r[e]=i),i[n]=t,t._cacheIndex=a.length,a.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=e[e.length-1],c=t._cacheIndex;s._cacheIndex=c,e[c]=s,e.pop(),delete o[i];t:{for(var l in o)break t;delete a[r]}},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new Ms(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?Rs.findByName(n,t):t,a=null!==i?i.uuid:t,o=this._actionsByClip[a],s=null;if(void 0!==o){var c=o.actionByRoot[r];if(void 0!==c)return c;s=o.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var l=new Cc(this,i,e);return this._bindAction(l,s),this._addInactiveAction(l,a,r),l},existingAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?Rs.findByName(n,t):t,a=i?i.uuid:t,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),a=this._accuIndex^=1,o=0;o!==n;++o){e[o]._update(r,t,i,a)}var s=this._bindings,c=this._nActiveBindings;for(o=0;o!==c;++o)s[o].apply(a);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var a=i.knownActions,o=0,s=a.length;o!==s;++o){var c=a[o];this._deactivateAction(c);var l=c._cacheIndex,u=e[e.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=l,e[l]=u,e.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[e];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),e.Uniform=Oc,Oc.prototype.clone=function(){return new Oc(void 0===this.value.clone?this.value:this.value.clone())},e.InstancedBufferGeometry=Nc,Nc.prototype=Object.assign(Object.create(In.prototype),{constructor:Nc,isInstancedBufferGeometry:!0,copy:function(t){return In.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),e.InterleavedBufferAttribute=Ic,Object.defineProperties(Ic.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Ic.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}}),e.InterleavedBuffer=zc,Object.defineProperty(zc.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(zc.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.stride:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),e.InstancedInterleavedBuffer=Uc,Uc.prototype=Object.assign(Object.create(zc.prototype),{constructor:Uc,isInstancedInterleavedBuffer:!0,copy:function(t){return zc.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),e.InstancedBufferAttribute=Dc,Dc.prototype=Object.assign(Object.create(bn.prototype),{constructor:Dc,isInstancedBufferAttribute:!0,copy:function(t){return bn.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),e.Raycaster=kc,Object.assign(kc.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,n){var r=n||[];return Bc(t,this,r,e),r.sort(Fc),r},intersectObjects:function(t,e,n){var r=n||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,a=t.length;i<a;i++)Bc(t[i],this,r,e);return r.sort(Fc),r}}),e.Clock=jc,Object.assign(jc.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}),e.Spherical=Hc,Object.assign(Hc.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(Re.clamp(t.y/this.radius,-1,1))),this}}),e.Cylindrical=Gc,Object.assign(Gc.prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}}),e.Box2=Vc,Object.assign(Vc.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new Le;return function(e,n){var r=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new Le),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new Le),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new Le),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new Le),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new Le;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),e.ImmediateRenderObject=Wc,Wc.prototype=Object.create(dn.prototype),Wc.prototype.constructor=Wc,Wc.prototype.isImmediateRenderObject=!0,e.VertexNormalsHelper=qc,qc.prototype=Object.create(Ji.prototype),qc.prototype.constructor=qc,qc.prototype.update=function(){var t=new Oe,e=new Oe,n=new Ne;return function(){var r=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,a=this.geometry.attributes.position,o=this.object.geometry;if(o&&o.isGeometry)for(var s=o.vertices,c=o.faces,l=0,u=0,h=c.length;u<h;u++)for(var f=c[u],d=0,p=f.vertexNormals.length;d<p;d++){var m=s[f[r[d]]],v=f.vertexNormals[d];t.copy(m).applyMatrix4(i),e.copy(v).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),a.setXYZ(l,t.x,t.y,t.z),l+=1,a.setXYZ(l,e.x,e.y,e.z),l+=1}else if(o&&o.isBufferGeometry){var g=o.attributes.position,y=o.attributes.normal;for(l=0,d=0,p=g.count;d<p;d++)t.set(g.getX(d),g.getY(d),g.getZ(d)).applyMatrix4(i),e.set(y.getX(d),y.getY(d),y.getZ(d)),e.applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),a.setXYZ(l,t.x,t.y,t.z),l+=1,a.setXYZ(l,e.x,e.y,e.z),l+=1}a.needsUpdate=!0}}(),e.SpotLightHelper=Xc,Xc.prototype=Object.create(dn.prototype),Xc.prototype.constructor=Xc,Xc.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Xc.prototype.update=function(){var t=new Oe,e=new Oe;return function(){this.light.updateMatrixWorld();var n=this.light.distance?this.light.distance:1e3,r=n*Math.tan(this.light.angle);this.cone.scale.set(r,r,n),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),e.SkeletonHelper=Yc,Yc.prototype=Object.create(Ji.prototype),Yc.prototype.constructor=Yc,Yc.prototype.updateMatrixWorld=function(){var t=new Oe,e=new Ce,n=new Ce;return function(r){var i=this.bones,a=this.geometry,o=a.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var s=0,c=0;s<i.length;s++){var l=i[s];l.parent&&l.parent.isBone&&(e.multiplyMatrices(n,l.matrixWorld),t.setFromMatrixPosition(e),o.setXYZ(c,t.x,t.y,t.z),e.multiplyMatrices(n,l.parent.matrixWorld),t.setFromMatrixPosition(e),o.setXYZ(c+1,t.x,t.y,t.z),c+=2)}a.getAttribute("position").needsUpdate=!0,dn.prototype.updateMatrixWorld.call(this,r)}}(),e.PointLightHelper=Zc,Zc.prototype=Object.create($n.prototype),Zc.prototype.constructor=Zc,Zc.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Zc.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},e.RectAreaLightHelper=Jc,Jc.prototype=Object.create(dn.prototype),Jc.prototype.constructor=Jc,Jc.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Jc.prototype.update=function(){var t=.5*this.light.width,e=.5*this.light.height,n=this.line.geometry.attributes.position,r=n.array;r[0]=t,r[1]=-e,r[2]=0,r[3]=t,r[4]=e,r[5]=0,r[6]=-t,r[7]=e,r[8]=0,r[9]=-t,r[10]=-e,r[11]=0,r[12]=t,r[13]=-e,r[14]=0,n.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},e.HemisphereLightHelper=Qc,Qc.prototype=Object.create(dn.prototype),Qc.prototype.constructor=Qc,Qc.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Qc.prototype.update=function(){var t=new Oe,e=new tn,n=new tn;return function(){var r=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=r.geometry.getAttribute("color");e.copy(this.light.color),n.copy(this.light.groundColor);for(var a=0,o=i.count;a<o;a++){var s=a<o/2?e:n;i.setXYZ(a,s.r,s.g,s.b)}i.needsUpdate=!0}r.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),e.GridHelper=Kc,Kc.prototype=Object.create(Ji.prototype),Kc.prototype.constructor=Kc,e.PolarGridHelper=$c,$c.prototype=Object.create(Ji.prototype),$c.prototype.constructor=$c,e.FaceNormalsHelper=tl,tl.prototype=Object.create(Ji.prototype),tl.prototype.constructor=tl,tl.prototype.update=function(){var t=new Oe,e=new Oe,n=new Ne;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var r=this.object.matrixWorld,i=this.geometry.attributes.position,a=this.object.geometry,o=a.vertices,s=a.faces,c=0,l=0,u=s.length;l<u;l++){var h=s[l],f=h.normal;t.copy(o[h.a]).add(o[h.b]).add(o[h.c]).divideScalar(3).applyMatrix4(r),e.copy(f).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),i.setXYZ(c,t.x,t.y,t.z),c+=1,i.setXYZ(c,e.x,e.y,e.z),c+=1}i.needsUpdate=!0}}(),e.DirectionalLightHelper=el,el.prototype=Object.create(dn.prototype),el.prototype.constructor=el,el.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},el.prototype.update=function(){var t=new Oe,e=new Oe,n=new Oe;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(e,t),this.lightPlane.lookAt(n),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(n),this.targetLine.scale.z=n.length()}}(),e.CameraHelper=nl,nl.prototype=Object.create(Ji.prototype),nl.prototype.constructor=nl,nl.prototype.update=function(){var t,e,n=new Oe,r=new pn;function i(i,a,o,s){n.set(a,o,s).unproject(r);var c=e[i];if(void 0!==c)for(var l=t.getAttribute("position"),u=0,h=c.length;u<h;u++)l.setXYZ(c[u],n.x,n.y,n.z)}return function(){t=this.geometry,e=this.pointMap;r.projectionMatrix.copy(this.camera.projectionMatrix),i("c",0,0,-1),i("t",0,0,1),i("n1",-1,-1,-1),i("n2",1,-1,-1),i("n3",-1,1,-1),i("n4",1,1,-1),i("f1",-1,-1,1),i("f2",1,-1,1),i("f3",-1,1,1),i("f4",1,1,1),i("u1",.7,1.1,-1),i("u2",-.7,1.1,-1),i("u3",0,2,-1),i("cf1",-1,0,1),i("cf2",1,0,1),i("cf3",0,-1,1),i("cf4",0,1,1),i("cn1",-1,0,-1),i("cn2",1,0,-1),i("cn3",0,-1,-1),i("cn4",0,1,-1),t.getAttribute("position").needsUpdate=!0}}(),e.BoxHelper=rl,rl.prototype=Object.create(Ji.prototype),rl.prototype.constructor=rl,rl.prototype.update=function(){var t=new qe;return function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&t.setFromObject(this.object),!t.isEmpty()){var n=t.min,r=t.max,i=this.geometry.attributes.position,a=i.array;a[0]=r.x,a[1]=r.y,a[2]=r.z,a[3]=n.x,a[4]=r.y,a[5]=r.z,a[6]=n.x,a[7]=n.y,a[8]=r.z,a[9]=r.x,a[10]=n.y,a[11]=r.z,a[12]=r.x,a[13]=r.y,a[14]=n.z,a[15]=n.x,a[16]=r.y,a[17]=n.z,a[18]=n.x,a[19]=n.y,a[20]=n.z,a[21]=r.x,a[22]=n.y,a[23]=n.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),rl.prototype.setFromObject=function(t){return this.object=t,this.update(),this},e.Box3Helper=il,il.prototype=Object.create(Ji.prototype),il.prototype.constructor=il,il.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),dn.prototype.updateMatrixWorld.call(this,t))},e.PlaneHelper=al,al.prototype=Object.create(Zi.prototype),al.prototype.constructor=al,al.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.lookAt(this.plane.normal),dn.prototype.updateMatrixWorld.call(this,t)},e.ArrowHelper=ol,ol.prototype=Object.create(dn.prototype),ol.prototype.constructor=ol,ol.prototype.setDirection=(Sc=new Oe,function(t){t.y>.99999?this.quaternion.set(0,0,0,1):t.y<-.99999?this.quaternion.set(1,0,0,0):(Sc.set(t.z,0,-t.x).normalize(),Tc=Math.acos(t.y),this.quaternion.setFromAxisAngle(Sc,Tc))}),ol.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},ol.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},e.AxesHelper=sl,sl.prototype=Object.create(Ji.prototype),sl.prototype.constructor=sl,e.Face4=function(t,e,n,r,i,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new vn(t,e,n,i,a,o)};e.LineStrip=0;function cl(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Vo.call(this,t),this.type="catmullrom",this.closed=!0}function ll(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Vo.call(this,t),this.type="catmullrom"}function ul(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Vo.call(this,t),this.type="catmullrom"}e.LinePieces=1,e.MeshFaceMaterial=function(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t},e.MultiMaterial=function(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t},e.PointCloud=function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new $i(t,e)},e.Particle=function(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Gi(t)},e.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new $i(t,e)},e.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ki(t)},e.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ki(t)},e.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ki(t)},e.Vertex=function(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Oe(t,e,n)},e.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new bn(t,e).setDynamic(!0)},e.Int8Attribute=function(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new wn(t,e)},e.Uint8Attribute=function(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Mn(t,e)},e.Uint8ClampedAttribute=function(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new En(t,e)},e.Int16Attribute=function(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Tn(t,e)},e.Uint16Attribute=function(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Sn(t,e)},e.Int32Attribute=function(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new An(t,e)},e.Uint32Attribute=function(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Rn(t,e)},e.Float32Attribute=function(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Ln(t,e)},e.Float64Attribute=function(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Cn(t,e)},Uo.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Uo.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(ns.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new xn,n=0,r=t.length;n<r;n++){var i=t[n];e.vertices.push(new Oe(i.x,i.y,i.z||0))}return e}}),Object.assign(rs.prototype,{fromPoints:function(t){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),e.ClosedSplineCurve3=cl,cl.prototype=Object.create(Vo.prototype),e.SplineCurve3=ll,ll.prototype=Object.create(Vo.prototype),e.Spline=ul,ul.prototype=Object.create(Vo.prototype),Object.assign(ul.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),e.AxisHelper=function(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new sl(t)},e.BoundingBoxHelper=function(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new rl(t,e)},e.EdgesHelper=function(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ji(new so(t.geometry),new Yi({color:void 0!==e?e:16777215}))},Kc.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Yc.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},e.WireframeHelper=function(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ji(new ia(t.geometry),new Yi({color:void 0!==e?e:16777215}))},Object.assign(Us.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Ds.extractUrlBase(t)}}),e.XHRLoader=function(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Co(t)},e.BinaryTextureLoader=function(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Oo(t)},Object.assign(Vc.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(qe.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Qn.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(Re,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Re.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Re.ceilPowerOfTwo(t)}}),Object.assign(Ne.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Ce.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new Oe),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,r,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,n,i,a)}}),Ye.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},Pe.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(Jn.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Kn.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(Kn,{barycoordFromPoint:function(t,e,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Kn.getBarycoord(t,e,n,r,i)},normal:function(t,e,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Kn.getNormal(t,e,n,r)}}),Object.assign(is.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ya(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new io(this,t)}}),Object.assign(Le.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Oe.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(He.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(xn.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(dn.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(dn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Vi.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Wi.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(Uo.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),zi.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(as.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(bn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(In.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(In.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Oc.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Xn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new tn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}}}),Object.defineProperties(xo.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Zn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(ki.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(ki.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Li.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Ge.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(Di.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),uc.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new oc).load(t,function(t){e.setBuffer(t)}),this},fc.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},cc.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};var hl={merge:function(t,e,n){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),r=e.matrix,e=e.geometry),t.merge(e,r,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}};e.GeometryUtils=hl;var fl={crossOrigin:void 0,loadTexture:function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new zo;i.setCrossOrigin(this.crossOrigin);var a=i.load(t,n,void 0,r);return e&&(a.mapping=e),a},loadTextureCube:function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Io;i.setCrossOrigin(this.crossOrigin);var a=i.load(t,n,void 0,r);return e&&(a.mapping=e),a},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};e.ImageUtils=fl,e.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},e.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}};var dl={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};e.SceneUtils=dl,e.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EPSILON=1e-6,e.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,e.RANDOM=Math.random,e.setMatrixArrayType=function(t){e.ARRAY_TYPE=t};const r=Math.PI/180;e.toRadian=function(t){return t*r},e.equals=function(t,n){return Math.abs(t-n)<=e.EPSILON*Math.max(1,Math.abs(t),Math.abs(n))}},function(t,e,n){var r;(function(){var n=this,i=n._,a=Array.prototype,o=Object.prototype,s=Function.prototype,c=a.push,l=a.slice,u=o.toString,h=o.hasOwnProperty,f=Array.isArray,d=Object.keys,p=s.bind,m=Object.create,v=function(){},g=function(t){return t instanceof g?t:this instanceof g?void(this._wrapped=t):new g(t)};t.exports&&(e=t.exports=g),e._=g,g.VERSION="1.8.3";var y=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,a){return t.call(e,n,r,i,a)}}return function(){return t.apply(e,arguments)}},_=function(t,e,n){return null==t?g.identity:g.isFunction(t)?y(t,e,n):g.isObject(t)?g.matcher(t):g.property(t)};g.iteratee=function(t,e){return _(t,e,1/0)};var x=function(t,e){return function(n){var r=arguments.length;if(r<2||null==n)return n;for(var i=1;i<r;i++)for(var a=arguments[i],o=t(a),s=o.length,c=0;c<s;c++){var l=o[c];e&&void 0!==n[l]||(n[l]=a[l])}return n}},b=function(t){if(!g.isObject(t))return{};if(m)return m(t);v.prototype=t;var e=new v;return v.prototype=null,e},w=function(t){return function(e){return null==e?void 0:e[t]}},M=Math.pow(2,53)-1,E=w("length"),T=function(t){var e=E(t);return"number"==typeof e&&e>=0&&e<=M};function S(t){return function(e,n,r,i){n=y(n,i,4);var a=!T(e)&&g.keys(e),o=(a||e).length,s=t>0?0:o-1;return arguments.length<3&&(r=e[a?a[s]:s],s+=t),function(e,n,r,i,a,o){for(;a>=0&&a<o;a+=t){var s=i?i[a]:a;r=n(r,e[s],s,e)}return r}(e,n,r,a,s,o)}}g.each=g.forEach=function(t,e,n){var r,i;if(e=y(e,n),T(t))for(r=0,i=t.length;r<i;r++)e(t[r],r,t);else{var a=g.keys(t);for(r=0,i=a.length;r<i;r++)e(t[a[r]],a[r],t)}return t},g.map=g.collect=function(t,e,n){e=_(e,n);for(var r=!T(t)&&g.keys(t),i=(r||t).length,a=Array(i),o=0;o<i;o++){var s=r?r[o]:o;a[o]=e(t[s],s,t)}return a},g.reduce=g.foldl=g.inject=S(1),g.reduceRight=g.foldr=S(-1),g.find=g.detect=function(t,e,n){var r;if(void 0!==(r=T(t)?g.findIndex(t,e,n):g.findKey(t,e,n))&&-1!==r)return t[r]},g.filter=g.select=function(t,e,n){var r=[];return e=_(e,n),g.each(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r},g.reject=function(t,e,n){return g.filter(t,g.negate(_(e)),n)},g.every=g.all=function(t,e,n){e=_(e,n);for(var r=!T(t)&&g.keys(t),i=(r||t).length,a=0;a<i;a++){var o=r?r[a]:a;if(!e(t[o],o,t))return!1}return!0},g.some=g.any=function(t,e,n){e=_(e,n);for(var r=!T(t)&&g.keys(t),i=(r||t).length,a=0;a<i;a++){var o=r?r[a]:a;if(e(t[o],o,t))return!0}return!1},g.contains=g.includes=g.include=function(t,e,n,r){return T(t)||(t=g.values(t)),("number"!=typeof n||r)&&(n=0),g.indexOf(t,e,n)>=0},g.invoke=function(t,e){var n=l.call(arguments,2),r=g.isFunction(e);return g.map(t,function(t){var i=r?e:t[e];return null==i?i:i.apply(t,n)})},g.pluck=function(t,e){return g.map(t,g.property(e))},g.where=function(t,e){return g.filter(t,g.matcher(e))},g.findWhere=function(t,e){return g.find(t,g.matcher(e))},g.max=function(t,e,n){var r,i,a=-1/0,o=-1/0;if(null==e&&null!=t)for(var s=0,c=(t=T(t)?t:g.values(t)).length;s<c;s++)(r=t[s])>a&&(a=r);else e=_(e,n),g.each(t,function(t,n,r){((i=e(t,n,r))>o||i===-1/0&&a===-1/0)&&(a=t,o=i)});return a},g.min=function(t,e,n){var r,i,a=1/0,o=1/0;if(null==e&&null!=t)for(var s=0,c=(t=T(t)?t:g.values(t)).length;s<c;s++)(r=t[s])<a&&(a=r);else e=_(e,n),g.each(t,function(t,n,r){((i=e(t,n,r))<o||i===1/0&&a===1/0)&&(a=t,o=i)});return a},g.shuffle=function(t){for(var e,n=T(t)?t:g.values(t),r=n.length,i=Array(r),a=0;a<r;a++)(e=g.random(0,a))!==a&&(i[a]=i[e]),i[e]=n[a];return i},g.sample=function(t,e,n){return null==e||n?(T(t)||(t=g.values(t)),t[g.random(t.length-1)]):g.shuffle(t).slice(0,Math.max(0,e))},g.sortBy=function(t,e,n){return e=_(e,n),g.pluck(g.map(t,function(t,n,r){return{value:t,index:n,criteria:e(t,n,r)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index}),"value")};var A=function(t){return function(e,n,r){var i={};return n=_(n,r),g.each(e,function(r,a){var o=n(r,a,e);t(i,r,o)}),i}};g.groupBy=A(function(t,e,n){g.has(t,n)?t[n].push(e):t[n]=[e]}),g.indexBy=A(function(t,e,n){t[n]=e}),g.countBy=A(function(t,e,n){g.has(t,n)?t[n]++:t[n]=1}),g.toArray=function(t){return t?g.isArray(t)?l.call(t):T(t)?g.map(t,g.identity):g.values(t):[]},g.size=function(t){return null==t?0:T(t)?t.length:g.keys(t).length},g.partition=function(t,e,n){e=_(e,n);var r=[],i=[];return g.each(t,function(t,n,a){(e(t,n,a)?r:i).push(t)}),[r,i]},g.first=g.head=g.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:g.initial(t,t.length-e)},g.initial=function(t,e,n){return l.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},g.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:g.rest(t,Math.max(0,t.length-e))},g.rest=g.tail=g.drop=function(t,e,n){return l.call(t,null==e||n?1:e)},g.compact=function(t){return g.filter(t,g.identity)};var R=function(t,e,n,r){for(var i=[],a=0,o=r||0,s=E(t);o<s;o++){var c=t[o];if(T(c)&&(g.isArray(c)||g.isArguments(c))){e||(c=R(c,e,n));var l=0,u=c.length;for(i.length+=u;l<u;)i[a++]=c[l++]}else n||(i[a++]=c)}return i};function L(t){return function(e,n,r){n=_(n,r);for(var i=E(e),a=t>0?0:i-1;a>=0&&a<i;a+=t)if(n(e[a],a,e))return a;return-1}}function C(t,e,n){return function(r,i,a){var o=0,s=E(r);if("number"==typeof a)t>0?o=a>=0?a:Math.max(a+s,o):s=a>=0?Math.min(a+1,s):a+s+1;else if(n&&a&&s)return r[a=n(r,i)]===i?a:-1;if(i!=i)return(a=e(l.call(r,o,s),g.isNaN))>=0?a+o:-1;for(a=t>0?o:s-1;a>=0&&a<s;a+=t)if(r[a]===i)return a;return-1}}g.flatten=function(t,e){return R(t,e,!1)},g.without=function(t){return g.difference(t,l.call(arguments,1))},g.uniq=g.unique=function(t,e,n,r){g.isBoolean(e)||(r=n,n=e,e=!1),null!=n&&(n=_(n,r));for(var i=[],a=[],o=0,s=E(t);o<s;o++){var c=t[o],l=n?n(c,o,t):c;e?(o&&a===l||i.push(c),a=l):n?g.contains(a,l)||(a.push(l),i.push(c)):g.contains(i,c)||i.push(c)}return i},g.union=function(){return g.uniq(R(arguments,!0,!0))},g.intersection=function(t){for(var e=[],n=arguments.length,r=0,i=E(t);r<i;r++){var a=t[r];if(!g.contains(e,a)){for(var o=1;o<n&&g.contains(arguments[o],a);o++);o===n&&e.push(a)}}return e},g.difference=function(t){var e=R(arguments,!0,!0,1);return g.filter(t,function(t){return!g.contains(e,t)})},g.zip=function(){return g.unzip(arguments)},g.unzip=function(t){for(var e=t&&g.max(t,E).length||0,n=Array(e),r=0;r<e;r++)n[r]=g.pluck(t,r);return n},g.object=function(t,e){for(var n={},r=0,i=E(t);r<i;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},g.findIndex=L(1),g.findLastIndex=L(-1),g.sortedIndex=function(t,e,n,r){for(var i=(n=_(n,r,1))(e),a=0,o=E(t);a<o;){var s=Math.floor((a+o)/2);n(t[s])<i?a=s+1:o=s}return a},g.indexOf=C(1,g.findIndex,g.sortedIndex),g.lastIndexOf=C(-1,g.findLastIndex),g.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var r=Math.max(Math.ceil((e-t)/n),0),i=Array(r),a=0;a<r;a++,t+=n)i[a]=t;return i};var P=function(t,e,n,r,i){if(!(r instanceof e))return t.apply(n,i);var a=b(t.prototype),o=t.apply(a,i);return g.isObject(o)?o:a};g.bind=function(t,e){if(p&&t.bind===p)return p.apply(t,l.call(arguments,1));if(!g.isFunction(t))throw new TypeError("Bind must be called on a function");var n=l.call(arguments,2),r=function(){return P(t,r,e,this,n.concat(l.call(arguments)))};return r},g.partial=function(t){var e=l.call(arguments,1),n=function(){for(var r=0,i=e.length,a=Array(i),o=0;o<i;o++)a[o]=e[o]===g?arguments[r++]:e[o];for(;r<arguments.length;)a.push(arguments[r++]);return P(t,n,this,this,a)};return n},g.bindAll=function(t){var e,n,r=arguments.length;if(r<=1)throw new Error("bindAll must be passed function names");for(e=1;e<r;e++)t[n=arguments[e]]=g.bind(t[n],t);return t},g.memoize=function(t,e){var n=function(r){var i=n.cache,a=""+(e?e.apply(this,arguments):r);return g.has(i,a)||(i[a]=t.apply(this,arguments)),i[a]};return n.cache={},n},g.delay=function(t,e){var n=l.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},g.defer=g.partial(g.delay,g,1),g.throttle=function(t,e,n){var r,i,a,o=null,s=0;n||(n={});var c=function(){s=!1===n.leading?0:g.now(),o=null,a=t.apply(r,i),o||(r=i=null)};return function(){var l=g.now();s||!1!==n.leading||(s=l);var u=e-(l-s);return r=this,i=arguments,u<=0||u>e?(o&&(clearTimeout(o),o=null),s=l,a=t.apply(r,i),o||(r=i=null)):o||!1===n.trailing||(o=setTimeout(c,u)),a}},g.debounce=function(t,e,n){var r,i,a,o,s,c=function(){var l=g.now()-o;l<e&&l>=0?r=setTimeout(c,e-l):(r=null,n||(s=t.apply(a,i),r||(a=i=null)))};return function(){a=this,i=arguments,o=g.now();var l=n&&!r;return r||(r=setTimeout(c,e)),l&&(s=t.apply(a,i),a=i=null),s}},g.wrap=function(t,e){return g.partial(e,t)},g.negate=function(t){return function(){return!t.apply(this,arguments)}},g.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},g.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},g.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},g.once=g.partial(g.before,2);var O=!{toString:null}.propertyIsEnumerable("toString"),N=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function I(t,e){var n=N.length,r=t.constructor,i=g.isFunction(r)&&r.prototype||o,a="constructor";for(g.has(t,a)&&!g.contains(e,a)&&e.push(a);n--;)(a=N[n])in t&&t[a]!==i[a]&&!g.contains(e,a)&&e.push(a)}g.keys=function(t){if(!g.isObject(t))return[];if(d)return d(t);var e=[];for(var n in t)g.has(t,n)&&e.push(n);return O&&I(t,e),e},g.allKeys=function(t){if(!g.isObject(t))return[];var e=[];for(var n in t)e.push(n);return O&&I(t,e),e},g.values=function(t){for(var e=g.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t[e[i]];return r},g.mapObject=function(t,e,n){e=_(e,n);for(var r,i=g.keys(t),a=i.length,o={},s=0;s<a;s++)o[r=i[s]]=e(t[r],r,t);return o},g.pairs=function(t){for(var e=g.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=[e[i],t[e[i]]];return r},g.invert=function(t){for(var e={},n=g.keys(t),r=0,i=n.length;r<i;r++)e[t[n[r]]]=n[r];return e},g.functions=g.methods=function(t){var e=[];for(var n in t)g.isFunction(t[n])&&e.push(n);return e.sort()},g.extend=x(g.allKeys),g.extendOwn=g.assign=x(g.keys),g.findKey=function(t,e,n){e=_(e,n);for(var r,i=g.keys(t),a=0,o=i.length;a<o;a++)if(e(t[r=i[a]],r,t))return r},g.pick=function(t,e,n){var r,i,a={},o=t;if(null==o)return a;g.isFunction(e)?(i=g.allKeys(o),r=y(e,n)):(i=R(arguments,!1,!1,1),r=function(t,e,n){return e in n},o=Object(o));for(var s=0,c=i.length;s<c;s++){var l=i[s],u=o[l];r(u,l,o)&&(a[l]=u)}return a},g.omit=function(t,e,n){if(g.isFunction(e))e=g.negate(e);else{var r=g.map(R(arguments,!1,!1,1),String);e=function(t,e){return!g.contains(r,e)}}return g.pick(t,e,n)},g.defaults=x(g.allKeys,!0),g.create=function(t,e){var n=b(t);return e&&g.extendOwn(n,e),n},g.clone=function(t){return g.isObject(t)?g.isArray(t)?t.slice():g.extend({},t):t},g.tap=function(t,e){return e(t),t},g.isMatch=function(t,e){var n=g.keys(e),r=n.length;if(null==t)return!r;for(var i=Object(t),a=0;a<r;a++){var o=n[a];if(e[o]!==i[o]||!(o in i))return!1}return!0};var z=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof g&&(t=t._wrapped),e instanceof g&&(e=e._wrapped);var i=u.call(t);if(i!==u.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}var a="[object Array]"===i;if(!a){if("object"!=typeof t||"object"!=typeof e)return!1;var o=t.constructor,s=e.constructor;if(o!==s&&!(g.isFunction(o)&&o instanceof o&&g.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1}r=r||[];for(var c=(n=n||[]).length;c--;)if(n[c]===t)return r[c]===e;if(n.push(t),r.push(e),a){if((c=t.length)!==e.length)return!1;for(;c--;)if(!z(t[c],e[c],n,r))return!1}else{var l,h=g.keys(t);if(c=h.length,g.keys(e).length!==c)return!1;for(;c--;)if(l=h[c],!g.has(e,l)||!z(t[l],e[l],n,r))return!1}return n.pop(),r.pop(),!0};g.isEqual=function(t,e){return z(t,e)},g.isEmpty=function(t){return null==t||(T(t)&&(g.isArray(t)||g.isString(t)||g.isArguments(t))?0===t.length:0===g.keys(t).length)},g.isElement=function(t){return!(!t||1!==t.nodeType)},g.isArray=f||function(t){return"[object Array]"===u.call(t)},g.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},g.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){g["is"+t]=function(e){return u.call(e)==="[object "+t+"]"}}),g.isArguments(arguments)||(g.isArguments=function(t){return g.has(t,"callee")}),"object"!=typeof Int8Array&&(g.isFunction=function(t){return"function"==typeof t||!1}),g.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},g.isNaN=function(t){return g.isNumber(t)&&t!==+t},g.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===u.call(t)},g.isNull=function(t){return null===t},g.isUndefined=function(t){return void 0===t},g.has=function(t,e){return null!=t&&h.call(t,e)},g.noConflict=function(){return n._=i,this},g.identity=function(t){return t},g.constant=function(t){return function(){return t}},g.noop=function(){},g.property=w,g.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},g.matcher=g.matches=function(t){return t=g.extendOwn({},t),function(e){return g.isMatch(e,t)}},g.times=function(t,e,n){var r=Array(Math.max(0,t));e=y(e,n,1);for(var i=0;i<t;i++)r[i]=e(i);return r},g.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},g.now=Date.now||function(){return(new Date).getTime()};var U={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},D=g.invert(U),k=function(t){var e=function(e){return t[e]},n="(?:"+g.keys(t).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(i,e):t}};g.escape=k(U),g.unescape=k(D),g.result=function(t,e,n){var r=null==t?void 0:t[e];return void 0===r&&(r=n),g.isFunction(r)?r.call(t):r};var F=0;g.uniqueId=function(t){var e=++F+"";return t?t+e:e},g.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,j={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},H=/\\|'|\r|\n|\u2028|\u2029/g,G=function(t){return"\\"+j[t]};g.template=function(t,e,n){!e&&n&&(e=n),e=g.defaults({},e,g.templateSettings);var r=RegExp([(e.escape||B).source,(e.interpolate||B).source,(e.evaluate||B).source].join("|")+"|$","g"),i=0,a="__p+='";t.replace(r,function(e,n,r,o,s){return a+=t.slice(i,s).replace(H,G),i=s+e.length,n?a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?a+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(a+="';\n"+o+"\n__p+='"),e}),a+="';\n",e.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var o=new Function(e.variable||"obj","_",a)}catch(t){throw t.source=a,t}var s=function(t){return o.call(this,t,g)},c=e.variable||"obj";return s.source="function("+c+"){\n"+a+"}",s},g.chain=function(t){var e=g(t);return e._chain=!0,e};var V=function(t,e){return t._chain?g(e).chain():e};g.mixin=function(t){g.each(g.functions(t),function(e){var n=g[e]=t[e];g.prototype[e]=function(){var t=[this._wrapped];return c.apply(t,arguments),V(this,n.apply(g,t))}})},g.mixin(g),g.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=a[t];g.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],V(this,n)}}),g.each(["concat","join","slice"],function(t){var e=a[t];g.prototype[t]=function(){return V(this,e.apply(this._wrapped,arguments))}}),g.prototype.value=function(){return this._wrapped},g.prototype.valueOf=g.prototype.toJSON=g.prototype.value,g.prototype.toString=function(){return""+this._wrapped},void 0===(r=function(){return g}.apply(e,[]))||(t.exports=r)}).call(this)},function(e,n){e.exports=t},function(t,e,n){var r=n(3),i=(n(0),n(1)),a=n(4),o=n(7);var s={int8:Int8Array,int16:Int16Array,int32:Int32Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,float32:Float32Array,float64:Float64Array},c={Int8Array:"int8",Int16Array:"int16",Int32Array:"int32",Uint8Array:"uint8",Uint16Array:"uint16",Uint32Array:"uint32",Float32Array:"float32",Float64Array:"float64"};function l(t,e){var n=s[t.dtype];return null==t&&console.log("data is null"),t.data||console.log("data.data is null"),t.data.buffer||console.log("data.data.buffer is null"),new n(t.data.buffer)}function u(t,e){if(null==t)return null;var n=null;return r.isNumber(t)?t:((n=r.map(t,function(t){return l(t)})).original_data=t,n)}function h(t,e){if(null==t)return null;var n=null;function a(t){for(var e=new Float32Array(3*t.length),n=0;n<t.length;n++){var r=new i.Color(t[n]);e[3*n+0]=r.r,e[3*n+1]=r.g,e[3*n+2]=r.b}return e}return"string"==typeof t?n=t:void 0!==t[0].dtype?n=r.map(t,function(t){return l(t)}):1==dimension&&"string"==typeof t[0]?n=a(t):2==dimension&&"string"==typeof t[0][0]?n=r.map(t,a):console.error("don't understand color type"),n.original_data=t,n}function f(t,e){return r.isNumber(t)?t:null!=t?void 0===t.original_data?t:t.original_data:null}window.ndarray=o,t.exports={texture:{deserialize:function(t,e){return"string"==typeof t&&t.startsWith("IPY_MODEL_")?a.unpack_models(t,e):t},serialize:function(t,e){return t}},serialize_array_or_json:f,deserialize_array_or_json:u,deserialize_color_or_json:h,array_or_json:{deserialize:u,serialize:f},color_or_json:{deserialize:h,serialize:f},ndarray:{deserialize:function(t,e){return null===t?null:o(l(t),t.shape)},serialize:function(t,e){if(null===t)return null;var i=t;r.isArray(t)&&!t.data&&(i=n(14)(t));return{data:i.data.buffer,dtype:c[i.data.constructor.name],shape:i.shape}}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);e.textAlign={center:new r.Vector2(0,0),left:new r.Vector2(1,0),topLeft:new r.Vector2(1,-1),topRight:new r.Vector2(-1,-1),right:new r.Vector2(-1,0),bottomLeft:new r.Vector2(1,1),bottomRight:new r.Vector2(-1,1)};var i={};e.getFontHeight=function(t){var e=i[t];if(!e){var n=document.getElementsByTagName("body")[0],r=document.createElement("div"),a=document.createTextNode("Mq");r.appendChild(a),r.setAttribute("style","font:"+t+";position:absolute;top:0;left:0"),n.appendChild(r),e=r.offsetHeight,i[t]=e,n.removeChild(r)}return e}},function(t,e,n){var r=n(40),i=n(41),a="undefined"!=typeof Float64Array;function o(t,e){return t[0]-e[0]}function s(){var t,e=this.stride,n=new Array(e.length);for(t=0;t<n.length;++t)n[t]=[Math.abs(e[t]),t];n.sort(o);var r=new Array(n.length);for(t=0;t<r.length;++t)r[t]=n[t][1];return r}function c(t,e){var n=["View",e,"d",t].join("");e<0&&(n="View_Nil"+t);var i="generic"===t;if(-1===e){var a="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+t+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}";return new Function(a)()}if(0===e){a="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+t+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(i?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(i?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}";return new Function("TrivialArray",a)(l[t][0])}a=["'use strict'"];var o=r(e),c=o.map(function(t){return"i"+t}),u="this.offset+"+o.map(function(t){return"this.stride["+t+"]*i"+t}).join("+"),h=o.map(function(t){return"b"+t}).join(","),f=o.map(function(t){return"c"+t}).join(",");a.push("function "+n+"(a,"+h+","+f+",d){this.data=a","this.shape=["+h+"]","this.stride=["+f+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+t+"'","proto.dimension="+e),a.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+o.map(function(t){return"this.shape["+t+"]"}).join("*"),"}})"),1===e?a.push("proto.order=[0]"):(a.push("Object.defineProperty(proto,'order',{get:"),e<4?(a.push("function "+n+"_order(){"),2===e?a.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&a.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):a.push("ORDER})")),a.push("proto.set=function "+n+"_set("+c.join(",")+",v){"),i?a.push("return this.data.set("+u+",v)}"):a.push("return this.data["+u+"]=v}"),a.push("proto.get=function "+n+"_get("+c.join(",")+"){"),i?a.push("return this.data.get("+u+")}"):a.push("return this.data["+u+"]}"),a.push("proto.index=function "+n+"_index(",c.join(),"){return "+u+"}"),a.push("proto.hi=function "+n+"_hi("+c.join(",")+"){return new "+n+"(this.data,"+o.map(function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")}).join(",")+","+o.map(function(t){return"this.stride["+t+"]"}).join(",")+",this.offset)}");var d=o.map(function(t){return"a"+t+"=this.shape["+t+"]"}),p=o.map(function(t){return"c"+t+"=this.stride["+t+"]"});a.push("proto.lo=function "+n+"_lo("+c.join(",")+"){var b=this.offset,d=0,"+d.join(",")+","+p.join(","));for(var m=0;m<e;++m)a.push("if(typeof i"+m+"==='number'&&i"+m+">=0){d=i"+m+"|0;b+=c"+m+"*d;a"+m+"-=d}");a.push("return new "+n+"(this.data,"+o.map(function(t){return"a"+t}).join(",")+","+o.map(function(t){return"c"+t}).join(",")+",b)}"),a.push("proto.step=function "+n+"_step("+c.join(",")+"){var "+o.map(function(t){return"a"+t+"=this.shape["+t+"]"}).join(",")+","+o.map(function(t){return"b"+t+"=this.stride["+t+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(m=0;m<e;++m)a.push("if(typeof i"+m+"==='number'){d=i"+m+"|0;if(d<0){c+=b"+m+"*(a"+m+"-1);a"+m+"=ceil(-a"+m+"/d)}else{a"+m+"=ceil(a"+m+"/d)}b"+m+"*=d}");a.push("return new "+n+"(this.data,"+o.map(function(t){return"a"+t}).join(",")+","+o.map(function(t){return"b"+t}).join(",")+",c)}");var v=new Array(e),g=new Array(e);for(m=0;m<e;++m)v[m]="a[i"+m+"]",g[m]="b[i"+m+"]";a.push("proto.transpose=function "+n+"_transpose("+c+"){"+c.map(function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+v.join(",")+","+g.join(",")+",this.offset)}"),a.push("proto.pick=function "+n+"_pick("+c+"){var a=[],b=[],c=this.offset");for(m=0;m<e;++m)a.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");return a.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),a.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+o.map(function(t){return"shape["+t+"]"}).join(",")+","+o.map(function(t){return"stride["+t+"]"}).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",a.join("\n"))(l[t],s)}var l={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=function(t,e,n,r){if(void 0===t)return(0,l.array[0])([]);"number"==typeof t&&(t=[t]),void 0===e&&(e=[t.length]);var o=e.length;if(void 0===n){n=new Array(o);for(var s=o-1,u=1;s>=0;--s)n[s]=u,u*=e[s]}if(void 0===r)for(r=0,s=0;s<o;++s)n[s]<0&&(r-=(e[s]-1)*n[s]);for(var h=function(t){if(i(t))return"buffer";if(a)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(t)?"array":"generic"}(t),f=l[h];f.length<=o+1;)f.push(c(h,f.length-1));return(0,f[o+1])(t,e,n,r)}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),o=n(6),s=n(22),c=function(t){function e(e,n){void 0===e&&(e=""),void 0===n&&(n={});var r=t.call(this)||this;return r._font=n.font||"30px Arial",r._fillStyle=n.fillStyle||"#FFFFFF",r._shadowColor=n.shadowColor||"rgba(0, 0, 0, 0)",r._shadowBlur=n.shadowBlur||0,r._shadowOffsetX=n.shadowOffsetX||0,r._shadowOffsetY=n.shadowOffsetY||0,r.canvas=new s.CanvasText,r.align=n.align||o.textAlign.center,r.side=n.side||a.DoubleSide,r.antialias=void 0===n.antialias||n.antialias,r.text=e,r}return i(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this.canvas.textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.canvas.textHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){this._text!==t&&(this._text=t,this.updateText())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"font",{get:function(){return this._font},set:function(t){this._font!==t&&(this._font=t,this.updateText())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillStyle",{get:function(){return this._fillStyle},set:function(t){this._fillStyle!==t&&(this._fillStyle=t,this.updateText())},enumerable:!0,configurable:!0}),e.prototype.cleanUp=function(){this.texture&&this.texture.dispose()},e.prototype.applyAntiAlias=function(){!1===this.antialias&&(this.texture.magFilter=a.NearestFilter,this.texture.minFilter=a.LinearMipMapLinearFilter)},e}(a.Object3D);e.Text2D=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2);function i(t,e,n){let r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=e[6],u=e[7],h=e[8],f=n[0],d=n[1],p=n[2],m=n[3],v=n[4],g=n[5],y=n[6],_=n[7],x=n[8];return t[0]=f*r+d*o+p*l,t[1]=f*i+d*s+p*u,t[2]=f*a+d*c+p*h,t[3]=m*r+v*o+g*l,t[4]=m*i+v*s+g*u,t[5]=m*a+v*c+g*h,t[6]=y*r+_*o+x*l,t[7]=y*i+_*s+x*u,t[8]=y*a+_*c+x*h,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}e.create=function(){let t=new r.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},e.clone=function(t){let e=new r.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromValues=function(t,e,n,i,a,o,s,c,l){let u=new r.ARRAY_TYPE(9);return u[0]=t,u[1]=e,u[2]=n,u[3]=i,u[4]=a,u[5]=o,u[6]=s,u[7]=c,u[8]=l,u},e.set=function(t,e,n,r,i,a,o,s,c,l){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=c,t[8]=l,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,e){if(t===e){let n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},e.invert=function(t,e){let n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],l=e[7],u=e[8],h=u*o-s*l,f=-u*a+s*c,d=l*a-o*c,p=n*h+r*f+i*d;return p?(p=1/p,t[0]=h*p,t[1]=(-u*r+i*l)*p,t[2]=(s*r-i*o)*p,t[3]=f*p,t[4]=(u*n-i*c)*p,t[5]=(-s*n+i*a)*p,t[6]=d*p,t[7]=(-l*n+r*c)*p,t[8]=(o*n-r*a)*p,t):null},e.adjoint=function(t,e){let n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],l=e[7],u=e[8];return t[0]=o*u-s*l,t[1]=i*l-r*u,t[2]=r*s-i*o,t[3]=s*c-a*u,t[4]=n*u-i*c,t[5]=i*a-n*s,t[6]=a*l-o*c,t[7]=r*c-n*l,t[8]=n*o-r*a,t},e.determinant=function(t){let e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],c=t[7],l=t[8];return e*(l*a-o*c)+n*(-l*i+o*s)+r*(c*i-a*s)},e.multiply=i,e.translate=function(t,e,n){let r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=e[6],u=e[7],h=e[8],f=n[0],d=n[1];return t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=c,t[6]=f*r+d*o+l,t[7]=f*i+d*s+u,t[8]=f*a+d*c+h,t},e.rotate=function(t,e,n){let r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=e[6],u=e[7],h=e[8],f=Math.sin(n),d=Math.cos(n);return t[0]=d*r+f*o,t[1]=d*i+f*s,t[2]=d*a+f*c,t[3]=d*o-f*r,t[4]=d*s-f*i,t[5]=d*c-f*a,t[6]=l,t[7]=u,t[8]=h,t},e.scale=function(t,e,n){let r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},e.fromRotation=function(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},e.fromQuat=function(t,e){let n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,c=i+i,l=n*o,u=r*o,h=r*s,f=i*o,d=i*s,p=i*c,m=a*o,v=a*s,g=a*c;return t[0]=1-h-p,t[3]=u-g,t[6]=f+v,t[1]=u+g,t[4]=1-l-p,t[7]=d-m,t[2]=f-v,t[5]=d+m,t[8]=1-l-h,t},e.normalFromMat4=function(t,e){let n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],l=e[7],u=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],v=e[14],g=e[15],y=n*s-r*o,_=n*c-i*o,x=n*l-a*o,b=r*c-i*s,w=r*l-a*s,M=i*l-a*c,E=u*m-h*p,T=u*v-f*p,S=u*g-d*p,A=h*v-f*m,R=h*g-d*m,L=f*g-d*v,C=y*L-_*R+x*A+b*S-w*T+M*E;return C?(C=1/C,t[0]=(s*L-c*R+l*A)*C,t[1]=(c*S-o*L-l*T)*C,t[2]=(o*R-s*S+l*E)*C,t[3]=(i*R-r*L-a*A)*C,t[4]=(n*L-i*S+a*T)*C,t[5]=(r*S-n*R-a*E)*C,t[6]=(m*M-v*w+g*b)*C,t[7]=(v*x-p*M-g*_)*C,t[8]=(p*w-m*x+g*y)*C,t):null},e.projection=function(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},e.subtract=a,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},e.equals=function(t,e){let n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=t[6],u=t[7],h=t[8],f=e[0],d=e[1],p=e[2],m=e[3],v=e[4],g=e[5],y=e[6],_=e[7],x=e[8];return Math.abs(n-f)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(i-d)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-p)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-m)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-v)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(c-g)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(l-y)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(u-_)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(h-x)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(x))},e.mul=i,e.sub=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2);function i(){let t=new r.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t}function a(t){let e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function o(t,e,n){let i=new r.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=n,i}function s(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function c(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function l(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function u(t,e){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function h(t,e){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function f(t){let e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function d(t,e){let n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a),t}function p(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}e.create=i,e.clone=function(t){var e=new r.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.length=a,e.fromValues=o,e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},e.subtract=s,e.multiply=c,e.divide=l,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},e.distance=u,e.squaredDistance=h,e.squaredLength=f,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},e.normalize=d,e.dot=p,e.cross=function(t,e,n){let r=e[0],i=e[1],a=e[2],o=n[0],s=n[1],c=n[2];return t[0]=i*c-a*s,t[1]=a*o-r*c,t[2]=r*s-i*o,t},e.lerp=function(t,e,n,r){let i=e[0],a=e[1],o=e[2];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=o+r*(n[2]-o),t},e.hermite=function(t,e,n,r,i,a){let o=a*a,s=o*(2*a-3)+1,c=o*(a-2)+a,l=o*(a-1),u=o*(3-2*a);return t[0]=e[0]*s+n[0]*c+r[0]*l+i[0]*u,t[1]=e[1]*s+n[1]*c+r[1]*l+i[1]*u,t[2]=e[2]*s+n[2]*c+r[2]*l+i[2]*u,t},e.bezier=function(t,e,n,r,i,a){let o=1-a,s=o*o,c=a*a,l=s*o,u=3*a*s,h=3*c*o,f=c*a;return t[0]=e[0]*l+n[0]*u+r[0]*h+i[0]*f,t[1]=e[1]*l+n[1]*u+r[1]*h+i[1]*f,t[2]=e[2]*l+n[2]*u+r[2]*h+i[2]*f,t},e.random=function(t,e){e=e||1;let n=2*r.RANDOM()*Math.PI,i=2*r.RANDOM()-1,a=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*a,t[1]=Math.sin(n)*a,t[2]=i*e,t},e.transformMat4=function(t,e,n){let r=e[0],i=e[1],a=e[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,t},e.transformMat3=function(t,e,n){let r=e[0],i=e[1],a=e[2];return t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8],t},e.transformQuat=function(t,e,n){let r=e[0],i=e[1],a=e[2],o=n[0],s=n[1],c=n[2],l=n[3],u=l*r+s*a-c*i,h=l*i+c*r-o*a,f=l*a+o*i-s*r,d=-o*r-s*i-c*a;return t[0]=u*l+d*-o+h*-c-f*-s,t[1]=h*l+d*-s+f*-o-u*-c,t[2]=f*l+d*-c+u*-s-h*-o,t},e.rotateX=function(t,e,n,r){let i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t},e.rotateY=function(t,e,n,r){let i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t},e.rotateZ=function(t,e,n,r){let i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t},e.angle=function(t,e){let n=o(t[0],t[1],t[2]),r=o(e[0],e[1],e[2]);d(n,n),d(r,r);let i=p(n,r);return i>1?0:i<-1?Math.PI:Math.acos(i)},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},e.equals=function(t,e){let n=t[0],i=t[1],a=t[2],o=e[0],s=e[1],c=e[2];return Math.abs(n-o)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(a-c)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))},e.sub=s,e.mul=c,e.div=l,e.dist=u,e.sqrDist=h,e.len=a,e.sqrLen=f,e.forEach=function(){let t=i();return function(e,n,r,i,a,o){let s,c;for(n||(n=3),r||(r=0),c=i?Math.min(i*n+r,e.length):e.length,s=r;s<c;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2);function i(){let t=new r.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function o(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function s(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function c(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function l(t,e){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+a*a)}function u(t,e){let n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return n*n+r*r+i*i+a*a}function h(t){let e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)}function f(t){let e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function d(t,e){let n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=a*o),t}e.create=i,e.clone=function(t){let e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.fromValues=function(t,e,n,i){let a=new r.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=i,a},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=a,e.multiply=o,e.divide=s,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},e.scale=c,e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},e.distance=l,e.squaredDistance=u,e.length=h,e.squaredLength=f,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},e.normalize=d,e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},e.lerp=function(t,e,n,r){let i=e[0],a=e[1],o=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=o+r*(n[2]-o),t[3]=s+r*(n[3]-s),t},e.random=function(t,e){return e=e||1,t[0]=r.RANDOM(),t[1]=r.RANDOM(),t[2]=r.RANDOM(),t[3]=r.RANDOM(),d(t,t),c(t,t,e),t},e.transformMat4=function(t,e,n){let r=e[0],i=e[1],a=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,t},e.transformQuat=function(t,e,n){let r=e[0],i=e[1],a=e[2],o=n[0],s=n[1],c=n[2],l=n[3],u=l*r+s*a-c*i,h=l*i+c*r-o*a,f=l*a+o*i-s*r,d=-o*r-s*i-c*a;return t[0]=u*l+d*-o+h*-c-f*-s,t[1]=h*l+d*-s+f*-o-u*-c,t[2]=f*l+d*-c+u*-s-h*-o,t[3]=e[3],t},e.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){let n=t[0],i=t[1],a=t[2],o=t[3],s=e[0],c=e[1],l=e[2],u=e[3];return Math.abs(n-s)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-c)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-l)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(o-u)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))},e.sub=a,e.mul=o,e.div=s,e.dist=l,e.sqrDist=u,e.len=h,e.sqrLen=f,e.forEach=function(){let t=i();return function(e,n,r,i,a,o){let s,c;for(n||(n=4),r||(r=0),c=i?Math.min(i*n+r,e.length):e.length,s=r;s<c;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}()},function(t){t.exports={name:"ipyvolume",version:"0.5.2",description:"IPython widget for rendering 3d volumes",author:"Maarten A. Breddels",main:"lib/index.js",repository:{type:"git",url:"https://github.com/maartenbreddels/ipyvolume.git"},keywords:["jupyter","widgets","ipython","ipywidgets"],scripts:{prepublish:"webpack ","install-test":"npm install && karma start --single-run",test:"karma start --single-run","build:lib":"tsc --project .",prepare:"npm run build:lib",watch:"npm-run-all -p watch:*","watch:lib":"tsc -w --project .","watch:nbextension":"webpack --watch"},jupyterlab:{extension:"lib/labplugin"},devDependencies:{"@types/chai":"^4.1.4","@types/expect.js":"^0.3.29","@types/mocha":"^2.2.41","@types/requirejs":"^2.1.31","@types/three":"^0.92.4","babel-loader":"7.1.1","babel-preset-es2015":"^6.24.1","babel-preset-es2015-without-strict":"0.0.4","cache-loader":"^1.2.2",chai:"^4.1.2","json-loader":"^0.5.4",karma:"^2.0.5","karma-chai":"^0.1.0","karma-chrome-launcher":"^2.0.0","karma-mocha":"^1.3.0","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.7","karma-typescript":"^3.0.12","karma-typescript-es6-transform":"^1.0.4","karma-webpack":"^2.0.3",mocha:"^3.5.3","npm-run-all":"^4.1.3","raw-loader":"^0.5.1",sinon:"^2.4.1","sinon-chai":"^2.11.0","thread-loader":"^1.2.0","ts-loader":"^4.4.2",typescript:"~3.0.0","url-loader":"^0.5.7",webpack:"^4.16.1","webpack-cli":"^3.0.8"},dependencies:{"@jupyter-widgets/base":"^1.0.0 || ^2.0.0","css-loader":"^0.28.4",d3:"~4.6.0","gl-matrix":"^2.0.0","is-typedarray":"~1.0.0",jquery:"^3.1.1",mustache:"^2.3.1",ndarray:"~1.0.18","ndarray-pack":"^1.2.1",screenfull:"^3.3.1","style-loader":"^0.18.2",three:"^0.91.0","three-text2d":"~0.4.1",underscore:"^1.8.3"},files:["dist/","css/","src/","lib/","data/","glsl/"]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(4),a=n(1),o=n(5);const s=n(15);var c=n(0).semver_range,l=n(47),u=n(0).shader_fix,h=i.WidgetView.extend({render:function(){this.renderer=this.options.parent,this.previous_values={},this.attributes_changed={},window.last_scatter=this,this.texture_loader=new a.TextureLoader,this.textures=null,this.model.get("texture")&&this._load_textures(),this.geo_diamond=new a.SphereGeometry(1,2,2),this.geo_sphere=new a.SphereGeometry(.5,12,12),this.geo_box=new a.BoxGeometry(1,1,1),this.geo_cat=new a.Geometry;for(var t=0;t<l.vertices.length;t++){var e=new a.Vector3(l.vertices[t][1],l.vertices[t][2],l.vertices[t][0]);this.geo_cat.vertices.push(e)}for(t=0;t<l.indices.length;){for(var n=[],r=0,i=!1;!i;)n.push(l.indices[t]),r++,l.indices[t]<0&&(i=!0),t++;n[r-1]=-1-n[r-1];for(var o=0;o<n.length-2;o++){var s=new a.Face3(n[0],n[1+o],n[2+o]);this.geo_cat.faces.push(s)}}this.geo_square_2d=new a.PlaneGeometry(2,2,1,1),this.geo_point_2d=new a.PlaneGeometry(.1,.1,1,1),this.geo_triangle_2d=new a.CircleGeometry(1,3,Math.PI/2),this.geo_circle_2d=new a.CircleGeometry(1,32,Math.PI/2),this.geo_arrow=new a.CylinderGeometry(0,.2,1),this.geos={diamond:this.geo_diamond,box:this.geo_box,arrow:this.geo_arrow,sphere:this.geo_sphere,cat:this.geo_cat,square_2d:this.geo_square_2d,point_2d:this.geo_point_2d,circle_2d:this.geo_circle_2d,triangle_2d:this.geo_triangle_2d},this.uniforms={xlim:{type:"2f",value:[0,1]},ylim:{type:"2f",value:[0,1]},zlim:{type:"2f",value:[0,1]},animation_time_x:{type:"f",value:1},animation_time_y:{type:"f",value:1},animation_time_z:{type:"f",value:1},animation_time_vx:{type:"f",value:1},animation_time_vy:{type:"f",value:1},animation_time_vz:{type:"f",value:1},animation_time_size:{type:"f",value:1},animation_time_color:{type:"f",value:1},texture:{type:"t",value:null},texture_previous:{type:"t",value:null}},this.material=this.model.get("material").obj.clone(),this.material_rgb=this.model.get("material").obj.clone(),this.line_material=this.model.get("line_material").obj.clone(),this.line_material_rgb=this.model.get("line_material").obj.clone(),this.materials=[this.material,this.material_rgb,this.line_material,this.line_material_rgb],this._update_materials(),this.model.get("material").on("change",()=>{this._update_materials(),this.renderer.update()}),this.model.get("line_material").on("change",()=>{this._update_materials(),this.renderer.update()}),this.create_mesh(),this.add_to_scene(),this.model.on("change:size change:size_selected change:color change:color_selected change:sequence_index change:x change:y change:z change:selected change:vx change:vy change:vz",this.on_change,this),this.model.on("change:geo change:connected",this.update_,this),this.model.on("change:texture",this._load_textures,this),this.model.on("change:visible",this.update_visibility,this),this.model.on("change:geo",()=>{this._update_materials(),this.renderer.update()})},_load_textures:function(){var t=this.model.get("texture");t.stream?(this.textures=null,this.texture_video=document.createElement("video"),t.stream.then(r.bind(function(t){this.texture_video.src=window.URL.createObjectURL(t);var e=new a.VideoTexture(this.texture_video);e.minFilter=a.LinearFilter,this.textures=[e],this.update_()},this))):this.textures=r.map(this.model.get("texture"),function(t){return this.texture_loader.load(t,r.bind(function(t){t.wrapS=a.RepeatWrapping,t.wrapT=a.RepeatWrapping,this.update_()},this))},this)},update_visibility:function(){this._update_materials(),this.renderer.update()},set_limits:function(t){r.mapObject(t,function(t,e){this.material.uniforms[e].value=t},this)},add_to_scene:function(){this.renderer.scene_scatter.add(this.mesh),this.line_segments&&this.renderer.scene_scatter.add(this.line_segments)},remove_from_scene:function(){-1==this.renderer.scene_scatter.children.indexOf(this.mesh)&&console.warn("trying to removing scatter mesh from scene that does not include it"),this.renderer.scene_scatter.remove(this.mesh),this.mesh.geometry.dispose(),this.line_segments&&(this.renderer.scene_scatter.remove(this.line_segments),this.line_segments.geometry.dispose())},on_change:function(t){r.mapObject(this.model.changedAttributes(),function(t,e){this.previous_values[e]=this.model.previous(e);var n=e.replace("_selected","");if("sequence_index"==n){r.each(["x","y","z","vx","vy","vz","size","color"],function(t){r.isArray(this.model.get(t))&&(this.attributes_changed[t]=[t,"sequence_index"])},this)}else"geo"==n||("selected"==n?(this.attributes_changed.color=[e],this.attributes_changed.size=[]):(this.attributes_changed[n]=[e],-1!=["x","y","z","vx","vy","vz","color"].indexOf(n)&&(this.attributes_changed.size=[])))},this),this.update_()},update_:function(){this.remove_from_scene(),this.create_mesh(),this.add_to_scene(),this.renderer.update()},_get_value:function(t,e,n){n=n;return t?r.isArray(t)&&!r.isNumber(t[0])?t[e%t.length]:t:n},get_current:function(t,e,n){return this._get_value(this.model.get(t),e,n)},get_previous:function(t,e,n){return this._get_value(this.previous_values[t]||this.model.get(t),e,n)},_get_value_vec3:function(t,e,n){n=n;return t?r.isArray(t)?t[e%t.length]:t:n},get_current_vec3:function(t,e,n){return this._get_value_vec3(this.model.get(t),e,n)},get_previous_vec3:function(t,e,n){return this._get_value_vec3(this.previous_values[t]||this.model.get(t),e,n)},_update_materials:function(){this.material.copy(this.model.get("material").obj),this.material_rgb.copy(this.model.get("material").obj),this.line_material.copy(this.model.get("line_material").obj),this.line_material_rgb.copy(this.model.get("line_material").obj),this.line_material_rgb.linewidth=this.line_material.linewidth=this.model.get("line_material").obj.linewidth,this.material.extensions={derivatives:!0},this.material_rgb.defines={USE_RGB:!0},this.material_rgb.extensions={derivatives:!0},this.line_material.defines={AS_LINE:!0},this.line_material_rgb.defines={USE_RGB:!0,AS_LINE:!0},this.material.visible=this.material.visible&&this.model.get("visible"),this.material_rgb.visible=this.material.visible&&this.model.get("visible"),this.line_material.visible=this.line_material.visible&&this.model.get("visible"),this.line_material_rgb.visible=this.line_material.visible&&this.model.get("visible"),this.materials.forEach(t=>{t.vertexShader=u(n(48)),t.fragmentShader=u(n(49)),t.uniforms=r.extend({},t.uniforms,this.uniforms),t.depthWrite=!0,t.transparant=!0,t.depthTest=!0,t.needsUpdate=!0});var t=this.model.get("geo").endsWith("2d");(t&&(this.material.defines.USE_SPRITE=!0,this.material_rgb.defines.USE_SPRITE=!0),t)&&(this.model.get("texture")&&this.textures&&(this.material.defines.USE_TEXTURE=!0));this.material.needsUpdate=!0,this.material_rgb.needsUpdate=!0,this.line_material.needsUpdate=!0,this.line_material_rgb.needsUpdate=!0},create_mesh:function(){var t=this.model.get("geo");t||(t="diamond");var e=t.endsWith("2d"),n=(new a.BufferGeometry).fromGeometry(this.geos[t]),i=new a.InstancedBufferGeometry,o=n.attributes.position.clone();i.addAttribute("position",o);var c=this.model.get("sequence_index"),l=this.previous_values.sequence_index;void 0===l&&(l=c);var u=["x","y","z","vx","vy","vz","size","size_selected"],h=["color","color_selected"],f=new s.Values(u,[],r.bind(this.get_current,this),c,h),d=new s.Values(u,[],r.bind(this.get_previous,this),l,h);0==Math.max(f.length,d.length)&&console.error("no single member is an array, not supported (yet?)"),f.trim(f.length),d.trim(d.length);var p=d.length,m=f.length;if(this.model.get("selected")||this.previous_values.selected){f.ensure_array(["size","size_selected","color","color_selected"]),d.ensure_array(["size","size_selected","color","color_selected"]);var v=this.get_current("selected",c,[]);f.select(v);v=this.get_previous("selected",l,[]);d.select(v)}(f.length!=d.length&&(f.ensure_array("size"),d.ensure_array("size")),f.length>d.length?(d.pad(f),d.array.size.fill(0,p)):f.length<d.length&&(f.pad(d),f.array.size.fill(0,m)),f.merge_to_vec3(["vx","vy","vz"],"v"),d.merge_to_vec3(["vx","vy","vz"],"v"),f.pop(["size_selected","color_selected"]),d.pop(["size_selected","color_selected"]),f.add_attributes(i),d.add_attributes(i,"_previous"),e)&&(this.model.get("texture")&&this.textures&&(this.material.uniforms.texture.value=this.textures[c%this.textures.length],this.material.uniforms.texture_previous.value=this.textures[l%this.textures.length]));if(this.mesh=new a.Mesh(i,this.material),this.mesh.material_rgb=this.material_rgb,this.mesh.material_normal=this.material,this.model.get("connected")){var g=new a.BufferGeometry;f.merge_to_vec3(["x","y","z"],"vertices"),d.merge_to_vec3(["x","y","z"],"vertices"),g.addAttribute("position",new a.BufferAttribute(f.array_vec3.vertices,3)),g.addAttribute("position_previous",new a.BufferAttribute(d.array_vec3.vertices,3)),f.ensure_array(["color"]),d.ensure_array(["color"]),g.addAttribute("color",new a.BufferAttribute(f.array_vec4.color,4)),g.addAttribute("color_previous",new a.BufferAttribute(d.array_vec4.color,4)),this.line_segments=new a.Line(g,this.line_material),this.line_segments.frustumCulled=!1}else this.line_segments=null;r.mapObject(this.attributes_changed,function(t,e){var n="animation_time_"+e;this.renderer.transition(function(t){this.material.uniforms[n].value=t},function(){r.each(t,function(t){delete this.previous_values[t]},this)},this)},this),this.attributes_changed={}}}),f=i.WidgetModel.extend({defaults:function(){return r.extend(i.WidgetModel.prototype.defaults(),{_model_name:"ScatterModel",_view_name:"ScatterView",_model_module:"ipyvolume",_view_module:"ipyvolume",_model_module_version:c,_view_module_version:c,size:5,size_selected:7,color:"red",color_selected:"white",geo:"diamond",sequence_index:0,connected:!1,visible:!0,selected:null})}},{serializers:r.extend({x:o.array_or_json,y:o.array_or_json,z:o.array_or_json,vx:o.array_or_json,vy:o.array_or_json,vz:o.array_or_json,selected:o.array_or_json,size:o.array_or_json,size_selected:o.array_or_json,color:o.color_or_json,color_selected:o.color_or_json,texture:o.texture,material:{deserialize:i.unpack_models},line_material:{deserialize:i.unpack_models}},i.WidgetModel.serializers)});t.exports={ScatterView:h,ScatterModel:f}},function(t,e,n){"use strict";var r=n(7),i=n(42);t.exports=function(t,e){for(var n=[],a=t,o=1;Array.isArray(a);)n.push(a.length),o*=a.length,a=a[0];return 0===n.length?r():(e||(e=r(new Float64Array(o),n)),i(e,t),e)}},function(t,e,n){"use strict";const r=n(3),i=n(1),a=n(0);class o{constructor(t,e,n,s,c){this.length=1/0,this.scalar={},this.scalar_vec3={},this.scalar_vec4={},this.array={},this.array_vec3={},this.array_vec4={},this.values={},this.trim=(t=>{this.array=r.mapObject(this.array,function(e){return e.length===t?e:e.slice(0,t)}),this.array_vec3=r.mapObject(this.array_vec3,function(e){return e.length===3*t?e:e.slice(0,3*t)}),this.array_vec4=r.mapObject(this.array_vec4,e=>e.length===4*t?e:e.slice(0,4*t)),this.length=t}),this.ensure_array=(t=>{let e=r.isArray(t)?t:[t];r.each(e,t=>{if(void 0!==this.scalar[t]){(this.array[t]=new Float32Array(this.length)).fill(this.scalar[t]),delete this.scalar[t],delete this.values[t]}let e=this.scalar_vec3[t],n=this.scalar_vec4[t];if(void 0!==e){let n=this.array_vec3[t]=new Float32Array(3*this.length);for(let t=0;t<this.length;t++)n[3*t+0]=e[0],n[3*t+1]=e[1],n[3*t+2]=e[2];delete this.scalar_vec3[t],delete this.values[t]}if(void 0!==n){this.array_vec4[t]=new Float32Array(4*this.length);let e=this.array_vec4[t];for(let t=0;t<this.length;t++)e[4*t+0]=n[0],e[4*t+1]=n[1],e[4*t+2]=n[2],e[4*t+3]=n[3];delete this.scalar_vec4[t],delete this.values[t]}})}),this.grow=(t=>{this.array=r.mapObject(this.array,e=>{let n=new e.constructor(t);return n.set(e),n}),this.array_vec3=r.mapObject(this.array_vec3,e=>{let n=new e.constructor(3*t);return n.set(e),n}),this.length=length}),this.pad=(t=>{this.array=r.mapObject(this.array,(e,n)=>{let r=new e.constructor(t.length);return void 0===t.array[n]?r.fill(t.scalar[n],this.length):r.set(t.array[n].slice(this.length),this.length),r.set(e),r}),this.array_vec3=r.mapObject(this.array_vec3,(e,n)=>{let r=new e.constructor(3*t.length);if(void 0===t.array_vec3[n]){let e=t.scalar_vec3[n];for(let n=this.length;n<t.length;n++)r[3*n+0]=e[0],r[3*n+1]=e[1],r[3*n+2]=e[2]}else r.set(t.array_vec3[n].slice(3*this.length),3*this.length);return r.set(e),r}),this.array_vec4=r.mapObject(this.array_vec4,(e,n)=>{let r=new e.constructor(4*t.length);if(void 0===t.array_vec4[n]){let e=t.scalar_vec4[n];for(let n=this.length;n<t.length;n++)r[4*n+0]=e[0],r[4*n+1]=e[1],r[4*n+2]=e[2],r[4*n+3]=e[3]}else r.set(t.array_vec4[n].slice(4*this.length),4*this.length);return r.set(e),r}),this.length=t.length}),this.select=(t=>{let e=this.array.size=this.array.size.slice(),n=this.array.size_selected,i=this.array_vec4.color=this.array_vec4.color.slice(),a=this.array_vec4.color_selected;r.each(t,t=>{t<this.length&&(e[t]=n[t],i[4*t+0]=a[4*t+0],i[4*t+1]=a[4*t+1],i[4*t+2]=a[4*t+2],i[4*t+3]=a[4*t+3])})}),this.merge_to_vec3=((t,e)=>{let n=t.length,i=new Float32Array(this.length*n);r.each(t,(t,e)=>{this.ensure_array(t);let r=this.array[t];for(let t=0;t<this.length;t++)i[t*n+e]=r[t];delete this.array[t],delete this.values[t]}),this.array_vec3[e]=i}),this.pop=(t=>{let e=r.isArray(t)?t:[t];r.each(e,t=>{r.each([this.scalar,this.scalar_vec3,this.array,this.array_vec3],e=>{void 0!==e[t]&&delete e[t]})})}),this.add_attributes=((t,e)=>{e=e||"",r.each(this.array,(n,r)=>{if(-1===r.indexOf("selected")){let a=new i.InstancedBufferAttribute(n,1,1);t.addAttribute(r+e,a)}}),r.each(this.array_vec3,(n,r)=>{if(-1===r.indexOf("selected")){let a=new i.InstancedBufferAttribute(n,3,1);a.normalized=-1!==r.indexOf("color"),t.addAttribute(r+e,a)}}),r.each(this.array_vec4,(n,r)=>{if(-1===r.indexOf("selected")){let a=new i.InstancedBufferAttribute(n,4,1);a.normalized=-1!==r.indexOf("color"),t.addAttribute(r+e,a)}}),r.each(this.scalar,(n,r)=>{if(-1===r.indexOf("selected")){let a=new i.InstancedBufferAttribute(new Float32Array([n]),1,this.length);t.addAttribute(r+e,a)}}),r.each(this.scalar_vec3,(n,r)=>{if(-1===r.indexOf("selected")){let a=new i.InstancedBufferAttribute(n,3,this.length);a.normalized=-1!=r.indexOf("color"),t.addAttribute(r+e,a)}}),r.each(this.scalar_vec4,(n,r)=>{if(-1===r.indexOf("selected")){let a=new i.InstancedBufferAttribute(n,4,this.length);a.normalized=-1!=r.indexOf("color"),t.addAttribute(r+e,a)}})}),r.each(t,t=>{let e=n(t,s,o.defaults[t]);a.is_typedarray(e)?("selected"!=t&&(this.length=Math.min(this.length,e.length)),this.array[t]=e):this.scalar[t]=e,this.values[t]=e}),r.each(e,t=>{let e=n(t,s,o.defaults[t]);if(-1!==t.indexOf("color")&&"string"==typeof e){let t=new i.Color(e);e=new Float32Array([t.r,t.g,t.b])}a.is_typedarray(e)&&e.length>3?(this.array_vec3[t]=e,this.length=Math.min(this.length,e.length/3)):this.scalar_vec3[t]=e,this.values[t]=e}),r.each(c,t=>{let e=n(t,s,o.defaults[t]);if(-1!==t.indexOf("color")&&"string"==typeof e){let t=new i.Color(e);e=new Float32Array([t.r,t.g,t.b,1])}a.is_typedarray(e)&&e.length>4?(this.array_vec4[t]=e,this.length=Math.min(this.length,e.length/4)):this.scalar_vec4[t]=e,this.values[t]=e})}}o.defaults={vx:0,vy:1,vz:0,x:0,y:0,z:0,size:0},t.exports={Values:o}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(4),a=n(1),o=n(5);const s=n(15);var c=n(0).semver_range,l=n(0).shader_fix,u=i.WidgetView.extend({render:function(){this.renderer=this.options.parent,this.previous_values={},this.attributes_changed={},window.last_mesh=this,this.meshes=[],this.texture_loader=new a.TextureLoader,this.textures=null,this.model.get("texture")&&this._load_textures(),this.uniforms={xlim:{type:"2f",value:[0,1]},ylim:{type:"2f",value:[0,1]},zlim:{type:"2f",value:[0,1]},animation_time_x:{type:"f",value:1},animation_time_y:{type:"f",value:1},animation_time_z:{type:"f",value:1},animation_time_u:{type:"f",value:1},animation_time_v:{type:"f",value:1},animation_time_color:{type:"f",value:1},animation_time_texture:{type:"f",value:1},texture:{type:"t",value:null},texture_previous:{type:"t",value:null}},this.material=this.model.get("material").obj.clone(),this.material_rgb=this.model.get("material").obj.clone(),this.line_material=this.model.get("line_material").obj.clone(),this.line_material_rgb=this.model.get("line_material").obj.clone(),this.materials=[this.material,this.material_rgb,this.line_material,this.line_material_rgb],this._update_materials(),this.model.get("material").on("change",()=>{this._update_materials(),this.renderer.update()}),this.model.get("line_material").on("change",()=>{this._update_materials(),this.renderer.update()}),this.create_mesh(),this.add_to_scene(),this.model.on("change:color change:sequence_index change:x change:y change:z change:v change:u change:triangles change:lines",this.on_change,this),this.model.on("change:geo change:connected",this.update_,this),this.model.on("change:texture",this._load_textures,this),this.model.on("change:visible",this.update_visibility,this)},update_visibility:function(){this._update_materials(),this.renderer.update()},_load_textures:function(){var t=this.model.get("texture");t.stream?(this.textures=null,this.texture_video=document.createElement("video"),t.stream.then(r.bind(function(t){this.texture_video.srcObject=t,this.texture_video.play();var e=new a.VideoTexture(this.texture_video);e.minFilter=a.LinearFilter,this.textures=[e],this._update_materials(),this.update_()},this))):this.textures=r.map(this.model.get("texture"),function(t){return this.texture_loader.load(t,r.bind(function(t){t.wrapS=a.RepeatWrapping,t.wrapT=a.RepeatWrapping,this._update_materials(),this.update_()},this))},this)},set_limits:function(t){r.mapObject(t,function(t,e){this.material.uniforms[e].value=t},this)},add_to_scene:function(){r.each(this.meshes,function(t){this.renderer.scene_scatter.add(t)},this)},remove_from_scene:function(){r.each(this.meshes,function(t){this.renderer.scene_scatter.remove(t),t.geometry.dispose()},this)},on_change:function(t){r.mapObject(this.model.changedAttributes(),function(t,e){this.previous_values[e]=this.model.previous(e);var n=e.replace("_selected","");if("sequence_index"==n){r.each(["x","y","z","u","v","color"],function(t){r.isArray(this.model.get(t))&&this.model.get(t).length>1&&(this.attributes_changed[t]=[t,"sequence_index"])},this),this.attributes_changed.texture=["texture","sequence_index"]}else"triangles"==n||"lines"==n||("selected"==n?this.attributes_changed.color=[e]:(this.attributes_changed[n]=[e],["x","y","z","u","v","color"].indexOf(n)))},this),this.update_()},update_:function(){this.remove_from_scene(),this.create_mesh(),this.add_to_scene(),this.renderer.update()},_get_value:function(t,e,n){n=n;if(!t)return n;if(r.isArray(t)&&!r.isNumber(t[0])){var i=e%t.length,a=t.original_data[i].shape[0];if(3===t.original_data[i].shape[1]&&r.isNumber(t[i][0])){for(var o=new Float32Array(4*a),s=t[i],c=0;c<a;c++)o[4*c]=s[3*c],o[4*c+1]=s[3*c+1],o[4*c+2]=s[3*c+2],o[4*c+3]=1;return o}return t[i]}return t},get_current:function(t,e,n){return this._get_value(this.model.get(t),e,n)},get_previous:function(t,e,n){return this._get_value(this.previous_values[t]||this.model.get(t),e,n)},_get_value_vec3:function(t,e,n){n=n;return t?r.isArray(t)?t[e%t.length]:t:n},get_current_vec3:function(t,e,n){return this._get_value_vec3(this.model.get(t),e,n)},get_previous_vec3:function(t,e,n){return this._get_value_vec3(this.previous_values[t]||this.model.get(t),e,n)},_update_materials:function(){this.material.copy(this.model.get("material").obj),this.material_rgb.copy(this.model.get("material").obj),this.line_material.copy(this.model.get("line_material").obj),this.line_material_rgb.copy(this.model.get("line_material").obj),this.material_rgb.defines={USE_RGB:!0},this.line_material.defines={AS_LINE:!0},this.line_material_rgb.defines={AS_LINE:!0,USE_RGB:!0},this.material.extensions={derivatives:!0},this.material.visible=this.material.visible&&this.model.get("visible"),this.material_rgb.visible=this.material.visible&&this.model.get("visible"),this.line_material.visible=this.line_material.visible&&this.model.get("visible"),this.line_material_rgb.visible=this.line_material.visible&&this.model.get("visible"),this.materials.forEach(t=>{t.vertexShader=l(n(50)),t.fragmentShader=l(n(51)),t.uniforms=this.uniforms,t.depthWrite=!0,t.transparant=!0,t.depthTest=!0}),this.model.get("texture")&&this.textures&&(this.material.defines.USE_TEXTURE=!0),this.material.needsUpdate=!0,this.material_rgb.needsUpdate=!0,this.line_material.needsUpdate=!0,this.line_material_rgb.needsUpdate=!0},create_mesh:function(){var t,e;this.meshes=[];var n,i,o=t=this.model.get("sequence_index"),c=e=o;void 0!==this.previous_values.sequence_index&&(c=e=this.previous_values.sequence_index),o>=c?(n=c-Math.floor(c),i=o-c,o=Math.ceil(o),(c=Math.floor(c))==e&&o==t||o-c>1&&(i=t-(c=o-1),n=0)):(n=Math.ceil(c)-c,i=c-o,o=Math.floor(o),(c=Math.ceil(c))==e&&o==t||c-o>1&&(n=0,i=(c=o+1)-t)),i>1&&0==(i%=1)&&(i=1),0==i&&(i=1);var l=["x","y","z","u","v"],u=["color"],h=new s.Values(l,[],r.bind(this.get_current,this),o,u),f=new s.Values(l,[],r.bind(this.get_previous,this),c,u);0==Math.max(h.length,f.length)&&console.error("no single member is an array, not supported (yet?)"),h.trim(h.length),f.trim(f.length);f.length,h.length;h.length>f.length?f.pad(h):h.length<f.length&&h.pad(f),h.merge_to_vec3(["x","y","z"],"vertices"),f.merge_to_vec3(["x","y","z"],"vertices"),h.ensure_array(["color"]),f.ensure_array(["color"]);var d=this.model.get("triangles");if(d){d=d[0],(b=new a.BufferGeometry).addAttribute("position",new a.BufferAttribute(h.array_vec3.vertices,3)),b.addAttribute("position_previous",new a.BufferAttribute(f.array_vec3.vertices,3)),b.addAttribute("color",new a.BufferAttribute(h.array_vec4.color,4)),b.addAttribute("color_previous",new a.BufferAttribute(f.array_vec4.color,4)),b.setIndex(new a.BufferAttribute(d,1));var p=this.model.get("texture"),m=h.array.u,v=h.array.v;if(p&&m&&v&&this.textures){var g=o;this.material.uniforms.texture.value=this.textures[g%this.textures.length],this.material.uniforms.texture_previous.value=this.textures[c%this.textures.length],b.addAttribute("u",new a.BufferAttribute(m,1)),b.addAttribute("v",new a.BufferAttribute(v,1));var y=f.array.u,_=f.array.v;b.addAttribute("u_previous",new a.BufferAttribute(y,1)),b.addAttribute("v_previous",new a.BufferAttribute(_,1))}this.surface_mesh=new a.Mesh(b,this.material),this.surface_mesh.frustumCulled=!1,this.surface_mesh.material_rgb=this.material_rgb,this.surface_mesh.material_normal=this.material,this.meshes.push(this.surface_mesh)}var x=this.model.get("lines");if(x){var b;(b=new a.BufferGeometry).addAttribute("position",new a.BufferAttribute(h.array_vec3.vertices,3)),b.addAttribute("position_previous",new a.BufferAttribute(f.array_vec3.vertices,3));var w=new a.BufferAttribute(h.array_vec4.color,4);w.normalized=!0,b.addAttribute("color",w);var M=new a.BufferAttribute(f.array_vec4.color,4);M.normalized=!0,b.addAttribute("color_previous",M);var E=new Uint32Array(x[0]);b.setIndex(new a.BufferAttribute(E,1)),this.line_segments=new a.LineSegments(b,this.line_material),this.line_segments.frustumCulled=!1,this.line_segments.material_rgb=this.line_material_rgb,this.line_segments.material_normal=this.line_material,this.meshes.push(this.line_segments)}else this.line_segments=null;r.mapObject(this.attributes_changed,function(t,e){var a="animation_time_"+e;this.renderer.transition(function(t){this.material.uniforms[a].value=n+i*t},function(){r.each(t,function(t){delete this.previous_values[t]},this)},this)},this),this.attributes_changed={}}}),h=i.WidgetModel.extend({defaults:function(){return r.extend(i.WidgetModel.prototype.defaults(),{_model_name:"MeshModel",_view_name:"MeshView",_model_module:"ipyvolume",_view_module:"ipyvolume",_model_module_version:c,_view_module_version:c,color:"red",sequence_index:0,connected:!1,visible:!0,visible_lines:!0,visible_faces:!0})}},{serializers:r.extend({x:o.array_or_json,y:o.array_or_json,z:o.array_or_json,u:o.array_or_json,v:o.array_or_json,triangles:o.array_or_json,lines:o.array_or_json,color:o.color_or_json,texture:o.texture,material:{deserialize:i.unpack_models},line_material:{deserialize:i.unpack_models}},i.WidgetModel.serializers)});t.exports={MeshView:u,MeshModel:h}},function(t,e,n){var r=n(3),i=n(4),a=n(1),o=(n(5),n(0).semver_range),s=n(0).shader_fix,c={};c.box_fragment=s(n(52)),c.box_vertex=s(n(53));var l=i.WidgetView.extend({render:function(){this.renderer=this.options.parent,this.attributes_changed={},this.data=[],window.last_volume_view=this;this.renderer.getRenderSize();this.vol_box_geo=new a.BoxBufferGeometry(1,1,1),this.box_material=new a.ShaderMaterial({uniforms:{offset:{type:"3f",value:[0,0,0]},scale:{type:"3f",value:[1,1,1]}},fragmentShader:c.box_fragment,vertexShader:c.box_vertex,side:a.BackSide}),this.vol_box_mesh=new a.Mesh(this.vol_box_geo,this.box_material),this.vol_box_mesh.updateMatrix(),this.vol_box_mesh.matrixAutoUpdate=!0,this.texture_loader=new a.TextureLoader,this.texture_tf=null,this.uniform_volumes_values={},this.uniform_data={type:"tv",value:[]},this.uniform_transfer_function={type:"tv",value:[]},this.tf_set(),this.data_set();var t=()=>{this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()};this.model.on("change:rendering_method",t),t(),this.add_to_scene(),this.model.on("change:data",this.data_set,this);var e=()=>{this.uniform_volumes_values.data_range=[this.model.get("data_min"),this.model.get("data_max")],this.uniform_volumes_values.show_range=[this.model.get("show_min"),this.model.get("show_max")],this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()};this.model.on("change:data_min change:data_max change:show_min change:show_max",e,this),e();var n=()=>{this.uniform_volumes_values.clamp_min=this.model.get("clamp_min"),this.uniform_volumes_values.clamp_max=this.model.get("clamp_max"),this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()};this.model.on("change:clamp_min change:clamp_max",n,this),n();var r=()=>{this.uniform_volumes_values.opacity_scale=this.model.get("opacity_scale"),this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()};r(),this.model.on("change:opacity_scale",r);var i=()=>{this.uniform_volumes_values.lighting=this.model.get("lighting"),this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()};i(),this.model.on("change:lighting",i);var o=()=>{this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()};o(),this.model.on("change:ray_steps",o);var s=()=>{this.uniform_volumes_values.brightness=this.model.get("brightness"),this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()};s(),this.model.on("change:brightness",s),this.model.on("change:tf",this.tf_set,this),this.model.on("change:extent",()=>{this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()}),window.last_volume=this},get_ray_steps:function(){var t=this.model.get("ray_steps");return null==t&&(t=r.max(this.data_shape)),t},is_max_intensity(){return"MAX_INTENSITY"==this.model.get("rendering_method")},is_normal(){return"NORMAL"==this.model.get("rendering_method")},data_set:function(){this.volume=this.model.get("data");var t=new Uint8Array(this.volume.tiles.buffer);this.texture_volume=new a.DataTexture(t,this.volume.image_shape[0],this.volume.image_shape[1],a.RGBAFormat,a.UnsignedByteType),this.texture_volume.magFilter=a.LinearFilter,this.texture_volume.minFilter=a.LinearFilter,this.uniform_volumes_values.rows=this.volume.rows,this.uniform_volumes_values.columns=this.volume.columns,this.uniform_volumes_values.slices=this.volume.slices,this.uniform_volumes_values.size=this.volume.image_shape,this.uniform_volumes_values.slice_size=this.volume.slice_shape,this.uniform_data.value=[this.texture_volume],this.uniform_data.value=[this.texture_volume],this.uniform_volumes_values.data_range=[this.model.get("data_min"),this.model.get("data_max")],this.uniform_volumes_values.show_range=[this.model.get("show_min"),this.model.get("show_max")],this.texture_volume.needsUpdate=!0,this.data_shape=[this.volume.slice_shape[0],this.volume.slice_shape[1],this.volume.slices],this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()},tf_set:function(){this.model.get("tf")&&(this.model.get("tf").on("change:rgba",this.tf_changed,this),this.tf_changed())},tf_changed:function(){var t=this.model.get("tf");t&&(this.texture_tf=new a.DataTexture(t.get_data_array(),t.get("rgba").shape[0],1,a.RGBAFormat,a.UnsignedByteType),this.texture_tf.needsUpdate=!0,this.uniform_transfer_function.value=[this.texture_tf]),this.renderer.rebuild_multivolume_rendering_material(),this.renderer.update()},set_limits:function(t){var e=t.xlim,n=t.ylim,r=t.zlim,i=e[1]-e[0],o=n[1]-n[0],s=r[1]-r[0],c=this.model.get("extent"),l=(c[0][0]-e[0])/i,u=(c[0][1]-e[0])/i,h=(c[1][0]-n[0])/o,f=(c[1][1]-n[0])/o,d=(c[2][0]-r[0])/s,p=(c[2][1]-r[0])/s,m=Math.max(l,0),v=Math.min(u,1),g=Math.max(h,0),y=Math.min(f,1),_=Math.max(d,0),x=Math.min(p,1);this.box_geo=new a.BoxBufferGeometry(1,1,1),this.box_geo.translate(.5,.5,.5),this.box_geo.scale(v-m,y-g,x-_),this.box_geo.translate(m,g,_),this.box_geo.translate(-.5,-.5,-.5),this.vol_box_mesh.geometry=this.box_geo,this.uniform_volumes_values.scale=[1/(u-l),1/(f-h),1/(p-d)],this.uniform_volumes_values.offset=[-l,-h,-d]},add_to_scene:function(){this.renderer.scene_volume.add(this.vol_box_mesh)},remove_from_scene:function(){this.renderer.scene_volume.remove(this.vol_box_mesh)}}),u=i.WidgetModel.extend({defaults:function(){return r.extend(i.WidgetModel.prototype.defaults(),{_model_name:"VolumeModel",_view_name:"VolumeView",_model_module:"ipyvolume",_view_module:"ipyvolume",_model_module_version:o,_view_module_version:o,sequence_index:0,step_size:.01,opacity_scale:1,brightness:1,extent:null,lighting:!0,rendering_method:"NORMAL",clamp_min:!1,clamp_max:!1,data_range:null,show_range:null,show_min:0,show_max:1,data_min:0,data_max:1,ray_steps:null})}},{serializers:r.extend({tf:{deserialize:i.unpack_models},data:{serialize:t=>t}},i.DOMWidgetModel.serializers)});t.exports={VolumeView:l,VolumeModel:u}},function(t,e,n){var r=n(3);t.exports=r.extend({},n(19),n(64),n(13),n(16),n(17),n(0)),t.exports.version=n(12).version},function(t,n,r){var i=r(4),a=r(3),o=r(1),s=r(20),c=(r(24),r(30)),l=r(31),u=r(32);r(33);var h=r(0).semver_range,f=r(0).shader_fix,d=r(39),p=r(13),m=r(16),v=r(17);window.THREE=o,r(54),r(55),r(56),r(57),r(58),r(59),ndarray=r(7);var g={};function y(t,e){return function(){var n=[this].concat([].slice.call(arguments));t.apply(e,n)}}g.screen_fragment=f(r(60)),g.screen_vertex=f(r(61)),g.volr_fragment=f(r(62)),g.volr_vertex=f(r(63));var _=function(t){var e=document.createElement("img");e.contentEditable=!0,e.src=t;var n=document.createElement("div");n.contentEditable=!0,n.appendChild(e),document.body.appendChild(n),function(t){if(document.body.createTextRange)(e=document.body.createTextRange()).moveToElementText(t),e.select();else if(window.getSelection){var e,n=window.getSelection();(e=document.createRange()).selectNodeContents(t),n.removeAllRanges(),n.addRange(e)}}(e),document.execCommand("Copy"),document.body.removeChild(n)},x=function(t,e){this.a=document.createElement("a"),this.a.className="ipyvolume-toolicon",this.a.setAttribute("href","javascript:void(0)"),this.li=document.createElement("li"),this.li.className="fa "+t,this.sub=document.createElement("div"),this.sub.className="ipyvolume-toolicon-dropdown-container",this.a.appendChild(this.li),this.a.appendChild(this.sub),e.appendChild(this.a),this.active=(t=>{t?this.li.classList.remove("fa-inactive"):this.li.classList.add("fa-inactive")})},b=function(t,e,n){this.a=document.createElement("a"),this.a.className="ipyvolume-toolicon-dropdown",this.a.setAttribute("href","javascript:void(0)"),this.li=document.createElement("li"),this.li.className="fa "+t,this.span_text=document.createElement("span"),this.span_text.innerText=n,this.a.appendChild(this.li),this.li.appendChild(this.span_text),e.appendChild(this.a),this.active=(t=>{t?this.a.classList.remove("ipyvolume-toolicon-inactive"):this.a.classList.add("ipyvolume-toolicon-inactive")})},w=function(t,e,n){return[t[0]/e*2-1,1-t[1]/n*2]},M={lasso:function(t){this.canvas=t,this.points=[],this.context=this.canvas.getContext("2d"),this.mouseMove=((t,e)=>{this.points.push([t,e])}),this.close=(()=>{this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}),this.draw=(()=>{this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.lineWidth=1.5,this.context.strokeStyle="rgba(255, 0, 0, 1)",this.context.fillStyle="rgba(255, 0, 0, 0.5)",this.context.beginPath();for(var t=0;t<this.points.length;t++)this.context.lineTo(this.points[t][0],this.points[t][1]);this.context.closePath(),this.context.fill(),this.context.stroke()}),this.getData=function(t,e){var n={type:"lasso"};return n.pixel=this.points,n.device=a.map(this.points,n=>w(n,t,e)),n}},circle:function(t){this.canvas=t,this.points=[],this.begin=null,this.end=null,this.mouseMove=((t,e)=>{this.begin?this.end=[t,e]:this.begin=[t,e]}),this.close=(()=>{ctx=this.canvas.getContext("2d"),ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.begin=null,this.end=null}),this.draw=(()=>{if(this.begin&&this.end){ctx=this.canvas.getContext("2d"),ctx.clearRect(0,0,this.canvas.width,this.canvas.height),ctx.lineWidth=1.5,ctx.strokeStyle="rgba(255, 0, 0, 1)",ctx.fillStyle="rgba(255, 0, 0, 0.5)",ctx.beginPath();var t=this.begin[0]-this.end[0],e=this.begin[1]-this.end[1],n=Math.sqrt(t*t+e*e);ctx.arc(this.begin[0],this.begin[1],n,0,2*Math.PI),ctx.fill(),ctx.stroke()}}),this.getData=function(t,e){var n={type:"circle"};return n.pixel={begin:this.begin,end:this.end},n.device={begin:w(this.begin,t,e),end:w(this.end,t,e)},n}},rectangle:function(t){this.canvas=t,this.points=[],this.begin=null,this.end=null,this.mouseMove=((t,e)=>{this.begin?this.end=[t,e]:this.begin=[t,e]}),this.close=(()=>{ctx=this.canvas.getContext("2d"),ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.begin=null,this.end=null}),this.draw=(()=>{this.begin&&this.end&&(ctx=this.canvas.getContext("2d"),ctx.clearRect(0,0,this.canvas.width,this.canvas.height),ctx.lineWidth=1.5,ctx.strokeStyle="rgba(255, 0, 0, 1)",ctx.fillStyle="rgba(255, 0, 0, 0.5)",ctx.beginPath(),ctx.rect(this.begin[0],this.begin[1],this.end[0]-this.begin[0],this.end[1]-this.begin[1]),ctx.fill(),ctx.stroke())}),this.getData=function(t,e){var n={type:"rectangle"};return n.pixel={begin:this.begin,end:this.end},n.device={begin:w(this.begin,t,e),end:w(this.end,t,e)},n}}},E=i.DOMWidgetView.extend({render:function(){this.transitions=[],this._update_requested=!1,this.update_counter=0;var t=this.model.get("width"),n=this.model.get("height");this.toolbar_div=document.createElement("div"),this.el.appendChild(this.toolbar_div);var r=a.bind(this._special_keys_down,this),i=a.bind(this._special_keys_up,this);document.addEventListener("keydown",r),document.addEventListener("keyup",i),this.once("remove",()=>{document.removeEventListener("keydown",r),document.removeEventListener("keyup",i)}),this.fullscreen_icon=new x("fa-arrows-alt",this.toolbar_div),this.fullscreen_icon.a.title="Fullscreen",this.fullscreen_icon.a.onclick=a.bind(function(){var t=this.renderer.domElement,e=t.style.width,n=t.style.height,r=a.bind(function(){l.isFullscreen?(t.style.width="100vw",t.style.height="100vh"):(t.style.width=e,t.style.height=n,l.off("change",r)),this.update_size()},this);l.onchange(r),l.request(t)},this),this.stereo_icon=new x("fa-eye",this.toolbar_div),this.stereo_icon.a.title="Stereoscopic view",this.stereo_icon.a.onclick=a.bind(function(){this.model.set("stereo",!this.model.get("stereo")),this.model.save_changes()},this),this.stereo_icon.active(this.model.get("stereo")),this.model.on("change:stereo",()=>{this.stereo_icon.active(this.model.get("stereo"))}),this.screenshot_icon=new x("fa-picture-o",this.toolbar_div),this.screenshot_icon.a.title="Make screensot (hold shift to copy to clipboard)",this.screenshot_icon.a.onclick=(t=>{try{var n=this.screenshot();t.shiftKey?_(n):function(t){var n=document.createElement("a");n.download="ipyvolume.png",n.href=t,document.createEvent?(e=document.createEvent("MouseEvents"),e.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(e)):lnk.fireEvent&&n.fireEvent("onclick")}(n)}finally{return t.preventDefault(),!1}}),window.ipvss=(()=>{return this.screenshot()}),this.camera_control_icon=new x("fa-arrow-up",this.toolbar_div),this.camera_control_icon.a.title="Camera locked to 'up' axis (orbit), instead of trackball mode",this.camera_control_icon.a.onclick=(()=>{if("trackball"==this.model.get("camera_control")){this.model.get("camera_control");this.model.set("camera_control","orbit"),this.camera_control_icon.active(!0)}else this.model.set("camera_control","trackball"),this.camera_control_icon.active(!1);this.touch()}),this.camera_control_icon.active(!1),this.select_icon=new x("fa-pencil-square-o",this.toolbar_div),this.select_icon.a.title="Select mode (auto when control key is pressed)",this.select_icon.a.onclick=(()=>{"select"==this.model.get("mouse_mode")?this.model.set("mouse_mode","normal"):this.model.set("mouse_mode","select"),this.update_icons(),this.touch()}),this.select_icon.active(!1),this.select_icon_lasso=new b("fa-vine",this.select_icon.sub,"Lasso selector"),this.select_icon_circle=new b("fa-circle",this.select_icon.sub,"Circle selector"),this.select_icon_rectangle=new b("fa-square",this.select_icon.sub,"Rectangle selector"),this.select_icon_lasso.a.onclick=(t=>{t.stopPropagation(),this.model.set("mouse_mode","select"),this.model.set("selector","lasso"),this.touch()}),this.select_icon_circle.a.onclick=(t=>{t.stopPropagation(),this.model.set("mouse_mode","select"),this.model.set("selector","circle"),this.touch()}),this.select_icon_rectangle.a.onclick=(t=>{t.stopPropagation(),this.model.set("mouse_mode","select"),this.model.set("selector","rectangle"),this.touch()}),this.zoom_icon=new x("fa-search-plus",this.toolbar_div),this.zoom_icon.a.title="Zoom mode (auto when control key is pressed, use scrolling)",this.zoom_icon.a.onclick=(()=>{"zoom"==this.model.get("mouse_mode")?this.model.set("mouse_mode","normal"):this.model.set("mouse_mode","zoom"),this.touch()}),this.quick_mouse_mode_change=!1,this.quick_mouse_previous_mode=this.model.get("mouse_mode"),this.update_icons(),this.model.on("change:mouse_mode change:selector",this.update_icons,this),this.model.on("change:mouse_mode change:selector",this.update_mouse_mode,this),this.reset_icon=new x("fa-home",this.toolbar_div),this.reset_icon.a.title="Reset view";this.model.get("camera_fov");this.reset_icon.a.onclick=(()=>{this.camera.copy(this.camera_initial),this.camera.ipymodel.syncToModel(!0)}),this.setting_icon=new x("fa-cog",this.toolbar_div),this.setting_icon_180=new b("fa-circle",this.setting_icon.sub,"180 degrees"),this.setting_icon_360=new b("fa-circle",this.setting_icon.sub,"360 degrees");var s=(t,e,n,r)=>{new b("fa-cogs",this.setting_icon.sub,t+" ("+e+"x"+n+")").a.onclick=(t=>{this.model.set("width",e),this.model.set("height",n),this.touch()})};s("default",this.model.get("width"),this.model.get("height")),s("small",500,400),s("medium",640,480),s("large",800,600),s("HD 720",1280,720),s("HD",1920,1080),s("2k",2048,1080),s("2k x 2k",2048,2048),s("4k UHD ",3840,2160),s("4k",4096,2160),s("4k x 4k",4096,4096);var c=t=>{new b("fa-compress",this.setting_icon.sub,"Scale canvas (down) by "+t).a.onclick=(e=>{this.model.set("displayscale",1/t),this.touch()})};c(1),c(2),c(4),c(8),this.setting_icon_180.a.onclick=(t=>{t.stopPropagation(),"180"==this.model.get("panorama_mode")?this.model.set("panorama_mode","no"):this.model.set("panorama_mode","180"),this.touch()}),this.setting_icon_360.a.onclick=(t=>{t.stopPropagation(),"360"==this.model.get("panorama_mode")?this.model.set("panorama_mode","no"):this.model.set("panorama_mode","360"),this.touch()}),this.setting_icon_360.active("360"==this.model.get("panorama_mode")),this.setting_icon_180.active("180"==this.model.get("panorama_mode")),this.model.on("change:panorama_mode",()=>{this.setting_icon_360.active("360"==this.model.get("panorama_mode")),this.setting_icon_180.active("180"==this.model.get("panorama_mode")),this.update_panorama()}),this.el.classList.add("jupyter-widgets"),this.canvas_container=document.createElement("div"),this.canvas_overlay_container=document.createElement("div"),this.canvas_overlay=document.createElement("canvas"),this.canvas_overlay_container.appendChild(this.canvas_overlay),this.canvas_container.appendChild(this.canvas_overlay_container),this.renderer=new o.WebGLRenderer({alpha:!0,antialias:!0}),this.canvas_renderer_container=document.createElement("div"),this.canvas_renderer_container.appendChild(this.renderer.domElement),this.canvas_container.appendChild(this.canvas_renderer_container),this.canvas_container.appendChild(this.canvas_overlay_container),this.canvas_overlay_container.style="position: absolute; z-index: 2; pointer-events: none; ",this.canvas_renderer_container.style="position: absolute; z-index: 1",this.canvas_container.style="position: relative",this.el.appendChild(this.canvas_container),this.el.setAttribute("tabindex","1"),this.el_mirror=document.createElement("div"),this.el.appendChild(this.el_mirror),this.el_axes=document.createElement("div"),this.el_mirror.appendChild(this.el_axes),this.renderer.domElement.addEventListener("wheel",this.mousewheel.bind(this),!1);this.camera=this.model.get("camera").obj,this.camera_initial=this.camera.clone(),this.model.get("camera").on("change",()=>{var t=new o.Vector3(0,1,0);t.applyQuaternion(this.camera.quaternion),this.camera.up=t,this.camera.lookAt(0,0,0),this.control_trackball.position0=this.camera.position.clone(),this.control_trackball.up0=this.camera.up.clone(),this.update()}),this.cube_camera=new o.CubeCamera(this.camera.near,this.camera.far,this.model.get("cube_resolution")),this.camera_stereo=new o.StereoCamera,this.renderer.setSize(t,n),this.renderer_stereo=new o.StereoEffect(this.renderer),this.renderer_selected=this.renderer_stereo;var u=function(t,e,n,r,i,a,s){var c=new o.Geometry;return c.vertices.push(new o.Vector3(t,e,n),new o.Vector3(r,i,a)),new o.Line(c,s)},h=function(t,e,n,r){return u(-.5,-.5,-.5,-.5+t,-.5+e,-.5+n,r)};this.axes_material=new o.LineBasicMaterial({color:"cyan",linewidth:1}),this.xaxes_material=new o.LineBasicMaterial({color:"red",linewidth:1}),this.yaxes_material=new o.LineBasicMaterial({color:"green",linewidth:1}),this.zaxes_material=new o.LineBasicMaterial({color:"blue",linewidth:1}),this.x_axis=h(1,0,0,this.xaxes_material),this.y_axis=h(0,1,0,this.yaxes_material),this.z_axis=h(0,0,1,this.zaxes_material),this.axes=new o.Object3D,this.axes.add(this.x_axis),this.axes.add(this.y_axis),this.axes.add(this.z_axis),this.wire_box=new o.Object3D;this.wire_box_x_line=u(-.5,-.5,-.5,.5,-.5,-.5,this.axes_material),this.wire_box.add(this.wire_box_x_line),this.wire_box.add(u(-.5,.5,-.5,.5,.5,-.5,this.axes_material)),this.wire_box.add(u(-.5,-.5,.5,.5,-.5,.5,this.axes_material)),this.wire_box.add(u(-.5,.5,.5,.5,.5,.5,this.axes_material)),this.wire_box_y_line=u(-.5,-.5,-.5,-.5,.5,-.5,this.axes_material),this.wire_box.add(this.wire_box_y_line),this.wire_box.add(u(.5,-.5,-.5,.5,.5,-.5,this.axes_material)),this.wire_box.add(u(-.5,-.5,.5,-.5,.5,.5,this.axes_material)),this.wire_box.add(u(.5,-.5,.5,.5,.5,.5,this.axes_material)),this.wire_box_z_line=u(-.5,-.5,-.5,-.5,-.5,.5,this.axes_material),this.wire_box.add(this.wire_box_z_line),this.wire_box.add(u(.5,-.5,-.5,.5,-.5,.5,this.axes_material)),this.wire_box.add(u(-.5,.5,-.5,-.5,.5,.5,this.axes_material)),this.wire_box.add(u(.5,.5,-.5,.5,.5,.5,this.axes_material)),this.camera.position.z=2*this.getTanDeg(22.5)/this.getTanDeg(this.model.get("camera_fov")/2),this.axes_data=[{name:"x",label:"x",object:null,object_label:null,translate:[0,-.5,-.5],rotate:[Math.PI/4,0,0],rotation_order:"XYZ"},{name:"y",label:"y",object:null,object_label:null,translate:[-.5,0,-.5],rotate:[3*Math.PI/4,0,Math.PI/2],rotation_order:"ZXY"},{name:"z",label:"z",object:null,object_label:null,translate:[-.5,-.5,0],rotate:[-Math.PI/8,-Math.PI/2,0],rotation_order:"YZX"}],this.ticks=5,this.scene_volume=new o.Scene,this.shared_scene=this.model.get("scene").obj,this.scene_volume.background=null,this.model.get("scene").on("rerender",()=>this.update()),this.scene_volume.add(this.camera),this.shared_scene.add(this.camera),this.scene_scatter=new o.Scene,this.scene_opaque=new o.Scene,this.scene_opaque.add(this.wire_box),this.scene_opaque.add(this.axes),this.mesh_views={},this.scatter_views={},this.volume_views={};var f=t,d=n;this.model.get("stereo")&&(f/=2),f/=this.model.get("downscale"),d/=this.model.get("downscale"),this.volume_back_target=new o.WebGLRenderTarget(f,d,{minFilter:o.LinearFilter,magFilter:o.LinearFilter,type:o.FloatType,format:o.RGBAFormat,generateMipmaps:!1}),this.geometry_depth_target=new o.WebGLRenderTarget(f,d,{minFilter:o.LinearFilter,magFilter:o.LinearFilter,format:o.RGBAFormat,generateMipmaps:!1,depthTexture:new o.DepthTexture}),this.geometry_depth_target.depthTexture.type=o.UnsignedShortType,this.color_pass_target=new o.WebGLRenderTarget(f,d,{minFilter:o.LinearFilter,magFilter:o.LinearFilter}),this.screen_pass_target=new o.WebGLRenderTarget(f,d,{minFilter:o.LinearFilter,magFilter:o.LinearFilter}),this.coordinate_texture=new o.WebGLRenderTarget(f,d,{minFilter:o.LinearFilter,magFilter:o.NearestFilter}),this.screen_texture=this.color_pass_target.texture,this.screen_scene=new o.Scene,this.screen_scene_cube=new o.Scene,this.screen_plane=new o.PlaneBufferGeometry(1,1),this.screen_material=new o.ShaderMaterial({uniforms:{tex:{type:"t",value:this.screen_pass_target.texture}},vertexShader:g.screen_vertex,fragmentShader:g.screen_fragment,depthWrite:!1}),this.screen_material_cube=new o.ShaderMaterial({uniforms:{tex:{type:"t",value:this.cube_camera.renderTarget.texture}},vertexShader:g.screen_vertex,fragmentShader:g.screen_fragment,defines:{},depthWrite:!1}),this.screen_mesh=new o.Mesh(this.screen_plane,this.screen_material),this.screen_mesh_cube=new o.Mesh(this.screen_plane,this.screen_material_cube),this.screen_scene.add(this.screen_mesh),this.screen_scene_cube.add(this.screen_mesh_cube),this.screen_camera=new o.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),this.screen_camera.position.z=10,this.update_panorama(),this.on("change:panorama_mode",this.update_panorama,this),this.renderer.domElement.addEventListener("mousedown",a.bind(this._mouse_down,this),!1),this.renderer.domElement.addEventListener("mousemove",a.bind(this._mouse_move,this),!1),this.renderer.domElement.addEventListener("dblclick",this._mouse_dbl_click.bind(this),!1),this.renderer.domElement.addEventListener("contextmenu",t=>{t.preventDefault(),t.stopPropagation()},!1),window.addEventListener("mouseup",a.bind(this._mouse_up,this),!1),this.mouse_inside=!1,this.mouse_trail=[],this.select_overlay=null,this.control_trackball=new o.TrackballControls(this.camera,this.renderer.domElement),this.control_orbit=new o.OrbitControls(this.camera,this.renderer.domElement),this.control_trackball.dynamicDampingFactor=1,this.control_trackball.noPan=!0,this.control_orbit.enablePan=!1,this.control_orbit.dampingFactor=1,this.update_mouse_mode(),this.control_orbit.rotateSpeed=.5,this.control_trackball.rotateSpeed=.5,this.control_trackball.zoomSpeed=3,window.addEventListener("deviceorientation",a.bind(this.on_orientationchange,this),!1);var p=this.getRenderSize();this.material_multivolume=new o.ShaderMaterial({uniforms:{back_tex:{type:"t",value:this.volume_back_target.texture},geometry_depth_tex:{type:"t",value:this.geometry_depth_target.depthTexture},volumes:{type:"tv",value:[{}]},data:{type:"tv",value:[]},transfer_function:{type:"tv",value:[]},volumes_max_int:{type:"tv",value:[{}]},data_max_int:{type:"tv",value:[]},transfer_function_max_int:{type:"tv",value:[]},ambient_coefficient:{type:"f",value:this.model.get("ambient_coefficient")},diffuse_coefficient:{type:"f",value:this.model.get("diffuse_coefficient")},specular_coefficient:{type:"f",value:this.model.get("specular_coefficient")},specular_exponent:{type:"f",value:this.model.get("specular_exponent")},brightness:{type:"f",value:2},render_size:{type:"2f",value:p},steps:{type:"f",value:10}},blending:o.CustomBlending,blendSrc:o.OneFactor,blendDst:o.OneMinusSrcAlphaFactor,blendEquation:o.AddEquation,transparent:!0,defines:{},side:o.FrontSide}),this.material_multivolume_depth=new o.ShaderMaterial({uniforms:this.material_multivolume.uniforms,blending:o.NoBlending,defines:{COORDINATE:!0},side:o.FrontSide}),this.model.on("change:scatters",this.update_scatters,this),this.update_scatters(),this.model.on("change:meshes",this.update_meshes,this),this.update_meshes(),this.model.on("change:volumes",this.update_volumes,this),this.update_volumes(),this.update_size();this.el.addEventListener("change",a.bind(this.update,this));var m=()=>{this.model.set("matrix_world",this._get_view_matrix().elements.slice()),this.touch()};this.model.on("change:xlim change:ylim change:zlim",()=>{m()}),this.model.get("camera").on("change:matrixWorld",()=>{m()}),m();var v=()=>{this.model.set("matrix_projection",this.camera.projectionMatrix.elements.slice())};v(),this.model.get("camera").on("change:projectionMatrix",()=>{v()}),v(),this.model.on("change:camera_control",this.update_mouse_mode,this),this.model.on("change:xlabel change:ylabel change:zlabel",this.update,this),this.model.on("change:render_continuous",this.update,this),this.model.on("change:style",this.update,this),this.model.on("change:xlim change:ylim change:zlim ",this.update,this),this.model.on("change:xlim change:ylim change:zlim ",this._save_matrices,this),this.model.on("change:downscale",this.update_size,this),this.model.on("change:stereo",this.update_size,this),this.model.on("change:eye_separation",this.update,this),this.model.on("change:camera_fov",this.update_current_control,this),this.model.on("change:width",this.update_size,this),this.model.on("change:height",this.update_size,this),this.model.on("change:displayscale",this.update_size,this),this.model.on("change:ambient_coefficient",this.update_light,this),this.model.on("change:diffuse_coefficient",this.update_light,this),this.model.on("change:specular_coefficient",this.update_light,this),this.model.on("change:specular_exponent",this.update_light,this);var y=()=>{a.each([this.scene_volume,this.scene_opaque,this.scene_scatter],t=>{var e=this.model.get("camera_center");t.position.set(-e[0],-e[1],-e[2])}),this.update()};if(this.model.on("change:camera_center",y),y(),this.model.on("change:tf",this.tf_set,this),this.listenTo(this.model,"msg:custom",a.bind(this.custom_msg,this)),this.control_trackball.addEventListener("end",a.bind(this.update_angles,this)),this.control_orbit.addEventListener("end",a.bind(this.update_angles,this)),this.control_trackball.addEventListener("change",a.bind(this.update,this)),this.control_orbit.addEventListener("change",a.bind(this.update,this)),this.renderer.domElement.addEventListener("resize",a.bind(this.on_canvas_resize,this),!1),this.update(),this.update_current_control(),this.update_light(),this.model.get("capture_fps"))var w=this.renderer.domElement.captureStream(this.model.get("capture_fps"));else w=this.renderer.domElement.captureStream();this.model.stream=Promise.resolve(w),window.last_figure_stream=w,this.renderer.domElement.onmouseover=(()=>{this.hover=!0}),this.renderer.domElement.onmouseleave=(()=>{this.hover=!1})},setStyle:function(){},update_icons:function(){var t="select"==this.model.get("mouse_mode");this.select_icon_lasso.active("lasso"==this.model.get("selector")&&t),this.select_icon_circle.active("circle"==this.model.get("selector")&&t),this.select_icon_rectangle.active("rectangle"==this.model.get("selector")&&t),this.select_icon.active(t);var e="zoom"==this.model.get("mouse_mode");this.zoom_icon.active(e)},update_mouse_mode:function(){var t="normal"==this.model.get("mouse_mode");this.control_trackball.enabled="trackball"==this.model.get("camera_control")&&t,this.control_orbit.enabled="orbit"==this.model.get("camera_control")&&t},mousewheel:function(t){if("zoom"==this.model.get("mouse_mode")){t.preventDefault(),t.stopPropagation();var e,n,r=25e-5*event.deltaY;2==event.deltaMode&&(r=.025*event.deltaY),1==event.deltaMode&&(r-=.01*event.deltaY),t.offsetX?(e=t.offsetX,n=t.offsetY):t.layerX&&(e=t.layerX,n=t.layerY),r*=10;var i=Math.pow(10,r),a=new Uint8Array(4),s=this.renderer.domElement.clientHeight;if(!this.last_zoom_coordinate)if(this.renderer.readRenderTargetPixels(this.coordinate_texture,e,s-n,1,1,a),a[3]>1)(c=new o.Vector3(a[0],a[1],a[2])).multiplyScalar(1/255),this.last_zoom_coordinate=c;if(this.last_zoom_coordinate){this.renderer.clearTarget(this.coordinate_texture,!0,!0,!0);var c,l=(c=this.last_zoom_coordinate).clone().sub(c.clone().multiplyScalar(i)),u=c.clone().add(c.clone().negate().addScalar(1).multiplyScalar(i)),h=this.model.get("xlim"),f=this.model.get("ylim"),d=this.model.get("zlim"),p=new o.Vector3(h[0],f[0],d[0]),m=new o.Vector3(h[1],f[1],d[1]).clone().sub(p),v=l.clone().multiply(m).add(p),g=u.clone().multiply(m).add(p);this.model.set("xlim",[v.x,g.x]),this.model.set("ylim",[v.y,g.y]),this.model.set("zlim",[v.z,g.z]),this.touch()}return!1}},_mouse_down:function(t){window.last_event=t,t.offsetX?(mouseX=t.offsetX,mouseY=t.offsetY):t.layerX&&(mouseX=t.layerX,mouseY=t.layerY),this.mouse_down_position={x:mouseX,y:mouseY},this.mouse_down_limits={x:this.model.get("xlim"),y:this.model.get("ylim"),z:this.model.get("zlim")};var e=this.renderer.domElement.clientHeight,n=new Uint8Array(4);if(this.renderer.readRenderTargetPixels(this.coordinate_texture,mouseX,e-mouseY,1,1,n),n[3]>1){var r=new o.Vector3(n[0],n[1],n[2]);r.multiplyScalar(1/255),this.last_pan_coordinate=r}if("select"==this.model.get("mouse_mode")){var i=M[this.model.get("selector")];this.selector=new i(this.canvas_overlay),t.preventDefault(),t.stopPropagation()}},_mouse_move:function(t){if(!t)t=event;var e,n;if(t.offsetX?(e=t.offsetX,n=t.offsetY):t.layerX&&(e=t.layerX,n=t.layerY),mouse_position={x:e,y:n},this.last_zoom_coordinate=null,this.selector&&(this.mouse_trail.push([e,n]),this.selector.mouseMove(e,n),this.selector.draw()),"zoom"==this.model.get("mouse_mode")&&this.last_pan_coordinate&&1==t.buttons){var r=this.renderer.domElement,i=mouse_position.x-this.mouse_down_position.x,a=-(mouse_position.y-this.mouse_down_position.y),s=i/r.clientWidth*2,c=a/r.clientHeight*2,l=this.camera.projectionMatrix,u=this._get_view_matrix(),h=h=l.clone().multiply(u),f=h.clone().getInverse(h),d=this.mouse_down_limits.x,p=this.mouse_down_limits.y,m=this.mouse_down_limits.z,v=new o.Vector3(d[0],p[0],m[0]),g=new o.Vector3(d[1],p[1],m[1]),y=g.clone().sub(v),_=this.last_pan_coordinate.clone().multiply(y).add(v).clone().applyMatrix4(h),x=_.clone();x.x+=s,x.y+=c;var b=_.applyMatrix4(f),w=x.applyMatrix4(f).clone().sub(b);v.sub(w),g.sub(w),this.model.set("xlim",[v.x,g.x]),this.model.set("ylim",[v.y,g.y]),this.model.set("zlim",[v.z,g.z])}},_mouse_dbl_click:function(t){if("zoom"==this.model.get("mouse_mode")&&this.last_pan_coordinate){var e=this.mouse_down_limits.x,n=this.mouse_down_limits.y,r=this.mouse_down_limits.z,i=new o.Vector3(e[0],n[0],r[0]),a=new o.Vector3(e[1],n[1],r[1]),s=a.clone().sub(i),c=this.last_pan_coordinate.clone().multiply(s).add(i),l=s.clone().multiplyScalar(.5);i=c.clone().sub(l),a=c.clone().add(l),this.model.set("xlim",[i.x,a.x]),this.model.set("ylim",[i.y,a.y]),this.model.set("zlim",[i.z,a.z])}},_mouse_up:function(t){if(this.selector){var e=this.renderer.domElement;this.send({event:"selection",data:this.selector.getData(e.clientWidth,e.clientHeight)}),this.mouse_trail=[],this.selector.close(),this.selector=null,t.preventDefault(),t.stopPropagation()}},_special_keys_down:function(t){if(this.hover){var e=window.event?event:t;e.altKey;var n=!1;return"="==e.key&&(this.model.set("selection_mode","replace"),n=!0),"|"==e.key&&(this.model.set("selection_mode","or"),n=!0),"&"==e.key&&(this.model.set("selection_mode","and"),n=!0),"-"==e.key&&(this.model.set("selection_mode","subtract"),n=!0),76==e.keyCode&&(this.model.set("selector","lasso"),n=!0),67==e.keyCode&&(this.model.set("selector","circle"),n=!0),82==e.keyCode&&(this.model.set("selector","rectangle"),n=!0),18==e.keyCode&&(this.quick_mouse_mode_change||(this.quick_mouse_mode_change=!0,this.quick_mouse_previous_mode=this.model.get("mouse_mode"),this.model.set("mouse_mode","zoom"),n=!0)),17==e.keyCode&&(this.quick_mouse_mode_change||(this.quick_mouse_mode_change=!0,this.quick_mouse_previous_mode=this.model.get("mouse_mode"),this.model.set("mouse_mode","select"),n=!0)),n?(this.touch(),t.preventDefault(),t.stopPropagation(),!1):void 0}},_special_keys_up:function(t){var e=window.event?event:t;e.altKey,17!=e.keyCode&&18!=e.keyCode||this.quick_mouse_mode_change&&(this.quick_mouse_mode_change=!1,this.model.set("mouse_mode",this.quick_mouse_previous_mode),this.touch())},custom_msg:function(t){if("screenshot"==t.msg){var e=this.screenshot(void 0,t.width,t.height);this.send({event:"screenshot",data:e})}},screenshot:function(t,e,n){var r=e&&n;try{r&&this._update_size(!0,e,n),this._real_update();var i=this.renderer.domElement.toDataURL(t||"image/png");return console.info("captured screenshot"),i}finally{r&&this._update_size(!1)}},_d3_add_axis:function(t,e,n){var r=new o.Object3D;r.translateX(e.translate[0]),r.translateY(e.translate[1]),r.translateZ(e.translate[2]),c.select(t).attr("translate-x",e.translate[0]),c.select(t).attr("translate-y",e.translate[1]),c.select(t).attr("translate-z",e.translate[2]),r.rotation.reorder(e.rotation_order),r.rotation.x=e.rotate[0],r.rotation.y=e.rotate[1],r.rotation.z=e.rotate[2],this.axes.add(r);var i=.004,a={x:s.textAlign.topRight,y:s.textAlign.topRight,z:s.textAlign.center},l=new s.SpriteText2D(e.label,{align:a[e.name],font:"30px Arial",fillStyle:"#00FF00",antialias:!0});l.material.transparent=!0,l.material.alphaTest=.3,l.scale.set(i,i,i),r.add(l),e.object_label=l,e.object=r,e.scale=c.scaleLinear().domain(this.model.get(e.name+"lim")).range([-.5,.5]),e.ticks=null},_d3_update_axis:function(t,e,n){e.object_label.text=e.label,e.object_label.fillStyle=e.fillStyle;var r=e.name;e.object_label.fillStyle=this.get_style("axes."+r+".label.color axes."+r+".color axes.label.color axes.color"),e.object_label.visible=this.get_style("axes."+r+".label.visible axes."+r+".visible axes.label.visible axes.visible"),e.scale=c.scaleLinear().domain(this.model.get(e.name+"lim")).range([-.5,.5])},_d3_add_axis_tick:function(t,e,n){var r=c.select(c.select(t).node().parentNode).datum(),i=r.scale.tickFormat(this.ticks,".1f")(e.value),a={x:s.textAlign.topRight,y:s.textAlign.topRight,z:s.textAlign.center},l=new s.SpriteText2D(i,{align:a[r.name],font:"30px Arial",fillStyle:"#00FF00",antialias:!0});l.material.transparent=!0,l.material.alphaTest=.3,l.blending=o.CustomBlending,l.blendSrc=o.SrcAlphaFactor,l.blendDst=o.OneMinusSrcAlphaFactor,l.blendEquation=o.AddEquation;l.scale.multiplyScalar(.002);var u=r.name;return l.fillStyle=this.get_style("axes."+u+".ticklabel.color axes.ticklabel.color axes."+u+".color axes.color"),r.object.add(l),e.object_ticklabel=l,l},_d3_update_axis_tick:function(t,e,n){var r=c.select(c.select(t).node().parentNode).datum(),i=r.scale,a=i.tickFormat(this.ticks,".1f")(e.value);e.object_ticklabel.text=a,e.object_ticklabel.position.x=i(e.value);var o=r.name;e.object_ticklabel.fillStyle=this.get_style("axes."+o+".ticklabel.color axes.ticklabel.color axes."+o+".color axes.color"),e.object_ticklabel.visible=this.get_style("axes."+o+".ticklabel.visible axes."+o+".visible axes.visible")},_d3_remove_axis_tick:function(t,e,n){e.object_ticklabel.parent.remove(e.object_ticklabel)},update_scatters:function(){var t=this.model.get("scatters");if(0!=t.length){var e=[];a.each(t,t=>{if(e.push(t.cid),!(t.cid in this.scatter_views)){var n={parent:this},r=new p.ScatterView({options:n,model:t});r.render(),this.scatter_views[t.cid]=r}},this),a.each(this.scatter_views,(t,n)=>{-1==e.indexOf(n)&&(t.remove_from_scene(),delete this.scatter_views[n])},this)}else this.scatter_views={}},update_meshes:function(){var t=this.model.get("meshes");if(0!=t.length){var e=[];a.each(t,t=>{if(e.push(t.cid),!(t.cid in this.mesh_views)){var n={parent:this},r=new m.MeshView({options:n,model:t});r.render(),this.mesh_views[t.cid]=r}},this),a.each(this.mesh_views,(t,n)=>{-1==e.indexOf(n)&&(t.remove_from_scene(),delete this.mesh_views[n])},this)}else this.mesh_views={}},update_volumes:function(){var t=this.model.get("volumes");if(0!=t.length){var e=[];a.each(t,t=>{if(e.push(t.cid),!(t.cid in this.volume_views)){var n={parent:this},r=new v.VolumeView({options:n,model:t});this.volume_views[t.cid]=r,r.render()}},this),a.each(this.volume_views,(t,n)=>{-1==e.indexOf(n)&&(t.remove_from_scene(),delete this.volume_views[n])},this)}else this.volume_views={}},transition:function(t,e,n){var r=this;return new function(){this.time_start=(new Date).getTime(),this.duration=r.model.get("animation"),this.cancelled=!1,this.called_on_done=!1,this.set=function(t){this.objects.push(t)},this.is_done=function(){return(new Date).getTime()-this.time_start>=this.duration||this.cancelled},this.cancel=function(){this.cancelled=!0},this.update=function(){if(!this.cancelled){var i=((new Date).getTime()-this.time_start)/this.duration,a=Math.min(1,i);a=Math.pow(a,r.model.get("animation_exponent")),t.apply(n,[a]),i>=1&&!this.called_on_done&&(this.called_on_done=!0,e.apply(n))}},r.transitions.push(this)}},on_orientationchange:function(t){a.each([this.scene_volume,this.scene_opaque,this.scene_scatter],e=>{e.rotation.reorder("XYZ"),e.rotation.x=t.gamma*Math.PI/180+2*Math.PI,e.rotation.y=-(t.beta*Math.PI/180+2*Math.PI),e.rotation.z=-t.alpha*Math.PI/180},this),this.update()},on_canvas_resize:function(t){},keypress:function(t){t.keyCode||t.which;t.keyCode,t.key},update_angles:function(){this.camera.ipymodel.syncToModel(!0),this.update()},_get_scale_matrix:function(){var t=new o.Matrix4;t.makeTranslation(-.5,-.5,-.5);var e=new o.Matrix4,n=this.model.get("xlim"),r=this.model.get("ylim"),i=this.model.get("zlim"),a=1/(n[1]-n[0]),s=1/(r[1]-r[0]),c=1/(i[1]-i[0]);e.makeScale(a,s,c);var l=new o.Matrix4;return l.makeTranslation(-n[0],-r[0],-i[0]),t.multiply(e),t.multiply(l),t},_get_view_matrix(){this.camera.updateMatrixWorld(),this.camera.matrixWorldInverse.getInverse(this.camera.matrixWorld);var t=this.camera.matrixWorldInverse.clone();return t.multiply(this._get_scale_matrix().clone()),t},getTanDeg:function(t){var e=t*Math.PI/180;return Math.tan(e)},update_current_control:function(){this.camera.ipymodel.syncToModel(!0),this.control_trackball.position0=this.camera.position.clone(),this.control_trackball.up0=this.camera.up.clone()},update_panorama:function(){var t=this.screen_material_cube;"360"==this.model.get("panorama_mode")&&(t.defines={PANORAMA_360:!0}),"180"==this.model.get("panorama_mode")&&(t.defines={PANORAMA_180:!0}),t.needsUpdate=!0,this.update()},update:function(){this._update_requested||(this._update_requested=!0,requestAnimationFrame(a.bind(this._real_update,this)))},_real_update:function(){this.control_trackball.handleResize(),this._update_requested=!1,this.camera.lookAt(0,0,0),this.renderer.setClearColor(this.get_style_color("background-color")),this.x_axis.visible=this.get_style("axes.x.visible axes.visible"),this.y_axis.visible=this.get_style("axes.y.visible axes.visible"),this.z_axis.visible=this.get_style("axes.z.visible axes.visible"),this.axes_material.color=this.get_style_color("axes.color"),this.xaxes_material.color=this.get_style_color("axes.x.color axes.color"),this.yaxes_material.color=this.get_style_color("axes.y.color axes.color"),this.zaxes_material.color=this.get_style_color("axes.z.color axes.color"),this.axes_data[0].fillStyle=this.get_style("axes.x.color axes.color"),this.axes_data[1].fillStyle=this.get_style("axes.y.color axes.color"),this.axes_data[2].fillStyle=this.get_style("axes.z.color axes.color"),this.axes_data[0].label=this.model.get("xlabel"),this.axes_data[1].label=this.model.get("ylabel"),this.axes_data[2].label=this.model.get("zlabel"),this.wire_box.visible=this.get_style("box.visible"),this.wire_box_x_line.visible=!this.x_axis.visible&&this.wire_box.visible,this.wire_box_y_line.visible=!this.y_axis.visible&&this.wire_box.visible,this.wire_box_z_line.visible=!this.z_axis.visible&&this.wire_box.visible,c.select(this.el_axes).selectAll(".ipyvol-axis").data(this.axes_data).each(y(this._d3_update_axis,this)).enter().append("div").attr("class","ipyvol-axis").each(y(this._d3_add_axis,this));var t=this;this.ticks=5,this.last_tick_selection=c.select(this.el_axes).selectAll(".ipyvol-axis").data(this.axes_data).selectAll(".ipyvol-tick").data(function(e,n,r){if(o=e.ticks){o=e.ticks=o.slice();for(var i=e.scale.ticks(t.ticks);o.length<i.length;)o.push({});for(;o.length>i.length;)o.pop();return a.each(i,(t,e)=>{o[e].value=t}),o}i=e.scale.ticks(t.ticks);var o=a.map(i,function(t){return{value:t}});return e.ticks=o,o}),this.last_tick_selection.each(y(this._d3_update_axis_tick,this)).enter().append("div").attr("class","ipyvol-tick").each(y(this._d3_add_axis_tick,this)),this.last_tick_selection.exit().remove().each(y(this._d3_remove_axis_tick,this));for(var e=[],n=0;n<this.transitions.length;n++){var r=this.transitions[n];r.is_done()||e.push(r),r.update()}if(this.renderer.clear(),this.model.get("stereo")){var i=this.renderer.getSize();null===this.camera.parent&&this.camera.updateMatrixWorld(),this.camera_stereo.eyeSep=this.model.get("eye_separation")/100,this.camera.focus=this.camera.focus,this.camera_stereo.update(this.camera),this.camera_stereo.cameraL.position.copy(this.camera.position),this.camera_stereo.cameraR.position.copy(this.camera.position),this.camera_stereo.cameraL.quaternion.copy(this.camera.quaternion),this.camera_stereo.cameraR.quaternion.copy(this.camera.quaternion),this.camera_stereo.cameraL.up.copy(this.camera.up),this.camera_stereo.cameraR.up.copy(this.camera.up);var o="no"!=this.model.get("panorama_mode");this.renderer.setScissorTest(!0),o?(this.renderer.setScissor(0,0,i.width,i.height/2),this.renderer.setViewport(0,0,i.width,i.height/2)):(this.renderer.setScissor(0,0,i.width/2,i.height),this.renderer.setViewport(0,0,i.width/2,i.height)),this._render_eye(this.camera_stereo.cameraL),o?(this.renderer.setScissor(0,i.height/2,i.width,i.height/2),this.renderer.setViewport(0,i.height/2,i.width,i.height/2)):(this.renderer.setScissor(i.width/2,0,i.width/2,i.height),this.renderer.setViewport(i.width/2,0,i.width/2,i.height)),this._render_eye(this.camera_stereo.cameraR),this.renderer.setScissorTest(!1),this.renderer.setViewport(0,0,i.width,i.height)}else this._render_eye(this.camera);this.selector&&this.selector.draw(),this.transitions=e,this.transitions.length>0&&this.update(),this.model.get("render_continuous")&&this.update(),this.model.get("scene").trigger("afterRender",this.scene_volume,this.renderer,this.camera)},get_style_color:function(t){if(style=this.get_style(t),style)return new o.Color(style);console.error("could not find color for",t)},get_style:function(t){var e=[null];return a.each(t.split(" "),t=>{var n=a.reduce(t.split("."),function(t,e){return null!=t&&null!=t[e]?t[e]:null},this.model.get("style"),this);null!=n&&null==e[0]&&(e[0]=n)},this),e[0]},_render_eye:function(t){this.camera.updateMatrixWorld();var e=0!=this.model.get("volumes").length,n="no"!=this.model.get("panorama_mode");if(a.each(this.scatter_views,t=>{t.set_limits(a.pick(this.model.attributes,"xlim","ylim","zlim"))},this),a.each(this.mesh_views,t=>{t.set_limits(a.pick(this.model.attributes,"xlim","ylim","zlim"))},this),n){if(this.cube_camera.clear(this.renderer,!0,!0,!0),this.renderer.autoClear=!1,this.cube_camera.position.copy(t.position),this.cube_camera.rotation.copy(t.rotation),this.cube_camera.quaternion.copy(this.camera.quaternion),this.model.get("stereo")){var r=new o.Vector3(0,0,0);t==this.camera_stereo.cameraR&&(r.x+=.032),t==this.camera_stereo.cameraL&&(r.x-=.032),r.applyQuaternion(t.quaternion),this.cube_camera.position.add(r);var i=new o.Vector3(0,0,1*this.camera.focus);i.applyQuaternion(t.quaternion),this.cube_camera.lookAt(i)}return this.cube_camera.update(this.renderer,this.scene_scatter),this.cube_camera.update(this.renderer,this.scene_opaque),this.screen_texture=this.cube_camera.renderTarget,void this.renderer.render(this.screen_scene_cube,this.screen_camera)}e&&(this.renderer.state.buffers.depth.setClear(0),a.each(this.volume_views,t=>{t.box_material.side=o.BackSide,t.box_material.depthFunc=o.GreaterDepth,t.vol_box_mesh.material=t.box_material,t.set_limits(a.pick(this.model.attributes,"xlim","ylim","zlim"))},this),this.renderer.clearTarget(this.volume_back_target,!0,!0,!0),this.renderer.render(this.scene_volume,t,this.volume_back_target),this.renderer.state.buffers.depth.setClear(1),this.renderer.autoClear=!1,this.renderer.clearTarget(this.geometry_depth_target,!0,!0,!0),this.renderer.render(this.scene_scatter,t,this.geometry_depth_target),this.renderer.render(this.scene_opaque,t,this.geometry_depth_target),this.renderer.autoClear=!0),this.renderer.autoClear=!1,this.renderer.clearTarget(this.color_pass_target,!0,!0,!0),this.renderer.render(this.scene_scatter,t,this.color_pass_target),this.renderer.render(this.scene_opaque,t,this.color_pass_target),this.renderer.autoClear=!0,e&&(this.renderer.context.colorMask(0,0,0,0),a.each(this.volume_views,t=>{t.box_material.side=o.FrontSide,t.box_material.depthFunc=o.LessEqualDepth},this),this.renderer.autoClear=!1,this.renderer.clearTarget(this.color_pass_target,!1,!0,!1),this.renderer.render(this.scene_volume,t,this.color_pass_target),this.renderer.autoClear=!0,this.renderer.context.colorMask(!0,!0,!0,!0),a.each(this.volume_views,t=>{t.vol_box_mesh.material=this.material_multivolume},this),this.renderer.autoClear=!1,this.renderer.clearTarget(this.color_pass_target,!1,!1,!1),this.renderer.render(this.scene_volume,t,this.color_pass_target),this.renderer.autoClear=!0),a.each(this.scatter_views,t=>{t.mesh.material=t.mesh.material_rgb},this),a.each(this.mesh_views,t=>{a.each(t.meshes,t=>{t.material=t.material_rgb},this)},this),this.renderer.autoClear=!1,this.renderer.setClearAlpha(0),this.renderer.clearTarget(this.coordinate_texture,!0,!0,!0),this.renderer.render(this.scene_scatter,t,this.coordinate_texture),this.renderer.autoClear=!0,e&&(this.renderer.context.colorMask(0,0,0,0),a.each(this.volume_views,t=>{t.box_material.side=o.FrontSide,t.box_material.depthFunc=o.LessEqualDepth},this),this.renderer.autoClear=!1,this.renderer.clearTarget(this.color_pass_target,!1,!0,!1),this.renderer.render(this.scene_volume,t,this.color_pass_target),this.renderer.autoClear=!0,this.renderer.context.colorMask(!0,!0,!0,!0),a.each(this.volume_views,t=>{t.vol_box_mesh.material=this.material_multivolume_depth},this),this.renderer.autoClear=!1,this.renderer.clearTarget(this.color_pass_target,!1,!1,!1),this.renderer.render(this.scene_volume,t,this.coordinate_texture),this.renderer.autoClear=!0),a.each(this.scatter_views,t=>{t.mesh.material=t.mesh.material_normal},this),a.each(this.mesh_views,t=>{a.each(t.meshes,t=>{t.material=t.material_normal},this)},this),this.screen_texture={Volume:this.color_pass_target,Back:this.volume_back_target,Geometry_back:this.geometry_depth_target,Coordinate:this.coordinate_texture}[this.model.get("show")],this.screen_material.uniforms.tex.value=this.screen_texture.texture,this.renderer.render(this.screen_scene,this.screen_camera)},rebuild_multivolume_rendering_material:function(){var t=this.model.get("volumes");if(0==t.length)return;var e=this.material_multivolume,n=this.material_multivolume_depth,r=0,i=0;e.uniforms.volumes.value=[],e.uniforms.volumes_max_int.value=[],e.uniforms.data.value=[],e.uniforms.data_max_int.value=[],e.uniforms.transfer_function.value=[],e.uniforms.transfer_function_max_int.value=[],e.uniforms.steps.value=a.max(t.map(t=>{let e=this.volume_views[t.cid];return e?e.get_ray_steps():0})),a.each(t,t=>{let n=this.volume_views[t.cid];if(n){n.model;n.is_normal()?(r++,e.uniforms.volumes.value.push(n.uniform_volumes_values),e.uniforms.data.value.push(n.uniform_data.value[0]),e.uniforms.transfer_function.value.push(n.uniform_transfer_function.value[0])):(i++,e.uniforms.volumes_max_int.value.push(n.uniform_volumes_values),e.uniforms.data_max_int.value.push(n.uniform_data.value[0]),e.uniforms.transfer_function_max_int.value.push(n.uniform_transfer_function.value[0]))}}),e.defines.VOLUME_COUNT=r,e.defines.VOLUME_COUNT_MAX_INT=i,n.defines.VOLUME_COUNT=r,n.defines.VOLUME_COUNT_MAX_INT=i;var o,s;n.fragmentShader=e.fragmentShader=(o=g.volr_fragment,s={volumes:a.range(r),volumes_max_int:a.range(i)},u.render(o,s)),n.vertexShader=e.vertexShader=g.volr_vertex,n.needsUpdate=e.needsUpdate=!0},update_light:function(){this.material_multivolume.uniforms.ambient_coefficient.value=this.model.get("ambient_coefficient"),this.material_multivolume.uniforms.diffuse_coefficient.value=this.model.get("diffuse_coefficient"),this.material_multivolume.uniforms.specular_coefficient.value=this.model.get("specular_coefficient"),this.material_multivolume.uniforms.specular_exponent.value=this.model.get("specular_exponent"),this.update()},update_size:function(){this._update_size()},_update_size:function(t,e,n){var r,i,a=this.renderer.domElement;this.is_fullscreen()?(r=e||a.clientWidth,i=n||a.clientHeight):(r=e||this.model.get("width"),i=n||this.model.get("height"));var o=r,s=i,c=r*this.model.get("displayscale"),l=i*this.model.get("displayscale");this.is_fullscreen()&&0!=this.model.get("volumes")&&(o=e||this.model.get("width"),s=n||this.model.get("height")),this.renderer.setSize(r,i,!1);var u=this.renderer.context.drawingBufferWidth,h=this.renderer.context.drawingBufferWidth;(u<r||h<i)&&console.info("could not set resolution to",r,i,", resolution is",u,h),this.renderer.domElement.style.width=c+"px",this.renderer.domElement.style.height=l+"px",this.canvas_container.style.width=c+"px",this.canvas_container.style.height=l+"px",this.canvas_overlay.style.width=c+"px",this.canvas_overlay.style.height=i+"px",this.canvas_overlay.width=r,this.canvas_overlay.height=i,this.model.get("stereo")&&(o/=2);var f=(o/=this.model.get("downscale"))/(s/=this.model.get("downscale"));this.camera.aspect=f,this.camera.updateProjectionMatrix(),this.material_multivolume.uniforms.render_size.value=[o,s],this.volume_back_target.setSize(o,s),this.geometry_depth_target.setSize(o,s),this.color_pass_target.setSize(o,s),this.screen_pass_target.setSize(o,s),this.coordinate_texture.setSize(o,s),this.screen_texture=this.color_pass_target.texture,t||this.update()},getRenderSize:function(){var t=this.renderer.getSize();return[t.width,t.width]},fullscreen:function(){l.request(this.el)},is_fullscreen:function(){return l.element===this.renderer.domElement}}),T=i.DOMWidgetModel.extend({defaults:function(){return a.extend(i.DOMWidgetModel.prototype.defaults(),{_model_name:"FigureModel",_view_name:"FigureView",_model_module:"ipyvolume",_view_module:"ipyvolume",_model_module_version:h,_view_module_version:h,eye_separation:6.4,stereo:!1,camera_control:"trackball",camera_fov:45,camera_center:[0,0,0],ambient_coefficient:.5,diffuse_coefficient:.8,specular_coefficient:.5,specular_exponent:5,width:500,height:400,downscale:1,displayscale:1,scatters:null,meshes:null,volumes:null,show:"Volume",xlim:[0,1],ylim:[0,1],zlim:[0,1],xlabel:"x",ylabel:"y",zlabel:"z",animation:1e3,animation_exponent:1,style:d.light,render_continuous:!1,selector:"lasso",selection_mode:"replace",mouse_mode:"normal",panorama_mode:"no",capture_fps:void 0,cube_resolution:512})}},{serializers:a.extend({scatters:{deserialize:i.unpack_models},meshes:{deserialize:i.unpack_models},volumes:{deserialize:i.unpack_models},camera:{deserialize:i.unpack_models},scene:{deserialize:i.unpack_models}},i.DOMWidgetModel.serializers)}),S=i.WidgetModel.extend({defaults:function(){return a.extend(i.WidgetModel.prototype.defaults(),{_model_name:"WidgetManagerHackModel",_model_module:"ipyvolume",_model_module_version:h})},initialize:function(t,e){console.log(this),S.__super__.initialize.apply(this,arguments),console.info("get reference to widget manager"),window.jupyter_widget_manager=this.widget_manager,window.jupyter_widgets=i}});t.exports={WidgetManagerHackModel:S,FigureModel:T,FigureView:E}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(21);e.SpriteText2D=r.SpriteText2D;var i=n(23);e.MeshText2D=i.MeshText2D;var a=n(6);e.textAlign=a.textAlign},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.raycast=function(){return this.sprite.raycast.apply(this.sprite,arguments)},e.prototype.updateText=function(){this.canvas.drawText(this._text,{font:this._font,fillStyle:this._fillStyle}),this.cleanUp(),this.texture=new a.Texture(this.canvas.canvas),this.texture.needsUpdate=!0,this.applyAntiAlias(),this.material?this.material.map=this.texture:this.material=new a.SpriteMaterial({map:this.texture}),this.sprite||(this.sprite=new a.Sprite(this.material),this.geometry=this.sprite.geometry,this.add(this.sprite)),this.sprite.scale.set(this.canvas.width,this.canvas.height,1),this.sprite.position.x=this.canvas.width/2-this.canvas.textWidth/2+this.canvas.textWidth/2*this.align.x,this.sprite.position.y=-this.canvas.height/2+this.canvas.textHeight/2*this.align.y},e}(n(8).Text2D);e.SpriteText2D=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(6),a=function(){function t(){this.textWidth=null,this.textHeight=null,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}return Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},enumerable:!0,configurable:!0}),t.prototype.drawText=function(t,e){return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.font=e.font,this.textWidth=Math.ceil(this.ctx.measureText(t).width),this.textHeight=i.getFontHeight(this.ctx.font),this.canvas.width=r.Math.ceilPowerOfTwo(this.textWidth),this.canvas.height=r.Math.ceilPowerOfTwo(this.textHeight),this.ctx.font=e.font,this.ctx.fillStyle=e.fillStyle,this.ctx.textAlign="left",this.ctx.textBaseline="top",this.ctx.shadowColor=e.shadowColor,this.ctx.shadowBlur=e.shadowBlur,this.ctx.shadowOffsetX=e.shadowOffsetX,this.ctx.shadowOffsetY=e.shadowOffsetY,this.ctx.fillText(t,0,0),this.canvas},t}();e.CanvasText=a},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),o=function(t){function e(e,n){return void 0===e&&(e=""),void 0===n&&(n={}),t.call(this,e,n)||this}return i(e,t),e.prototype.raycast=function(){this.mesh.raycast.apply(this.mesh,arguments)},e.prototype.updateText=function(){this.cleanUp(),this.canvas.drawText(this._text,{font:this._font,fillStyle:this._fillStyle,shadowBlur:this._shadowBlur,shadowColor:this._shadowColor,shadowOffsetX:this._shadowOffsetX,shadowOffsetY:this._shadowOffsetY}),this.texture=new a.Texture(this.canvas.canvas),this.texture.needsUpdate=!0,this.applyAntiAlias(),this.material?this.material.map=this.texture:(this.material=new a.MeshBasicMaterial({map:this.texture,side:this.side}),this.material.transparent=!0),this.mesh||(this.geometry=new a.PlaneGeometry(this.canvas.width,this.canvas.height),this.mesh=new a.Mesh(this.geometry,this.material),this.add(this.mesh)),this.mesh.position.x=this.canvas.width/2-this.canvas.textWidth/2+this.canvas.textWidth/2*this.align.x,this.mesh.position.y=-this.canvas.height/2+this.canvas.textHeight/2*this.align.y,this.geometry.vertices[0].x=this.geometry.vertices[2].x=-this.canvas.width/2,this.geometry.vertices[1].x=this.geometry.vertices[3].x=this.canvas.width/2,this.geometry.vertices[0].y=this.geometry.vertices[1].y=this.canvas.height/2,this.geometry.vertices[2].y=this.geometry.vertices[3].y=-this.canvas.height/2,this.geometry.verticesNeedUpdate=!0},e}(n(8).Text2D);e.MeshText2D=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2);e.glMatrix=r;const i=n(25);e.mat2=i;const a=n(26);e.mat2d=a;const o=n(9);e.mat3=o;const s=n(27);e.mat4=s;const c=n(28);e.quat=c;const l=n(29);e.vec2=l;const u=n(10);e.vec3=u;const h=n(11);e.vec4=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2);function i(t,e,n){let r=e[0],i=e[1],a=e[2],o=e[3],s=n[0],c=n[1],l=n[2],u=n[3];return t[0]=r*s+a*c,t[1]=i*s+o*c,t[2]=r*l+a*u,t[3]=i*l+o*u,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}e.create=function(){let t=new r.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.clone=function(t){let e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,e,n,i){let a=new r.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=i,a},e.set=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},e.transpose=function(t,e){if(t===e){let n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},e.invert=function(t,e){let n=e[0],r=e[1],i=e[2],a=e[3],o=n*a-i*r;return o?(o=1/o,t[0]=a*o,t[1]=-r*o,t[2]=-i*o,t[3]=n*o,t):null},e.adjoint=function(t,e){let n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=i,e.rotate=function(t,e,n){let r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),c=Math.cos(n);return t[0]=r*c+a*s,t[1]=i*c+o*s,t[2]=r*-s+a*c,t[3]=i*-s+o*c,t},e.scale=function(t,e,n){let r=e[0],i=e[1],a=e[2],o=e[3],s=n[0],c=n[1];return t[0]=r*s,t[1]=i*s,t[2]=a*c,t[3]=o*c,t},e.fromRotation=function(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=a,e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){let n=t[0],i=t[1],a=t[2],o=t[3],s=e[0],c=e[1],l=e[2],u=e[3];return Math.abs(n-s)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-c)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-l)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(o-u)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))},e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},e.mul=i,e.sub=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2);function i(t,e,n){let r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=n[0],u=n[1],h=n[2],f=n[3],d=n[4],p=n[5];return t[0]=r*l+a*u,t[1]=i*l+o*u,t[2]=r*h+a*f,t[3]=i*h+o*f,t[4]=r*d+a*p+s,t[5]=i*d+o*p+c,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}e.create=function(){let t=new r.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.clone=function(t){let e=new r.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.fromValues=function(t,e,n,i,a,o){let s=new r.ARRAY_TYPE(6);return s[0]=t,s[1]=e,s[2]=n,s[3]=i,s[4]=a,s[5]=o,s},e.set=function(t,e,n,r,i,a,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t},e.invert=function(t,e){let n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=n*a-r*i;return c?(c=1/c,t[0]=a*c,t[1]=-r*c,t[2]=-i*c,t[3]=n*c,t[4]=(i*s-a*o)*c,t[5]=(r*o-n*s)*c,t):null},e.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},e.multiply=i,e.rotate=function(t,e,n){let r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*l,t[1]=i*u+o*l,t[2]=r*-l+a*u,t[3]=i*-l+o*u,t[4]=s,t[5]=c,t},e.scale=function(t,e,n){let r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=n[0],u=n[1];return t[0]=r*l,t[1]=i*l,t[2]=a*u,t[3]=o*u,t[4]=s,t[5]=c,t},e.translate=function(t,e,n){let r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=n[0],u=n[1];return t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=r*l+a*u+s,t[5]=i*l+o*u+c,t},e.fromRotation=function(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},e.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},e.subtract=a,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},e.equals=function(t,e){let n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=e[0],u=e[1],h=e[2],f=e[3],d=e[4],p=e[5];return Math.abs(n-l)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-u)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-h)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(o-f)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(s-d)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(c-p)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(p))},e.mul=i,e.sub=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2);function i(t,e,n){let r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=e[6],u=e[7],h=e[8],f=e[9],d=e[10],p=e[11],m=e[12],v=e[13],g=e[14],y=e[15],_=n[0],x=n[1],b=n[2],w=n[3];return t[0]=_*r+x*s+b*h+w*m,t[1]=_*i+x*c+b*f+w*v,t[2]=_*a+x*l+b*d+w*g,t[3]=_*o+x*u+b*p+w*y,_=n[4],x=n[5],b=n[6],w=n[7],t[4]=_*r+x*s+b*h+w*m,t[5]=_*i+x*c+b*f+w*v,t[6]=_*a+x*l+b*d+w*g,t[7]=_*o+x*u+b*p+w*y,_=n[8],x=n[9],b=n[10],w=n[11],t[8]=_*r+x*s+b*h+w*m,t[9]=_*i+x*c+b*f+w*v,t[10]=_*a+x*l+b*d+w*g,t[11]=_*o+x*u+b*p+w*y,_=n[12],x=n[13],b=n[14],w=n[15],t[12]=_*r+x*s+b*h+w*m,t[13]=_*i+x*c+b*f+w*v,t[14]=_*a+x*l+b*d+w*g,t[15]=_*o+x*u+b*p+w*y,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}e.create=function(){let t=new r.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.clone=function(t){let e=new r.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.fromValues=function(t,e,n,i,a,o,s,c,l,u,h,f,d,p,m,v){let g=new r.ARRAY_TYPE(16);return g[0]=t,g[1]=e,g[2]=n,g[3]=i,g[4]=a,g[5]=o,g[6]=s,g[7]=c,g[8]=l,g[9]=u,g[10]=h,g[11]=f,g[12]=d,g[13]=p,g[14]=m,g[15]=v,g},e.set=function(t,e,n,r,i,a,o,s,c,l,u,h,f,d,p,m,v){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=c,t[8]=l,t[9]=u,t[10]=h,t[11]=f,t[12]=d,t[13]=p,t[14]=m,t[15]=v,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.transpose=function(t,e){if(t===e){let n=e[1],r=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},e.invert=function(t,e){let n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],l=e[7],u=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],v=e[14],g=e[15],y=n*s-r*o,_=n*c-i*o,x=n*l-a*o,b=r*c-i*s,w=r*l-a*s,M=i*l-a*c,E=u*m-h*p,T=u*v-f*p,S=u*g-d*p,A=h*v-f*m,R=h*g-d*m,L=f*g-d*v,C=y*L-_*R+x*A+b*S-w*T+M*E;return C?(C=1/C,t[0]=(s*L-c*R+l*A)*C,t[1]=(i*R-r*L-a*A)*C,t[2]=(m*M-v*w+g*b)*C,t[3]=(f*w-h*M-d*b)*C,t[4]=(c*S-o*L-l*T)*C,t[5]=(n*L-i*S+a*T)*C,t[6]=(v*x-p*M-g*_)*C,t[7]=(u*M-f*x+d*_)*C,t[8]=(o*R-s*S+l*E)*C,t[9]=(r*S-n*R-a*E)*C,t[10]=(p*w-m*x+g*y)*C,t[11]=(h*x-u*w-d*y)*C,t[12]=(s*T-o*A-c*E)*C,t[13]=(n*A-r*T+i*E)*C,t[14]=(m*_-p*b-v*y)*C,t[15]=(u*b-h*_+f*y)*C,t):null},e.adjoint=function(t,e){let n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],l=e[7],u=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],v=e[14],g=e[15];return t[0]=s*(f*g-d*v)-h*(c*g-l*v)+m*(c*d-l*f),t[1]=-(r*(f*g-d*v)-h*(i*g-a*v)+m*(i*d-a*f)),t[2]=r*(c*g-l*v)-s*(i*g-a*v)+m*(i*l-a*c),t[3]=-(r*(c*d-l*f)-s*(i*d-a*f)+h*(i*l-a*c)),t[4]=-(o*(f*g-d*v)-u*(c*g-l*v)+p*(c*d-l*f)),t[5]=n*(f*g-d*v)-u*(i*g-a*v)+p*(i*d-a*f),t[6]=-(n*(c*g-l*v)-o*(i*g-a*v)+p*(i*l-a*c)),t[7]=n*(c*d-l*f)-o*(i*d-a*f)+u*(i*l-a*c),t[8]=o*(h*g-d*m)-u*(s*g-l*m)+p*(s*d-l*h),t[9]=-(n*(h*g-d*m)-u*(r*g-a*m)+p*(r*d-a*h)),t[10]=n*(s*g-l*m)-o*(r*g-a*m)+p*(r*l-a*s),t[11]=-(n*(s*d-l*h)-o*(r*d-a*h)+u*(r*l-a*s)),t[12]=-(o*(h*v-f*m)-u*(s*v-c*m)+p*(s*f-c*h)),t[13]=n*(h*v-f*m)-u*(r*v-i*m)+p*(r*f-i*h),t[14]=-(n*(s*v-c*m)-o*(r*v-i*m)+p*(r*c-i*s)),t[15]=n*(s*f-c*h)-o*(r*f-i*h)+u*(r*c-i*s),t},e.determinant=function(t){let e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],c=t[7],l=t[8],u=t[9],h=t[10],f=t[11],d=t[12],p=t[13],m=t[14],v=t[15];return(e*o-n*a)*(h*v-f*m)-(e*s-r*a)*(u*v-f*p)+(e*c-i*a)*(u*m-h*p)+(n*s-r*o)*(l*v-f*d)-(n*c-i*o)*(l*m-h*d)+(r*c-i*s)*(l*p-u*d)},e.multiply=i,e.translate=function(t,e,n){let r,i,a,o,s,c,l,u,h,f,d,p,m=n[0],v=n[1],g=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*g+e[12],t[13]=e[1]*m+e[5]*v+e[9]*g+e[13],t[14]=e[2]*m+e[6]*v+e[10]*g+e[14],t[15]=e[3]*m+e[7]*v+e[11]*g+e[15]):(r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=e[6],u=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=c,t[6]=l,t[7]=u,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=r*m+s*v+h*g+e[12],t[13]=i*m+c*v+f*g+e[13],t[14]=a*m+l*v+d*g+e[14],t[15]=o*m+u*v+p*g+e[15]),t},e.scale=function(t,e,n){let r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.rotate=function(t,e,n,i){let a,o,s,c,l,u,h,f,d,p,m,v,g,y,_,x,b,w,M,E,T,S,A,R,L=i[0],C=i[1],P=i[2],O=Math.sqrt(L*L+C*C+P*P);return Math.abs(O)<r.EPSILON?null:(L*=O=1/O,C*=O,P*=O,a=Math.sin(n),s=1-(o=Math.cos(n)),c=e[0],l=e[1],u=e[2],h=e[3],f=e[4],d=e[5],p=e[6],m=e[7],v=e[8],g=e[9],y=e[10],_=e[11],x=L*L*s+o,b=C*L*s+P*a,w=P*L*s-C*a,M=L*C*s-P*a,E=C*C*s+o,T=P*C*s+L*a,S=L*P*s+C*a,A=C*P*s-L*a,R=P*P*s+o,t[0]=c*x+f*b+v*w,t[1]=l*x+d*b+g*w,t[2]=u*x+p*b+y*w,t[3]=h*x+m*b+_*w,t[4]=c*M+f*E+v*T,t[5]=l*M+d*E+g*T,t[6]=u*M+p*E+y*T,t[7]=h*M+m*E+_*T,t[8]=c*S+f*A+v*R,t[9]=l*S+d*A+g*R,t[10]=u*S+p*A+y*R,t[11]=h*S+m*A+_*R,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},e.rotateX=function(t,e,n){let r=Math.sin(n),i=Math.cos(n),a=e[4],o=e[5],s=e[6],c=e[7],l=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+l*r,t[5]=o*i+u*r,t[6]=s*i+h*r,t[7]=c*i+f*r,t[8]=l*i-a*r,t[9]=u*i-o*r,t[10]=h*i-s*r,t[11]=f*i-c*r,t},e.rotateY=function(t,e,n){let r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],c=e[3],l=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-l*r,t[1]=o*i-u*r,t[2]=s*i-h*r,t[3]=c*i-f*r,t[8]=a*r+l*i,t[9]=o*r+u*i,t[10]=s*r+h*i,t[11]=c*r+f*i,t},e.rotateZ=function(t,e,n){let r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],c=e[3],l=e[4],u=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+l*r,t[1]=o*i+u*r,t[2]=s*i+h*r,t[3]=c*i+f*r,t[4]=l*i-a*r,t[5]=u*i-o*r,t[6]=h*i-s*r,t[7]=f*i-c*r,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,e,n){let i,a,o,s=n[0],c=n[1],l=n[2],u=Math.sqrt(s*s+c*c+l*l);return Math.abs(u)<r.EPSILON?null:(s*=u=1/u,c*=u,l*=u,i=Math.sin(e),o=1-(a=Math.cos(e)),t[0]=s*s*o+a,t[1]=c*s*o+l*i,t[2]=l*s*o-c*i,t[3]=0,t[4]=s*c*o-l*i,t[5]=c*c*o+a,t[6]=l*c*o+s*i,t[7]=0,t[8]=s*l*o+c*i,t[9]=c*l*o-s*i,t[10]=l*l*o+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},e.fromXRotation=function(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=function(t,e,n){let r=e[0],i=e[1],a=e[2],o=e[3],s=r+r,c=i+i,l=a+a,u=r*s,h=r*c,f=r*l,d=i*c,p=i*l,m=a*l,v=o*s,g=o*c,y=o*l;return t[0]=1-(d+m),t[1]=h+y,t[2]=f-g,t[3]=0,t[4]=h-y,t[5]=1-(u+m),t[6]=p+v,t[7]=0,t[8]=f+g,t[9]=p-v,t[10]=1-(u+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.getScaling=function(t,e){let n=e[0],r=e[1],i=e[2],a=e[4],o=e[5],s=e[6],c=e[8],l=e[9],u=e[10];return t[0]=Math.sqrt(n*n+r*r+i*i),t[1]=Math.sqrt(a*a+o*o+s*s),t[2]=Math.sqrt(c*c+l*l+u*u),t},e.getRotation=function(t,e){let n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},e.fromRotationTranslationScale=function(t,e,n,r){let i=e[0],a=e[1],o=e[2],s=e[3],c=i+i,l=a+a,u=o+o,h=i*c,f=i*l,d=i*u,p=a*l,m=a*u,v=o*u,g=s*c,y=s*l,_=s*u,x=r[0],b=r[1],w=r[2];return t[0]=(1-(p+v))*x,t[1]=(f+_)*x,t[2]=(d-y)*x,t[3]=0,t[4]=(f-_)*b,t[5]=(1-(h+v))*b,t[6]=(m+g)*b,t[7]=0,t[8]=(d+y)*w,t[9]=(m-g)*w,t[10]=(1-(h+p))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,e,n,r,i){let a=e[0],o=e[1],s=e[2],c=e[3],l=a+a,u=o+o,h=s+s,f=a*l,d=a*u,p=a*h,m=o*u,v=o*h,g=s*h,y=c*l,_=c*u,x=c*h,b=r[0],w=r[1],M=r[2],E=i[0],T=i[1],S=i[2];return t[0]=(1-(m+g))*b,t[1]=(d+x)*b,t[2]=(p-_)*b,t[3]=0,t[4]=(d-x)*w,t[5]=(1-(f+g))*w,t[6]=(v+y)*w,t[7]=0,t[8]=(p+_)*M,t[9]=(v-y)*M,t[10]=(1-(f+m))*M,t[11]=0,t[12]=n[0]+E-(t[0]*E+t[4]*T+t[8]*S),t[13]=n[1]+T-(t[1]*E+t[5]*T+t[9]*S),t[14]=n[2]+S-(t[2]*E+t[6]*T+t[10]*S),t[15]=1,t},e.fromQuat=function(t,e){let n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,c=i+i,l=n*o,u=r*o,h=r*s,f=i*o,d=i*s,p=i*c,m=a*o,v=a*s,g=a*c;return t[0]=1-h-p,t[1]=u+g,t[2]=f-v,t[3]=0,t[4]=u-g,t[5]=1-l-p,t[6]=d+m,t[7]=0,t[8]=f+v,t[9]=d-m,t[10]=1-l-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,e,n,r,i,a,o){let s=1/(n-e),c=1/(i-r),l=1/(a-o);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*c,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*c,t[10]=(o+a)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*l,t[15]=0,t},e.perspective=function(t,e,n,r,i){let a=1/Math.tan(e/2),o=1/(r-i);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+r)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*r*o,t[15]=0,t},e.perspectiveFromFieldOfView=function(t,e,n,r){let i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),c=2/(o+s),l=2/(i+a);return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-(o-s)*c*.5,t[9]=(i-a)*l*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},e.ortho=function(t,e,n,r,i,a,o){let s=1/(e-n),c=1/(r-i),l=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*c,t[14]=(o+a)*l,t[15]=1,t},e.lookAt=function(t,e,n,i){let a,o,s,c,l,u,h,f,d,p,m=e[0],v=e[1],g=e[2],y=i[0],_=i[1],x=i[2],b=n[0],w=n[1],M=n[2];return Math.abs(m-b)<r.EPSILON&&Math.abs(v-w)<r.EPSILON&&Math.abs(g-M)<r.EPSILON?mat4.identity(t):(h=m-b,f=v-w,d=g-M,a=_*(d*=p=1/Math.sqrt(h*h+f*f+d*d))-x*(f*=p),o=x*(h*=p)-y*d,s=y*f-_*h,(p=Math.sqrt(a*a+o*o+s*s))?(a*=p=1/p,o*=p,s*=p):(a=0,o=0,s=0),c=f*s-d*o,l=d*a-h*s,u=h*o-f*a,(p=Math.sqrt(c*c+l*l+u*u))?(c*=p=1/p,l*=p,u*=p):(c=0,l=0,u=0),t[0]=a,t[1]=c,t[2]=h,t[3]=0,t[4]=o,t[5]=l,t[6]=f,t[7]=0,t[8]=s,t[9]=u,t[10]=d,t[11]=0,t[12]=-(a*m+o*v+s*g),t[13]=-(c*m+l*v+u*g),t[14]=-(h*m+f*v+d*g),t[15]=1,t)},e.targetTo=function(t,e,n,r){let i=e[0],a=e[1],o=e[2],s=r[0],c=r[1],l=r[2],u=i-n[0],h=a-n[1],f=o-n[2],d=u*u+h*h+f*f;d>0&&(u*=d=1/Math.sqrt(d),h*=d,f*=d);let p=c*f-l*h,m=l*u-s*f,v=s*h-c*u;return t[0]=p,t[1]=m,t[2]=v,t[3]=0,t[4]=h*v-f*m,t[5]=f*p-u*v,t[6]=u*m-h*p,t[7]=0,t[8]=u,t[9]=h,t[10]=f,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},e.subtract=a,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},e.equals=function(t,e){let n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=t[6],u=t[7],h=t[8],f=t[9],d=t[10],p=t[11],m=t[12],v=t[13],g=t[14],y=t[15],_=e[0],x=e[1],b=e[2],w=e[3],M=e[4],E=e[5],T=e[6],S=e[7],A=e[8],R=e[9],L=e[10],C=e[11],P=e[12],O=e[13],N=e[14],I=e[15];return Math.abs(n-_)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(i-x)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(a-b)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(o-w)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-M)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(c-E)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(l-T)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(u-S)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(h-A)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(f-R)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(d-L)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(p-C)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(m-P)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(v-O)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(g-N)<=r.EPSILON*Math.max(1,Math.abs(g),Math.abs(N))&&Math.abs(y-I)<=r.EPSILON*Math.max(1,Math.abs(y),Math.abs(I))},e.mul=i,e.sub=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2),i=n(9),a=n(10),o=n(11);function s(){let t=new r.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function c(t,e,n){n*=.5;let r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function l(t,e,n){let r=e[0],i=e[1],a=e[2],o=e[3],s=n[0],c=n[1],l=n[2],u=n[3];return t[0]=r*u+o*s+i*l-a*c,t[1]=i*u+o*c+a*s-r*l,t[2]=a*u+o*l+r*c-i*s,t[3]=o*u-r*s-i*c-a*l,t}function u(t,e,n,r){let i,a,o,s,c,l=e[0],u=e[1],h=e[2],f=e[3],d=n[0],p=n[1],m=n[2],v=n[3];return(a=l*d+u*p+h*m+f*v)<0&&(a=-a,d=-d,p=-p,m=-m,v=-v),1-a>1e-6?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-r)*i)/o,c=Math.sin(r*i)/o):(s=1-r,c=r),t[0]=s*l+c*d,t[1]=s*u+c*p,t[2]=s*h+c*m,t[3]=s*f+c*v,t}function h(t,e){let n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{let r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);let i=(r+1)%3,a=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*i+i]-e[3*a+a]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*i+a]-e[3*a+i])*n,t[i]=(e[3*i+r]+e[3*r+i])*n,t[a]=(e[3*a+r]+e[3*r+a])*n}return t}e.create=s,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},e.setAxisAngle=c,e.getAxisAngle=function(t,e){let n=2*Math.acos(e[3]),r=Math.sin(n/2);return 0!=r?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n},e.multiply=l,e.rotateX=function(t,e,n){n*=.5;let r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),c=Math.cos(n);return t[0]=r*c+o*s,t[1]=i*c+a*s,t[2]=a*c-i*s,t[3]=o*c-r*s,t},e.rotateY=function(t,e,n){n*=.5;let r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),c=Math.cos(n);return t[0]=r*c-a*s,t[1]=i*c+o*s,t[2]=a*c+r*s,t[3]=o*c-i*s,t},e.rotateZ=function(t,e,n){n*=.5;let r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),c=Math.cos(n);return t[0]=r*c+i*s,t[1]=i*c-r*s,t[2]=a*c+o*s,t[3]=o*c-a*s,t},e.calculateW=function(t,e){let n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t},e.slerp=u,e.invert=function(t,e){let n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a,s=o?1/o:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=a*s,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},e.fromMat3=h,e.fromEuler=function(t,e,n,r){let i=.5*Math.PI/180;e*=i,n*=i,r*=i;let a=Math.sin(e),o=Math.cos(e),s=Math.sin(n),c=Math.cos(n),l=Math.sin(r),u=Math.cos(r);return t[0]=a*c*u-o*s*l,t[1]=o*s*u+a*c*l,t[2]=o*c*l-a*s*u,t[3]=o*c*u+a*s*l,t},e.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.clone=o.clone,e.fromValues=o.fromValues,e.copy=o.copy,e.set=o.set,e.add=o.add,e.mul=l,e.scale=o.scale,e.dot=o.dot,e.lerp=o.lerp,e.length=o.length,e.len=e.length,e.squaredLength=o.squaredLength,e.sqrLen=e.squaredLength,e.normalize=o.normalize,e.exactEquals=o.exactEquals,e.equals=o.equals,e.rotationTo=function(){let t=a.create(),n=a.fromValues(1,0,0),r=a.fromValues(0,1,0);return function(i,o,s){let l=a.dot(o,s);return l<-.999999?(a.cross(t,n,o),a.len(t)<1e-6&&a.cross(t,r,o),a.normalize(t,t),c(i,t,Math.PI),i):l>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(a.cross(t,o,s),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+l,e.normalize(i,i))}}(),e.sqlerp=function(){let t=s(),e=s();return function(n,r,i,a,o,s){return u(t,r,o,s),u(e,i,a,s),u(n,t,e,2*s*(1-s)),n}}(),e.setAxes=function(){let t=i.create();return function(n,r,i,a){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],e.normalize(n,h(n,t))}}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2);function i(){let t=new r.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function o(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function s(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function c(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function l(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function u(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function h(t){var e=t[0],n=t[1];return e*e+n*n}e.create=i,e.clone=function(t){let e=new r.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},e.fromValues=function(t,e){let n=new r.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},e.set=function(t,e,n){return t[0]=e,t[1]=n,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},e.subtract=a,e.multiply=o,e.divide=s,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t},e.distance=c,e.squaredDistance=l,e.length=u,e.squaredLength=h,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},e.normalize=function(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},e.cross=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t},e.lerp=function(t,e,n,r){var i=e[0],a=e[1];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t},e.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},e.transformMat2=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t},e.transformMat2d=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t},e.transformMat3=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t},e.transformMat4=function(t,e,n){let r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t},e.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},e.equals=function(t,e){let n=t[0],i=t[1],a=e[0],o=e[1];return Math.abs(n-a)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-o)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(o))},e.len=u,e.sub=a,e.mul=o,e.div=s,e.dist=c,e.sqrDist=l,e.sqrLen=h,e.forEach=function(){let t=i();return function(e,n,r,i,a,o){let s,c;for(n||(n=2),r||(r=0),c=i?Math.min(i*n+r,e.length):e.length,s=r;s<c;s+=n)t[0]=e[s],t[1]=e[s+1],a(t,t,o),e[s]=t[0],e[s+1]=t[1];return e}}()},function(t,e,n){!function(t){"use strict";var e=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},n=function(t){var n;return 1===t.length&&(n=t,t=function(t,r){return e(n(t),r)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)<0?r=a+1:i=a}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)>0?i=a:r=a+1}return r}}},r=n(e),i=r.right,a=r.left,o=function(t){return null===t?NaN:+t},s=function(t,e){var n,r,i=t.length,a=0,s=0,c=-1,l=0;if(null==e)for(;++c<i;)isNaN(n=o(t[c]))||(a+=(r=n-a)/++l,s+=r*(n-a));else for(;++c<i;)isNaN(n=o(e(t[c],c,t)))||(a+=(r=n-a)/++l,s+=r*(n-a));if(l>1)return s/(l-1)},c=function(t,e){var n=s(t,e);return n?Math.sqrt(n):n},l=function(t,e){var n,r,i,a=-1,o=t.length;if(null==e){for(;++a<o;)if(null!=(r=t[a])&&r>=r){n=i=r;break}for(;++a<o;)null!=(r=t[a])&&(n>r&&(n=r),i<r&&(i=r))}else{for(;++a<o;)if(null!=(r=e(t[a],a,t))&&r>=r){n=i=r;break}for(;++a<o;)null!=(r=e(t[a],a,t))&&(n>r&&(n=r),i<r&&(i=r))}return[n,i]},u=Array.prototype,h=u.slice,f=u.map,d=function(t){return function(){return t}},p=function(t){return t},m=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a},v=Math.sqrt(50),g=Math.sqrt(10),y=Math.sqrt(2),_=function(t,e,n){var r=x(t,e,n);return m(Math.ceil(t/r)*r,Math.floor(e/r)*r+r/2,r)};function x(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=v?i*=10:a>=g?i*=5:a>=y&&(i*=2),e<t?-i:i}var b=function(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1},w=function(t,e,n){if(null==n&&(n=o),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),s=+n(t[a],a,t),c=+n(t[a+1],a+1,t);return s+(c-s)*(i-a)}},M=function(t){for(var e,n,r,i=t.length,a=-1,o=0;++a<i;)o+=t[a].length;for(n=new Array(o);--i>=0;)for(r=t[i],e=r.length;--e>=0;)n[--o]=r[e];return n},E=function(t,e){var n,r,i=-1,a=t.length;if(null==e){for(;++i<a;)if(null!=(r=t[i])&&r>=r){n=r;break}for(;++i<a;)null!=(r=t[i])&&n>r&&(n=r)}else{for(;++i<a;)if(null!=(r=e(t[i],i,t))&&r>=r){n=r;break}for(;++i<a;)null!=(r=e(t[i],i,t))&&n>r&&(n=r)}return n},T=function(t){if(!(i=t.length))return[];for(var e=-1,n=E(t,S),r=new Array(n);++e<n;)for(var i,a=-1,o=r[e]=new Array(i);++a<i;)o[a]=t[a][e];return r};function S(t){return t.length}var A=Array.prototype.slice,R=function(t){return t},L=1,C=2,P=3,O=4,N=1e-6;function I(t,e,n){var r=t(n);return"translate("+(isFinite(r)?r:e(n))+",0)"}function z(t,e,n){var r=t(n);return"translate(0,"+(isFinite(r)?r:e(n))+")"}function U(){return!this.__axis}function D(t,e){var n=[],r=null,i=null,a=6,o=6,s=3;function c(c){var l,u=null==r?e.ticks?e.ticks.apply(e,n):e.domain():r,h=null==i?e.tickFormat?e.tickFormat.apply(e,n):R:i,f=Math.max(a,0)+s,d=t===L||t===P?I:z,p=e.range(),m=p[0]+.5,v=p[p.length-1]+.5,g=(e.bandwidth?function(t){var e=t.bandwidth()/2;return t.round()&&(e=Math.round(e)),function(n){return t(n)+e}}:R)(e.copy()),y=c.selection?c.selection():c,_=y.selectAll(".domain").data([null]),x=y.selectAll(".tick").data(u,e).order(),b=x.exit(),w=x.enter().append("g").attr("class","tick"),M=x.select("line"),E=x.select("text"),T=t===L||t===O?-1:1,S=t===O||t===C?(l="x","y"):(l="y","x");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),x=x.merge(w),M=M.merge(w.append("line").attr("stroke","#000").attr(l+"2",T*a).attr(S+"1",.5).attr(S+"2",.5)),E=E.merge(w.append("text").attr("fill","#000").attr(l,T*f).attr(S,.5).attr("dy",t===L?"0em":t===P?"0.71em":"0.32em")),c!==y&&(_=_.transition(c),x=x.transition(c),M=M.transition(c),E=E.transition(c),b=b.transition(c).attr("opacity",N).attr("transform",function(t){return d(g,this.parentNode.__axis||g,t)}),w.attr("opacity",N).attr("transform",function(t){return d(this.parentNode.__axis||g,g,t)})),b.remove(),_.attr("d",t===O||t==C?"M"+T*o+","+m+"H0.5V"+v+"H"+T*o:"M"+m+","+T*o+"V0.5H"+v+"V"+T*o),x.attr("opacity",1).attr("transform",function(t){return d(g,g,t)}),M.attr(l+"2",T*a),E.attr(l,T*f).text(h),y.filter(U).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===C?"start":t===O?"end":"middle"),y.each(function(){this.__axis=g})}return c.scale=function(t){return arguments.length?(e=t,c):e},c.ticks=function(){return n=A.call(arguments),c},c.tickArguments=function(t){return arguments.length?(n=null==t?[]:A.call(t),c):n.slice()},c.tickValues=function(t){return arguments.length?(r=null==t?null:A.call(t),c):r&&r.slice()},c.tickFormat=function(t){return arguments.length?(i=t,c):i},c.tickSize=function(t){return arguments.length?(a=o=+t,c):a},c.tickSizeInner=function(t){return arguments.length?(a=+t,c):a},c.tickSizeOuter=function(t){return arguments.length?(o=+t,c):o},c.tickPadding=function(t){return arguments.length?(s=+t,c):s},c}var k={value:function(){}};function F(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new B(r)}function B(t){this._=t}function j(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function H(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=k,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}B.prototype=F.prototype={constructor:B,on:function(t,e){var n,r,i=this._,a=(r=i,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),o=-1,s=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=a[o]).type)i[n]=H(i[n],t.name,e);else if(null==e)for(n in i)i[n]=H(i[n],t.name,null);return this}for(;++o<s;)if((n=(t=a[o]).type)&&(n=j(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new B(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=this._[t],a=0,n=r.length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};var G="http://www.w3.org/1999/xhtml",V={svg:"http://www.w3.org/2000/svg",xhtml:G,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},W=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),V.hasOwnProperty(e)?{space:V[e],local:t}:t},q=function(t){var e=W(t);return(e.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===G&&e.documentElement.namespaceURI===G?e.createElement(t):e.createElementNS(n,t)}})(e)},X=0;function Y(){return new Z}function Z(){this._="@"+(++X).toString(36)}Z.prototype=Y.prototype={constructor:Z,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var J=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var Q=document.documentElement;if(!Q.matches){var K=Q.webkitMatchesSelector||Q.msMatchesSelector||Q.mozMatchesSelector||Q.oMatchesSelector;J=function(t){return function(){return K.call(this,t)}}}}var $=J,tt={};if(t.event=null,"undefined"!=typeof document){var et=document.documentElement;"onmouseenter"in et||(tt={mouseenter:"mouseover",mouseleave:"mouseout"})}function nt(t,e,n){return t=rt(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function rt(e,n,r){return function(i){var a=t.event;t.event=i;try{e.call(this,this.__data__,n,r)}finally{t.event=a}}}function it(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function at(t,e,n){var r=tt.hasOwnProperty(t.type)?nt:rt;return function(i,a,o){var s,c=this.__on,l=r(e,a,o);if(c)for(var u=0,h=c.length;u<h;++u)if((s=c[u]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=l,s.capture=n),void(s.value=e);this.addEventListener(t.type,l,n),s={type:t.type,name:t.name,value:e,listener:l,capture:n},c?c.push(s):this.__on=[s]}}function ot(e,n,r,i){var a=t.event;e.sourceEvent=t.event,t.event=e;try{return n.apply(r,i)}finally{t.event=a}}var st=function(){for(var e,n=t.event;e=n.sourceEvent;)n=e;return n},ct=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]},lt=function(t){var e=st();return e.changedTouches&&(e=e.changedTouches[0]),ct(t,e)};function ut(){}var ht=function(t){return null==t?ut:function(){return this.querySelector(t)}};function ft(){return[]}var dt=function(t){return null==t?ft:function(){return this.querySelectorAll(t)}},pt=function(t){return new Array(t.length)};function mt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}mt.prototype={constructor:mt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var vt="$";function gt(t,e,n,r,i,a){for(var o,s=0,c=e.length,l=a.length;s<l;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new mt(t,a[s]);for(;s<c;++s)(o=e[s])&&(i[s]=o)}function yt(t,e,n,r,i,a,o){var s,c,l,u={},h=e.length,f=a.length,d=new Array(h);for(s=0;s<h;++s)(c=e[s])&&(d[s]=l=vt+o.call(c,c.__data__,s,e),l in u?i[s]=c:u[l]=c);for(s=0;s<f;++s)l=vt+o.call(t,a[s],s,a),(c=u[l])?(r[s]=c,c.__data__=a[s],u[l]=null):n[s]=new mt(t,a[s]);for(s=0;s<h;++s)(c=e[s])&&u[d[s]]===c&&(i[s]=c)}function _t(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var xt=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function bt(t){return t.trim().split(/^|\s+/)}function wt(t){return t.classList||new Mt(t)}function Mt(t){this._node=t,this._names=bt(t.getAttribute("class")||"")}function Et(t,e){for(var n=wt(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Tt(t,e){for(var n=wt(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function St(){this.textContent=""}function At(){this.innerHTML=""}function Rt(){this.nextSibling&&this.parentNode.appendChild(this)}function Lt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ct(){return null}function Pt(){var t=this.parentNode;t&&t.removeChild(this)}function Ot(t,e,n){var r=xt(t),i=r.CustomEvent;i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}Mt.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Nt=[null];function It(t,e){this._groups=t,this._parents=e}function zt(){return new It([[document.documentElement]],Nt)}It.prototype=zt.prototype={constructor:It,select:function(t){"function"!=typeof t&&(t=ht(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=e[i],c=s.length,l=r[i]=new Array(c),u=0;u<c;++u)(a=s[u])&&(o=t.call(a,a.__data__,u,s))&&("__data__"in a&&(o.__data__=a.__data__),l[u]=o);return new It(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=dt(t));for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o,s=e[a],c=s.length,l=0;l<c;++l)(o=s[l])&&(r.push(t.call(o,o.__data__,l,s)),i.push(o));return new It(r,i)},filter:function(t){"function"!=typeof t&&(t=$(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,c=r[i]=[],l=0;l<s;++l)(a=o[l])&&t.call(a,a.__data__,l,o)&&c.push(a);return new It(r,this._parents)},data:function(t,e){if(!t)return p=new Array(this.size()),u=-1,this.each(function(t){p[++u]=t}),p;var n,r=e?yt:gt,i=this._parents,a=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=a.length,s=new Array(o),c=new Array(o),l=new Array(o),u=0;u<o;++u){var h=i[u],f=a[u],d=f.length,p=t.call(h,h&&h.__data__,u,i),m=p.length,v=c[u]=new Array(m),g=s[u]=new Array(m),y=l[u]=new Array(d);r(h,f,v,g,y,p,e);for(var _,x,b=0,w=0;b<m;++b)if(_=v[b]){for(b>=w&&(w=b+1);!(x=g[w])&&++w<m;);_._next=x||null}}return(s=new It(s,i))._enter=c,s._exit=l,s},enter:function(){return new It(this._enter||this._groups.map(pt),this._parents)},exit:function(){return new It(this._exit||this._groups.map(pt),this._parents)},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var c,l=e[s],u=n[s],h=l.length,f=o[s]=new Array(h),d=0;d<h;++d)(c=l[d]||u[d])&&(f[d]=c);for(;s<r;++s)o[s]=e[s];return new It(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=_t);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],c=s.length,l=i[a]=new Array(c),u=0;u<c;++u)(o=s[u])&&(l[u]=o);l.sort(e)}return new It(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,s=a.length;o<s;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,e){var n=W(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}:function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){var r;return arguments.length>1?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):xt(r=this.node()).getComputedStyle(r,null).getPropertyValue(t)},property:function(t,e){return arguments.length>1?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=bt(t+"");if(arguments.length<2){for(var r=wt(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?Et:Tt)(this,t)}}:e?function(t){return function(){Et(this,t)}}:function(t){return function(){Tt(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?St:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?At:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(Rt)},lower:function(){return this.each(Lt)},append:function(t){var e="function"==typeof t?t:q(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:q(t),r=null==e?Ct:"function"==typeof e?e:ht(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(Pt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),o=a.length;if(!(arguments.length<2)){for(s=e?at:it,null==n&&(n=!1),r=0;r<o;++r)this.each(s(a[r],e,n));return this}var s=this.node().__on;if(s)for(var c,l=0,u=s.length;l<u;++l)for(r=0,c=s[l];r<o;++r)if((i=a[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return Ot(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return Ot(this,t,e)}})(t,e))}};var Ut=function(t){return"string"==typeof t?new It([[document.querySelector(t)]],[document.documentElement]):new It([[t]],Nt)},Dt=function(t,e,n){arguments.length<3&&(n=e,e=st().changedTouches);for(var r,i=0,a=e?e.length:0;i<a;++i)if((r=e[i]).identifier===n)return ct(t,r);return null};function kt(){t.event.stopImmediatePropagation()}var Ft=function(){t.event.preventDefault(),t.event.stopImmediatePropagation()},Bt=function(t){var e=t.document.documentElement,n=Ut(t).on("dragstart.drag",Ft,!0);"onselectstart"in e?n.on("selectstart.drag",Ft,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function jt(t,e){var n=t.document.documentElement,r=Ut(t).on("dragstart.drag",null);e&&(r.on("click.drag",Ft,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Ht=function(t){return function(){return t}};function Gt(t,e,n,r,i,a,o,s,c,l){this.target=t,this.type=e,this.subject=n,this.identifier=r,this.active=i,this.x=a,this.y=o,this.dx=s,this.dy=c,this._=l}function Vt(){return!t.event.button}function Wt(){return this.parentNode}function qt(e){return null==e?{x:t.event.x,y:t.event.y}:e}Gt.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Xt=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function Yt(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Zt(){}var Jt=1/.7,Qt="\\s*([+-]?\\d+)\\s*",Kt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",$t="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",te=/^#([0-9a-f]{3})$/,ee=/^#([0-9a-f]{6})$/,ne=new RegExp("^rgb\\("+[Qt,Qt,Qt]+"\\)$"),re=new RegExp("^rgb\\("+[$t,$t,$t]+"\\)$"),ie=new RegExp("^rgba\\("+[Qt,Qt,Qt,Kt]+"\\)$"),ae=new RegExp("^rgba\\("+[$t,$t,$t,Kt]+"\\)$"),oe=new RegExp("^hsl\\("+[Kt,$t,$t]+"\\)$"),se=new RegExp("^hsla\\("+[Kt,$t,$t,Kt]+"\\)$"),ce={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function le(t){var e;return t=(t+"").trim().toLowerCase(),(e=te.exec(t))?new pe((e=parseInt(e[1],16))>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):(e=ee.exec(t))?ue(parseInt(e[1],16)):(e=ne.exec(t))?new pe(e[1],e[2],e[3],1):(e=re.exec(t))?new pe(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=ie.exec(t))?he(e[1],e[2],e[3],e[4]):(e=ae.exec(t))?he(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=oe.exec(t))?me(e[1],e[2]/100,e[3]/100,1):(e=se.exec(t))?me(e[1],e[2]/100,e[3]/100,e[4]):ce.hasOwnProperty(t)?ue(ce[t]):"transparent"===t?new pe(NaN,NaN,NaN,0):null}function ue(t){return new pe(t>>16&255,t>>8&255,255&t,1)}function he(t,e,n,r){return r<=0&&(t=e=n=NaN),new pe(t,e,n,r)}function fe(t){return t instanceof Zt||(t=le(t)),t?new pe((t=t.rgb()).r,t.g,t.b,t.opacity):new pe}function de(t,e,n,r){return 1===arguments.length?fe(t):new pe(t,e,n,null==r?1:r)}function pe(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function me(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ge(t,e,n,r)}function ve(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof ge)return new ge(t.h,t.s,t.l,t.opacity);if(t instanceof Zt||(t=le(t)),!t)return new ge;if(t instanceof ge)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new ge(o,s,c,t.opacity)}(t):new ge(t,e,n,null==r?1:r)}function ge(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function ye(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Xt(Zt,le,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),Xt(pe,de,Yt(Zt,{brighter:function(t){return t=null==t?Jt:Math.pow(Jt,t),new pe(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new pe(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),Xt(ge,ve,Yt(Zt,{brighter:function(t){return t=null==t?Jt:Math.pow(Jt,t),new ge(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ge(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new pe(ye(t>=240?t-240:t+120,i,r),ye(t,i,r),ye(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var _e=Math.PI/180,xe=180/Math.PI,be=.95047,we=1,Me=1.08883,Ee=4/29,Te=6/29,Se=3*Te*Te,Ae=Te*Te*Te;function Re(t){if(t instanceof Ce)return new Ce(t.l,t.a,t.b,t.opacity);if(t instanceof Ue){var e=t.h*_e;return new Ce(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof pe||(t=fe(t));var n=Ie(t.r),r=Ie(t.g),i=Ie(t.b),a=Pe((.4124564*n+.3575761*r+.1804375*i)/be),o=Pe((.2126729*n+.7151522*r+.072175*i)/we),s=Pe((.0193339*n+.119192*r+.9503041*i)/Me);return new Ce(116*o-16,500*(a-o),200*(o-s),t.opacity)}function Le(t,e,n,r){return 1===arguments.length?Re(t):new Ce(t,e,n,null==r?1:r)}function Ce(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Pe(t){return t>Ae?Math.pow(t,1/3):t/Se+Ee}function Oe(t){return t>Te?t*t*t:Se*(t-Ee)}function Ne(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Ie(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ze(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Ue)return new Ue(t.h,t.c,t.l,t.opacity);t instanceof Ce||(t=Re(t));var e=Math.atan2(t.b,t.a)*xe;return new Ue(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new Ue(t,e,n,null==r?1:r)}function Ue(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}Xt(Ce,Le,Yt(Zt,{brighter:function(t){return new Ce(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Ce(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return t=we*Oe(t),e=be*Oe(e),n=Me*Oe(n),new pe(Ne(3.2404542*e-1.5371385*t-.4985314*n),Ne(-.969266*e+1.8760108*t+.041556*n),Ne(.0556434*e-.2040259*t+1.0572252*n),this.opacity)}})),Xt(Ue,ze,Yt(Zt,{brighter:function(t){return new Ue(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Ue(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return Re(this).rgb()}}));var De=-.14861,ke=1.78277,Fe=-.29227,Be=-.90649,je=1.97294,He=je*Be,Ge=je*ke,Ve=ke*Fe-Be*De;function We(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof qe)return new qe(t.h,t.s,t.l,t.opacity);t instanceof pe||(t=fe(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(Ve*r+He*e-Ge*n)/(Ve+He-Ge),a=r-i,o=(je*(n-i)-Fe*a)/Be,s=Math.sqrt(o*o+a*a)/(je*i*(1-i)),c=s?Math.atan2(o,a)*xe-120:NaN;return new qe(c<0?c+360:c,s,i,t.opacity)}(t):new qe(t,e,n,null==r?1:r)}function qe(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Xe(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}Xt(qe,We,Yt(Zt,{brighter:function(t){return t=null==t?Jt:Math.pow(Jt,t),new qe(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new qe(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*_e,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new pe(255*(e+n*(De*r+ke*i)),255*(e+n*(Fe*r+Be*i)),255*(e+n*(je*r)),this.opacity)}}));var Ye=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return Xe((n-r/e)*e,o,i,a,s)}},Ze=function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return Xe((n-r/e)*e,i,a,o,s)}},Je=function(t){return function(){return t}};function Qe(t,e){return function(n){return t+n*e}}function Ke(t,e){var n=e-t;return n?Qe(t,n>180||n<-180?n-360*Math.round(n/360):n):Je(isNaN(t)?e:t)}function $e(t){return 1==(t=+t)?tn:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Je(isNaN(e)?n:e)}}function tn(t,e){var n=e-t;return n?Qe(t,n):Je(isNaN(t)?e:t)}var en=function t(e){var n=$e(e);function r(t,e){var r=n((t=de(t)).r,(e=de(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=tn(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function nn(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=de(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}var rn,an,on,sn,cn=nn(Ye),ln=nn(Ze),un=function(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(r),o=new Array(r);for(n=0;n<i;++n)a[n]=gn(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}},hn=function(t,e){var n=new Date;return e-=t=+t,function(r){return n.setTime(t+e*r),n}},fn=function(t,e){return e-=t=+t,function(n){return t+e*n}},dn=function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=gn(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},pn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,mn=new RegExp(pn.source,"g"),vn=function(t,e){var n,r,i,a=pn.lastIndex=mn.lastIndex=0,o=-1,s=[],c=[];for(t+="",e+="";(n=pn.exec(t))&&(r=mn.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:fn(n,r)})),a=mn.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})},gn=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?Je(e):("number"===r?fn:"string"===r?(n=le(e))?(e=n,en):vn:e instanceof le?en:e instanceof Date?hn:Array.isArray(e)?un:isNaN(e)?dn:fn)(t,e)},yn=function(t,e){return e-=t=+t,function(n){return Math.round(t+e*n)}},_n=180/Math.PI,xn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},bn=function(t,e,n,r,i,a){var o,s,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*_n,skewX:Math.atan(c)*_n,scaleX:o,scaleY:s}};function wn(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],c=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var c=o.push("translate(",null,e,null,n);s.push({i:c-4,x:fn(t,i)},{i:c-2,x:fn(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,c),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:fn(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,c),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:fn(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,c),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:fn(t,n)},{i:s-2,x:fn(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,c),a=o=null,function(t){for(var e,n=-1,r=c.length;++n<r;)s[(e=c[n]).i]=e.x(t);return s.join("")}}}var Mn=wn(function(t){return"none"===t?xn:(rn||(rn=document.createElement("DIV"),an=document.documentElement,on=document.defaultView),rn.style.transform=t,t=on.getComputedStyle(an.appendChild(rn),null).getPropertyValue("transform"),an.removeChild(rn),t=t.slice(7,-1).split(","),bn(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))},"px, ","px)","deg)"),En=wn(function(t){return null==t?xn:(sn||(sn=document.createElementNS("http://www.w3.org/2000/svg","g")),sn.setAttribute("transform",t),(t=sn.transform.baseVal.consolidate())?(t=t.matrix,bn(t.a,t.b,t.c,t.d,t.e,t.f)):xn)},", ",")",")"),Tn=Math.SQRT2;function Sn(t){return((t=Math.exp(t))+1/t)/2}var An=function(t,e){var n,r,i=t[0],a=t[1],o=t[2],s=e[0],c=e[1],l=e[2],u=s-i,h=c-a,f=u*u+h*h;if(f<1e-12)r=Math.log(l/o)/Tn,n=function(t){return[i+t*u,a+t*h,o*Math.exp(Tn*t*r)]};else{var d=Math.sqrt(f),p=(l*l-o*o+4*f)/(2*o*2*d),m=(l*l-o*o-4*f)/(2*l*2*d),v=Math.log(Math.sqrt(p*p+1)-p),g=Math.log(Math.sqrt(m*m+1)-m);r=(g-v)/Tn,n=function(t){var e,n=t*r,s=Sn(v),c=o/(2*d)*(s*(e=Tn*n+v,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(v));return[i+c*u,a+c*h,o*s/Sn(Tn*n+v)]}}return n.duration=1e3*r,n};function Rn(t){return function(e,n){var r=t((e=ve(e)).h,(n=ve(n)).h),i=tn(e.s,n.s),a=tn(e.l,n.l),o=tn(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=a(t),e.opacity=o(t),e+""}}}var Ln=Rn(Ke),Cn=Rn(tn);function Pn(t){return function(e,n){var r=t((e=ze(e)).h,(n=ze(n)).h),i=tn(e.c,n.c),a=tn(e.l,n.l),o=tn(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=a(t),e.opacity=o(t),e+""}}}var On=Pn(Ke),Nn=Pn(tn);function In(t){return function e(n){function r(e,r){var i=t((e=We(e)).h,(r=We(r)).h),a=tn(e.s,r.s),o=tn(e.l,r.l),s=tn(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}var zn,Un,Dn=In(Ke),kn=In(tn),Fn=0,Bn=0,jn=0,Hn=1e3,Gn=0,Vn=0,Wn=0,qn="object"==typeof performance&&performance.now?performance:Date,Xn="function"==typeof requestAnimationFrame?requestAnimationFrame:function(t){setTimeout(t,17)};function Yn(){return Vn||(Xn(Zn),Vn=qn.now()+Wn)}function Zn(){Vn=0}function Jn(){this._call=this._time=this._next=null}function Qn(t,e,n){var r=new Jn;return r.restart(t,e,n),r}function Kn(){Yn(),++Fn;for(var t,e=zn;e;)(t=Vn-e._time)>=0&&e._call.call(null,t),e=e._next;--Fn}function $n(){Vn=(Gn=qn.now())+Wn,Fn=Bn=0;try{Kn()}finally{Fn=0,function(){for(var t,e,n=zn,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:zn=e);Un=t,er(r)}(),Vn=0}}function tr(){var t=qn.now(),e=t-Gn;e>Hn&&(Wn-=e,Gn=t)}function er(t){if(!Fn){Bn&&(Bn=clearTimeout(Bn));var e=t-Vn;e>24?(t<1/0&&(Bn=setTimeout($n,e)),jn&&(jn=clearInterval(jn))):(jn||(Gn=Vn,jn=setInterval(tr,Hn)),Fn=1,Xn($n))}}Jn.prototype=Qn.prototype={constructor:Jn,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Yn():+n)+(null==e?0:+e),this._next||Un===this||(Un?Un._next=this:zn=this,Un=this),this._call=t,this._time=n,er()},stop:function(){this._call&&(this._call=null,this._time=1/0,er())}};var nr=function(t,e,n){var r=new Jn;return e=null==e?0:+e,r.restart(function(n){r.stop(),t(n+e)},e,n),r},rr=F("start","end","interrupt"),ir=[],ar=0,or=1,sr=2,cr=3,lr=4,ur=5,hr=6,fr=function(t,e,n,r,i,a){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function a(c){var l,u,h,f;if(n.state!==or)return s();for(l in i)if((f=i[l]).name===n.name){if(f.state===cr)return nr(a);f.state===lr?(f.state=hr,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete i[l]):+l<e&&(f.state=hr,f.timer.stop(),delete i[l])}if(nr(function(){n.state===cr&&(n.state=lr,n.timer.restart(o,n.delay,n.time),o(c))}),n.state=sr,n.on.call("start",t,t.__data__,n.index,n.group),n.state===sr){for(n.state=cr,r=new Array(h=n.tween.length),l=0,u=-1;l<h;++l)(f=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(r[++u]=f);r.length=u+1}}function o(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=ur,1),a=-1,o=r.length;++a<o;)r[a].call(null,i);n.state===ur&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=hr,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=Qn(function(t){n.state=or,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)},0,n.time)}(t,n,{name:e,index:r,group:i,on:rr,tween:ir,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:ar})};function dr(t,e){var n=t.__transition;if(!n||!(n=n[e])||n.state>ar)throw new Error("too late");return n}function pr(t,e){var n=t.__transition;if(!n||!(n=n[e])||n.state>sr)throw new Error("too late");return n}function mr(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("too late");return n}var vr=function(t,e){var n,r,i,a=t.__transition,o=!0;if(a){for(i in e=null==e?null:e+"",a)(n=a[i]).name===e?(r=n.state>sr&&n.state<ur,n.state=hr,n.timer.stop(),r&&n.on.call("interrupt",t,t.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete t.__transition}};function gr(t,e,n){var r=t._id;return t.each(function(){var t=pr(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return mr(t,r).value[e]}}var yr=function(t,e){var n;return("number"==typeof e?fn:e instanceof le?en:(n=le(e))?(e=n,en):vn)(t,e)},_r=zt.prototype.constructor,xr=0;function br(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function wr(t){return zt().transition(t)}function Mr(){return++xr}var Er=zt.prototype;function Tr(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function Sr(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}br.prototype=wr.prototype={constructor:br,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=ht(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s,c,l=r[o],u=l.length,h=a[o]=new Array(u),f=0;f<u;++f)(s=l[f])&&(c=t.call(s,s.__data__,f,l))&&("__data__"in s&&(c.__data__=s.__data__),h[f]=c,fr(h[f],e,n,f,h,mr(s,n)));return new br(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=dt(t));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var c,l=r[s],u=l.length,h=0;h<u;++h)if(c=l[h]){for(var f,d=t.call(c,c.__data__,h,l),p=mr(c,n),m=0,v=d.length;m<v;++m)(f=d[m])&&fr(f,e,n,m,d,p);a.push(d),o.push(c)}return new br(a,o,e,n)},filter:function(t){"function"!=typeof t&&(t=$(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,c=r[i]=[],l=0;l<s;++l)(a=o[l])&&t.call(a,a.__data__,l,o)&&c.push(a);return new br(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var c,l=e[s],u=n[s],h=l.length,f=o[s]=new Array(h),d=0;d<h;++d)(c=l[d]||u[d])&&(f[d]=c);for(;s<r;++s)o[s]=e[s];return new br(o,this._parents,this._name,this._id)},selection:function(){return new _r(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Mr(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],c=s.length,l=0;l<c;++l)if(o=s[l]){var u=mr(o,e);fr(o,t,n,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new br(r,this._parents,t,n)},call:Er.call,nodes:Er.nodes,node:Er.node,size:Er.size,empty:Er.empty,each:Er.each,on:function(t,e){var n=this._id;return arguments.length<2?mr(this.node(),n).on.on(t):this.each(function(t,e,n){var r,i,a=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?dr:pr;return function(){var o=a(this,t),s=o.on;s!==r&&(i=(r=s).copy()).on(e,n),o.on=i}}(n,t,e))},attr:function(t,e){var n=W(t),r="transform"===n?En:yr;return this.attrTween(t,"function"==typeof e?(n.local?function(t,e,n){var r,i,a;return function(){var o,s=n(this);if(null!=s)return(o=this.getAttributeNS(t.space,t.local))===s?null:o===r&&s===i?a:a=e(r=o,i=s);this.removeAttributeNS(t.space,t.local)}}:function(t,e,n){var r,i,a;return function(){var o,s=n(this);if(null!=s)return(o=this.getAttribute(t))===s?null:o===r&&s===i?a:a=e(r=o,i=s);this.removeAttribute(t)}})(n,r,gr(this,"attr."+t,e)):null==e?(n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(n):(n.local?function(t,e,n){var r,i;return function(){var a=this.getAttributeNS(t.space,t.local);return a===n?null:a===r?i:i=e(r=a,n)}}:function(t,e,n){var r,i;return function(){var a=this.getAttribute(t);return a===n?null:a===r?i:i=e(r=a,n)}})(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=W(t);return this.tween(n,(r.local?function(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttributeNS(t.space,t.local,r(e))}}return n._value=e,n}:function(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttribute(t,r(e))}}return n._value=e,n})(r,e))},style:function(t,e,n){var r="transform"==(t+="")?Mn:yr;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var a=xt(this).getComputedStyle(this,null),o=a.getPropertyValue(t),s=(this.style.removeProperty(t),a.getPropertyValue(t));return o===s?null:o===n&&s===r?i:i=e(n=o,r=s)}}(t,r)).on("end.style."+t,function(t){return function(){this.style.removeProperty(t)}}(t)):this.styleTween(t,"function"==typeof e?function(t,e,n){var r,i,a;return function(){var o=xt(this).getComputedStyle(this,null),s=o.getPropertyValue(t),c=n(this);return null==c&&(this.style.removeProperty(t),c=o.getPropertyValue(t)),s===c?null:s===r&&c===i?a:a=e(r=s,i=c)}}(t,r,gr(this,"style."+t,e)):function(t,e,n){var r,i;return function(){var a=xt(this).getComputedStyle(this,null).getPropertyValue(t);return a===n?null:a===r?i:i=e(r=a,n)}}(t,r,e),n)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){function r(){var r=this,i=e.apply(r,arguments);return i&&function(e){r.style.setProperty(t,i(e),n)}}return r._value=e,r}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(gr(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=mr(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==e?function(t,e){var n,r;return function(){var i=pr(this,t),a=i.tween;if(a!==n){r=n=a;for(var o=0,s=r.length;o<s;++o)if(r[o].name===e){(r=r.slice()).splice(o,1);break}}i.tween=r}}:function(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=pr(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:e,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===e){i[c]=s;break}c===l&&i.push(s)}a.tween=i}})(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){dr(this,t).delay=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){dr(this,t).delay=e}})(e,t)):mr(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){pr(this,t).duration=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){pr(this,t).duration=e}})(e,t)):mr(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){pr(this,t).ease=e}}(e,t)):mr(this.node(),e).ease}};var Ar=function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n}(3),Rr=function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(3),Lr=function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(3),Cr=Math.PI,Pr=Cr/2;function Or(t){return(1-Math.cos(Cr*t))/2}function Nr(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function Ir(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var zr=4/11,Ur=6/11,Dr=8/11,kr=.75,Fr=9/11,Br=10/11,jr=.9375,Hr=21/22,Gr=63/64,Vr=1/zr/zr;function Wr(t){return(t=+t)<zr?Vr*t*t:t<Dr?Vr*(t-=Ur)*t+kr:t<Br?Vr*(t-=Fr)*t+jr:Vr*(t-=Hr)*t+Gr}var qr=function t(e){function n(t){return t*t*((e+1)*t-e)}return e=+e,n.overshoot=t,n}(1.70158),Xr=function t(e){function n(t){return--t*t*((e+1)*t+e)+1}return e=+e,n.overshoot=t,n}(1.70158),Yr=function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(1.70158),Zr=2*Math.PI,Jr=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Zr);function i(t){return e*Math.pow(2,10*--t)*Math.sin((r-t)/n)}return i.amplitude=function(e){return t(e,n*Zr)},i.period=function(n){return t(e,n)},i}(1,.3),Qr=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Zr);function i(t){return 1-e*Math.pow(2,-10*(t=+t))*Math.sin((t+r)/n)}return i.amplitude=function(e){return t(e,n*Zr)},i.period=function(n){return t(e,n)},i}(1,.3),Kr=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Zr);function i(t){return((t=2*t-1)<0?e*Math.pow(2,10*t)*Math.sin((r-t)/n):2-e*Math.pow(2,-10*t)*Math.sin((r+t)/n))/2}return i.amplitude=function(e){return t(e,n*Zr)},i.period=function(n){return t(e,n)},i}(1,.3),$r={time:null,delay:0,duration:250,ease:Sr};function ti(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return $r.time=Yn(),$r;return n}zt.prototype.interrupt=function(t){return this.each(function(){vr(this,t)})},zt.prototype.transition=function(t){var e,n;t instanceof br?(e=t._id,t=t._name):(e=Mr(),(n=$r).time=Yn(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],c=s.length,l=0;l<c;++l)(o=s[l])&&fr(o,t,e,l,s,n||ti(o,e));return new br(r,this._parents,t,e)};var ei=[null],ni=function(t){return function(){return t}},ri=function(t,e,n){this.target=t,this.type=e,this.selection=n};function ii(){t.event.stopImmediatePropagation()}var ai=function(){t.event.preventDefault(),t.event.stopImmediatePropagation()},oi={name:"drag"},si={name:"space"},ci={name:"handle"},li={name:"center"},ui={name:"x",handles:["e","w"].map(yi),input:function(t,e){return t&&[[t[0],e[0][1]],[t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},hi={name:"y",handles:["n","s"].map(yi),input:function(t,e){return t&&[[e[0][0],t[0]],[e[1][0],t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},fi={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(yi),input:function(t){return t},output:function(t){return t}},di={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},pi={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},mi={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},vi={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},gi={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function yi(t){return{type:t}}function _i(){return!t.event.button}function xi(){var t=this.ownerSVGElement||this;return[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function bi(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function wi(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Mi(e){var n,r=xi,i=_i,a=F(s,"start","brush","end"),o=6;function s(t){var n=t.property("__brush",f).selectAll(".overlay").data([yi("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",di.overlay).merge(n).each(function(){var t=bi(this).extent;Ut(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])}),t.selectAll(".selection").data([yi("selection")]).enter().append("rect").attr("class","selection").attr("cursor",di.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=t.selectAll(".handle").data(e.handles,function(t){return t.type});r.exit().remove(),r.enter().append("rect").attr("class",function(t){return"handle handle--"+t.type}).attr("cursor",function(t){return di[t.type]}),t.each(c).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",h)}function c(){var t=Ut(this),e=bi(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",function(t){return"e"===t.type[t.type.length-1]?e[1][0]-o/2:e[0][0]-o/2}).attr("y",function(t){return"s"===t.type[0]?e[1][1]-o/2:e[0][1]-o/2}).attr("width",function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+o:o}).attr("height",function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+o:o})):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function l(t,e){return t.__brush.emitter||new u(t,e)}function u(t,e){this.that=t,this.args=e,this.state=t.__brush,this.active=0}function h(){if(t.event.touches){if(t.event.changedTouches.length<t.event.touches.length)return ai()}else if(n)return;if(i.apply(this,arguments)){var r,a,o,s,u,h,f,d,p,m,v,g,y,_=this,x=t.event.target.__data__.type,b="selection"===(t.event.metaKey?x="overlay":x)?oi:t.event.altKey?li:ci,w=e===hi?null:vi[x],M=e===ui?null:gi[x],E=bi(_),T=E.extent,S=E.selection,A=T[0][0],R=T[0][1],L=T[1][0],C=T[1][1],P=w&&M&&t.event.shiftKey,O=lt(_),N=O,I=l(_,arguments).beforestart();"overlay"===x?E.selection=S=[[r=e===hi?A:O[0],o=e===ui?R:O[1]],[u=e===hi?L:r,f=e===ui?C:o]]:(r=S[0][0],o=S[0][1],u=S[1][0],f=S[1][1]),a=r,s=o,h=u,d=f;var z=Ut(_).attr("pointer-events","none"),U=z.selectAll(".overlay").attr("cursor",di[x]);if(t.event.touches)z.on("touchmove.brush",k,!0).on("touchend.brush touchcancel.brush",B,!0);else{var D=Ut(t.event.view).on("keydown.brush",function(){switch(t.event.keyCode){case 16:P=w&&M;break;case 18:b===ci&&(w&&(u=h-p*w,r=a+p*w),M&&(f=d-m*M,o=s+m*M),b=li,F());break;case 32:b!==ci&&b!==li||(w<0?u=h-p:w>0&&(r=a-p),M<0?f=d-m:M>0&&(o=s-m),b=si,U.attr("cursor",di.selection),F());break;default:return}ai()},!0).on("keyup.brush",function(){switch(t.event.keyCode){case 16:P&&(g=y=P=!1,F());break;case 18:b===li&&(w<0?u=h:w>0&&(r=a),M<0?f=d:M>0&&(o=s),b=ci,F());break;case 32:b===si&&(t.event.altKey?(w&&(u=h-p*w,r=a+p*w),M&&(f=d-m*M,o=s+m*M),b=li):(w<0?u=h:w>0&&(r=a),M<0?f=d:M>0&&(o=s),b=ci),U.attr("cursor",di[x]),F());break;default:return}ai()},!0).on("mousemove.brush",k,!0).on("mouseup.brush",B,!0);Bt(t.event.view)}ii(),vr(_),c.call(_),I.start()}function k(){var t=lt(_);!P||g||y||(Math.abs(t[0]-N[0])>Math.abs(t[1]-N[1])?y=!0:g=!0),N=t,v=!0,ai(),F()}function F(){var t;switch(p=N[0]-O[0],m=N[1]-O[1],b){case si:case oi:w&&(p=Math.max(A-r,Math.min(L-u,p)),a=r+p,h=u+p),M&&(m=Math.max(R-o,Math.min(C-f,m)),s=o+m,d=f+m);break;case ci:w<0?(p=Math.max(A-r,Math.min(L-r,p)),a=r+p,h=u):w>0&&(p=Math.max(A-u,Math.min(L-u,p)),a=r,h=u+p),M<0?(m=Math.max(R-o,Math.min(C-o,m)),s=o+m,d=f):M>0&&(m=Math.max(R-f,Math.min(C-f,m)),s=o,d=f+m);break;case li:w&&(a=Math.max(A,Math.min(L,r-p*w)),h=Math.max(A,Math.min(L,u+p*w))),M&&(s=Math.max(R,Math.min(C,o-m*M)),d=Math.max(R,Math.min(C,f+m*M)))}h<a&&(w*=-1,t=r,r=u,u=t,t=a,a=h,h=t,x in pi&&U.attr("cursor",di[x=pi[x]])),d<s&&(M*=-1,t=o,o=f,f=t,t=s,s=d,d=t,x in mi&&U.attr("cursor",di[x=mi[x]])),E.selection&&(S=E.selection),g&&(a=S[0][0],h=S[1][0]),y&&(s=S[0][1],d=S[1][1]),S[0][0]===a&&S[0][1]===s&&S[1][0]===h&&S[1][1]===d||(E.selection=[[a,s],[h,d]],c.call(_),I.brush())}function B(){if(ii(),t.event.touches){if(t.event.touches.length)return;n&&clearTimeout(n),n=setTimeout(function(){n=null},500),z.on("touchmove.brush touchend.brush touchcancel.brush",null)}else jt(t.event.view,v),D.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);z.attr("pointer-events","all"),U.attr("cursor",di.overlay),E.selection&&(S=E.selection),wi(S)&&(E.selection=null,c.call(_)),I.end()}}function f(){var t=this.__brush||{selection:null};return t.extent=r.apply(this,arguments),t.dim=e,t}return s.move=function(t,n){t.selection?t.on("start.brush",function(){l(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){l(this,arguments).end()}).tween("brush",function(){var t=this,r=t.__brush,i=l(t,arguments),a=r.selection,o=e.input("function"==typeof n?n.apply(this,arguments):n,r.extent),s=gn(a,o);function u(e){r.selection=1===e&&wi(o)?null:s(e),c.call(t),i.brush()}return a&&o?u:u(1)}):t.each(function(){var t=arguments,r=this.__brush,i=e.input("function"==typeof n?n.apply(this,t):n,r.extent),a=l(this,t).beforestart();vr(this),r.selection=null==i||wi(i)?null:i,c.call(this),a.start().brush().end()})},u.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(t){ot(new ri(s,t,e.output(this.state.selection)),a.apply,a,[t,this.that,this.args])}},s.extent=function(t){return arguments.length?(r="function"==typeof t?t:ni([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),s):r},s.filter=function(t){return arguments.length?(i="function"==typeof t?t:ni(!!t),s):i},s.handleSize=function(t){return arguments.length?(o=+t,s):o},s.on=function(){var t=a.on.apply(a,arguments);return t===a?s:t},s}var Ei=Math.cos,Ti=Math.sin,Si=Math.PI,Ai=Si/2,Ri=2*Si,Li=Math.max,Ci=Array.prototype.slice,Pi=function(t){return function(){return t}},Oi=Math.PI,Ni=2*Oi,Ii=Ni-1e-6;function zi(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Ui(){return new zi}function Di(t){return t.source}function ki(t){return t.target}function Fi(t){return t.radius}function Bi(t){return t.startAngle}function ji(t){return t.endAngle}function Hi(){}function Gi(t,e){var n=new Hi;if(t instanceof Hi)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var r,i=-1,a=t.length;if(null==e)for(;++i<a;)n.set(i,t[i]);else for(;++i<a;)n.set(e(r=t[i],i,t),r)}else if(t)for(var o in t)n.set(o,t[o]);return n}function Vi(){return{}}function Wi(t,e,n){t[e]=n}function qi(){return Gi()}function Xi(t,e,n){t.set(e,n)}function Yi(){}zi.prototype=Ui.prototype={constructor:zi,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-t,c=r-e,l=a-t,u=o-e,h=l*l+u*u;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>1e-6)if(Math.abs(u*s-c*l)>1e-6&&i){var f=n-a,d=r-o,p=s*s+c*c,m=f*f+d*d,v=Math.sqrt(p),g=Math.sqrt(h),y=i*Math.tan((Oi-Math.acos((p+h-m)/(2*v*g)))/2),_=y/g,x=y/v;Math.abs(_-1)>1e-6&&(this._+="L"+(t+_*l)+","+(e+_*u)),this._+="A"+i+","+i+",0,0,"+ +(u*f>l*d)+","+(this._x1=t+x*s)+","+(this._y1=e+x*c)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,r,i,a){t=+t,e=+e;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),c=t+o,l=e+s,u=1^a,h=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+l:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+c+","+l),n&&(h>Ii?this._+="A"+n+","+n+",0,1,"+u+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=c)+","+(this._y1=l):(h<0&&(h=h%Ni+Ni),this._+="A"+n+","+n+",0,"+ +(h>=Oi)+","+u+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}},Hi.prototype=Gi.prototype={constructor:Hi,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var Zi=Gi.prototype;function Ji(t,e){var n=new Yi;if(t instanceof Yi)t.each(function(t){n.add(t)});else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}function Qi(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}")}Yi.prototype=Ji.prototype={constructor:Yi,has:Zi.has,add:function(t){return this["$"+(t+="")]=t,this},remove:Zi.remove,clear:Zi.clear,values:Zi.keys,size:Zi.size,empty:Zi.empty,each:Zi.each};var Ki=function(t){var e=new RegExp('["'+t+"\n]"),n=t.charCodeAt(0);function r(t,e){var r,i,a={},o={},s=[],c=t.length,l=0,u=0;function h(){if(l>=c)return o;if(i)return i=!1,a;var e,r=l;if(34===t.charCodeAt(r)){for(var s=r;s++<c;)if(34===t.charCodeAt(s)){if(34!==t.charCodeAt(s+1))break;++s}return l=s+2,13===(e=t.charCodeAt(s+1))?(i=!0,10===t.charCodeAt(s+2)&&++l):10===e&&(i=!0),t.slice(r+1,s).replace(/""/g,'"')}for(;l<c;){var u=1;if(10===(e=t.charCodeAt(l++)))i=!0;else if(13===e)i=!0,10===t.charCodeAt(l)&&(++l,++u);else if(e!==n)continue;return t.slice(r,l-u)}return t.slice(r)}for(;(r=h())!==o;){for(var f=[];r!==a&&r!==o;)f.push(r),r=h();e&&null==(f=e(f,u++))||s.push(f)}return s}function i(e){return e.map(a).join(t)}function a(t){return null==t?"":e.test(t+="")?'"'+t.replace(/\"/g,'""')+'"':t}return{parse:function(t,e){var n,i,a=r(t,function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=Qi(t);return function(r,i){return e(n(r),i,t)}}(t,e):Qi(t)});return a.columns=i,a},parseRows:r,format:function(e,n){return null==n&&(n=function(t){var e=Object.create(null),n=[];return t.forEach(function(t){for(var r in t)r in e||n.push(e[r]=r)}),n}(e)),[n.map(a).join(t)].concat(e.map(function(e){return n.map(function(t){return a(e[t])}).join(t)})).join("\n")},formatRows:function(t){return t.map(i).join("\n")}}},$i=Ki(","),ta=$i.parse,ea=$i.parseRows,na=$i.format,ra=$i.formatRows,ia=Ki("\t"),aa=ia.parse,oa=ia.parseRows,sa=ia.format,ca=ia.formatRows,la=function(t){return function(){return t}},ua=function(){return 1e-6*(Math.random()-.5)};function ha(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a,o,s,c,l,u,h,f,d=t._root,p={data:r},m=t._x0,v=t._y0,g=t._x1,y=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((l=e>=(a=(m+g)/2))?m=a:g=a,(u=n>=(o=(v+y)/2))?v=o:y=o,i=d,!(d=d[h=u<<1|l]))return i[h]=p,t;if(s=+t._x.call(null,d.data),c=+t._y.call(null,d.data),e===s&&n===c)return p.next=d,i?i[h]=p:t._root=p,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(l=e>=(a=(m+g)/2))?m=a:g=a,(u=n>=(o=(v+y)/2))?v=o:y=o}while((h=u<<1|l)==(f=(c>=o)<<1|s>=a));return i[f]=d,i[h]=p,t}var fa=function(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i};function da(t){return t[0]}function pa(t){return t[1]}function ma(t,e,n){var r=new va(null==e?da:e,null==n?pa:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function va(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function ga(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var ya=ma.prototype=va.prototype;function _a(t){return t.x+t.vx}function xa(t){return t.y+t.vy}function ba(t){return t.index}function wa(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function Ma(t){return t.x}function Ea(t){return t.y}ya.copy=function(){var t,e,n=new va(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=ga(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=ga(e));return n},ya.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return ha(this.cover(e,n),e,n,t)},ya.addAll=function(t){var e,n,r,i,a=t.length,o=new Array(a),s=new Array(a),c=1/0,l=1/0,u=-1/0,h=-1/0;for(n=0;n<a;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(o[n]=r,s[n]=i,r<c&&(c=r),r>u&&(u=r),i<l&&(l=i),i>h&&(h=i));for(u<c&&(c=this._x0,u=this._x1),h<l&&(l=this._y0,h=this._y1),this.cover(c,l).cover(u,h),n=0;n<a;++n)ha(this,o[n],s[n],t[n]);return this},ya.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{if(!(n>t||t>i||r>e||e>a))return this;var o,s,c=i-n,l=this._root;switch(s=(e<(r+a)/2)<<1|t<(n+i)/2){case 0:do{(o=new Array(4))[s]=l,l=o}while(a=r+(c*=2),t>(i=n+c)||e>a);break;case 1:do{(o=new Array(4))[s]=l,l=o}while(a=r+(c*=2),(n=i-c)>t||e>a);break;case 2:do{(o=new Array(4))[s]=l,l=o}while(r=a-(c*=2),t>(i=n+c)||r>e);break;case 3:do{(o=new Array(4))[s]=l,l=o}while(r=a-(c*=2),(n=i-c)>t||r>e)}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this},ya.data=function(){var t=[];return this.visit(function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)}),t},ya.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},ya.find=function(t,e,n){var r,i,a,o,s,c,l,u=this._x0,h=this._y0,f=this._x1,d=this._y1,p=[],m=this._root;for(m&&p.push(new fa(m,u,h,f,d)),null==n?n=1/0:(u=t-n,h=e-n,f=t+n,d=e+n,n*=n);c=p.pop();)if(!(!(m=c.node)||(i=c.x0)>f||(a=c.y0)>d||(o=c.x1)<u||(s=c.y1)<h))if(m.length){var v=(i+o)/2,g=(a+s)/2;p.push(new fa(m[3],v,g,o,s),new fa(m[2],i,g,v,s),new fa(m[1],v,a,o,g),new fa(m[0],i,a,v,g)),(l=(e>=g)<<1|t>=v)&&(c=p[p.length-1],p[p.length-1]=p[p.length-1-l],p[p.length-1-l]=c)}else{var y=t-+this._x.call(null,m.data),_=e-+this._y.call(null,m.data),x=y*y+_*_;if(x<n){var b=Math.sqrt(n=x);u=t-b,h=e-b,f=t+b,d=e+b,r=m.data}}return r},ya.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,r,i,a,o,s,c,l,u,h,f,d=this._root,p=this._x0,m=this._y0,v=this._x1,g=this._y1;if(!d)return this;if(d.length)for(;;){if((l=a>=(s=(p+v)/2))?p=s:v=s,(u=o>=(c=(m+g)/2))?m=c:g=c,e=d,!(d=d[h=u<<1|l]))return this;if(!d.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,f=h)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[f]=d:this._root=d),this):(this._root=i,this)},ya.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},ya.root=function(){return this._root},ya.size=function(){var t=0;return this.visit(function(e){if(!e.length)do{++t}while(e=e.next)}),t},ya.visit=function(t){var e,n,r,i,a,o,s=[],c=this._root;for(c&&s.push(new fa(c,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(c=e.node,r=e.x0,i=e.y0,a=e.x1,o=e.y1)&&c.length){var l=(r+a)/2,u=(i+o)/2;(n=c[3])&&s.push(new fa(n,l,u,a,o)),(n=c[2])&&s.push(new fa(n,r,u,l,o)),(n=c[1])&&s.push(new fa(n,l,i,a,u)),(n=c[0])&&s.push(new fa(n,r,i,l,u))}return this},ya.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new fa(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var a,o=e.x0,s=e.y0,c=e.x1,l=e.y1,u=(o+c)/2,h=(s+l)/2;(a=i[0])&&n.push(new fa(a,o,s,u,h)),(a=i[1])&&n.push(new fa(a,u,s,c,h)),(a=i[2])&&n.push(new fa(a,o,h,u,l)),(a=i[3])&&n.push(new fa(a,u,h,c,l))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},ya.x=function(t){return arguments.length?(this._x=t,this):this._x},ya.y=function(t){return arguments.length?(this._y=t,this):this._y};var Ta,Sa=10,Aa=Math.PI*(3-Math.sqrt(5)),Ra=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},La=function(t){return(t=Ra(Math.abs(t)))?t[1]:NaN},Ca=function(t,e){var n=Ra(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},Pa={"":function(t,e){t:for(var n,r=(t=t.toPrecision(e)).length,i=1,a=-1;i<r;++i)switch(t[i]){case".":a=n=i;break;case"0":0===a&&(a=i),n=i;break;case"e":break t;default:a>0&&(a=0)}return a>0?t.slice(0,a)+t.slice(n+1):t},"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Ca(100*t,e)},r:Ca,s:function(t,e){var n=Ra(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(Ta=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Ra(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Oa=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i,Na=function(t){return new Ia(t)};function Ia(t){if(!(e=Oa.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",r=e[2]||">",i=e[3]||"-",a=e[4]||"",o=!!e[5],s=e[6]&&+e[6],c=!!e[7],l=e[8]&&+e[8].slice(1),u=e[9]||"";"n"===u?(c=!0,u="g"):Pa[u]||(u=""),(o||"0"===n&&"="===r)&&(o=!0,n="0",r="="),this.fill=n,this.align=r,this.sign=i,this.symbol=a,this.zero=o,this.width=s,this.comma=c,this.precision=l,this.type=u}Ia.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var za=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Ua(t){return t}var Da,ka=function(t){var e,n,r=t.grouping&&t.thousands?(e=t.grouping,n=t.thousands,function(t,r){for(var i=t.length,a=[],o=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(t.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}):Ua,i=t.currency,a=t.decimal;function o(t){var e=(t=Na(t)).fill,n=t.align,o=t.sign,s=t.symbol,c=t.zero,l=t.width,u=t.comma,h=t.precision,f=t.type,d="$"===s?i[0]:"#"===s&&/[boxX]/.test(f)?"0"+f.toLowerCase():"",p="$"===s?i[1]:/[%p]/.test(f)?"%":"",m=Pa[f],v=!f||/[defgprs%]/.test(f);function g(t){var i,s,g,y=d,_=p;if("c"===f)_=m(t)+_,t="";else{var x=((t=+t)<0||1/t<0)&&(t*=-1,!0);if(t=m(t,h),x)for(i=-1,s=t.length,x=!1;++i<s;)if(48<(g=t.charCodeAt(i))&&g<58||"x"===f&&96<g&&g<103||"X"===f&&64<g&&g<71){x=!0;break}if(y=(x?"("===o?o:"-":"-"===o||"("===o?"":o)+y,_=_+("s"===f?za[8+Ta/3]:"")+(x&&"("===o?")":""),v)for(i=-1,s=t.length;++i<s;)if(48>(g=t.charCodeAt(i))||g>57){_=(46===g?a+t.slice(i+1):t.slice(i))+_,t=t.slice(0,i);break}}u&&!c&&(t=r(t,1/0));var b=y.length+t.length+_.length,w=b<l?new Array(l-b+1).join(e):"";switch(u&&c&&(t=r(w+t,w.length?l-_.length:1/0),w=""),n){case"<":return y+t+_+w;case"=":return y+w+t+_;case"^":return w.slice(0,b=w.length>>1)+y+t+_+w.slice(b)}return w+y+t+_}return h=null==h?f?6:12:/[gprs]/.test(f)?Math.max(1,Math.min(21,h)):Math.max(0,Math.min(20,h)),g.toString=function(){return t+""},g}return{format:o,formatPrefix:function(t,e){var n=o(((t=Na(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(La(e)/3))),i=Math.pow(10,-r),a=za[8+r/3];return function(t){return n(i*t)+a}}}};function Fa(e){return Da=ka(e),t.format=Da.format,t.formatPrefix=Da.formatPrefix,Da}Fa({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var Ba=function(t){return Math.max(0,-La(Math.abs(t)))},ja=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(La(e)/3)))-La(Math.abs(t)))},Ha=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,La(e)-La(t))+1},Ga=function(){return new Va};function Va(){this.reset()}Va.prototype={constructor:Va,reset:function(){this.s=this.t=0},add:function(t){qa(Wa,t,this.t),qa(this,Wa.s,this.s),this.s?this.t+=Wa.t:this.s=Wa.t},valueOf:function(){return this.s}};var Wa=new Va;function qa(t,e,n){var r=t.s=e+n,i=r-e,a=r-i;t.t=e-a+(n-i)}var Xa=1e-6,Ya=Math.PI,Za=Ya/2,Ja=Ya/4,Qa=2*Ya,Ka=180/Ya,$a=Ya/180,to=Math.abs,eo=Math.atan,no=Math.atan2,ro=Math.cos,io=Math.ceil,ao=Math.exp,oo=Math.log,so=Math.pow,co=Math.sin,lo=Math.sign||function(t){return t>0?1:t<0?-1:0},uo=Math.sqrt,ho=Math.tan;function fo(t){return t>1?0:t<-1?Ya:Math.acos(t)}function po(t){return t>1?Za:t<-1?-Za:Math.asin(t)}function mo(t){return(t=co(t/2))*t}function vo(){}function go(t,e){t&&_o.hasOwnProperty(t.type)&&_o[t.type](t,e)}var yo={Feature:function(t,e){go(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)go(n[r].geometry,e)}},_o={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){xo(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)xo(n[r],e,0)},Polygon:function(t,e){bo(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)bo(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)go(n[r],e)}};function xo(t,e,n){var r,i=-1,a=t.length-n;for(e.lineStart();++i<a;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function bo(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)xo(t[n],e,1);e.polygonEnd()}var wo,Mo,Eo,To,So,Ao,Ro,Lo,Co,Po,Oo,No,Io,zo=function(t,e){t&&yo.hasOwnProperty(t.type)?yo[t.type](t,e):go(t,e)},Uo=Ga(),Do=Ga(),ko={point:vo,lineStart:vo,lineEnd:vo,polygonStart:function(){Uo.reset(),ko.lineStart=Fo,ko.lineEnd=Bo},polygonEnd:function(){var t=+Uo;Do.add(t<0?Qa+t:t),this.lineStart=this.lineEnd=this.point=vo},sphere:function(){Do.add(Qa)}};function Fo(){ko.point=jo}function Bo(){Ho(wo,Mo)}function jo(t,e){ko.point=Ho,wo=t,Mo=e,Eo=t*=$a,To=ro(e=(e*=$a)/2+Ja),So=co(e)}function Ho(t,e){var n=(t*=$a)-Eo,r=n>=0?1:-1,i=r*n,a=ro(e=(e*=$a)/2+Ja),o=co(e),s=So*o,c=To*a+s*ro(i),l=s*r*co(i);Uo.add(no(l,c)),Eo=t,To=a,So=o}function Go(t){return[no(t[1],t[0]),po(t[2])]}function Vo(t){var e=t[0],n=t[1],r=ro(n);return[r*ro(e),r*co(e),co(n)]}function Wo(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function qo(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Xo(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Yo(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Zo(t){var e=uo(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var Jo,Qo,Ko=Ga(),$o={point:ts,lineStart:ns,lineEnd:rs,polygonStart:function(){$o.point=is,$o.lineStart=as,$o.lineEnd=os,Ko.reset(),ko.polygonStart()},polygonEnd:function(){ko.polygonEnd(),$o.point=ts,$o.lineStart=ns,$o.lineEnd=rs,Uo<0?(Ao=-(Lo=180),Ro=-(Co=90)):Ko>Xa?Co=90:Ko<-Xa&&(Ro=-90),Qo[0]=Ao,Qo[1]=Lo}};function ts(t,e){Jo.push(Qo=[Ao=t,Lo=t]),e<Ro&&(Ro=e),e>Co&&(Co=e)}function es(t,e){var n=Vo([t*$a,e*$a]);if(Io){var r=qo(Io,n),i=[r[1],-r[0],0],a=qo(i,r);Zo(a),a=Go(a);var o,s=t-Po,c=s>0?1:-1,l=a[0]*Ka*c,u=to(s)>180;u^(c*Po<l&&l<c*t)?(o=a[1]*Ka)>Co&&(Co=o):u^(c*Po<(l=(l+360)%360-180)&&l<c*t)?(o=-a[1]*Ka)<Ro&&(Ro=o):(e<Ro&&(Ro=e),e>Co&&(Co=e)),u?t<Po?ss(Ao,t)>ss(Ao,Lo)&&(Lo=t):ss(t,Lo)>ss(Ao,Lo)&&(Ao=t):Lo>=Ao?(t<Ao&&(Ao=t),t>Lo&&(Lo=t)):t>Po?ss(Ao,t)>ss(Ao,Lo)&&(Lo=t):ss(t,Lo)>ss(Ao,Lo)&&(Ao=t)}else Jo.push(Qo=[Ao=t,Lo=t]);e<Ro&&(Ro=e),e>Co&&(Co=e),Io=n,Po=t}function ns(){$o.point=es}function rs(){Qo[0]=Ao,Qo[1]=Lo,$o.point=ts,Io=null}function is(t,e){if(Io){var n=t-Po;Ko.add(to(n)>180?n+(n>0?360:-360):n)}else Oo=t,No=e;ko.point(t,e),es(t,e)}function as(){ko.lineStart()}function os(){is(Oo,No),ko.lineEnd(),to(Ko)>Xa&&(Ao=-(Lo=180)),Qo[0]=Ao,Qo[1]=Lo,Io=null}function ss(t,e){return(e-=t)<0?e+360:e}function cs(t,e){return t[0]-e[0]}function ls(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var us,hs,fs,ds,ps,ms,vs,gs,ys,_s,xs,bs,ws,Ms,Es,Ts,Ss={sphere:vo,point:As,lineStart:Ls,lineEnd:Os,polygonStart:function(){Ss.lineStart=Ns,Ss.lineEnd=Is},polygonEnd:function(){Ss.lineStart=Ls,Ss.lineEnd=Os}};function As(t,e){t*=$a;var n=ro(e*=$a);Rs(n*ro(t),n*co(t),co(e))}function Rs(t,e,n){fs+=(t-fs)/++us,ds+=(e-ds)/us,ps+=(n-ps)/us}function Ls(){Ss.point=Cs}function Cs(t,e){t*=$a;var n=ro(e*=$a);Ms=n*ro(t),Es=n*co(t),Ts=co(e),Ss.point=Ps,Rs(Ms,Es,Ts)}function Ps(t,e){t*=$a;var n=ro(e*=$a),r=n*ro(t),i=n*co(t),a=co(e),o=no(uo((o=Es*a-Ts*i)*o+(o=Ts*r-Ms*a)*o+(o=Ms*i-Es*r)*o),Ms*r+Es*i+Ts*a);hs+=o,ms+=o*(Ms+(Ms=r)),vs+=o*(Es+(Es=i)),gs+=o*(Ts+(Ts=a)),Rs(Ms,Es,Ts)}function Os(){Ss.point=As}function Ns(){Ss.point=zs}function Is(){Us(bs,ws),Ss.point=As}function zs(t,e){bs=t,ws=e,t*=$a,e*=$a,Ss.point=Us;var n=ro(e);Ms=n*ro(t),Es=n*co(t),Ts=co(e),Rs(Ms,Es,Ts)}function Us(t,e){t*=$a;var n=ro(e*=$a),r=n*ro(t),i=n*co(t),a=co(e),o=Es*a-Ts*i,s=Ts*r-Ms*a,c=Ms*i-Es*r,l=uo(o*o+s*s+c*c),u=Ms*r+Es*i+Ts*a,h=l&&-po(l)/l,f=no(l,u);ys+=h*o,_s+=h*s,xs+=h*c,hs+=f,ms+=f*(Ms+(Ms=r)),vs+=f*(Es+(Es=i)),gs+=f*(Ts+(Ts=a)),Rs(Ms,Es,Ts)}var Ds=function(t){return function(){return t}},ks=function(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n};function Fs(t,e){return[t>Ya?t-Qa:t<-Ya?t+Qa:t,e]}function Bs(t,e,n){return(t%=Qa)?e||n?ks(Hs(t),Gs(e,n)):Hs(t):e||n?Gs(e,n):Fs}function js(t){return function(e,n){return[(e+=t)>Ya?e-Qa:e<-Ya?e+Qa:e,n]}}function Hs(t){var e=js(t);return e.invert=js(-t),e}function Gs(t,e){var n=ro(t),r=co(t),i=ro(e),a=co(e);function o(t,e){var o=ro(e),s=ro(t)*o,c=co(t)*o,l=co(e),u=l*n+s*r;return[no(c*i-u*a,s*n-l*r),po(u*i+c*a)]}return o.invert=function(t,e){var o=ro(e),s=ro(t)*o,c=co(t)*o,l=co(e),u=l*i-c*a;return[no(c*i+l*a,s*n+u*r),po(u*n-s*r)]},o}function Vs(t,e,n,r,i,a){if(n){var o=ro(e),s=co(e),c=r*n;null==i?(i=e+r*Qa,a=e-c/2):(i=Ws(o,i),a=Ws(o,a),(r>0?i<a:i>a)&&(i+=r*Qa));for(var l,u=i;r>0?u>a:u<a;u-=c)l=Go([o,-s*ro(u),-s*co(u)]),t.point(l[0],l[1])}}function Ws(t,e){(e=Vo(e))[0]-=t,Zo(e);var n=fo(-e[1]);return((-e[2]<0?-n:n)+Qa-Xa)%Qa}Fs.invert=Fs;var qs=function(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:vo,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},Xs=function(t,e,n,r,i,a){var o,s=t[0],c=t[1],l=e[0],u=e[1],h=0,f=1,d=l-s,p=u-c;if(o=n-s,d||!(o>0)){if(o/=d,d<0){if(o<h)return;o<f&&(f=o)}else if(d>0){if(o>f)return;o>h&&(h=o)}if(o=i-s,d||!(o<0)){if(o/=d,d<0){if(o>f)return;o>h&&(h=o)}else if(d>0){if(o<h)return;o<f&&(f=o)}if(o=r-c,p||!(o>0)){if(o/=p,p<0){if(o<h)return;o<f&&(f=o)}else if(p>0){if(o>f)return;o>h&&(h=o)}if(o=a-c,p||!(o<0)){if(o/=p,p<0){if(o>f)return;o>h&&(h=o)}else if(p>0){if(o<h)return;o<f&&(f=o)}return h>0&&(t[0]=s+h*d,t[1]=c+h*p),f<1&&(e[0]=s+f*d,e[1]=c+f*p),!0}}}}},Ys=function(t,e){return to(t[0]-e[0])<Xa&&to(t[1]-e[1])<Xa};function Zs(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var Js=function(t,e,n,r,i){var a,o,s=[],c=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],o=t[e];if(Ys(r,o)){for(i.lineStart(),a=0;a<e;++a)i.point((r=t[a])[0],r[1]);i.lineEnd()}else s.push(n=new Zs(r,t,null,!0)),c.push(n.o=new Zs(r,null,n,!1)),s.push(n=new Zs(o,t,null,!1)),c.push(n.o=new Zs(o,null,n,!0))}}),s.length){for(c.sort(e),Qs(s),Qs(c),a=0,o=c.length;a<o;++a)c[a].e=n=!n;for(var l,u,h=s[0];;){for(var f=h,d=!0;f.v;)if((f=f.n)===h)return;l=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(a=0,o=l.length;a<o;++a)i.point((u=l[a])[0],u[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(d)for(l=f.p.z,a=l.length-1;a>=0;--a)i.point((u=l[a])[0],u[1]);else r(f.x,f.p.x,-1,i);f=f.p}f=f.o,l=f.z,d=!d}while(!f.v);i.lineEnd()}}};function Qs(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}var Ks=1e9,$s=-Ks;function tc(t,e,n,r){function i(i,a){return t<=i&&i<=n&&e<=a&&a<=r}function a(i,a,s,l){var u=0,h=0;if(null==i||(u=o(i,s))!==(h=o(a,s))||c(i,a)<0^s>0)do{l.point(0===u||3===u?t:n,u>1?r:e)}while((u=(u+s+4)%4)!==h);else l.point(a[0],a[1])}function o(r,i){return to(r[0]-t)<Xa?i>0?0:3:to(r[0]-n)<Xa?i>0?2:1:to(r[1]-e)<Xa?i>0?1:0:i>0?3:2}function s(t,e){return c(t.x,e.x)}function c(t,e){var n=o(t,1),r=o(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){var c,l,u,h,f,d,p,m,v,g,y,_=o,x=qs(),b={point:w,lineStart:function(){b.point=E,l&&l.push(u=[]),g=!0,v=!1,p=m=NaN},lineEnd:function(){c&&(E(h,f),d&&v&&x.rejoin(),c.push(x.result())),b.point=w,v&&_.lineEnd()},polygonStart:function(){_=x,c=[],l=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=l.length;n<i;++n)for(var a,o,s=l[n],c=1,u=s.length,h=s[0],f=h[0],d=h[1];c<u;++c)a=f,o=d,h=s[c],f=h[0],d=h[1],o<=r?d>r&&(f-a)*(r-o)>(d-o)*(t-a)&&++e:d<=r&&(f-a)*(r-o)<(d-o)*(t-a)&&--e;return e}(),n=y&&e,i=(c=M(c)).length;(n||i)&&(o.polygonStart(),n&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),i&&Js(c,s,e,a,o),o.polygonEnd()),_=o,c=l=u=null}};function w(t,e){i(t,e)&&_.point(t,e)}function E(a,o){var s=i(a,o);if(l&&u.push([a,o]),g)h=a,f=o,d=s,g=!1,s&&(_.lineStart(),_.point(a,o));else if(s&&v)_.point(a,o);else{var c=[p=Math.max($s,Math.min(Ks,p)),m=Math.max($s,Math.min(Ks,m))],x=[a=Math.max($s,Math.min(Ks,a)),o=Math.max($s,Math.min(Ks,o))];Xs(c,x,t,e,n,r)?(v||(_.lineStart(),_.point(c[0],c[1])),_.point(x[0],x[1]),s||_.lineEnd(),y=!1):s&&(_.lineStart(),_.point(a,o),y=!1)}p=a,m=o,v=s}return b}}var ec,nc,rc,ic=Ga(),ac={sphere:vo,point:vo,lineStart:function(){ac.point=sc,ac.lineEnd=oc},lineEnd:vo,polygonStart:vo,polygonEnd:vo};function oc(){ac.point=ac.lineEnd=vo}function sc(t,e){ec=t*=$a,nc=co(e*=$a),rc=ro(e),ac.point=cc}function cc(t,e){t*=$a;var n=co(e*=$a),r=ro(e),i=to(t-ec),a=ro(i),o=co(i),s=r*o,c=rc*n-nc*r*a,l=nc*n+rc*r*a;ic.add(no(uo(s*s+c*c),l)),ec=t,nc=n,rc=r}var lc=function(t){return ic.reset(),zo(t,ac),+ic},uc=[null,null],hc={type:"LineString",coordinates:uc};function fc(t,e,n){var r=m(t,e-Xa,n).concat(e);return function(t){return r.map(function(e){return[t,e]})}}function dc(t,e,n){var r=m(t,e-Xa,n).concat(e);return function(t){return r.map(function(e){return[e,t]})}}function pc(){var t,e,n,r,i,a,o,s,c,l,u,h,f=10,d=f,p=90,v=360,g=2.5;function y(){return{type:"MultiLineString",coordinates:_()}}function _(){return m(io(r/p)*p,n,p).map(u).concat(m(io(s/v)*v,o,v).map(h)).concat(m(io(e/f)*f,t,f).filter(function(t){return to(t%p)>Xa}).map(c)).concat(m(io(a/d)*d,i,d).filter(function(t){return to(t%v)>Xa}).map(l))}return y.lines=function(){return _().map(function(t){return{type:"LineString",coordinates:t}})},y.outline=function(){return{type:"Polygon",coordinates:[u(r).concat(h(o).slice(1),u(n).reverse().slice(1),h(s).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],s=+t[0][1],o=+t[1][1],r>n&&(t=r,r=n,n=t),s>o&&(t=s,s=o,o=t),y.precision(g)):[[r,s],[n,o]]},y.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],a=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),a>i&&(n=a,a=i,i=n),y.precision(g)):[[e,a],[t,i]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(p=+t[0],v=+t[1],y):[p,v]},y.stepMinor=function(t){return arguments.length?(f=+t[0],d=+t[1],y):[f,d]},y.precision=function(f){return arguments.length?(g=+f,c=fc(a,i,90),l=dc(e,t,g),u=fc(s,o,90),h=dc(r,n,g),y):g},y.extentMajor([[-180,-90+Xa],[180,90-Xa]]).extentMinor([[-180,-80-Xa],[180,80+Xa]])}var mc,vc,gc,yc,_c=function(t){return t},xc=Ga(),bc=Ga(),wc={point:vo,lineStart:vo,lineEnd:vo,polygonStart:function(){wc.lineStart=Mc,wc.lineEnd=Sc},polygonEnd:function(){wc.lineStart=wc.lineEnd=wc.point=vo,xc.add(to(bc)),bc.reset()},result:function(){var t=xc/2;return xc.reset(),t}};function Mc(){wc.point=Ec}function Ec(t,e){wc.point=Tc,mc=gc=t,vc=yc=e}function Tc(t,e){bc.add(yc*t-gc*e),gc=t,yc=e}function Sc(){Tc(mc,vc)}var Ac,Rc,Lc,Cc,Pc=1/0,Oc=Pc,Nc=-Pc,Ic=Nc,zc={point:function(t,e){t<Pc&&(Pc=t),t>Nc&&(Nc=t),e<Oc&&(Oc=e),e>Ic&&(Ic=e)},lineStart:vo,lineEnd:vo,polygonStart:vo,polygonEnd:vo,result:function(){var t=[[Pc,Oc],[Nc,Ic]];return Nc=Ic=-(Oc=Pc=1/0),t}},Uc=0,Dc=0,kc=0,Fc=0,Bc=0,jc=0,Hc=0,Gc=0,Vc=0,Wc={point:qc,lineStart:Xc,lineEnd:Jc,polygonStart:function(){Wc.lineStart=Qc,Wc.lineEnd=Kc},polygonEnd:function(){Wc.point=qc,Wc.lineStart=Xc,Wc.lineEnd=Jc},result:function(){var t=Vc?[Hc/Vc,Gc/Vc]:jc?[Fc/jc,Bc/jc]:kc?[Uc/kc,Dc/kc]:[NaN,NaN];return Uc=Dc=kc=Fc=Bc=jc=Hc=Gc=Vc=0,t}};function qc(t,e){Uc+=t,Dc+=e,++kc}function Xc(){Wc.point=Yc}function Yc(t,e){Wc.point=Zc,qc(Lc=t,Cc=e)}function Zc(t,e){var n=t-Lc,r=e-Cc,i=uo(n*n+r*r);Fc+=i*(Lc+t)/2,Bc+=i*(Cc+e)/2,jc+=i,qc(Lc=t,Cc=e)}function Jc(){Wc.point=qc}function Qc(){Wc.point=$c}function Kc(){tl(Ac,Rc)}function $c(t,e){Wc.point=tl,qc(Ac=Lc=t,Rc=Cc=e)}function tl(t,e){var n=t-Lc,r=e-Cc,i=uo(n*n+r*r);Fc+=i*(Lc+t)/2,Bc+=i*(Cc+e)/2,jc+=i,Hc+=(i=Cc*t-Lc*e)*(Lc+t),Gc+=i*(Cc+e),Vc+=3*i,qc(Lc=t,Cc=e)}function el(t){this._context=t}el.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Qa)}},result:vo};var nl,rl,il,al,ol,sl=Ga(),cl={point:vo,lineStart:function(){cl.point=ll},lineEnd:function(){nl&&ul(rl,il),cl.point=vo},polygonStart:function(){nl=!0},polygonEnd:function(){nl=null},result:function(){var t=+sl;return sl.reset(),t}};function ll(t,e){cl.point=ul,rl=al=t,il=ol=e}function ul(t,e){al-=t,ol-=e,sl.add(uo(al*al+ol*ol)),al=t,ol=e}function hl(){this._string=[]}function fl(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}hl.prototype={_circle:fl(4.5),pointRadius:function(t){return this._circle=fl(t),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}}};var dl=Ga(),pl=function(t,e,n,r){return function(i,a){var o,s,c,l=e(a),u=i.invert(r[0],r[1]),h=qs(),f=e(h),d=!1,p={point:m,lineStart:g,lineEnd:y,polygonStart:function(){p.point=_,p.lineStart=x,p.lineEnd=b,s=[],o=[]},polygonEnd:function(){p.point=m,p.lineStart=g,p.lineEnd=y,s=M(s);var t=function(t,e){var n=e[0],r=e[1],i=[co(n),-ro(n),0],a=0,o=0;dl.reset();for(var s=0,c=t.length;s<c;++s)if(u=(l=t[s]).length)for(var l,u,h=l[u-1],f=h[0],d=h[1]/2+Ja,p=co(d),m=ro(d),v=0;v<u;++v,f=y,p=x,m=b,h=g){var g=l[v],y=g[0],_=g[1]/2+Ja,x=co(_),b=ro(_),w=y-f,M=w>=0?1:-1,E=M*w,T=E>Ya,S=p*x;if(dl.add(no(S*M*co(E),m*b+S*ro(E))),a+=T?w+M*Qa:w,T^f>=n^y>=n){var A=qo(Vo(h),Vo(g));Zo(A);var R=qo(i,A);Zo(R);var L=(T^w>=0?-1:1)*po(R[2]);(r>L||r===L&&(A[0]||A[1]))&&(o+=T^w>=0?1:-1)}}return(a<-Xa||a<Xa&&dl<-Xa)^1&o}(o,u);s.length?(d||(a.polygonStart(),d=!0),Js(s,vl,t,n,a)):t&&(d||(a.polygonStart(),d=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),d&&(a.polygonEnd(),d=!1),s=o=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function m(e,n){var r=i(e,n);t(e=r[0],n=r[1])&&a.point(e,n)}function v(t,e){var n=i(t,e);l.point(n[0],n[1])}function g(){p.point=v,l.lineStart()}function y(){p.point=m,l.lineEnd()}function _(t,e){c.push([t,e]);var n=i(t,e);f.point(n[0],n[1])}function x(){f.lineStart(),c=[]}function b(){_(c[0][0],c[0][1]),f.lineEnd();var t,e,n,r,i=f.clean(),l=h.result(),u=l.length;if(c.pop(),o.push(c),c=null,u)if(1&i){if(n=l[0],(e=n.length-1)>0){for(d||(a.polygonStart(),d=!0),a.lineStart(),t=0;t<e;++t)a.point((r=n[t])[0],r[1]);a.lineEnd()}}else u>1&&2&i&&l.push(l.pop().concat(l.shift())),s.push(l.filter(ml))}return p}};function ml(t){return t.length>1}function vl(t,e){return((t=t.x)[0]<0?t[1]-Za-Xa:Za-t[1])-((e=e.x)[0]<0?e[1]-Za-Xa:Za-e[1])}var gl=pl(function(){return!0},function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,o){var s=a>0?Ya:-Ya,c=to(a-n);to(c-Ya)<Xa?(t.point(n,r=(r+o)/2>0?Za:-Za),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(a,r),e=0):i!==s&&c>=Ya&&(to(n-i)<Xa&&(n-=i*Xa),to(a-s)<Xa&&(a-=s*Xa),r=function(t,e,n,r){var i,a,o=co(t-n);return to(o)>Xa?eo((co(e)*(a=ro(r))*co(n)-co(r)*(i=ro(e))*co(t))/(i*a*o)):(e+r)/2}(n,r,a,o),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=a,r=o),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}},function(t,e,n,r){var i;if(null==t)i=n*Za,r.point(-Ya,i),r.point(0,i),r.point(Ya,i),r.point(Ya,0),r.point(Ya,-i),r.point(0,-i),r.point(-Ya,-i),r.point(-Ya,0),r.point(-Ya,i);else if(to(t[0]-e[0])>Xa){var a=t[0]<e[0]?Ya:-Ya;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(e[0],e[1])},[-Ya,-Za]),yl=function(t,e){var n=ro(t),r=n>0,i=to(n)>Xa;function a(t,e){return ro(t)*ro(e)>n}function o(t,e,r){var i=Vo(t),a=Vo(e),o=[1,0,0],s=qo(i,a),c=Wo(s,s),l=s[0],u=c-l*l;if(!u)return!r&&t;var h=n*c/u,f=-n*l/u,d=qo(o,s),p=Yo(o,h),m=Yo(s,f);Xo(p,m);var v=d,g=Wo(p,v),y=Wo(v,v),_=g*g-y*(Wo(p,p)-1);if(!(_<0)){var x=uo(_),b=Yo(v,(-g-x)/y);if(Xo(b,p),b=Go(b),!r)return b;var w,M=t[0],E=e[0],T=t[1],S=e[1];E<M&&(w=M,M=E,E=w);var A=E-M,R=to(A-Ya)<Xa,L=R||A<Xa;if(!R&&S<T&&(w=T,T=S,S=w),L?R?T+S>0^b[1]<(to(b[0]-M)<Xa?T:S):T<=b[1]&&b[1]<=S:A>Ya^(M<=b[0]&&b[0]<=E)){var C=Yo(v,(-g+x)/y);return Xo(C,p),[b,Go(C)]}}}function s(e,n){var i=r?t:Ya-t,a=0;return e<-i?a|=1:e>i&&(a|=2),n<-i?a|=4:n>i&&(a|=8),a}return pl(a,function(t){var e,n,c,l,u;return{lineStart:function(){l=c=!1,u=1},point:function(h,f){var d,p=[h,f],m=a(h,f),v=r?m?0:s(h,f):m?s(h+(h<0?Ya:-Ya),f):0;if(!e&&(l=c=m)&&t.lineStart(),m!==c&&(d=o(e,p),(Ys(e,d)||Ys(p,d))&&(p[0]+=Xa,p[1]+=Xa,m=a(p[0],p[1]))),m!==c)u=0,m?(t.lineStart(),d=o(p,e),t.point(d[0],d[1])):(d=o(e,p),t.point(d[0],d[1]),t.lineEnd()),e=d;else if(i&&e&&r^m){var g;v&n||!(g=o(p,e,!0))||(u=0,r?(t.lineStart(),t.point(g[0][0],g[0][1]),t.point(g[1][0],g[1][1]),t.lineEnd()):(t.point(g[1][0],g[1][1]),t.lineEnd(),t.lineStart(),t.point(g[0][0],g[0][1])))}!m||e&&Ys(e,p)||t.point(p[0],p[1]),e=p,c=m,n=v},lineEnd:function(){c&&t.lineEnd(),e=null},clean:function(){return u|(l&&c)<<1}}},function(n,r,i,a){Vs(a,t,e,i,n,r)},r?[0,-t]:[-Ya,t-Ya])};function _l(t){return function(e){var n=new xl;for(var r in t)n[r]=t[r];return n.stream=e,n}}function xl(){}function bl(t,e,n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=a&&t.clipExtent(null),zo(n,t.stream(zc));var o=zc.result(),s=Math.min(r/(o[1][0]-o[0][0]),i/(o[1][1]-o[0][1])),c=+e[0][0]+(r-s*(o[1][0]+o[0][0]))/2,l=+e[0][1]+(i-s*(o[1][1]+o[0][1]))/2;return null!=a&&t.clipExtent(a),t.scale(150*s).translate([c,l])}function wl(t,e,n){return bl(t,[[0,0],e],n)}xl.prototype={constructor:xl,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Ml=16,El=ro(30*$a),Tl=function(t,e){return+e?function(t,e){function n(r,i,a,o,s,c,l,u,h,f,d,p,m,v){var g=l-r,y=u-i,_=g*g+y*y;if(_>4*e&&m--){var x=o+f,b=s+d,w=c+p,M=uo(x*x+b*b+w*w),E=po(w/=M),T=to(to(w)-1)<Xa||to(a-h)<Xa?(a+h)/2:no(b,x),S=t(T,E),A=S[0],R=S[1],L=A-r,C=R-i,P=y*L-g*C;(P*P/_>e||to((g*L+y*C)/_-.5)>.3||o*f+s*d+c*p<El)&&(n(r,i,a,o,s,c,A,R,T,x/=M,b/=M,w,m,v),v.point(A,R),n(A,R,T,x,b,w,l,u,h,f,d,p,m,v))}}return function(e){var r,i,a,o,s,c,l,u,h,f,d,p,m={point:v,lineStart:g,lineEnd:_,polygonStart:function(){e.polygonStart(),m.lineStart=x},polygonEnd:function(){e.polygonEnd(),m.lineStart=g}};function v(n,r){n=t(n,r),e.point(n[0],n[1])}function g(){u=NaN,m.point=y,e.lineStart()}function y(r,i){var a=Vo([r,i]),o=t(r,i);n(u,h,l,f,d,p,u=o[0],h=o[1],l=r,f=a[0],d=a[1],p=a[2],Ml,e),e.point(u,h)}function _(){m.point=v,e.lineEnd()}function x(){g(),m.point=b,m.lineEnd=w}function b(t,e){y(r=t,e),i=u,a=h,o=f,s=d,c=p,m.point=y}function w(){n(u,h,l,f,d,p,i,a,r,o,s,c,Ml,e),m.lineEnd=_,_()}return m}}(t,e):function(t){return _l({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)},Sl=_l({point:function(t,e){this.stream.point(t*$a,e*$a)}});function Al(t){return Rl(function(){return t})()}function Rl(t){var e,n,r,i,a,o,s,c,l,u,h=150,f=480,d=250,p=0,m=0,v=0,g=0,y=0,_=null,x=gl,b=null,w=_c,M=.5,E=Tl(A,M);function T(t){return[(t=a(t[0]*$a,t[1]*$a))[0]*h+n,r-t[1]*h]}function S(t){return(t=a.invert((t[0]-n)/h,(r-t[1])/h))&&[t[0]*Ka,t[1]*Ka]}function A(t,i){return[(t=e(t,i))[0]*h+n,r-t[1]*h]}function R(){a=ks(i=Bs(v,g,y),e);var t=e(p,m);return n=f-t[0]*h,r=d+t[1]*h,L()}function L(){return l=u=null,T}return T.stream=function(t){return l&&u===t?l:l=Sl(x(i,E(w(u=t))))},T.clipAngle=function(t){return arguments.length?(x=+t?yl(_=t*$a,6*$a):(_=null,gl),L()):_*Ka},T.clipExtent=function(t){return arguments.length?(w=null==t?(b=o=s=c=null,_c):tc(b=+t[0][0],o=+t[0][1],s=+t[1][0],c=+t[1][1]),L()):null==b?null:[[b,o],[s,c]]},T.scale=function(t){return arguments.length?(h=+t,R()):h},T.translate=function(t){return arguments.length?(f=+t[0],d=+t[1],R()):[f,d]},T.center=function(t){return arguments.length?(p=t[0]%360*$a,m=t[1]%360*$a,R()):[p*Ka,m*Ka]},T.rotate=function(t){return arguments.length?(v=t[0]%360*$a,g=t[1]%360*$a,y=t.length>2?t[2]%360*$a:0,R()):[v*Ka,g*Ka,y*Ka]},T.precision=function(t){return arguments.length?(E=Tl(A,M=t*t),L()):uo(M)},T.fitExtent=function(t,e){return bl(T,t,e)},T.fitSize=function(t,e){return wl(T,t,e)},function(){return e=t.apply(this,arguments),T.invert=e.invert&&S,R()}}function Ll(t){var e=0,n=Ya/3,r=Rl(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*$a,n=t[1]*$a):[e*Ka,n*Ka]},i}function Cl(t,e){var n=co(t),r=(n+co(e))/2;if(to(r)<Xa)return function(t){var e=ro(t);function n(t,n){return[t*e,co(n)/e]}return n.invert=function(t,n){return[t/e,po(n*e)]},n}(t);var i=1+n*(2*r-n),a=uo(i)/r;function o(t,e){var n=uo(i-2*r*co(e))/r;return[n*co(t*=r),a-n*ro(t)]}return o.invert=function(t,e){var n=a-e;return[no(t,to(n))/r*lo(n),po((i-(t*t+n*n)*r*r)/(2*r))]},o}var Pl=function(){return Ll(Cl).scale(155.424).center([0,33.6442])},Ol=function(){return Pl().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};function Nl(t){return function(e,n){var r=ro(e),i=ro(n),a=t(r*i);return[a*i*co(e),a*co(n)]}}function Il(t){return function(e,n){var r=uo(e*e+n*n),i=t(r),a=co(i),o=ro(i);return[no(e*a,r*o),po(r&&n*a/r)]}}var zl=Nl(function(t){return uo(2/(1+t))});zl.invert=Il(function(t){return 2*po(t/2)});var Ul=Nl(function(t){return(t=fo(t))&&t/co(t)});function Dl(t,e){return[t,oo(ho((Za+e)/2))]}function kl(t){var e,n=Al(t),r=n.scale,i=n.translate,a=n.clipExtent;return n.scale=function(t){return arguments.length?(r(t),e&&n.clipExtent(null),n):r()},n.translate=function(t){return arguments.length?(i(t),e&&n.clipExtent(null),n):i()},n.clipExtent=function(t){if(!arguments.length)return e?null:a();if(e=null==t){var o=Ya*r(),s=i();t=[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]}return a(t),n},n.clipExtent(null)}function Fl(t){return ho((Za+t)/2)}function Bl(t,e){var n=ro(t),r=t===e?co(t):oo(n/ro(e))/oo(Fl(e)/Fl(t)),i=n*so(Fl(t),r)/r;if(!r)return Dl;function a(t,e){i>0?e<-Za+Xa&&(e=-Za+Xa):e>Za-Xa&&(e=Za-Xa);var n=i/so(Fl(e),r);return[n*co(r*t),i-n*ro(r*t)]}return a.invert=function(t,e){var n=i-e,a=lo(r)*uo(t*t+n*n);return[no(t,to(n))/r*lo(n),2*eo(so(i/a,1/r))-Za]},a}function jl(t,e){return[t,e]}function Hl(t,e){var n=ro(t),r=t===e?co(t):(n-ro(e))/(e-t),i=n/r+t;if(to(r)<Xa)return jl;function a(t,e){var n=i-e,a=r*t;return[n*co(a),i-n*ro(a)]}return a.invert=function(t,e){var n=i-e;return[no(t,to(n))/r*lo(n),i-lo(r)*uo(t*t+n*n)]},a}function Gl(t,e){var n=ro(e),r=ro(t)*n;return[n*co(t)/r,co(e)/r]}function Vl(t,e,n,r){return 1===t&&1===e&&0===n&&0===r?_c:_l({point:function(i,a){this.stream.point(i*t+n,a*e+r)}})}function Wl(t,e){return[ro(e)*co(t),co(e)]}function ql(t,e){var n=ro(e),r=1+ro(t)*n;return[n*co(t)/r,co(e)/r]}function Xl(t,e){return[oo(ho((Za+e)/2)),-t]}function Yl(t,e){return t.parent===e.parent?1:2}function Zl(t,e){return t+e.x}function Jl(t,e){return Math.max(t,e.y)}function Ql(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function Kl(t,e){var n,r,i,a,o,s=new nu(t),c=+t.value&&(s.value=t.value),l=[s];for(null==e&&(e=$l);n=l.pop();)if(c&&(n.value=+n.data.value),(i=e(n.data))&&(o=i.length))for(n.children=new Array(o),a=o-1;a>=0;--a)l.push(r=n.children[a]=new nu(i[a])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(eu)}function $l(t){return t.children}function tu(t){t.data=t.data.data}function eu(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function nu(t){this.data=t,this.depth=this.height=0,this.parent=null}function ru(t){this._=t,this.next=null}Ul.invert=Il(function(t){return t}),Dl.invert=function(t,e){return[t,2*eo(ao(e))-Za]},jl.invert=jl,Gl.invert=Il(eo),Wl.invert=Il(po),ql.invert=Il(function(t){return 2*eo(t)}),Xl.invert=function(t,e){return[-e,2*eo(ao(t))-Za]},nu.prototype=Kl.prototype={constructor:nu,count:function(){return this.eachAfter(Ql)},each:function(t){var e,n,r,i,a=this,o=[a];do{for(e=o.reverse(),o=[];a=e.pop();)if(t(a),n=a.children)for(r=0,i=n.length;r<i;++r)o.push(n[r])}while(o.length);return this},eachAfter:function(t){for(var e,n,r,i=this,a=[i],o=[];i=a.pop();)if(o.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)a.push(e[n]);for(;i=o.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})},sort:function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each(function(e){t.push(e)}),t},leaves:function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},links:function(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e},copy:function(){return Kl(this).eachBefore(tu)}};var iu=function(t){return function t(e,n){var r,i,a,o,s=null,c=e.head;switch(n.length){case 1:o=n[0],r={x:o.x,y:o.y,r:o.r};break;case 2:r=function(t,e){var n=t.x,r=t.y,i=t.r,a=e.x,o=e.y,s=e.r,c=a-n,l=o-r,u=s-i,h=Math.sqrt(c*c+l*l);return{x:(n+a+c/h*u)/2,y:(r+o+l/h*u)/2,r:(h+i+s)/2}}(n[0],n[1]);break;case 3:r=function(t,e,n){var r=t.x,i=t.y,a=t.r,o=e.x,s=e.y,c=e.r,l=n.x,u=n.y,h=n.r,f=2*(r-o),d=2*(i-s),p=2*(c-a),m=r*r+i*i-a*a-o*o-s*s+c*c,v=2*(r-l),g=2*(i-u),y=2*(h-a),_=r*r+i*i-a*a-l*l-u*u+h*h,x=v*d-f*g,b=(d*_-g*m)/x-r,w=(g*p-d*y)/x,M=(v*m-f*_)/x-i,E=(f*y-v*p)/x,T=w*w+E*E-1,S=2*(b*w+M*E+a),A=b*b+M*M-a*a,R=(-S-Math.sqrt(S*S-4*T*A))/(2*T);return{x:b+w*R+r,y:M+E*R+i,r:R}}(n[0],n[1],n[2])}for(;c;)a=c._,i=c.next,r&&au(r,a)?s=c:(s?(e.tail=s,s.next=null):e.head=e.tail=null,n.push(a),r=t(e,n),n.pop(),e.head?(c.next=e.head,e.head=c):(c.next=null,e.head=e.tail=c),(s=e.tail).next=i),c=i;return e.tail=s,r}(function(t){for(var e=(t=t.slice()).length,n=null,r=n;e;){var i=new ru(t[e-1]);r=r?r.next=i:n=i,t[void 0]=t[--e]}return{head:n,tail:r}}(t),[])};function au(t,e){var n=e.x-t.x,r=e.y-t.y,i=t.r-e.r;return i*i+1e-6>n*n+r*r}function ou(t,e,n){var r=t.x,i=t.y,a=e.r+n.r,o=t.r+n.r,s=e.x-r,c=e.y-i,l=s*s+c*c;if(l){var u=.5+((o*=o)-(a*=a))/(2*l),h=Math.sqrt(Math.max(0,2*a*(o+l)-(o-=l)*o-a*a))/(2*l);n.x=r+u*s+h*c,n.y=i+u*c-h*s}else n.x=r+o,n.y=i}function su(t,e){var n=e.x-t.x,r=e.y-t.y,i=t.r+e.r;return i*i-1e-6>n*n+r*r}function cu(t,e){for(var n=t._.r;t!==e;)n+=2*(t=t.next)._.r;return n-e._.r}function lu(t,e,n){var r=t._,i=t.next._,a=r.r+i.r,o=(r.x*i.r+i.x*r.r)/a-e,s=(r.y*i.r+i.y*r.r)/a-n;return o*o+s*s}function uu(t){this._=t,this.next=null,this.previous=null}function hu(t){if(!(i=t.length))return 0;var e,n,r,i;if((e=t[0]).x=0,e.y=0,!(i>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(i>2))return e.r+n.r;ou(n,e,r=t[2]);var a,o,s,c,l,u,h,f=e.r*e.r,d=n.r*n.r,p=r.r*r.r,m=f+d+p,v=f*e.x+d*n.x+p*r.x,g=f*e.y+d*n.y+p*r.y;e=new uu(e),n=new uu(n),r=new uu(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(s=3;s<i;++s){ou(e._,n._,r=t[s]),r=new uu(r),c=n.next,l=e.previous,u=n._.r,h=e._.r;do{if(u<=h){if(su(c._,r._)){u+e._.r+n._.r>cu(c,n)?e=c:n=c,e.next=n,n.previous=e,--s;continue t}u+=c._.r,c=c.next}else{if(su(l._,r._)){cu(e,l)>h+e._.r+n._.r?e=l:n=l,e.next=n,n.previous=e,--s;continue t}h+=l._.r,l=l.previous}}while(c!==l.next);for(r.previous=e,r.next=n,e.next=n.previous=n=r,m+=p=r._.r*r._.r,v+=p*r._.x,g+=p*r._.y,f=lu(e,a=v/m,o=g/m);(r=r.next)!==n;)(p=lu(r,a,o))<f&&(e=r,f=p);n=e.next}for(e=[n._],r=n;(r=r.next)!==n;)e.push(r._);for(r=iu(e),s=0;s<i;++s)(e=t[s]).x-=r.x,e.y-=r.y;return r.r}function fu(t){if("function"!=typeof t)throw new Error;return t}function du(){return 0}var pu=function(t){return function(){return t}};function mu(t){return Math.sqrt(t.value)}function vu(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function gu(t,e){return function(n){if(r=n.children){var r,i,a,o=r.length,s=t(n)*e||0;if(s)for(i=0;i<o;++i)r[i].r+=s;if(a=hu(r),s)for(i=0;i<o;++i)r[i].r-=s;n.r=a+s}}}function yu(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}var _u=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},xu=function(t,e,n,r,i){for(var a,o=t.children,s=-1,c=o.length,l=t.value&&(r-e)/t.value;++s<c;)(a=o[s]).y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*l},bu="$",wu={depth:-1},Mu={};function Eu(t){return t.id}function Tu(t){return t.parentId}function Su(t,e){return t.parent===e.parent?1:2}function Au(t){var e=t.children;return e?e[0]:t.t}function Ru(t){var e=t.children;return e?e[e.length-1]:t.t}function Lu(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function Cu(t,e,n){return t.a.parent===e.parent?t.a:n}function Pu(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}Pu.prototype=Object.create(nu.prototype);var Ou=function(t,e,n,r,i){for(var a,o=t.children,s=-1,c=o.length,l=t.value&&(i-n)/t.value;++s<c;)(a=o[s]).x0=e,a.x1=r,a.y0=n,a.y1=n+=a.value*l},Nu=(1+Math.sqrt(5))/2;function Iu(t,e,n,r,i,a){for(var o,s,c,l,u,h,f,d,p,m,v,g=[],y=e.children,_=0,x=0,b=y.length,w=e.value;_<b;){c=i-n,l=a-r;do{u=y[x++].value}while(!u&&x<b);for(h=f=u,m=Math.max(l/c,c/l)/(w*t),v=u*u*m,p=Math.max(f/v,v/h);x<b;++x){if(u+=s=y[x].value,s<h&&(h=s),s>f&&(f=s),v=u*u*m,(d=Math.max(f/v,v/h))>p){u-=s;break}p=d}g.push(o={value:u,dice:c<l,children:y.slice(_,x)}),o.dice?xu(o,n,r,i,w?r+=l*u/w:a):Ou(o,n,r,w?n+=c*u/w:i,a),w-=u,_=x}return g}var zu=function t(e){function n(t,n,r,i,a){Iu(e,t,n,r,i,a)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Nu),Uu=function t(e){function n(t,n,r,i,a){if((o=t._squarify)&&o.ratio===e)for(var o,s,c,l,u,h=-1,f=o.length,d=t.value;++h<f;){for(s=o[h],c=s.children,l=s.value=0,u=c.length;l<u;++l)s.value+=c[l].value;s.dice?xu(s,n,r,i,r+=(a-r)*s.value/d):Ou(s,n,r,n+=(i-n)*s.value/d,a),d-=s.value}else t._squarify=o=Iu(e,t,n,r,i,a),o.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Nu),Du=function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])};function ku(t,e){return t[0]-e[0]||t[1]-e[1]}function Fu(t){for(var e=t.length,n=[0,1],r=2,i=2;i<e;++i){for(;r>1&&Du(t[n[r-2]],t[n[r-1]],t[i])<=0;)--r;n[r++]=i}return n.slice(0,r)}var Bu=[].slice,ju={};function Hu(t){if(!(t>=1))throw new Error;this._size=t,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}function Gu(t){if(!t._start)try{!function(t){for(;t._start=t._waiting&&t._active<t._size;){var e=t._ended+t._active,n=t._tasks[e],r=n.length-1,i=n[r];n[r]=Vu(t,e),--t._waiting,++t._active,n=i.apply(null,n),t._tasks[e]&&(t._tasks[e]=n||ju)}}(t)}catch(e){if(t._tasks[t._ended+t._active-1])Wu(t,e);else if(!t._data)throw e}}function Vu(t,e){return function(n,r){t._tasks[e]&&(--t._active,++t._ended,t._tasks[e]=null,null==t._error&&(null!=n?Wu(t,n):(t._data[e]=r,t._waiting?Gu(t):qu(t))))}}function Wu(t,e){var n,r=t._tasks.length;for(t._error=e,t._data=void 0,t._waiting=NaN;--r>=0;)if((n=t._tasks[r])&&(t._tasks[r]=null,n.abort))try{n.abort()}catch(e){}t._active=NaN,qu(t)}function qu(t){if(!t._active&&t._call){var e=t._data;t._data=void 0,t._call(t._error,e)}}function Xu(t){return new Hu(arguments.length?+t:1/0)}Hu.prototype=Xu.prototype={constructor:Hu,defer:function(t){if("function"!=typeof t||this._call)throw new Error;if(null!=this._error)return this;var e=Bu.call(arguments,1);return e.push(t),++this._waiting,this._tasks.push(e),Gu(this),this},abort:function(){return null==this._error&&Wu(this,new Error("abort")),this},await:function(t){if("function"!=typeof t||this._call)throw new Error;return this._call=function(e,n){t.apply(null,[e].concat(n))},qu(this),this},awaitAll:function(t){if("function"!=typeof t||this._call)throw new Error;return this._call=t,qu(this),this}};var Yu=function(t,e){var n,r;return t=null==t?0:+t,e=null==e?1:+e,function(){var i;if(null!=n)i=n,n=null;else do{n=2*Math.random()-1,i=2*Math.random()-1,r=n*n+i*i}while(!r||r>1);return t+e*i*Math.sqrt(-2*Math.log(r)/r)}},Zu=function(t){return function(){for(var e=0,n=0;n<t;++n)e+=Math.random();return e}},Ju=function(t,e){var n,r,i,a,o=F("beforesend","progress","load","error"),s=Gi(),c=new XMLHttpRequest,l=null,u=null,h=0;function f(t){var e,r=c.status;if(!r&&function(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}(c)||r>=200&&r<300||304===r){if(i)try{e=i.call(n,c)}catch(t){return void o.call("error",n,t)}else e=c;o.call("load",n,e)}else o.call("error",n,t)}if("undefined"==typeof XDomainRequest||"withCredentials"in c||!/^(http(s)?:)?\/\//.test(t)||(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=c.ontimeout=f:c.onreadystatechange=function(t){c.readyState>3&&f(t)},c.onprogress=function(t){o.call("progress",n,t)},n={header:function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?s.get(t):(null==e?s.remove(t):s.set(t,e+""),n)},mimeType:function(t){return arguments.length?(r=null==t?null:t+"",n):r},responseType:function(t){return arguments.length?(a=t,n):a},timeout:function(t){return arguments.length?(h=+t,n):h},user:function(t){return arguments.length<1?l:(l=null==t?null:t+"",n)},password:function(t){return arguments.length<1?u:(u=null==t?null:t+"",n)},response:function(t){return i=t,n},get:function(t,e){return n.send("GET",t,e)},post:function(t,e){return n.send("POST",t,e)},send:function(e,i,f){return c.open(e,t,!0,l,u),null==r||s.has("accept")||s.set("accept",r+",*/*"),c.setRequestHeader&&s.each(function(t,e){c.setRequestHeader(e,t)}),null!=r&&c.overrideMimeType&&c.overrideMimeType(r),null!=a&&(c.responseType=a),h>0&&(c.timeout=h),null==f&&"function"==typeof i&&(f=i,i=null),null!=f&&1===f.length&&(f=function(t){return function(e,n){t(null==e?n:null)}}(f)),null!=f&&n.on("error",f).on("load",function(t){f(null,t)}),o.call("beforesend",n,c),c.send(null==i?null:i),n},abort:function(){return c.abort(),n},on:function(){var t=o.on.apply(o,arguments);return t===o?n:t}},null!=e){if("function"!=typeof e)throw new Error("invalid callback: "+e);return n.get(e)}return n},Qu=function(t,e){return function(n,r){var i=Ju(n).mimeType(t).response(e);if(null!=r){if("function"!=typeof r)throw new Error("invalid callback: "+r);return i.get(r)}return i}},Ku=Qu("text/html",function(t){return document.createRange().createContextualFragment(t.responseText)}),$u=Qu("application/json",function(t){return JSON.parse(t.responseText)}),th=Qu("text/plain",function(t){return t.responseText}),eh=Qu("application/xml",function(t){var e=t.responseXML;if(!e)throw new Error("parse error");return e}),nh=function(t,e){return function(n,r,i){arguments.length<3&&(i=r,r=null);var a=Ju(n).mimeType(t);return a.row=function(t){return arguments.length?a.response(function(t,e){return function(n){return t(n.responseText,e)}}(e,r=t)):r},a.row(r),i?a.get(i):a}},rh=nh("text/csv",ta),ih=nh("text/tab-separated-values",aa),ah=Array.prototype,oh=ah.map,sh=ah.slice,ch={name:"implicit"};function lh(t){var e=Gi(),n=[],r=ch;function i(i){var a=i+"",o=e.get(a);if(!o){if(r!==ch)return r;e.set(a,o=n.push(i))}return t[(o-1)%t.length]}return t=null==t?[]:sh.call(t),i.domain=function(t){if(!arguments.length)return n.slice();n=[],e=Gi();for(var r,a,o=-1,s=t.length;++o<s;)e.has(a=(r=t[o])+"")||e.set(a,n.push(r));return i},i.range=function(e){return arguments.length?(t=sh.call(e),i):t.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return lh().domain(n).range(t).unknown(r)},i}function uh(){var t,e,n=lh().unknown(void 0),r=n.domain,i=n.range,a=[0,1],o=!1,s=0,c=0,l=.5;function u(){var n=r().length,u=a[1]<a[0],h=a[u-0],f=a[1-u];t=(f-h)/Math.max(1,n-s+2*c),o&&(t=Math.floor(t)),h+=(f-h-t*(n-s))*l,e=t*(1-s),o&&(h=Math.round(h),e=Math.round(e));var d=m(n).map(function(e){return h+t*e});return i(u?d.reverse():d)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),u()):r()},n.range=function(t){return arguments.length?(a=[+t[0],+t[1]],u()):a.slice()},n.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,u()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(o=!!t,u()):o},n.padding=function(t){return arguments.length?(s=c=Math.max(0,Math.min(1,t)),u()):s},n.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),u()):s},n.paddingOuter=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),u()):c},n.align=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),u()):l},n.copy=function(){return uh().domain(r()).range(a).round(o).paddingInner(s).paddingOuter(c).align(l)},u()}var hh=function(t){return function(){return t}},fh=function(t){return+t},dh=[0,1];function ph(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:hh(e)}function mh(t,e,n,r){var i=t[0],a=t[1],o=e[0],s=e[1];return a<i?(i=n(a,i),o=r(s,o)):(i=n(i,a),o=r(o,s)),function(t){return o(i(t))}}function vh(t,e,n,r){var a=Math.min(t.length,e.length)-1,o=new Array(a),s=new Array(a),c=-1;for(t[a]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++c<a;)o[c]=n(t[c],t[c+1]),s[c]=r(e[c],e[c+1]);return function(e){var n=i(t,e,1,a)-1;return s[n](o[n](e))}}function gh(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function yh(t,e){var n,r,i,a=dh,o=dh,s=gn,c=!1;function l(){return n=Math.min(a.length,o.length)>2?vh:mh,r=i=null,u}function u(e){return(r||(r=n(a,o,c?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=e?0:t>=n?1:r(t)}}}(t):t,s)))(+e)}return u.invert=function(t){return(i||(i=n(o,a,ph,c?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=0?e:t>=1?n:r(t)}}}(e):e)))(+t)},u.domain=function(t){return arguments.length?(a=oh.call(t,fh),l()):a.slice()},u.range=function(t){return arguments.length?(o=sh.call(t),l()):o.slice()},u.rangeRound=function(t){return o=sh.call(t),s=yn,l()},u.clamp=function(t){return arguments.length?(c=!!t,l()):c},u.interpolate=function(t){return arguments.length?(s=t,l()):s},l()}var _h=function(e,n,r){var i,a=e[0],o=e[e.length-1],s=x(a,o,null==n?10:n);switch((r=Na(null==r?",f":r)).type){case"s":var c=Math.max(Math.abs(a),Math.abs(o));return null!=r.precision||isNaN(i=ja(s,c))||(r.precision=i),t.formatPrefix(r,c);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=Ha(s,Math.max(Math.abs(a),Math.abs(o))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=Ba(s))||(r.precision=i-2*("%"===r.type))}return t.format(r)};function xh(t){var e=t.domain;return t.ticks=function(t){var n=e();return _(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){return _h(e(),t,n)},t.nice=function(n){var r=e(),i=r.length-1,a=null==n?10:n,o=r[0],s=r[i],c=x(o,s,a);return c&&(c=x(Math.floor(o/c)*c,Math.ceil(s/c)*c,a),r[0]=Math.floor(o/c)*c,r[i]=Math.ceil(s/c)*c,e(r)),t},t}var bh=function(t,e){t=t.slice();var n,r=0,i=t.length-1,a=t[r],o=t[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),t[r]=e.floor(a),t[i]=e.ceil(o),t};function wh(t,e){return(e=Math.log(e/t))?function(n){return Math.log(n/t)/e}:hh(e)}function Mh(t,e){return t<0?function(n){return-Math.pow(-e,n)*Math.pow(-t,1-n)}:function(n){return Math.pow(e,n)*Math.pow(t,1-n)}}function Eh(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Th(t){return 10===t?Eh:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function Sh(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function Ah(t){return function(e){return-t(-e)}}function Rh(t,e){return t<0?-Math.pow(-t,e):Math.pow(t,e)}function Lh(){var t=1,e=yh(function(e,n){return(n=Rh(n,t)-(e=Rh(e,t)))?function(r){return(Rh(r,t)-e)/n}:hh(n)},function(e,n){return n=Rh(n,t)-(e=Rh(e,t)),function(r){return Rh(e+n*r,1/t)}}),n=e.domain;return e.exponent=function(e){return arguments.length?(t=+e,n(n())):t},e.copy=function(){return gh(e,Lh().exponent(t))},xh(e)}var Ch=new Date,Ph=new Date;function Oh(t,e,n,r){function i(e){return t(e=new Date(+e)),e}return i.floor=i,i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r&&a>0))return o;do{o.push(new Date(+n))}while(e(n,a),t(n),n<r);return o},i.filter=function(n){return Oh(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,r){if(t>=t)for(;--r>=0;)for(;e(t,1),!n(t););})},n&&(i.count=function(e,r){return Ch.setTime(+e),Ph.setTime(+r),t(Ch),t(Ph),Math.floor(n(Ch,Ph))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var Nh=Oh(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});Nh.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Oh(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):Nh:null};var Ih=Nh.range,zh=6e4,Uh=6048e5,Dh=Oh(function(t){t.setTime(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}),kh=Dh.range,Fh=Oh(function(t){t.setTime(Math.floor(t/zh)*zh)},function(t,e){t.setTime(+t+e*zh)},function(t,e){return(e-t)/zh},function(t){return t.getMinutes()}),Bh=Fh.range,jh=Oh(function(t){var e=t.getTimezoneOffset()*zh%36e5;e<0&&(e+=36e5),t.setTime(36e5*Math.floor((+t-e)/36e5)+e)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getHours()}),Hh=jh.range,Gh=Oh(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*zh)/864e5},function(t){return t.getDate()-1}),Vh=Gh.range;function Wh(t){return Oh(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*zh)/Uh})}var qh=Wh(0),Xh=Wh(1),Yh=Wh(2),Zh=Wh(3),Jh=Wh(4),Qh=Wh(5),Kh=Wh(6),$h=qh.range,tf=Xh.range,ef=Yh.range,nf=Zh.range,rf=Jh.range,af=Qh.range,of=Kh.range,sf=Oh(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}),cf=sf.range,lf=Oh(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});lf.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Oh(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};var uf=lf.range,hf=Oh(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*zh)},function(t,e){return(e-t)/zh},function(t){return t.getUTCMinutes()}),ff=hf.range,df=Oh(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getUTCHours()}),pf=df.range,mf=Oh(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1}),vf=mf.range;function gf(t){return Oh(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/Uh})}var yf=gf(0),_f=gf(1),xf=gf(2),bf=gf(3),wf=gf(4),Mf=gf(5),Ef=gf(6),Tf=yf.range,Sf=_f.range,Af=xf.range,Rf=bf.range,Lf=wf.range,Cf=Mf.range,Pf=Ef.range,Of=Oh(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),Nf=Of.range,If=Oh(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});If.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Oh(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var zf=If.range;function Uf(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Df(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function kf(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function Ff(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,s=t.months,c=t.shortMonths,l=Xf(i),u=Yf(i),h=Xf(a),f=Yf(a),d=Xf(o),p=Yf(o),m=Xf(s),v=Yf(s),g=Xf(c),y=Yf(c),_={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:ld,e:ld,H:ud,I:hd,j:fd,L:dd,m:pd,M:md,p:function(t){return i[+(t.getHours()>=12)]},S:vd,U:gd,w:yd,W:_d,x:null,X:null,y:xd,Y:bd,Z:wd,"%":Dd},x={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:Md,e:Md,H:Ed,I:Td,j:Sd,L:Ad,m:Rd,M:Ld,p:function(t){return i[+(t.getUTCHours()>=12)]},S:Cd,U:Pd,w:Od,W:Nd,x:null,X:null,y:Id,Y:zd,Z:Ud,"%":Dd},b={a:function(t,e,n){var r=d.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=f[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=v[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return E(t,e,n,r)},d:nd,e:nd,H:id,I:id,j:rd,L:sd,m:ed,M:ad,p:function(t,e,n){var r=l.exec(e.slice(n));return r?(t.p=u[r[0].toLowerCase()],n+r[0].length):-1},S:od,U:Jf,w:Zf,W:Qf,x:function(t,e,r){return E(t,n,e,r)},X:function(t,e,n){return E(t,r,e,n)},y:$f,Y:Kf,Z:td,"%":cd};function w(t,e){return function(n){var r,i,a,o=[],s=-1,c=0,l=t.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===t.charCodeAt(s)&&(o.push(t.slice(c,s)),null!=(i=jf[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),c=s+1);return o.push(t.slice(c,s)),o.join("")}}function M(t,e){return function(n){var r=kf(1900),i=E(r,t,n+="",0);if(i!=n.length)return null;if("p"in r&&(r.H=r.H%12+12*r.p),"W"in r||"U"in r){"w"in r||(r.w="W"in r?1:0);var a="Z"in r?Df(kf(r.y)).getUTCDay():e(kf(r.y)).getDay();r.m=0,r.d="W"in r?(r.w+6)%7+7*r.W-(a+5)%7:r.w+7*r.U-(a+6)%7}return"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,Df(r)):e(r)}}function E(t,e,n,r){for(var i,a,o=0,s=e.length,c=n.length;o<s;){if(r>=c)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=b[i in jf?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return _.x=w(n,_),_.X=w(r,_),_.c=w(e,_),x.x=w(n,x),x.X=w(r,x),x.c=w(e,x),{format:function(t){var e=w(t+="",_);return e.toString=function(){return t},e},parse:function(t){var e=M(t+="",Uf);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=M(t,Df);return e.toString=function(){return t},e}}}var Bf,jf={"-":"",_:" ",0:"0"},Hf=/^\s*\d+/,Gf=/^%/,Vf=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;function Wf(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function qf(t){return t.replace(Vf,"\\$&")}function Xf(t){return new RegExp("^(?:"+t.map(qf).join("|")+")","i")}function Yf(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Zf(t,e,n){var r=Hf.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Jf(t,e,n){var r=Hf.exec(e.slice(n));return r?(t.U=+r[0],n+r[0].length):-1}function Qf(t,e,n){var r=Hf.exec(e.slice(n));return r?(t.W=+r[0],n+r[0].length):-1}function Kf(t,e,n){var r=Hf.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function $f(t,e,n){var r=Hf.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function td(t,e,n){var r=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function ed(t,e,n){var r=Hf.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function nd(t,e,n){var r=Hf.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function rd(t,e,n){var r=Hf.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function id(t,e,n){var r=Hf.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function ad(t,e,n){var r=Hf.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function od(t,e,n){var r=Hf.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function sd(t,e,n){var r=Hf.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function cd(t,e,n){var r=Gf.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function ld(t,e){return Wf(t.getDate(),e,2)}function ud(t,e){return Wf(t.getHours(),e,2)}function hd(t,e){return Wf(t.getHours()%12||12,e,2)}function fd(t,e){return Wf(1+Gh.count(lf(t),t),e,3)}function dd(t,e){return Wf(t.getMilliseconds(),e,3)}function pd(t,e){return Wf(t.getMonth()+1,e,2)}function md(t,e){return Wf(t.getMinutes(),e,2)}function vd(t,e){return Wf(t.getSeconds(),e,2)}function gd(t,e){return Wf(qh.count(lf(t),t),e,2)}function yd(t){return t.getDay()}function _d(t,e){return Wf(Xh.count(lf(t),t),e,2)}function xd(t,e){return Wf(t.getFullYear()%100,e,2)}function bd(t,e){return Wf(t.getFullYear()%1e4,e,4)}function wd(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Wf(e/60|0,"0",2)+Wf(e%60,"0",2)}function Md(t,e){return Wf(t.getUTCDate(),e,2)}function Ed(t,e){return Wf(t.getUTCHours(),e,2)}function Td(t,e){return Wf(t.getUTCHours()%12||12,e,2)}function Sd(t,e){return Wf(1+mf.count(If(t),t),e,3)}function Ad(t,e){return Wf(t.getUTCMilliseconds(),e,3)}function Rd(t,e){return Wf(t.getUTCMonth()+1,e,2)}function Ld(t,e){return Wf(t.getUTCMinutes(),e,2)}function Cd(t,e){return Wf(t.getUTCSeconds(),e,2)}function Pd(t,e){return Wf(yf.count(If(t),t),e,2)}function Od(t){return t.getUTCDay()}function Nd(t,e){return Wf(_f.count(If(t),t),e,2)}function Id(t,e){return Wf(t.getUTCFullYear()%100,e,2)}function zd(t,e){return Wf(t.getUTCFullYear()%1e4,e,4)}function Ud(){return"+0000"}function Dd(){return"%"}function kd(e){return Bf=Ff(e),t.timeFormat=Bf.format,t.timeParse=Bf.parse,t.utcFormat=Bf.utcFormat,t.utcParse=Bf.utcParse,Bf}kd({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Fd=Date.prototype.toISOString?function(t){return t.toISOString()}:t.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),Bd=+new Date("2000-01-01T00:00:00.000Z")?function(t){var e=new Date(t);return isNaN(e)?null:e}:t.utcParse("%Y-%m-%dT%H:%M:%S.%LZ"),jd=1e3,Hd=60*jd,Gd=60*Hd,Vd=24*Gd,Wd=7*Vd,qd=30*Vd,Xd=365*Vd;function Yd(t){return new Date(t)}function Zd(t){return t instanceof Date?+t:+new Date(+t)}function Jd(t,e,r,i,a,o,s,c,l){var u=yh(ph,fn),h=u.invert,f=u.domain,d=l(".%L"),p=l(":%S"),m=l("%I:%M"),v=l("%I %p"),g=l("%a %d"),y=l("%b %d"),_=l("%B"),b=l("%Y"),w=[[s,1,jd],[s,5,5*jd],[s,15,15*jd],[s,30,30*jd],[o,1,Hd],[o,5,5*Hd],[o,15,15*Hd],[o,30,30*Hd],[a,1,Gd],[a,3,3*Gd],[a,6,6*Gd],[a,12,12*Gd],[i,1,Vd],[i,2,2*Vd],[r,1,Wd],[e,1,qd],[e,3,3*qd],[t,1,Xd]];function M(n){return(s(n)<n?d:o(n)<n?p:a(n)<n?m:i(n)<n?v:e(n)<n?r(n)<n?g:y:t(n)<n?_:b)(n)}function E(e,r,i,a){if(null==e&&(e=10),"number"==typeof e){var o=Math.abs(i-r)/e,s=n(function(t){return t[2]}).right(w,o);s===w.length?(a=x(r/Xd,i/Xd,e),e=t):s?(s=w[o/w[s-1][2]<w[s][2]/o?s-1:s],a=s[1],e=s[0]):(a=x(r,i,e),e=c)}return null==a?e:e.every(a)}return u.invert=function(t){return new Date(h(t))},u.domain=function(t){return arguments.length?f(oh.call(t,Zd)):f().map(Yd)},u.ticks=function(t,e){var n,r=f(),i=r[0],a=r[r.length-1],o=a<i;return o&&(n=i,i=a,a=n),n=(n=E(t,i,a,e))?n.range(i,a+1):[],o?n.reverse():n},u.tickFormat=function(t,e){return null==e?M:l(e)},u.nice=function(t,e){var n=f();return(t=E(t,n[0],n[n.length-1],e))?f(bh(n,t)):u},u.copy=function(){return gh(u,Jd(t,e,r,i,a,o,s,c,l))},u}var Qd=function(t){return t.match(/.{6}/g).map(function(t){return"#"+t})},Kd=Qd("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),$d=Qd("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),tp=Qd("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),ep=Qd("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),np=kn(We(300,.5,0),We(-240,.5,1)),rp=kn(We(-100,.75,.35),We(80,1.5,.8)),ip=kn(We(260,.75,.35),We(80,1.5,.8)),ap=We();function op(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}var sp=op(Qd("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),cp=op(Qd("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),lp=op(Qd("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),up=op(Qd("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),hp=function(t){return function(){return t}},fp=1e-12,dp=Math.PI,pp=dp/2,mp=2*dp;function vp(t){return t.innerRadius}function gp(t){return t.outerRadius}function yp(t){return t.startAngle}function _p(t){return t.endAngle}function xp(t){return t&&t.padAngle}function bp(t){return t>=1?pp:t<=-1?-pp:Math.asin(t)}function wp(t,e,n,r,i,a,o){var s=t-n,c=e-r,l=(o?a:-a)/Math.sqrt(s*s+c*c),u=l*c,h=-l*s,f=t+u,d=e+h,p=n+u,m=r+h,v=(f+p)/2,g=(d+m)/2,y=p-f,_=m-d,x=y*y+_*_,b=i-a,w=f*m-p*d,M=(_<0?-1:1)*Math.sqrt(Math.max(0,b*b*x-w*w)),E=(w*_-y*M)/x,T=(-w*y-_*M)/x,S=(w*_+y*M)/x,A=(-w*y+_*M)/x,R=E-v,L=T-g,C=S-v,P=A-g;return R*R+L*L>C*C+P*P&&(E=S,T=A),{cx:E,cy:T,x01:-u,y01:-h,x11:E*(i/b-1),y11:T*(i/b-1)}}function Mp(t){this._context=t}Mp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var Ep=function(t){return new Mp(t)};function Tp(t){return t[0]}function Sp(t){return t[1]}var Ap=function(){var t=Tp,e=Sp,n=hp(!0),r=null,i=Ep,a=null;function o(o){var s,c,l,u=o.length,h=!1;for(null==r&&(a=i(l=Ui())),s=0;s<=u;++s)!(s<u&&n(c=o[s],s,o))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+t(c,s,o),+e(c,s,o));if(l)return a=null,l+""||null}return o.x=function(e){return arguments.length?(t="function"==typeof e?e:hp(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:hp(+t),o):e},o.defined=function(t){return arguments.length?(n="function"==typeof t?t:hp(!!t),o):n},o.curve=function(t){return arguments.length?(i=t,null!=r&&(a=i(r)),o):i},o.context=function(t){return arguments.length?(null==t?r=a=null:a=i(r=t),o):r},o},Rp=function(){var t=Tp,e=null,n=hp(0),r=Sp,i=hp(!0),a=null,o=Ep,s=null;function c(c){var l,u,h,f,d,p=c.length,m=!1,v=new Array(p),g=new Array(p);for(null==a&&(s=o(d=Ui())),l=0;l<=p;++l){if(!(l<p&&i(f=c[l],l,c))===m)if(m=!m)u=l,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=l-1;h>=u;--h)s.point(v[h],g[h]);s.lineEnd(),s.areaEnd()}m&&(v[l]=+t(f,l,c),g[l]=+n(f,l,c),s.point(e?+e(f,l,c):v[l],r?+r(f,l,c):g[l]))}if(d)return s=null,d+""||null}function l(){return Ap().defined(i).curve(o).context(a)}return c.x=function(n){return arguments.length?(t="function"==typeof n?n:hp(+n),e=null,c):t},c.x0=function(e){return arguments.length?(t="function"==typeof e?e:hp(+e),c):t},c.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:hp(+t),c):e},c.y=function(t){return arguments.length?(n="function"==typeof t?t:hp(+t),r=null,c):n},c.y0=function(t){return arguments.length?(n="function"==typeof t?t:hp(+t),c):n},c.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:hp(+t),c):r},c.lineX0=c.lineY0=function(){return l().x(t).y(n)},c.lineY1=function(){return l().x(t).y(r)},c.lineX1=function(){return l().x(e).y(n)},c.defined=function(t){return arguments.length?(i="function"==typeof t?t:hp(!!t),c):i},c.curve=function(t){return arguments.length?(o=t,null!=a&&(s=o(a)),c):o},c.context=function(t){return arguments.length?(null==t?a=s=null:s=o(a=t),c):a},c},Lp=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},Cp=function(t){return t},Pp=Np(Ep);function Op(t){this._curve=t}function Np(t){function e(e){return new Op(t(e))}return e._curve=t,e}function Ip(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(Np(t)):e()._curve},t}Op.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var zp={draw:function(t,e){var n=Math.sqrt(e/dp);t.moveTo(n,0),t.arc(0,0,n,0,mp)}},Up={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},Dp=Math.sqrt(1/3),kp=2*Dp,Fp={draw:function(t,e){var n=Math.sqrt(e/kp),r=n*Dp;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},Bp=Math.sin(dp/10)/Math.sin(7*dp/10),jp=Math.sin(mp/10)*Bp,Hp=-Math.cos(mp/10)*Bp,Gp={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),r=jp*n,i=Hp*n;t.moveTo(0,-n),t.lineTo(r,i);for(var a=1;a<5;++a){var o=mp*a/5,s=Math.cos(o),c=Math.sin(o);t.lineTo(c*n,-s*n),t.lineTo(s*r-c*i,c*r+s*i)}t.closePath()}},Vp={draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},Wp=Math.sqrt(3),qp={draw:function(t,e){var n=-Math.sqrt(e/(3*Wp));t.moveTo(0,2*n),t.lineTo(-Wp*n,-n),t.lineTo(Wp*n,-n),t.closePath()}},Xp=-.5,Yp=Math.sqrt(3)/2,Zp=1/Math.sqrt(12),Jp=3*(Zp/2+1),Qp={draw:function(t,e){var n=Math.sqrt(e/Jp),r=n/2,i=n*Zp,a=r,o=n*Zp+n,s=-a,c=o;t.moveTo(r,i),t.lineTo(a,o),t.lineTo(s,c),t.lineTo(Xp*r-Yp*i,Yp*r+Xp*i),t.lineTo(Xp*a-Yp*o,Yp*a+Xp*o),t.lineTo(Xp*s-Yp*c,Yp*s+Xp*c),t.lineTo(Xp*r+Yp*i,Xp*i-Yp*r),t.lineTo(Xp*a+Yp*o,Xp*o-Yp*a),t.lineTo(Xp*s+Yp*c,Xp*c-Yp*s),t.closePath()}},Kp=[zp,Up,Fp,Vp,Gp,qp,Qp],$p=function(){};function tm(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function em(t){this._context=t}function nm(t){this._context=t}function rm(t){this._context=t}function im(t,e){this._basis=new em(t),this._beta=e}em.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:tm(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:tm(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},nm.prototype={areaStart:$p,areaEnd:$p,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:tm(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},rm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:tm(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},im.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],a=e[0],o=t[n]-i,s=e[n]-a,c=-1;++c<=n;)r=c/n,this._basis.point(this._beta*t[c]+(1-this._beta)*(i+r*o),this._beta*e[c]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var am=function t(e){function n(t){return 1===e?new em(t):new im(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function om(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function sm(t,e){this._context=t,this._k=(1-e)/6}sm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:om(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:om(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var cm=function t(e){function n(t){return new sm(t,e)}return n.tension=function(e){return t(+e)},n}(0);function lm(t,e){this._context=t,this._k=(1-e)/6}lm.prototype={areaStart:$p,areaEnd:$p,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:om(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var um=function t(e){function n(t){return new lm(t,e)}return n.tension=function(e){return t(+e)},n}(0);function hm(t,e){this._context=t,this._k=(1-e)/6}hm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:om(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var fm=function t(e){function n(t){return new hm(t,e)}return n.tension=function(e){return t(+e)},n}(0);function dm(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>fp){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>fp){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,u=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*l+t._x1*t._l23_2a-e*t._l12_2a)/u,o=(o*l+t._y1*t._l23_2a-n*t._l12_2a)/u}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function pm(t,e){this._context=t,this._alpha=e}pm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:dm(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var mm=function t(e){function n(t){return e?new pm(t,e):new sm(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function vm(t,e){this._context=t,this._alpha=e}vm.prototype={areaStart:$p,areaEnd:$p,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:dm(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var gm=function t(e){function n(t){return e?new vm(t,e):new lm(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function ym(t,e){this._context=t,this._alpha=e}ym.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:dm(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var _m=function t(e){function n(t){return e?new ym(t,e):new hm(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function xm(t){this._context=t}function bm(t){return t<0?-1:1}function wm(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(bm(a)+bm(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function Mm(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Em(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,s=(a-r)/3;t._context.bezierCurveTo(r+s,i+s*e,a-s,o-s*n,a,o)}function Tm(t){this._context=t}function Sm(t){this._context=new Am(t)}function Am(t){this._context=t}function Rm(t){this._context=t}function Lm(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function Cm(t,e){this._context=t,this._t=e}xm.prototype={areaStart:$p,areaEnd:$p,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},Tm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Em(this,this._t0,Mm(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Em(this,Mm(this,n=wm(this,t,e)),n);break;default:Em(this,this._t0,n=wm(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(Sm.prototype=Object.create(Tm.prototype)).point=function(t,e){Tm.prototype.point.call(this,e,t)},Am.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},Rm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=Lm(t),i=Lm(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},Cm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var Pm=Array.prototype.slice,Om=function(t,e){if((r=t.length)>1)for(var n,r,i=1,a=t[e[0]],o=a.length;i<r;++i){n=a,a=t[e[i]];for(var s=0;s<o;++s)a[s][1]+=a[s][0]=isNaN(n[s][1])?n[s][0]:n[s][1]}},Nm=function(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n};function Im(t,e){return t[e]}var zm=function(t){var e=t.map(Um);return Nm(t).sort(function(t,n){return e[t]-e[n]})};function Um(t){for(var e,n=0,r=-1,i=t.length;++r<i;)(e=+t[r][1])&&(n+=e);return n}var Dm=function(t){return function(){return t}};function km(t){return t[0]}function Fm(t){return t[1]}function Bm(){this._=null}function jm(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Hm(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Gm(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function Vm(t){for(;t.L;)t=t.L;return t}function Wm(t,e,n,r){var i=[null,null],a=mv.push(i)-1;return i.left=t,i.right=e,n&&Xm(i,t,e,n),r&&Xm(i,e,t,r),dv[t.index].halfedges.push(a),dv[e.index].halfedges.push(a),i}function qm(t,e,n){var r=[e,n];return r.left=t,r}function Xm(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function Ym(t,e,n,r,i){var a,o=t[0],s=t[1],c=o[0],l=o[1],u=s[0],h=s[1],f=0,d=1,p=u-c,m=h-l;if(a=e-c,p||!(a>0)){if(a/=p,p<0){if(a<f)return;a<d&&(d=a)}else if(p>0){if(a>d)return;a>f&&(f=a)}if(a=r-c,p||!(a<0)){if(a/=p,p<0){if(a>d)return;a>f&&(f=a)}else if(p>0){if(a<f)return;a<d&&(d=a)}if(a=n-l,m||!(a>0)){if(a/=m,m<0){if(a<f)return;a<d&&(d=a)}else if(m>0){if(a>d)return;a>f&&(f=a)}if(a=i-l,m||!(a<0)){if(a/=m,m<0){if(a>d)return;a>f&&(f=a)}else if(m>0){if(a<f)return;a<d&&(d=a)}return!(f>0||d<1)||(f>0&&(t[0]=[c+f*p,l+f*m]),d<1&&(t[1]=[c+d*p,l+d*m]),!0)}}}}}function Zm(t,e,n,r,i){var a=t[1];if(a)return!0;var o,s,c=t[0],l=t.left,u=t.right,h=l[0],f=l[1],d=u[0],p=u[1],m=(h+d)/2,v=(f+p)/2;if(p===f){if(m<e||m>=r)return;if(h>d){if(c){if(c[1]>=i)return}else c=[m,n];a=[m,i]}else{if(c){if(c[1]<n)return}else c=[m,i];a=[m,n]}}else if(s=v-(o=(h-d)/(p-f))*m,o<-1||o>1)if(h>d){if(c){if(c[1]>=i)return}else c=[(n-s)/o,n];a=[(i-s)/o,i]}else{if(c){if(c[1]<n)return}else c=[(i-s)/o,i];a=[(n-s)/o,n]}else if(f<p){if(c){if(c[0]>=r)return}else c=[e,o*e+s];a=[r,o*r+s]}else{if(c){if(c[0]<e)return}else c=[r,o*r+s];a=[e,o*e+s]}return t[0]=c,t[1]=a,!0}function Jm(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function Qm(t,e){return e[+(e.left!==t.site)]}function Km(t,e){return e[+(e.left===t.site)]}Bm.prototype={constructor:Bm,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Vm(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)r=n.U,n===r.L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(Hm(this,n),n=(t=n).U),n.C=!1,r.C=!0,Gm(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(Gm(this,n),n=(t=n).U),n.C=!1,r.C=!0,Hm(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,a=t.L,o=t.R;if(n=a?o?Vm(o):a:o,i?i.L===t?i.L=n:i.R=n:this._=n,a&&o?(r=n.C,n.C=t.C,n.L=a,a.U=n,n!==o?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=o,o.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,Hm(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Gm(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,Hm(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,Gm(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Hm(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,Gm(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var $m,tv=[];function ev(){jm(this),this.x=this.y=this.arc=this.site=this.cy=null}function nv(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,a=n.site;if(r!==a){var o=i[0],s=i[1],c=r[0]-o,l=r[1]-s,u=a[0]-o,h=a[1]-s,f=2*(c*h-l*u);if(!(f>=-gv)){var d=c*c+l*l,p=u*u+h*h,m=(h*d-l*p)/f,v=(c*p-u*d)/f,g=tv.pop()||new ev;g.arc=t,g.site=i,g.x=m+o,g.y=(g.cy=v+s)+Math.sqrt(m*m+v*v),t.circle=g;for(var y=null,_=pv._;_;)if(g.y<_.y||g.y===_.y&&g.x<=_.x){if(!_.L){y=_.P;break}_=_.L}else{if(!_.R){y=_;break}_=_.R}pv.insert(y,g),y||($m=g)}}}}function rv(t){var e=t.circle;e&&(e.P||($m=e.N),pv.remove(e),tv.push(e),jm(e),t.circle=null)}var iv=[];function av(){jm(this),this.edge=this.site=this.circle=null}function ov(t){var e=iv.pop()||new av;return e.site=t,e}function sv(t){rv(t),fv.remove(t),iv.push(t),jm(t)}function cv(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],a=t.P,o=t.N,s=[t];sv(t);for(var c=a;c.circle&&Math.abs(n-c.circle.x)<vv&&Math.abs(r-c.circle.cy)<vv;)a=c.P,s.unshift(c),sv(c),c=a;s.unshift(c),rv(c);for(var l=o;l.circle&&Math.abs(n-l.circle.x)<vv&&Math.abs(r-l.circle.cy)<vv;)o=l.N,s.push(l),sv(l),l=o;s.push(l),rv(l);var u,h=s.length;for(u=1;u<h;++u)l=s[u],c=s[u-1],Xm(l.edge,c.site,l.site,i);c=s[0],(l=s[h-1]).edge=Wm(c.site,l.site,null,i),nv(c),nv(l)}function lv(t){for(var e,n,r,i,a=t[0],o=t[1],s=fv._;s;)if((r=uv(s,o)-a)>vv)s=s.L;else{if(!((i=a-hv(s,o))>vv)){r>-vv?(e=s.P,n=s):i>-vv?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}!function(t){dv[t.index]={site:t,halfedges:[]}}(t);var c=ov(t);if(fv.insert(e,c),e||n){if(e===n)return rv(e),n=ov(e.site),fv.insert(c,n),c.edge=n.edge=Wm(e.site,c.site),nv(e),void nv(n);if(n){rv(e),rv(n);var l=e.site,u=l[0],h=l[1],f=t[0]-u,d=t[1]-h,p=n.site,m=p[0]-u,v=p[1]-h,g=2*(f*v-d*m),y=f*f+d*d,_=m*m+v*v,x=[(v*y-d*_)/g+u,(f*_-m*y)/g+h];Xm(n.edge,l,p,x),c.edge=Wm(l,t,null,x),n.edge=Wm(t,p,null,x),nv(e),nv(n)}else c.edge=Wm(e.site,c.site)}}function uv(t,e){var n=t.site,r=n[0],i=n[1],a=i-e;if(!a)return r;var o=t.P;if(!o)return-1/0;var s=(n=o.site)[0],c=n[1],l=c-e;if(!l)return s;var u=s-r,h=1/a-1/l,f=u/l;return h?(-f+Math.sqrt(f*f-2*h*(u*u/(-2*l)-c+l/2+i-a/2)))/h+r:(r+s)/2}function hv(t,e){var n=t.N;if(n)return uv(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var fv,dv,pv,mv,vv=1e-6,gv=1e-12;function yv(t,e){return e[1]-t[1]||e[0]-t[0]}function _v(t,e){var n,r,i,a=t.sort(yv).pop();for(mv=[],dv=new Array(t.length),fv=new Bm,pv=new Bm;;)if(i=$m,a&&(!i||a[1]<i.y||a[1]===i.y&&a[0]<i.x))a[0]===n&&a[1]===r||(lv(a),n=a[0],r=a[1]),a=t.pop();else{if(!i)break;cv(i.arc)}if(function(){for(var t,e,n,r,i=0,a=dv.length;i<a;++i)if((t=dv[i])&&(r=(e=t.halfedges).length)){var o=new Array(r),s=new Array(r);for(n=0;n<r;++n)o[n]=n,s[n]=Jm(t,mv[e[n]]);for(o.sort(function(t,e){return s[e]-s[t]}),n=0;n<r;++n)s[n]=e[o[n]];for(n=0;n<r;++n)e[n]=s[n]}}(),e){var o=+e[0][0],s=+e[0][1],c=+e[1][0],l=+e[1][1];!function(t,e,n,r){for(var i,a=mv.length;a--;)Zm(i=mv[a],t,e,n,r)&&Ym(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>vv||Math.abs(i[0][1]-i[1][1])>vv)||delete mv[a]}(o,s,c,l),function(t,e,n,r){var i,a,o,s,c,l,u,h,f,d,p,m,v=dv.length,g=!0;for(i=0;i<v;++i)if(a=dv[i]){for(o=a.site,c=a.halfedges,s=c.length;s--;)mv[c[s]]||c.splice(s,1);for(s=0,l=c.length;s<l;)d=Km(a,mv[c[s]]),p=d[0],m=d[1],u=Qm(a,mv[c[++s%l]]),h=u[0],f=u[1],(Math.abs(p-h)>vv||Math.abs(m-f)>vv)&&(c.splice(s,0,mv.push(qm(o,d,Math.abs(p-t)<vv&&r-m>vv?[t,Math.abs(h-t)<vv?f:r]:Math.abs(m-r)<vv&&n-p>vv?[Math.abs(f-r)<vv?h:n,r]:Math.abs(p-n)<vv&&m-e>vv?[n,Math.abs(h-n)<vv?f:e]:Math.abs(m-e)<vv&&p-t>vv?[Math.abs(f-e)<vv?h:t,e]:null))-1),++l);l&&(g=!1)}if(g){var y,_,x,b=1/0;for(i=0,g=null;i<v;++i)(a=dv[i])&&(o=a.site,y=o[0]-t,_=o[1]-e,(x=y*y+_*_)<b&&(b=x,g=a));if(g){var w=[t,e],M=[t,r],E=[n,r],T=[n,e];g.halfedges.push(mv.push(qm(o=g.site,w,M))-1,mv.push(qm(o,M,E))-1,mv.push(qm(o,E,T))-1,mv.push(qm(o,T,w))-1)}}for(i=0;i<v;++i)(a=dv[i])&&(a.halfedges.length||delete dv[i])}(o,s,c,l)}this.edges=mv,this.cells=dv,fv=pv=mv=dv=null}_v.prototype={constructor:_v,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(n){return Qm(e,t[n])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,r){if(a=(i=n.halfedges).length)for(var i,a,o,s,c,l,u=n.site,h=-1,f=e[i[a-1]],d=f.left===u?f.right:f.left;++h<a;)o=d,f=e[i[h]],d=f.left===u?f.right:f.left,o&&d&&r<o.index&&r<d.index&&(c=o,l=d,((s=u)[0]-l[0])*(c[1]-s[1])-(s[0]-c[0])*(l[1]-s[1])<0)&&t.push([u.data,o.data,d.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var r,i,a=this,o=a._found||0,s=a.cells.length;!(i=a.cells[o]);)if(++o>=s)return null;var c=t-i.site[0],l=e-i.site[1],u=c*c+l*l;do{i=a.cells[r=o],o=null,i.halfedges.forEach(function(n){var r=a.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var c=t-s[0],l=e-s[1],h=c*c+l*l;h<u&&(u=h,o=s.index)}})}while(null!==o);return a._found=r,null==n||u<=n*n?i.site:null}};var xv=function(t){return function(){return t}};function bv(t,e,n){this.target=t,this.type=e,this.transform=n}function wv(t,e,n){this.k=t,this.x=e,this.y=n}wv.prototype={constructor:wv,scale:function(t){return 1===t?this:new wv(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new wv(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Mv=new wv(1,0,0);function Ev(t){return t.__zoom||Mv}function Tv(){t.event.stopImmediatePropagation()}Ev.prototype=wv.prototype;var Sv=function(){t.event.preventDefault(),t.event.stopImmediatePropagation()};function Av(){return!t.event.button}function Rv(){var t,e,n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,t=n.width.baseVal.value,e=n.height.baseVal.value):(t=n.clientWidth,e=n.clientHeight),[[0,0],[t,e]]}function Lv(){return this.__zoom||Mv}t.version="4.6.0",t.bisect=i,t.bisectRight=i,t.bisectLeft=a,t.ascending=e,t.bisector=n,t.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},t.deviation=c,t.extent=l,t.histogram=function(){var t=p,e=l,n=b;function r(r){var a,o,s=r.length,c=new Array(s);for(a=0;a<s;++a)c[a]=t(r[a],a,r);var l=e(c),u=l[0],h=l[1],f=n(c,u,h);Array.isArray(f)||(f=_(u,h,f));for(var d=f.length;f[0]<=u;)f.shift(),--d;for(;f[d-1]>=h;)f.pop(),--d;var p,m=new Array(d+1);for(a=0;a<=d;++a)(p=m[a]=[]).x0=a>0?f[a-1]:u,p.x1=a<d?f[a]:h;for(a=0;a<s;++a)o=c[a],u<=o&&o<=h&&m[i(f,o,0,d)].push(r[a]);return m}return r.value=function(e){return arguments.length?(t="function"==typeof e?e:d(e),r):t},r.domain=function(t){return arguments.length?(e="function"==typeof t?t:d([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?d(h.call(t)):d(t),r):n},r},t.thresholdFreedmanDiaconis=function(t,n,r){return t=f.call(t,o).sort(e),Math.ceil((r-n)/(2*(w(t,.75)-w(t,.25))*Math.pow(t.length,-1/3)))},t.thresholdScott=function(t,e,n){return Math.ceil((n-e)/(3.5*c(t)*Math.pow(t.length,-1/3)))},t.thresholdSturges=b,t.max=function(t,e){var n,r,i=-1,a=t.length;if(null==e){for(;++i<a;)if(null!=(r=t[i])&&r>=r){n=r;break}for(;++i<a;)null!=(r=t[i])&&r>n&&(n=r)}else{for(;++i<a;)if(null!=(r=e(t[i],i,t))&&r>=r){n=r;break}for(;++i<a;)null!=(r=e(t[i],i,t))&&r>n&&(n=r)}return n},t.mean=function(t,e){var n,r=0,i=t.length,a=-1,s=i;if(null==e)for(;++a<i;)isNaN(n=o(t[a]))?--s:r+=n;else for(;++a<i;)isNaN(n=o(e(t[a],a,t)))?--s:r+=n;if(s)return r/s},t.median=function(t,n){var r,i=[],a=t.length,s=-1;if(null==n)for(;++s<a;)isNaN(r=o(t[s]))||i.push(r);else for(;++s<a;)isNaN(r=o(n(t[s],s,t)))||i.push(r);return w(i.sort(e),.5)},t.merge=M,t.min=E,t.pairs=function(t){for(var e=0,n=t.length-1,r=t[0],i=new Array(n<0?0:n);e<n;)i[e]=[r,r=t[++e]];return i},t.permute=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},t.quantile=w,t.range=m,t.scan=function(t,n){if(r=t.length){var r,i,a=0,o=0,s=t[o];for(n||(n=e);++a<r;)(n(i=t[a],s)<0||0!==n(s,s))&&(s=i,o=a);return 0===n(s,s)?o:void 0}},t.shuffle=function(t,e,n){for(var r,i,a=(null==n?t.length:n)-(e=null==e?0:+e);a;)i=Math.random()*a--|0,r=t[a+e],t[a+e]=t[i+e],t[i+e]=r;return t},t.sum=function(t,e){var n,r=0,i=t.length,a=-1;if(null==e)for(;++a<i;)(n=+t[a])&&(r+=n);else for(;++a<i;)(n=+e(t[a],a,t))&&(r+=n);return r},t.ticks=_,t.tickStep=x,t.transpose=T,t.variance=s,t.zip=function(){return T(arguments)},t.axisTop=function(t){return D(L,t)},t.axisRight=function(t){return D(C,t)},t.axisBottom=function(t){return D(P,t)},t.axisLeft=function(t){return D(O,t)},t.brush=function(){return Mi(fi)},t.brushX=function(){return Mi(ui)},t.brushY=function(){return Mi(hi)},t.brushSelection=function(t){var e=t.__brush;return e?e.dim.output(e.selection):null},t.chord=function(){var t=0,e=null,n=null,r=null;function i(i){var a,o,s,c,l,u,h=i.length,f=[],d=m(h),p=[],v=[],g=v.groups=new Array(h),y=new Array(h*h);for(a=0,l=-1;++l<h;){for(o=0,u=-1;++u<h;)o+=i[l][u];f.push(o),p.push(m(h)),a+=o}for(e&&d.sort(function(t,n){return e(f[t],f[n])}),n&&p.forEach(function(t,e){t.sort(function(t,r){return n(i[e][t],i[e][r])})}),a=Li(0,Ri-t*h)/a,c=a?t:Ri/h,o=0,l=-1;++l<h;){for(s=o,u=-1;++u<h;){var _=d[l],x=p[_][u],b=i[_][x],w=o,M=o+=b*a;y[x*h+_]={index:_,subindex:x,startAngle:w,endAngle:M,value:b}}g[_]={index:_,startAngle:s,endAngle:o,value:f[_]},o+=c}for(l=-1;++l<h;)for(u=l-1;++u<h;){var E=y[u*h+l],T=y[l*h+u];(E.value||T.value)&&v.push(E.value<T.value?{source:T,target:E}:{source:E,target:T})}return r?v.sort(r):v}return i.padAngle=function(e){return arguments.length?(t=Li(0,e),i):t},i.sortGroups=function(t){return arguments.length?(e=t,i):e},i.sortSubgroups=function(t){return arguments.length?(n=t,i):n},i.sortChords=function(t){return arguments.length?(null==t?r=null:(e=t,r=function(t,n){return e(t.source.value+t.target.value,n.source.value+n.target.value)})._=t,i):r&&r._;var e},i},t.ribbon=function(){var t=Di,e=ki,n=Fi,r=Bi,i=ji,a=null;function o(){var o,s=Ci.call(arguments),c=t.apply(this,s),l=e.apply(this,s),u=+n.apply(this,(s[0]=c,s)),h=r.apply(this,s)-Ai,f=i.apply(this,s)-Ai,d=u*Ei(h),p=u*Ti(h),m=+n.apply(this,(s[0]=l,s)),v=r.apply(this,s)-Ai,g=i.apply(this,s)-Ai;if(a||(a=o=Ui()),a.moveTo(d,p),a.arc(0,0,u,h,f),h===v&&f===g||(a.quadraticCurveTo(0,0,m*Ei(v),m*Ti(v)),a.arc(0,0,m,v,g)),a.quadraticCurveTo(0,0,d,p),a.closePath(),o)return a=null,o+""||null}return o.radius=function(t){return arguments.length?(n="function"==typeof t?t:Pi(+t),o):n},o.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:Pi(+t),o):r},o.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:Pi(+t),o):i},o.source=function(e){return arguments.length?(t=e,o):t},o.target=function(t){return arguments.length?(e=t,o):e},o.context=function(t){return arguments.length?(a=null==t?null:t,o):a},o},t.nest=function(){var t,e,n,r=[],i=[];function a(n,i,o,s){if(i>=r.length)return null!=e?e(n):null!=t?n.sort(t):n;for(var c,l,u,h=-1,f=n.length,d=r[i++],p=Gi(),m=o();++h<f;)(u=p.get(c=d(l=n[h])+""))?u.push(l):p.set(c,[l]);return p.each(function(t,e){s(m,e,a(t,i,o,s))}),m}return n={object:function(t){return a(t,0,Vi,Wi)},map:function(t){return a(t,0,qi,Xi)},entries:function(t){return function t(n,a){if(++a>r.length)return n;var o,s=i[a-1];return null!=e&&a>=r.length?o=n.entries():(o=[],n.each(function(e,n){o.push({key:n,values:t(e,a)})})),null!=s?o.sort(function(t,e){return s(t.key,e.key)}):o}(a(t,0,qi,Xi),0)},key:function(t){return r.push(t),n},sortKeys:function(t){return i[r.length-1]=t,n},sortValues:function(e){return t=e,n},rollup:function(t){return e=t,n}}},t.set=Ji,t.map=Gi,t.keys=function(t){var e=[];for(var n in t)e.push(n);return e},t.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},t.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},t.color=le,t.rgb=de,t.hsl=ve,t.lab=Le,t.hcl=ze,t.cubehelix=We,t.dispatch=F,t.drag=function(){var e,n,r=Vt,i=Wt,a=qt,o={},s=F("start","drag","end"),c=0;function l(t){t.on("mousedown.drag",u).on("touchstart.drag",d).on("touchmove.drag",p).on("touchend.drag touchcancel.drag",m).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function u(){if(!n&&r.apply(this,arguments)){var a=v("mouse",i.apply(this,arguments),lt,this,arguments);a&&(Ut(t.event.view).on("mousemove.drag",h,!0).on("mouseup.drag",f,!0),Bt(t.event.view),kt(),e=!1,a("start"))}}function h(){Ft(),e=!0,o.mouse("drag")}function f(){Ut(t.event.view).on("mousemove.drag mouseup.drag",null),jt(t.event.view,e),Ft(),o.mouse("end")}function d(){if(r.apply(this,arguments)){var e,n,a=t.event.changedTouches,o=i.apply(this,arguments),s=a.length;for(e=0;e<s;++e)(n=v(a[e].identifier,o,Dt,this,arguments))&&(kt(),n("start"))}}function p(){var e,n,r=t.event.changedTouches,i=r.length;for(e=0;e<i;++e)(n=o[r[e].identifier])&&(Ft(),n("drag"))}function m(){var e,r,i=t.event.changedTouches,a=i.length;for(n&&clearTimeout(n),n=setTimeout(function(){n=null},500),e=0;e<a;++e)(r=o[i[e].identifier])&&(kt(),r("end"))}function v(e,n,r,i,u){var h,f,d,p=r(n,e),m=s.copy();if(ot(new Gt(l,"beforestart",h,e,c,p[0],p[1],0,0,m),function(){return null!=(t.event.subject=h=a.apply(i,u))&&(f=h.x-p[0]||0,d=h.y-p[1]||0,!0)}))return function t(a){var s,v=p;switch(a){case"start":o[e]=t,s=c++;break;case"end":delete o[e],--c;case"drag":p=r(n,e),s=c}ot(new Gt(l,a,h,e,s,p[0]+f,p[1]+d,p[0]-v[0],p[1]-v[1],m),m.apply,m,[a,i,u])}}return l.filter=function(t){return arguments.length?(r="function"==typeof t?t:Ht(!!t),l):r},l.container=function(t){return arguments.length?(i="function"==typeof t?t:Ht(t),l):i},l.subject=function(t){return arguments.length?(a="function"==typeof t?t:Ht(t),l):a},l.on=function(){var t=s.on.apply(s,arguments);return t===s?l:t},l},t.dragDisable=Bt,t.dragEnable=jt,t.dsvFormat=Ki,t.csvParse=ta,t.csvParseRows=ea,t.csvFormat=na,t.csvFormatRows=ra,t.tsvParse=aa,t.tsvParseRows=oa,t.tsvFormat=sa,t.tsvFormatRows=ca,t.easeLinear=function(t){return+t},t.easeQuad=Tr,t.easeQuadIn=function(t){return t*t},t.easeQuadOut=function(t){return t*(2-t)},t.easeQuadInOut=Tr,t.easeCubic=Sr,t.easeCubicIn=function(t){return t*t*t},t.easeCubicOut=function(t){return--t*t*t+1},t.easeCubicInOut=Sr,t.easePoly=Lr,t.easePolyIn=Ar,t.easePolyOut=Rr,t.easePolyInOut=Lr,t.easeSin=Or,t.easeSinIn=function(t){return 1-Math.cos(t*Pr)},t.easeSinOut=function(t){return Math.sin(t*Pr)},t.easeSinInOut=Or,t.easeExp=Nr,t.easeExpIn=function(t){return Math.pow(2,10*t-10)},t.easeExpOut=function(t){return 1-Math.pow(2,-10*t)},t.easeExpInOut=Nr,t.easeCircle=Ir,t.easeCircleIn=function(t){return 1-Math.sqrt(1-t*t)},t.easeCircleOut=function(t){return Math.sqrt(1- --t*t)},t.easeCircleInOut=Ir,t.easeBounce=Wr,t.easeBounceIn=function(t){return 1-Wr(1-t)},t.easeBounceOut=Wr,t.easeBounceInOut=function(t){return((t*=2)<=1?1-Wr(1-t):Wr(t-1)+1)/2},t.easeBack=Yr,t.easeBackIn=qr,t.easeBackOut=Xr,t.easeBackInOut=Yr,t.easeElastic=Qr,t.easeElasticIn=Jr,t.easeElasticOut=Qr,t.easeElasticInOut=Kr,t.forceCenter=function(t,e){var n;function r(){var r,i,a=n.length,o=0,s=0;for(r=0;r<a;++r)i=n[r],o+=i.x,s+=i.y;for(o=o/a-t,s=s/a-e,r=0;r<a;++r)(i=n[r]).x-=o,i.y-=s}return null==t&&(t=0),null==e&&(e=0),r.initialize=function(t){n=t},r.x=function(e){return arguments.length?(t=+e,r):t},r.y=function(t){return arguments.length?(e=+t,r):e},r},t.forceCollide=function(t){var e,n,r=1,i=1;function a(){for(var t,a,s,c,l,u,h,f=e.length,d=0;d<i;++d)for(a=ma(e,_a,xa).visitAfter(o),t=0;t<f;++t)s=e[t],u=n[s.index],h=u*u,c=s.x+s.vx,l=s.y+s.vy,a.visit(p);function p(t,e,n,i,a){var o=t.data,f=t.r,d=u+f;if(!o)return e>c+d||i<c-d||n>l+d||a<l-d;if(o.index>s.index){var p=c-o.x-o.vx,m=l-o.y-o.vy,v=p*p+m*m;v<d*d&&(0===p&&(p=ua(),v+=p*p),0===m&&(m=ua(),v+=m*m),v=(d-(v=Math.sqrt(v)))/v*r,s.vx+=(p*=v)*(d=(f*=f)/(h+f)),s.vy+=(m*=v)*d,o.vx-=p*(d=1-d),o.vy-=m*d)}}}function o(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function s(){if(e){var r,i,a=e.length;for(n=new Array(a),r=0;r<a;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!=typeof t&&(t=la(null==t?1:+t)),a.initialize=function(t){e=t,s()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(r=+t,a):r},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:la(+e),s(),a):t},a},t.forceLink=function(t){var e,n,r,i,a,o=ba,s=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},c=la(30),l=1;function u(r){for(var i=0,o=t.length;i<l;++i)for(var s,c,u,h,f,d,p,m=0;m<o;++m)s=t[m],c=s.source,u=s.target,h=u.x+u.vx-c.x-c.vx||ua(),f=u.y+u.vy-c.y-c.vy||ua(),d=((d=Math.sqrt(h*h+f*f))-n[m])/d*r*e[m],h*=d,f*=d,u.vx-=h*(p=a[m]),u.vy-=f*p,c.vx+=h*(p=1-p),c.vy+=f*p}function h(){if(r){var s,c,l=r.length,u=t.length,h=Gi(r,o);for(s=0,i=new Array(l);s<u;++s)(c=t[s]).index=s,"object"!=typeof c.source&&(c.source=wa(h,c.source)),"object"!=typeof c.target&&(c.target=wa(h,c.target)),i[c.source.index]=(i[c.source.index]||0)+1,i[c.target.index]=(i[c.target.index]||0)+1;for(s=0,a=new Array(u);s<u;++s)c=t[s],a[s]=i[c.source.index]/(i[c.source.index]+i[c.target.index]);e=new Array(u),f(),n=new Array(u),d()}}function f(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+s(t[n],n,t)}function d(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+c(t[e],e,t)}return null==t&&(t=[]),u.initialize=function(t){r=t,h()},u.links=function(e){return arguments.length?(t=e,h(),u):t},u.id=function(t){return arguments.length?(o=t,u):o},u.iterations=function(t){return arguments.length?(l=+t,u):l},u.strength=function(t){return arguments.length?(s="function"==typeof t?t:la(+t),f(),u):s},u.distance=function(t){return arguments.length?(c="function"==typeof t?t:la(+t),d(),u):c},u},t.forceManyBody=function(){var t,e,n,r,i=la(-30),a=1,o=1/0,s=.81;function c(r){var i,a=t.length,o=ma(t,Ma,Ea).visitAfter(u);for(n=r,i=0;i<a;++i)e=t[i],o.visit(h)}function l(){if(t){var e,n,a=t.length;for(r=new Array(a),e=0;e<a;++e)n=t[e],r[n.index]=+i(n,e,t)}}function u(t){var e,n,i,a,o,s=0;if(t.length){for(i=a=o=0;o<4;++o)(e=t[o])&&(n=e.value)&&(s+=n,i+=n*e.x,a+=n*e.y);t.x=i/s,t.y=a/s}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=r[e.data.index]}while(e=e.next)}t.value=s}function h(t,i,c,l){if(!t.value)return!0;var u=t.x-e.x,h=t.y-e.y,f=l-i,d=u*u+h*h;if(f*f/s<d)return d<o&&(0===u&&(u=ua(),d+=u*u),0===h&&(h=ua(),d+=h*h),d<a&&(d=Math.sqrt(a*d)),e.vx+=u*t.value*n/d,e.vy+=h*t.value*n/d),!0;if(!(t.length||d>=o)){(t.data!==e||t.next)&&(0===u&&(u=ua(),d+=u*u),0===h&&(h=ua(),d+=h*h),d<a&&(d=Math.sqrt(a*d)));do{t.data!==e&&(f=r[t.data.index]*n/d,e.vx+=u*f,e.vy+=h*f)}while(t=t.next)}}return c.initialize=function(e){t=e,l()},c.strength=function(t){return arguments.length?(i="function"==typeof t?t:la(+t),l(),c):i},c.distanceMin=function(t){return arguments.length?(a=t*t,c):Math.sqrt(a)},c.distanceMax=function(t){return arguments.length?(o=t*t,c):Math.sqrt(o)},c.theta=function(t){return arguments.length?(s=t*t,c):Math.sqrt(s)},c},t.forceSimulation=function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=Gi(),c=Qn(u),l=F("tick","end");function u(){h(),l.call("tick",e),n<r&&(c.stop(),l.call("end",e))}function h(){var e,r,c=t.length;for(n+=(a-n)*i,s.each(function(t){t(n)}),e=0;e<c;++e)null==(r=t[e]).fx?r.x+=r.vx*=o:(r.x=r.fx,r.vx=0),null==r.fy?r.y+=r.vy*=o:(r.y=r.fy,r.vy=0)}function f(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,isNaN(e.x)||isNaN(e.y)){var i=Sa*Math.sqrt(n),a=n*Aa;e.x=i*Math.cos(a),e.y=i*Math.sin(a)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function d(e){return e.initialize&&e.initialize(t),e}return null==t&&(t=[]),f(),e={tick:h,restart:function(){return c.restart(u),e},stop:function(){return c.stop(),e},nodes:function(n){return arguments.length?(t=n,f(),s.each(d),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(a=+t,e):a},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},force:function(t,n){return arguments.length>1?(null==n?s.remove(t):s.set(t,d(n)),e):s.get(t)},find:function(e,n,r){var i,a,o,s,c,l=0,u=t.length;for(null==r?r=1/0:r*=r,l=0;l<u;++l)(o=(i=e-(s=t[l]).x)*i+(a=n-s.y)*a)<r&&(c=s,r=o);return c},on:function(t,n){return arguments.length>1?(l.on(t,n),e):l.on(t)}}},t.forceX=function(t){var e,n,r,i=la(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vx+=(r[a]-i.x)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=la(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:la(+t),o(),a):i},a.x=function(e){return arguments.length?(t="function"==typeof e?e:la(+e),o(),a):t},a},t.forceY=function(t){var e,n,r,i=la(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vy+=(r[a]-i.y)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=la(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:la(+t),o(),a):i},a.y=function(e){return arguments.length?(t="function"==typeof e?e:la(+e),o(),a):t},a},t.formatDefaultLocale=Fa,t.formatLocale=ka,t.formatSpecifier=Na,t.precisionFixed=Ba,t.precisionPrefix=ja,t.precisionRound=Ha,t.geoArea=function(t){return Do.reset(),zo(t,ko),2*Do},t.geoBounds=function(t){var e,n,r,i,a,o,s;if(Co=Lo=-(Ao=Ro=1/0),Jo=[],zo(t,$o),n=Jo.length){for(Jo.sort(cs),e=1,r=Jo[0],a=[r];e<n;++e)i=Jo[e],ls(r,i[0])||ls(r,i[1])?(ss(r[0],i[1])>ss(r[0],r[1])&&(r[1]=i[1]),ss(i[0],r[1])>ss(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,n=a.length-1,e=0,r=a[n];e<=n;r=i,++e)i=a[e],(s=ss(r[1],i[0]))>o&&(o=s,Ao=i[0],Lo=r[1])}return Jo=Qo=null,Ao===1/0||Ro===1/0?[[NaN,NaN],[NaN,NaN]]:[[Ao,Ro],[Lo,Co]]},t.geoCentroid=function(t){us=hs=fs=ds=ps=ms=vs=gs=ys=_s=xs=0,zo(t,Ss);var e=ys,n=_s,r=xs,i=e*e+n*n+r*r;return i<1e-12&&(e=ms,n=vs,r=gs,hs<Xa&&(e=fs,n=ds,r=ps),(i=e*e+n*n+r*r)<1e-12)?[NaN,NaN]:[no(n,e)*Ka,po(r/uo(i))*Ka]},t.geoCircle=function(){var t,e,n=Ds([0,0]),r=Ds(90),i=Ds(6),a={point:function(n,r){t.push(n=e(n,r)),n[0]*=Ka,n[1]*=Ka}};function o(){var o=n.apply(this,arguments),s=r.apply(this,arguments)*$a,c=i.apply(this,arguments)*$a;return t=[],e=Bs(-o[0]*$a,-o[1]*$a,0).invert,Vs(a,s,c,1),o={type:"Polygon",coordinates:[t]},t=e=null,o}return o.center=function(t){return arguments.length?(n="function"==typeof t?t:Ds([+t[0],+t[1]]),o):n},o.radius=function(t){return arguments.length?(r="function"==typeof t?t:Ds(+t),o):r},o.precision=function(t){return arguments.length?(i="function"==typeof t?t:Ds(+t),o):i},o},t.geoClipExtent=function(){var t,e,n,r=0,i=0,a=960,o=500;return n={stream:function(n){return t&&e===n?t:t=tc(r,i,a,o)(e=n)},extent:function(s){return arguments.length?(r=+s[0][0],i=+s[0][1],a=+s[1][0],o=+s[1][1],t=e=null,n):[[r,i],[a,o]]}}},t.geoDistance=function(t,e){return uc[0]=t,uc[1]=e,lc(hc)},t.geoGraticule=pc,t.geoGraticule10=function(){return pc()()},t.geoInterpolate=function(t,e){var n=t[0]*$a,r=t[1]*$a,i=e[0]*$a,a=e[1]*$a,o=ro(r),s=co(r),c=ro(a),l=co(a),u=o*ro(n),h=o*co(n),f=c*ro(i),d=c*co(i),p=2*po(uo(mo(a-r)+o*c*mo(i-n))),m=co(p),v=p?function(t){var e=co(t*=p)/m,n=co(p-t)/m,r=n*u+e*f,i=n*h+e*d,a=n*s+e*l;return[no(i,r)*Ka,no(a,uo(r*r+i*i))*Ka]}:function(){return[n*Ka,r*Ka]};return v.distance=p,v},t.geoLength=lc,t.geoPath=function(t,e){var n,r,i=4.5;function a(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),zo(t,n(r))),r.result()}return a.area=function(t){return zo(t,n(wc)),wc.result()},a.measure=function(t){return zo(t,n(cl)),cl.result()},a.bounds=function(t){return zo(t,n(zc)),zc.result()},a.centroid=function(t){return zo(t,n(Wc)),Wc.result()},a.projection=function(e){return arguments.length?(n=null==e?(t=null,_c):(t=e).stream,a):t},a.context=function(t){return arguments.length?(r=null==t?(e=null,new hl):new el(e=t),"function"!=typeof i&&r.pointRadius(i),a):e},a.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),a):i},a.projection(t).context(e)},t.geoAlbers=Ol,t.geoAlbersUsa=function(){var t,e,n,r,i,a,o=Ol(),s=Pl().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=Pl().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,e){a=[t,e]}};function u(t){var e=t[0],o=t[1];return a=null,n.point(e,o),a||(r.point(e,o),a)||(i.point(e,o),a)}function h(){return t=e=null,u}return u.invert=function(t){var e=o.scale(),n=o.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?c:o).invert(t)},u.stream=function(n){return t&&e===n?t:(r=[o.stream(e=n),s.stream(n),c.stream(n)],i=r.length,t={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},u.precision=function(t){return arguments.length?(o.precision(t),s.precision(t),c.precision(t),h()):o.precision()},u.scale=function(t){return arguments.length?(o.scale(t),s.scale(.35*t),c.scale(t),u.translate(o.translate())):o.scale()},u.translate=function(t){if(!arguments.length)return o.translate();var e=o.scale(),a=+t[0],u=+t[1];return n=o.translate(t).clipExtent([[a-.455*e,u-.238*e],[a+.455*e,u+.238*e]]).stream(l),r=s.translate([a-.307*e,u+.201*e]).clipExtent([[a-.425*e+Xa,u+.12*e+Xa],[a-.214*e-Xa,u+.234*e-Xa]]).stream(l),i=c.translate([a-.205*e,u+.212*e]).clipExtent([[a-.214*e+Xa,u+.166*e+Xa],[a-.115*e-Xa,u+.234*e-Xa]]).stream(l),h()},u.fitExtent=function(t,e){return bl(u,t,e)},u.fitSize=function(t,e){return wl(u,t,e)},u.scale(1070)},t.geoAzimuthalEqualArea=function(){return Al(zl).scale(124.75).clipAngle(179.999)},t.geoAzimuthalEqualAreaRaw=zl,t.geoAzimuthalEquidistant=function(){return Al(Ul).scale(79.4188).clipAngle(179.999)},t.geoAzimuthalEquidistantRaw=Ul,t.geoConicConformal=function(){return Ll(Bl).scale(109.5).parallels([30,30])},t.geoConicConformalRaw=Bl,t.geoConicEqualArea=Pl,t.geoConicEqualAreaRaw=Cl,t.geoConicEquidistant=function(){return Ll(Hl).scale(131.154).center([0,13.9389])},t.geoConicEquidistantRaw=Hl,t.geoEquirectangular=function(){return Al(jl).scale(152.63)},t.geoEquirectangularRaw=jl,t.geoGnomonic=function(){return Al(Gl).scale(144.049).clipAngle(60)},t.geoGnomonicRaw=Gl,t.geoIdentity=function(){var t,e,n,r,i,a,o=1,s=0,c=0,l=1,u=1,h=_c,f=null,d=_c;function p(){return r=i=null,a}return a={stream:function(t){return r&&i===t?r:r=h(d(i=t))},clipExtent:function(r){return arguments.length?(d=null==r?(f=t=e=n=null,_c):tc(f=+r[0][0],t=+r[0][1],e=+r[1][0],n=+r[1][1]),p()):null==f?null:[[f,t],[e,n]]},scale:function(t){return arguments.length?(h=Vl((o=+t)*l,o*u,s,c),p()):o},translate:function(t){return arguments.length?(h=Vl(o*l,o*u,s=+t[0],c=+t[1]),p()):[s,c]},reflectX:function(t){return arguments.length?(h=Vl(o*(l=t?-1:1),o*u,s,c),p()):l<0},reflectY:function(t){return arguments.length?(h=Vl(o*l,o*(u=t?-1:1),s,c),p()):u<0},fitExtent:function(t,e){return bl(a,t,e)},fitSize:function(t,e){return wl(a,t,e)}}},t.geoProjection=Al,t.geoProjectionMutator=Rl,t.geoMercator=function(){return kl(Dl).scale(961/Qa)},t.geoMercatorRaw=Dl,t.geoOrthographic=function(){return Al(Wl).scale(249.5).clipAngle(90+Xa)},t.geoOrthographicRaw=Wl,t.geoStereographic=function(){return Al(ql).scale(250).clipAngle(142)},t.geoStereographicRaw=ql,t.geoTransverseMercator=function(){var t=kl(Xl),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)},t.geoTransverseMercatorRaw=Xl,t.geoRotation=function(t){function e(e){return(e=t(e[0]*$a,e[1]*$a))[0]*=Ka,e[1]*=Ka,e}return t=Bs(t[0]*$a,t[1]*$a,t.length>2?t[2]*$a:0),e.invert=function(e){return(e=t.invert(e[0]*$a,e[1]*$a))[0]*=Ka,e[1]*=Ka,e},e},t.geoStream=zo,t.geoTransform=function(t){return{stream:_l(t)}},t.cluster=function(){var t=Yl,e=1,n=1,r=!1;function i(i){var a,o=0;i.eachAfter(function(e){var n=e.children;n?(e.x=function(t){return t.reduce(Zl,0)/t.length}(n),e.y=function(t){return 1+t.reduce(Jl,0)}(n)):(e.x=a?o+=t(e,a):0,e.y=0,a=e)});var s=function(t){for(var e;e=t.children;)t=e[0];return t}(i),c=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),l=s.x-t(s,c)/2,u=c.x+t(c,s)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-l)/(u-l)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},t.hierarchy=Kl,t.pack=function(){var t=null,e=1,n=1,r=du;function i(i){return i.x=e/2,i.y=n/2,t?i.eachBefore(vu(t)).eachAfter(gu(r,.5)).eachBefore(yu(1)):i.eachBefore(vu(mu)).eachAfter(gu(du,1)).eachAfter(gu(r,i.r/Math.min(e,n))).eachBefore(yu(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=null==(n=e)?null:fu(n),i):t;var n},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:pu(+t),i):r},i},t.packSiblings=function(t){return hu(t),t},t.packEnclose=iu,t.partition=function(){var t=1,e=1,n=0,r=!1;function i(i){var a=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/a,i.eachBefore(function(t,e){return function(r){r.children&&xu(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,a=r.y0,o=r.x1-n,s=r.y1-n;o<i&&(i=o=(i+o)/2),s<a&&(a=s=(a+s)/2),r.x0=i,r.y0=a,r.x1=o,r.y1=s}}(e,a)),r&&i.eachBefore(_u),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},t.stratify=function(){var t=Eu,e=Tu;function n(n){var r,i,a,o,s,c,l,u=n.length,h=new Array(u),f={};for(i=0;i<u;++i)r=n[i],s=h[i]=new nu(r),null!=(c=t(r,i,n))&&(c+="")&&(l=bu+(s.id=c),f[l]=l in f?Mu:s);for(i=0;i<u;++i)if(s=h[i],null!=(c=e(n[i],i,n))&&(c+="")){if(!(o=f[bu+c]))throw new Error("missing: "+c);if(o===Mu)throw new Error("ambiguous: "+c);o.children?o.children.push(s):o.children=[s],s.parent=o}else{if(a)throw new Error("multiple roots");a=s}if(!a)throw new Error("no root");if(a.parent=wu,a.eachBefore(function(t){t.depth=t.parent.depth+1,--u}).eachBefore(eu),a.parent=null,u>0)throw new Error("cycle");return a}return n.id=function(e){return arguments.length?(t=fu(e),n):t},n.parentId=function(t){return arguments.length?(e=fu(t),n):e},n},t.tree=function(){var t=Su,e=1,n=1,r=null;function i(i){var c=function(t){for(var e,n,r,i,a,o=new Pu(t,0),s=[o];e=s.pop();)if(r=e._.children)for(e.children=new Array(a=r.length),i=a-1;i>=0;--i)s.push(n=e.children[i]=new Pu(r[i],i)),n.parent=e;return(o.parent=new Pu(null,0)).children=[o],o}(i);if(c.eachAfter(a),c.parent.m=-c.z,c.eachBefore(o),r)i.eachBefore(s);else{var l=i,u=i,h=i;i.eachBefore(function(t){t.x<l.x&&(l=t),t.x>u.x&&(u=t),t.depth>h.depth&&(h=t)});var f=l===u?1:t(l,u)/2,d=f-l.x,p=e/(u.x+f+d),m=n/(h.depth||1);i.eachBefore(function(t){t.x=(t.x+d)*p,t.y=t.depth*m})}return i}function a(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,a=i.length;--a>=0;)(e=i[a]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var a=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-a):e.z=a}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,a=e,o=e,s=n,c=a.parent.children[0],l=a.m,u=o.m,h=s.m,f=c.m;s=Ru(s),a=Au(a),s&&a;)c=Au(c),(o=Ru(o)).a=e,(i=s.z+h-a.z-l+t(s._,a._))>0&&(Lu(Cu(s,e,r),e,i),l+=i,u+=i),h+=s.m,l+=a.m,f+=c.m,u+=o.m;s&&!Ru(o)&&(o.t=s,o.m+=h-u),a&&!Au(c)&&(c.t=a,c.m+=l-f,r=e)}return r}(e,i,e.parent.A||r[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},t.treemap=function(){var t=zu,e=!1,n=1,r=1,i=[0],a=du,o=du,s=du,c=du,l=du;function u(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(h),i=[0],e&&t.eachBefore(_u),t}function h(e){var n=i[e.depth],r=e.x0+n,u=e.y0+n,h=e.x1-n,f=e.y1-n;h<r&&(r=h=(r+h)/2),f<u&&(u=f=(u+f)/2),e.x0=r,e.y0=u,e.x1=h,e.y1=f,e.children&&(n=i[e.depth+1]=a(e)/2,r+=l(e)-n,u+=o(e)-n,h-=s(e)-n,f-=c(e)-n,h<r&&(r=h=(r+h)/2),f<u&&(u=f=(u+f)/2),t(e,r,u,h,f))}return u.round=function(t){return arguments.length?(e=!!t,u):e},u.size=function(t){return arguments.length?(n=+t[0],r=+t[1],u):[n,r]},u.tile=function(e){return arguments.length?(t=fu(e),u):t},u.padding=function(t){return arguments.length?u.paddingInner(t).paddingOuter(t):u.paddingInner()},u.paddingInner=function(t){return arguments.length?(a="function"==typeof t?t:pu(+t),u):a},u.paddingOuter=function(t){return arguments.length?u.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):u.paddingTop()},u.paddingTop=function(t){return arguments.length?(o="function"==typeof t?t:pu(+t),u):o},u.paddingRight=function(t){return arguments.length?(s="function"==typeof t?t:pu(+t),u):s},u.paddingBottom=function(t){return arguments.length?(c="function"==typeof t?t:pu(+t),u):c},u.paddingLeft=function(t){return arguments.length?(l="function"==typeof t?t:pu(+t),u):l},u},t.treemapBinary=function(t,e,n,r,i){var a,o,s=t.children,c=s.length,l=new Array(c+1);for(l[0]=o=a=0;a<c;++a)l[a+1]=o+=s[a].value;!function t(e,n,r,i,a,o,c){if(e>=n-1){var u=s[e];return u.x0=i,u.y0=a,u.x1=o,void(u.y1=c)}for(var h=l[e],f=r/2+h,d=e+1,p=n-1;d<p;){var m=d+p>>>1;l[m]<f?d=m+1:p=m}var v=l[d]-h,g=r-v;if(c-a>o-i){var y=(a*g+c*v)/r;t(e,d,v,i,a,o,y),t(d,n,g,i,y,o,c)}else{var _=(i*g+o*v)/r;t(e,d,v,i,a,_,c),t(d,n,g,_,a,o,c)}}(0,c,t.value,e,n,r,i)},t.treemapDice=xu,t.treemapSlice=Ou,t.treemapSliceDice=function(t,e,n,r,i){(1&t.depth?Ou:xu)(t,e,n,r,i)},t.treemapSquarify=zu,t.treemapResquarify=Uu,t.interpolate=gn,t.interpolateArray=un,t.interpolateBasis=Ye,t.interpolateBasisClosed=Ze,t.interpolateDate=hn,t.interpolateNumber=fn,t.interpolateObject=dn,t.interpolateRound=yn,t.interpolateString=vn,t.interpolateTransformCss=Mn,t.interpolateTransformSvg=En,t.interpolateZoom=An,t.interpolateRgb=en,t.interpolateRgbBasis=cn,t.interpolateRgbBasisClosed=ln,t.interpolateHsl=Ln,t.interpolateHslLong=Cn,t.interpolateLab=function(t,e){var n=tn((t=Le(t)).l,(e=Le(e)).l),r=tn(t.a,e.a),i=tn(t.b,e.b),a=tn(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=a(e),t+""}},t.interpolateHcl=On,t.interpolateHclLong=Nn,t.interpolateCubehelix=Dn,t.interpolateCubehelixLong=kn,t.quantize=function(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n},t.path=Ui,t.polygonArea=function(t){for(var e,n=-1,r=t.length,i=t[r-1],a=0;++n<r;)e=i,i=t[n],a+=e[1]*i[0]-e[0]*i[1];return a/2},t.polygonCentroid=function(t){for(var e,n,r=-1,i=t.length,a=0,o=0,s=t[i-1],c=0;++r<i;)e=s,s=t[r],c+=n=e[0]*s[1]-s[0]*e[1],a+=(e[0]+s[0])*n,o+=(e[1]+s[1])*n;return[a/(c*=3),o/c]},t.polygonHull=function(t){if((n=t.length)<3)return null;var e,n,r=new Array(n),i=new Array(n);for(e=0;e<n;++e)r[e]=[+t[e][0],+t[e][1],e];for(r.sort(ku),e=0;e<n;++e)i[e]=[r[e][0],-r[e][1]];var a=Fu(r),o=Fu(i),s=o[0]===a[0],c=o[o.length-1]===a[a.length-1],l=[];for(e=a.length-1;e>=0;--e)l.push(t[r[a[e]][2]]);for(e=+s;e<o.length-c;++e)l.push(t[r[o[e]][2]]);return l},t.polygonContains=function(t,e){for(var n,r,i=t.length,a=t[i-1],o=e[0],s=e[1],c=a[0],l=a[1],u=!1,h=0;h<i;++h)a=t[h],n=a[0],(r=a[1])>s!=l>s&&o<(c-n)*(s-r)/(l-r)+n&&(u=!u),c=n,l=r;return u},t.polygonLength=function(t){for(var e,n,r=-1,i=t.length,a=t[i-1],o=a[0],s=a[1],c=0;++r<i;)e=o,n=s,a=t[r],o=a[0],s=a[1],e-=o,n-=s,c+=Math.sqrt(e*e+n*n);return c},t.quadtree=ma,t.queue=Xu,t.randomUniform=function(t,e){return t=null==t?0:+t,e=null==e?1:+e,1===arguments.length?(e=t,t=0):e-=t,function(){return Math.random()*e+t}},t.randomNormal=Yu,t.randomLogNormal=function(){var t=Yu.apply(this,arguments);return function(){return Math.exp(t())}},t.randomBates=function(t){var e=Zu(t);return function(){return e()/t}},t.randomIrwinHall=Zu,t.randomExponential=function(t){return function(){return-Math.log(1-Math.random())/t}},t.request=Ju,t.html=Ku,t.json=$u,t.text=th,t.xml=eh,t.csv=rh,t.tsv=ih,t.scaleBand=uh,t.scalePoint=function(){return function t(e){var n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return t(n())},e}(uh().paddingInner(1))},t.scaleIdentity=function t(){var e=[0,1];function n(t){return+t}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=oh.call(t,fh),n):e.slice()},n.copy=function(){return t().domain(e)},xh(n)},t.scaleLinear=function t(){var e=yh(ph,fn);return e.copy=function(){return gh(e,t())},xh(e)},t.scaleLog=function e(){var n=yh(wh,Mh).domain([1,10]),r=n.domain,i=10,a=Sh(10),o=Th(10);function s(){return a=Sh(i),o=Th(i),r()[0]<0&&(a=Ah(a),o=Ah(o)),n}return n.base=function(t){return arguments.length?(i=+t,s()):i},n.domain=function(t){return arguments.length?(r(t),s()):r()},n.ticks=function(t){var e,n=r(),s=n[0],c=n[n.length-1];(e=c<s)&&(f=s,s=c,c=f);var l,u,h,f=a(s),d=a(c),p=null==t?10:+t,m=[];if(!(i%1)&&d-f<p){if(f=Math.round(f)-1,d=Math.round(d)+1,s>0){for(;f<d;++f)for(u=1,l=o(f);u<i;++u)if(!((h=l*u)<s)){if(h>c)break;m.push(h)}}else for(;f<d;++f)for(u=i-1,l=o(f);u>=1;--u)if(!((h=l*u)<s)){if(h>c)break;m.push(h)}}else m=_(f,d,Math.min(d-f,p)).map(o);return e?m.reverse():m},n.tickFormat=function(e,r){if(null==r&&(r=10===i?".0e":","),"function"!=typeof r&&(r=t.format(r)),e===1/0)return r;null==e&&(e=10);var s=Math.max(1,i*e/n.ticks().length);return function(t){var e=t/o(Math.round(a(t)));return e*i<i-.5&&(e*=i),e<=s?r(t):""}},n.nice=function(){return r(bh(r(),{floor:function(t){return o(Math.floor(a(t)))},ceil:function(t){return o(Math.ceil(a(t)))}}))},n.copy=function(){return gh(n,e().base(i))},n},t.scaleOrdinal=lh,t.scaleImplicit=ch,t.scalePow=Lh,t.scaleSqrt=function(){return Lh().exponent(.5)},t.scaleQuantile=function t(){var n=[],r=[],a=[];function o(){var t=0,e=Math.max(1,r.length);for(a=new Array(e-1);++t<e;)a[t-1]=w(n,t/e);return s}function s(t){if(!isNaN(t=+t))return r[i(a,t)]}return s.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?a[e-1]:n[0],e<a.length?a[e]:n[n.length-1]]},s.domain=function(t){if(!arguments.length)return n.slice();n=[];for(var r,i=0,a=t.length;i<a;++i)null==(r=t[i])||isNaN(r=+r)||n.push(r);return n.sort(e),o()},s.range=function(t){return arguments.length?(r=sh.call(t),o()):r.slice()},s.quantiles=function(){return a.slice()},s.copy=function(){return t().domain(n).range(r)},s},t.scaleQuantize=function t(){var e=0,n=1,r=1,a=[.5],o=[0,1];function s(t){if(t<=t)return o[i(a,t,0,r)]}function c(){var t=-1;for(a=new Array(r);++t<r;)a[t]=((t+1)*n-(t-r)*e)/(r+1);return s}return s.domain=function(t){return arguments.length?(e=+t[0],n=+t[1],c()):[e,n]},s.range=function(t){return arguments.length?(r=(o=sh.call(t)).length-1,c()):o.slice()},s.invertExtent=function(t){var i=o.indexOf(t);return i<0?[NaN,NaN]:i<1?[e,a[0]]:i>=r?[a[r-1],n]:[a[i-1],a[i]]},s.copy=function(){return t().domain([e,n]).range(o)},xh(s)},t.scaleThreshold=function t(){var e=[.5],n=[0,1],r=1;function a(t){if(t<=t)return n[i(e,t,0,r)]}return a.domain=function(t){return arguments.length?(e=sh.call(t),r=Math.min(e.length,n.length-1),a):e.slice()},a.range=function(t){return arguments.length?(n=sh.call(t),r=Math.min(e.length,n.length-1),a):n.slice()},a.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},a.copy=function(){return t().domain(e).range(n)},a},t.scaleTime=function(){return Jd(lf,sf,qh,Gh,jh,Fh,Dh,Nh,t.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},t.scaleUtc=function(){return Jd(If,Of,yf,mf,df,hf,Dh,Nh,t.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},t.schemeCategory10=Kd,t.schemeCategory20b=$d,t.schemeCategory20c=tp,t.schemeCategory20=ep,t.interpolateCubehelixDefault=np,t.interpolateRainbow=function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return ap.h=360*t-100,ap.s=1.5-1.5*e,ap.l=.8-.9*e,ap+""},t.interpolateWarm=rp,t.interpolateCool=ip,t.interpolateViridis=sp,t.interpolateMagma=cp,t.interpolateInferno=lp,t.interpolatePlasma=up,t.scaleSequential=function t(e){var n=0,r=1,i=!1;function a(t){var a=(t-n)/(r-n);return e(i?Math.max(0,Math.min(1,a)):a)}return a.domain=function(t){return arguments.length?(n=+t[0],r=+t[1],a):[n,r]},a.clamp=function(t){return arguments.length?(i=!!t,a):i},a.interpolator=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return t(e).domain([n,r]).clamp(i)},xh(a)},t.creator=q,t.local=Y,t.matcher=$,t.mouse=lt,t.namespace=W,t.namespaces=V,t.select=Ut,t.selectAll=function(t){return"string"==typeof t?new It([document.querySelectorAll(t)],[document.documentElement]):new It([null==t?[]:t],Nt)},t.selection=zt,t.selector=ht,t.selectorAll=dt,t.touch=Dt,t.touches=function(t,e){null==e&&(e=st().touches);for(var n=0,r=e?e.length:0,i=new Array(r);n<r;++n)i[n]=ct(t,e[n]);return i},t.window=xt,t.customEvent=ot,t.arc=function(){var t=vp,e=gp,n=hp(0),r=null,i=yp,a=_p,o=xp,s=null;function c(){var c,l,u=+t.apply(this,arguments),h=+e.apply(this,arguments),f=i.apply(this,arguments)-pp,d=a.apply(this,arguments)-pp,p=Math.abs(d-f),m=d>f;if(s||(s=c=Ui()),h<u&&(l=h,h=u,u=l),h>fp)if(p>mp-fp)s.moveTo(h*Math.cos(f),h*Math.sin(f)),s.arc(0,0,h,f,d,!m),u>fp&&(s.moveTo(u*Math.cos(d),u*Math.sin(d)),s.arc(0,0,u,d,f,m));else{var v,g,y=f,_=d,x=f,b=d,w=p,M=p,E=o.apply(this,arguments)/2,T=E>fp&&(r?+r.apply(this,arguments):Math.sqrt(u*u+h*h)),S=Math.min(Math.abs(h-u)/2,+n.apply(this,arguments)),A=S,R=S;if(T>fp){var L=bp(T/u*Math.sin(E)),C=bp(T/h*Math.sin(E));(w-=2*L)>fp?(x+=L*=m?1:-1,b-=L):(w=0,x=b=(f+d)/2),(M-=2*C)>fp?(y+=C*=m?1:-1,_-=C):(M=0,y=_=(f+d)/2)}var P=h*Math.cos(y),O=h*Math.sin(y),N=u*Math.cos(b),I=u*Math.sin(b);if(S>fp){var z=h*Math.cos(_),U=h*Math.sin(_),D=u*Math.cos(x),k=u*Math.sin(x);if(p<dp){var F=w>fp?function(t,e,n,r,i,a,o,s){var c=n-t,l=r-e,u=o-i,h=s-a,f=(u*(e-a)-h*(t-i))/(h*c-u*l);return[t+f*c,e+f*l]}(P,O,D,k,z,U,N,I):[N,I],B=P-F[0],j=O-F[1],H=z-F[0],G=U-F[1],V=1/Math.sin(Math.acos((B*H+j*G)/(Math.sqrt(B*B+j*j)*Math.sqrt(H*H+G*G)))/2),W=Math.sqrt(F[0]*F[0]+F[1]*F[1]);A=Math.min(S,(u-W)/(V-1)),R=Math.min(S,(h-W)/(V+1))}}M>fp?R>fp?(v=wp(D,k,P,O,h,R,m),g=wp(z,U,N,I,h,R,m),s.moveTo(v.cx+v.x01,v.cy+v.y01),R<S?s.arc(v.cx,v.cy,R,Math.atan2(v.y01,v.x01),Math.atan2(g.y01,g.x01),!m):(s.arc(v.cx,v.cy,R,Math.atan2(v.y01,v.x01),Math.atan2(v.y11,v.x11),!m),s.arc(0,0,h,Math.atan2(v.cy+v.y11,v.cx+v.x11),Math.atan2(g.cy+g.y11,g.cx+g.x11),!m),s.arc(g.cx,g.cy,R,Math.atan2(g.y11,g.x11),Math.atan2(g.y01,g.x01),!m))):(s.moveTo(P,O),s.arc(0,0,h,y,_,!m)):s.moveTo(P,O),u>fp&&w>fp?A>fp?(v=wp(N,I,z,U,u,-A,m),g=wp(P,O,D,k,u,-A,m),s.lineTo(v.cx+v.x01,v.cy+v.y01),A<S?s.arc(v.cx,v.cy,A,Math.atan2(v.y01,v.x01),Math.atan2(g.y01,g.x01),!m):(s.arc(v.cx,v.cy,A,Math.atan2(v.y01,v.x01),Math.atan2(v.y11,v.x11),!m),s.arc(0,0,u,Math.atan2(v.cy+v.y11,v.cx+v.x11),Math.atan2(g.cy+g.y11,g.cx+g.x11),m),s.arc(g.cx,g.cy,A,Math.atan2(g.y11,g.x11),Math.atan2(g.y01,g.x01),!m))):s.arc(0,0,u,b,x,m):s.lineTo(N,I)}else s.moveTo(0,0);if(s.closePath(),c)return s=null,c+""||null}return c.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-dp/2;return[Math.cos(r)*n,Math.sin(r)*n]},c.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:hp(+e),c):t},c.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:hp(+t),c):e},c.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:hp(+t),c):n},c.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:hp(+t),c):r},c.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:hp(+t),c):i},c.endAngle=function(t){return arguments.length?(a="function"==typeof t?t:hp(+t),c):a},c.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:hp(+t),c):o},c.context=function(t){return arguments.length?(s=null==t?null:t,c):s},c},t.area=Rp,t.line=Ap,t.pie=function(){var t=Cp,e=Lp,n=null,r=hp(0),i=hp(mp),a=hp(0);function o(o){var s,c,l,u,h,f=o.length,d=0,p=new Array(f),m=new Array(f),v=+r.apply(this,arguments),g=Math.min(mp,Math.max(-mp,i.apply(this,arguments)-v)),y=Math.min(Math.abs(g)/f,a.apply(this,arguments)),_=y*(g<0?-1:1);for(s=0;s<f;++s)(h=m[p[s]=s]=+t(o[s],s,o))>0&&(d+=h);for(null!=e?p.sort(function(t,n){return e(m[t],m[n])}):null!=n&&p.sort(function(t,e){return n(o[t],o[e])}),s=0,l=d?(g-f*_)/d:0;s<f;++s,v=u)c=p[s],h=m[c],u=v+(h>0?h*l:0)+_,m[c]={data:o[c],index:s,value:h,startAngle:v,endAngle:u,padAngle:y};return m}return o.value=function(e){return arguments.length?(t="function"==typeof e?e:hp(+e),o):t},o.sortValues=function(t){return arguments.length?(e=t,n=null,o):e},o.sort=function(t){return arguments.length?(n=t,e=null,o):n},o.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:hp(+t),o):r},o.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:hp(+t),o):i},o.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:hp(+t),o):a},o},t.radialArea=function(){var t=Rp().curve(Pp),e=t.curve,n=t.lineX0,r=t.lineX1,i=t.lineY0,a=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return Ip(n())},delete t.lineX0,t.lineEndAngle=function(){return Ip(r())},delete t.lineX1,t.lineInnerRadius=function(){return Ip(i())},delete t.lineY0,t.lineOuterRadius=function(){return Ip(a())},delete t.lineY1,t.curve=function(t){return arguments.length?e(Np(t)):e()._curve},t},t.radialLine=function(){return Ip(Ap().curve(Pp))},t.symbol=function(){var t=hp(zp),e=hp(64),n=null;function r(){var r;if(n||(n=r=Ui()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return r.type=function(e){return arguments.length?(t="function"==typeof e?e:hp(e),r):t},r.size=function(t){return arguments.length?(e="function"==typeof t?t:hp(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r},t.symbols=Kp,t.symbolCircle=zp,t.symbolCross=Up,t.symbolDiamond=Fp,t.symbolSquare=Vp,t.symbolStar=Gp,t.symbolTriangle=qp,t.symbolWye=Qp,t.curveBasisClosed=function(t){return new nm(t)},t.curveBasisOpen=function(t){return new rm(t)},t.curveBasis=function(t){return new em(t)},t.curveBundle=am,t.curveCardinalClosed=um,t.curveCardinalOpen=fm,t.curveCardinal=cm,t.curveCatmullRomClosed=gm,t.curveCatmullRomOpen=_m,t.curveCatmullRom=mm,t.curveLinearClosed=function(t){return new xm(t)},t.curveLinear=Ep,t.curveMonotoneX=function(t){return new Tm(t)},t.curveMonotoneY=function(t){return new Sm(t)},t.curveNatural=function(t){return new Rm(t)},t.curveStep=function(t){return new Cm(t,.5)},t.curveStepAfter=function(t){return new Cm(t,1)},t.curveStepBefore=function(t){return new Cm(t,0)},t.stack=function(){var t=hp([]),e=Nm,n=Om,r=Im;function i(i){var a,o,s=t.apply(this,arguments),c=i.length,l=s.length,u=new Array(l);for(a=0;a<l;++a){for(var h,f=s[a],d=u[a]=new Array(c),p=0;p<c;++p)d[p]=h=[0,+r(i[p],f,p,i)],h.data=i[p];d.key=f}for(a=0,o=e(u);a<l;++a)u[o[a]].index=a;return n(u,o),u}return i.keys=function(e){return arguments.length?(t="function"==typeof e?e:hp(Pm.call(e)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:hp(+t),i):r},i.order=function(t){return arguments.length?(e=null==t?Nm:"function"==typeof t?t:hp(Pm.call(t)),i):e},i.offset=function(t){return arguments.length?(n=null==t?Om:t,i):n},i},t.stackOffsetExpand=function(t,e){if((r=t.length)>0){for(var n,r,i,a=0,o=t[0].length;a<o;++a){for(i=n=0;n<r;++n)i+=t[n][a][1]||0;if(i)for(n=0;n<r;++n)t[n][a][1]/=i}Om(t,e)}},t.stackOffsetNone=Om,t.stackOffsetSilhouette=function(t,e){if((n=t.length)>0){for(var n,r=0,i=t[e[0]],a=i.length;r<a;++r){for(var o=0,s=0;o<n;++o)s+=t[o][r][1]||0;i[r][1]+=i[r][0]=-s/2}Om(t,e)}},t.stackOffsetWiggle=function(t,e){if((i=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,i,a=0,o=1;o<r;++o){for(var s=0,c=0,l=0;s<i;++s){for(var u=t[e[s]],h=u[o][1]||0,f=u[o-1][1]||0,d=(h-f)/2,p=0;p<s;++p){var m=t[e[p]],v=m[o][1]||0,g=m[o-1][1]||0;d+=v-g}c+=h,l+=d*h}n[o-1][1]+=n[o-1][0]=a,c&&(a-=l/c)}n[o-1][1]+=n[o-1][0]=a,Om(t,e)}},t.stackOrderAscending=zm,t.stackOrderDescending=function(t){return zm(t).reverse()},t.stackOrderInsideOut=function(t){var e,n,r=t.length,i=t.map(Um),a=Nm(t).sort(function(t,e){return i[e]-i[t]}),o=0,s=0,c=[],l=[];for(e=0;e<r;++e)n=a[e],o<s?(o+=i[n],c.push(n)):(s+=i[n],l.push(n));return l.reverse().concat(c)},t.stackOrderNone=Nm,t.stackOrderReverse=function(t){return Nm(t).reverse()},t.timeInterval=Oh,t.timeMillisecond=Nh,t.timeMilliseconds=Ih,t.utcMillisecond=Nh,t.utcMilliseconds=Ih,t.timeSecond=Dh,t.timeSeconds=kh,t.utcSecond=Dh,t.utcSeconds=kh,t.timeMinute=Fh,t.timeMinutes=Bh,t.timeHour=jh,t.timeHours=Hh,t.timeDay=Gh,t.timeDays=Vh,t.timeWeek=qh,t.timeWeeks=$h,t.timeSunday=qh,t.timeSundays=$h,t.timeMonday=Xh,t.timeMondays=tf,t.timeTuesday=Yh,t.timeTuesdays=ef,t.timeWednesday=Zh,t.timeWednesdays=nf,t.timeThursday=Jh,t.timeThursdays=rf,t.timeFriday=Qh,t.timeFridays=af,t.timeSaturday=Kh,t.timeSaturdays=of,t.timeMonth=sf,t.timeMonths=cf,t.timeYear=lf,t.timeYears=uf,t.utcMinute=hf,t.utcMinutes=ff,t.utcHour=df,t.utcHours=pf,t.utcDay=mf,t.utcDays=vf,t.utcWeek=yf,t.utcWeeks=Tf,t.utcSunday=yf,t.utcSundays=Tf,t.utcMonday=_f,t.utcMondays=Sf,t.utcTuesday=xf,t.utcTuesdays=Af,t.utcWednesday=bf,t.utcWednesdays=Rf,t.utcThursday=wf,t.utcThursdays=Lf,t.utcFriday=Mf,t.utcFridays=Cf,t.utcSaturday=Ef,t.utcSaturdays=Pf,t.utcMonth=Of,t.utcMonths=Nf,t.utcYear=If,t.utcYears=zf,t.timeFormatDefaultLocale=kd,t.timeFormatLocale=Ff,t.isoFormat=Fd,t.isoParse=Bd,t.now=Yn,t.timer=Qn,t.timerFlush=Kn,t.timeout=nr,t.interval=function(t,e,n){var r=new Jn,i=e;return null==e?(r.restart(t,e,n),r):(e=+e,n=null==n?Yn():+n,r.restart(function a(o){o+=i,r.restart(a,i+=e,n),t(o)},e,n),r)},t.transition=wr,t.active=function(t,e){var n,r,i=t.__transition;if(i)for(r in e=null==e?null:e+"",i)if((n=i[r]).state>or&&n.name===e)return new br([[t]],ei,e,+r);return null},t.interrupt=vr,t.voronoi=function(){var t=km,e=Fm,n=null;function r(r){return new _v(r.map(function(n,i){var a=[Math.round(t(n,i,r)/vv)*vv,Math.round(e(n,i,r)/vv)*vv];return a.index=i,a.data=n,a}),n)}return r.polygons=function(t){return r(t).polygons()},r.links=function(t){return r(t).links()},r.triangles=function(t){return r(t).triangles()},r.x=function(e){return arguments.length?(t="function"==typeof e?e:Dm(+e),r):t},r.y=function(t){return arguments.length?(e="function"==typeof t?t:Dm(+t),r):e},r.extent=function(t){return arguments.length?(n=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(t){return arguments.length?(n=null==t?null:[[0,0],[+t[0],+t[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r},t.zoom=function(){var e,n,r=Av,i=Rv,a=0,o=1/0,s=-o,c=o,l=s,u=c,h=250,f=An,d=[],p=F("start","zoom","end"),m=500,v=150;function g(t){t.on("wheel.zoom",T).on("mousedown.zoom",S).on("dblclick.zoom",A).on("touchstart.zoom",R).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",C).style("-webkit-tap-highlight-color","rgba(0,0,0,0)").property("__zoom",Lv)}function y(t,e){return(e=Math.max(a,Math.min(o,e)))===t.k?t:new wv(e,t.x,t.y)}function _(t,e,n){var r=e[0]-n[0]*t.k,i=e[1]-n[1]*t.k;return r===t.x&&i===t.y?t:new wv(t.k,r,i)}function x(t,e){var n=t.invertX(e[0][0])-s,r=t.invertX(e[1][0])-c,i=t.invertY(e[0][1])-l,a=t.invertY(e[1][1])-u;return t.translate(r>n?(n+r)/2:Math.min(0,n)||Math.max(0,r),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}function b(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function w(t,e,n){t.on("start.zoom",function(){M(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){M(this,arguments).end()}).tween("zoom",function(){var t=arguments,r=M(this,t),a=i.apply(this,t),o=n||b(a),s=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),c=this.__zoom,l="function"==typeof e?e.apply(this,t):e,u=f(c.invert(o).concat(s/c.k),l.invert(o).concat(s/l.k));return function(t){if(1===t)t=l;else{var e=u(t),n=s/e[2];t=new wv(n,o[0]-e[0]*n,o[1]-e[1]*n)}r.zoom(null,t)}})}function M(t,e){for(var n,r=0,i=d.length;r<i;++r)if((n=d[r]).that===t)return n;return new E(t,e)}function E(t,e){this.that=t,this.args=e,this.index=-1,this.active=0,this.extent=i.apply(t,e)}function T(){if(r.apply(this,arguments)){var e=M(this,arguments),n=this.__zoom,i=Math.max(a,Math.min(o,n.k*Math.pow(2,-t.event.deltaY*(t.event.deltaMode?120:1)/500))),s=lt(this);if(e.wheel)e.mouse[0][0]===s[0]&&e.mouse[0][1]===s[1]||(e.mouse[1]=n.invert(e.mouse[0]=s)),clearTimeout(e.wheel);else{if(n.k===i)return;e.mouse=[s,n.invert(s)],vr(this),e.start()}Sv(),e.wheel=setTimeout(function(){e.wheel=null,e.end()},v),e.zoom("mouse",x(_(y(n,i),e.mouse[0],e.mouse[1]),e.extent))}}function S(){if(!n&&r.apply(this,arguments)){var e=M(this,arguments),i=Ut(t.event.view).on("mousemove.zoom",function(){Sv(),e.moved=!0,e.zoom("mouse",x(_(e.that.__zoom,e.mouse[0]=lt(e.that),e.mouse[1]),e.extent))},!0).on("mouseup.zoom",function(){i.on("mousemove.zoom mouseup.zoom",null),jt(t.event.view,e.moved),Sv(),e.end()},!0),a=lt(this);Bt(t.event.view),Tv(),e.mouse=[a,this.__zoom.invert(a)],vr(this),e.start()}}function A(){if(r.apply(this,arguments)){var e=this.__zoom,n=lt(this),a=e.invert(n),o=e.k*(t.event.shiftKey?.5:2),s=x(_(y(e,o),n,a),i.apply(this,arguments));Sv(),h>0?Ut(this).transition().duration(h).call(w,s,n):Ut(this).call(g.transform,s)}}function R(){if(r.apply(this,arguments)){var n,i,a,o,s=M(this,arguments),c=t.event.changedTouches,l=c.length;for(Tv(),i=0;i<l;++i)a=c[i],o=[o=Dt(this,c,a.identifier),this.__zoom.invert(o),a.identifier],s.touch0?s.touch1||(s.touch1=o):(s.touch0=o,n=!0);if(e&&(e=clearTimeout(e),!s.touch1))return s.end(),void((o=Ut(this).on("dblclick.zoom"))&&o.apply(this,arguments));n&&(e=setTimeout(function(){e=null},m),vr(this),s.start())}}function L(){var n,r,i,a,o=M(this,arguments),s=t.event.changedTouches,c=s.length;for(Sv(),e&&(e=clearTimeout(e)),n=0;n<c;++n)r=s[n],i=Dt(this,s,r.identifier),o.touch0&&o.touch0[2]===r.identifier?o.touch0[0]=i:o.touch1&&o.touch1[2]===r.identifier&&(o.touch1[0]=i);if(r=o.that.__zoom,o.touch1){var l=o.touch0[0],u=o.touch0[1],h=o.touch1[0],f=o.touch1[1],d=(d=h[0]-l[0])*d+(d=h[1]-l[1])*d,p=(p=f[0]-u[0])*p+(p=f[1]-u[1])*p;r=y(r,Math.sqrt(d/p)),i=[(l[0]+h[0])/2,(l[1]+h[1])/2],a=[(u[0]+f[0])/2,(u[1]+f[1])/2]}else{if(!o.touch0)return;i=o.touch0[0],a=o.touch0[1]}o.zoom("touch",x(_(r,i,a),o.extent))}function C(){var e,r,i=M(this,arguments),a=t.event.changedTouches,o=a.length;for(Tv(),n&&clearTimeout(n),n=setTimeout(function(){n=null},m),e=0;e<o;++e)r=a[e],i.touch0&&i.touch0[2]===r.identifier?delete i.touch0:i.touch1&&i.touch1[2]===r.identifier&&delete i.touch1;i.touch1&&!i.touch0&&(i.touch0=i.touch1,delete i.touch1),i.touch0||i.end()}return g.transform=function(t,e){var n=t.selection?t.selection():t;n.property("__zoom",Lv),t!==n?w(t,e):n.interrupt().each(function(){M(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()})},g.scaleBy=function(t,e){g.scaleTo(t,function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)})},g.scaleTo=function(t,e){g.transform(t,function(){var t=i.apply(this,arguments),n=this.__zoom,r=b(t),a=n.invert(r);return x(_(y(n,"function"==typeof e?e.apply(this,arguments):e),r,a),t)})},g.translateBy=function(t,e,n){g.transform(t,function(){return x(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),i.apply(this,arguments))})},E.prototype={start:function(){return 1==++this.active&&(this.index=d.push(this)-1,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(d.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(t){ot(new bv(g,t,this.that.__zoom),p.apply,p,[t,this.that,this.args])}},g.filter=function(t){return arguments.length?(r="function"==typeof t?t:xv(!!t),g):r},g.extent=function(t){return arguments.length?(i="function"==typeof t?t:xv([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),g):i},g.scaleExtent=function(t){return arguments.length?(a=+t[0],o=+t[1],g):[a,o]},g.translateExtent=function(t){return arguments.length?(s=+t[0][0],c=+t[1][0],l=+t[0][1],u=+t[1][1],g):[[s,l],[c,u]]},g.duration=function(t){return arguments.length?(h=+t,g):h},g.interpolate=function(t){return arguments.length?(f=t,g):f},g.on=function(){var t=p.on.apply(p,arguments);return t===p?g:t},g},t.zoomTransform=Ev,t.zoomIdentity=Mv,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){
/*!
* screenfull
* v3.3.2 - 2017-10-27
* (c) Sindre Sorhus; MIT License
*/
!function(){"use strict";var e="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=t.exports,r="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,i=function(){for(var t,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,i=n.length,a={};r<i;r++)if((t=n[r])&&t[1]in e){for(r=0;r<t.length;r++)a[n[0][r]]=t[r];return a}return!1}(),a={change:i.fullscreenchange,error:i.fullscreenerror},o={request:function(t){var n=i.requestFullscreen;t=t||e.documentElement,/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)?t[n]():t[n](r&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){e[i.exitFullscreen]()},toggle:function(t){this.isFullscreen?this.exit():this.request(t)},onchange:function(t){this.on("change",t)},onerror:function(t){this.on("error",t)},on:function(t,n){var r=a[t];r&&e.addEventListener(r,n,!1)},off:function(t,n){var r=a[t];r&&e.removeEventListener(r,n,!1)},raw:i};i?(Object.defineProperties(o,{isFullscreen:{get:function(){return Boolean(e[i.fullscreenElement])}},element:{enumerable:!0,get:function(){return e[i.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return Boolean(e[i.fullscreenEnabled])}}}),n?t.exports=o:window.screenfull=o):n?t.exports=!1:window.screenfull=!1}()},function(t,e,n){var r,i,a,o;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
o=function(t){var e=Object.prototype.toString,n=Array.isArray||function(t){return"[object Array]"===e.call(t)};function r(t){return"function"==typeof t}function i(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function a(t,e){return null!=t&&"object"==typeof t&&e in t}var o=RegExp.prototype.test,s=/\S/;function c(t){return!function(t,e){return o.call(t,e)}(s,t)}var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},u=/\s*/,h=/\s+/,f=/\s*=/,d=/\s*\}/,p=/#|\^|\/|>|\{|&|=|!/;function m(t){this.string=t,this.tail=t,this.pos=0}function v(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function g(){this.cache={}}m.prototype.eos=function(){return""===this.tail},m.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var n=e[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},m.prototype.scanUntil=function(t){var e,n=this.tail.search(t);switch(n){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=e.length,e},v.prototype.push=function(t){return new v(t,this)},v.prototype.lookup=function(t){var e,n=this.cache;if(n.hasOwnProperty(t))e=n[t];else{for(var i,o,s=this,c=!1;s;){if(t.indexOf(".")>0)for(e=s.view,i=t.split("."),o=0;null!=e&&o<i.length;)o===i.length-1&&(c=a(e,i[o])),e=e[i[o++]];else e=s.view[t],c=a(s.view,t);if(c)break;s=s.parent}n[t]=e}return r(e)&&(e=e.call(this.view)),e},g.prototype.clearCache=function(){this.cache={}},g.prototype.parse=function(e,r){var a=this.cache,o=e+":"+(r||t.tags).join(":"),s=a[o];return null==s&&(s=a[o]=function(e,r){if(!e)return[];var a,o,s,l=[],v=[],g=[],y=!1,_=!1;function x(){if(y&&!_)for(;g.length;)delete v[g.pop()];else g=[];y=!1,_=!1}function b(t){if("string"==typeof t&&(t=t.split(h,2)),!n(t)||2!==t.length)throw new Error("Invalid tags: "+t);a=new RegExp(i(t[0])+"\\s*"),o=new RegExp("\\s*"+i(t[1])),s=new RegExp("\\s*"+i("}"+t[1]))}b(r||t.tags);for(var w,M,E,T,S,A,R=new m(e);!R.eos();){if(w=R.pos,E=R.scanUntil(a))for(var L=0,C=E.length;L<C;++L)c(T=E.charAt(L))?g.push(v.length):_=!0,v.push(["text",T,w,w+1]),w+=1,"\n"===T&&x();if(!R.scan(a))break;if(y=!0,M=R.scan(p)||"name",R.scan(u),"="===M?(E=R.scanUntil(f),R.scan(f),R.scanUntil(o)):"{"===M?(E=R.scanUntil(s),R.scan(d),R.scanUntil(o),M="&"):E=R.scanUntil(o),!R.scan(o))throw new Error("Unclosed tag at "+R.pos);if(S=[M,E,w,R.pos],v.push(S),"#"===M||"^"===M)l.push(S);else if("/"===M){if(!(A=l.pop()))throw new Error('Unopened section "'+E+'" at '+w);if(A[1]!==E)throw new Error('Unclosed section "'+A[1]+'" at '+w)}else"name"===M||"{"===M||"&"===M?_=!0:"="===M&&b(E)}if(A=l.pop())throw new Error('Unclosed section "'+A[1]+'" at '+R.pos);return function(t){for(var e,n=[],r=n,i=[],a=0,o=t.length;a<o;++a)switch((e=t[a])[0]){case"#":case"^":r.push(e),i.push(e),r=e[4]=[];break;case"/":i.pop()[5]=e[2],r=i.length>0?i[i.length-1][4]:n;break;default:r.push(e)}return n}(function(t){for(var e,n,r=[],i=0,a=t.length;i<a;++i)(e=t[i])&&("text"===e[0]&&n&&"text"===n[0]?(n[1]+=e[1],n[3]=e[3]):(r.push(e),n=e));return r}(v))}(e,r)),s},g.prototype.render=function(t,e,n){var r=this.parse(t),i=e instanceof v?e:new v(e);return this.renderTokens(r,i,n,t)},g.prototype.renderTokens=function(t,e,n,r){for(var i,a,o,s="",c=0,l=t.length;c<l;++c)o=void 0,"#"===(a=(i=t[c])[0])?o=this.renderSection(i,e,n,r):"^"===a?o=this.renderInverted(i,e,n,r):">"===a?o=this.renderPartial(i,e,n,r):"&"===a?o=this.unescapedValue(i,e):"name"===a?o=this.escapedValue(i,e):"text"===a&&(o=this.rawValue(i)),void 0!==o&&(s+=o);return s},g.prototype.renderSection=function(t,e,i,a){var o=this,s="",c=e.lookup(t[1]);if(c){if(n(c))for(var l=0,u=c.length;l<u;++l)s+=this.renderTokens(t[4],e.push(c[l]),i,a);else if("object"==typeof c||"string"==typeof c||"number"==typeof c)s+=this.renderTokens(t[4],e.push(c),i,a);else if(r(c)){if("string"!=typeof a)throw new Error("Cannot use higher-order sections without the original template");null!=(c=c.call(e.view,a.slice(t[3],t[5]),function(t){return o.render(t,e,i)}))&&(s+=c)}else s+=this.renderTokens(t[4],e,i,a);return s}},g.prototype.renderInverted=function(t,e,r,i){var a=e.lookup(t[1]);if(!a||n(a)&&0===a.length)return this.renderTokens(t[4],e,r,i)},g.prototype.renderPartial=function(t,e,n){if(n){var i=r(n)?n(t[1]):n[t[1]];return null!=i?this.renderTokens(this.parse(i),e,n,i):void 0}},g.prototype.unescapedValue=function(t,e){var n=e.lookup(t[1]);if(null!=n)return n},g.prototype.escapedValue=function(e,n){var r=n.lookup(e[1]);if(null!=r)return t.escape(r)},g.prototype.rawValue=function(t){return t[1]},t.name="mustache.js",t.version="2.3.1",t.tags=["{{","}}"];var y=new g;return t.clearCache=function(){return y.clearCache()},t.parse=function(t,e){return y.parse(t,e)},t.render=function(t,e,r){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+(n(i=t)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return y.render(t,e,r)},t.to_html=function(e,n,i,a){var o=t.render(e,n,i);if(!r(a))return o;a(o)},t.escape=function(t){return String(t).replace(/[&<>"'`=\/]/g,function(t){return l[t]})},t.Scanner=m,t.Context=v,t.Writer=g,t},e&&"string"!=typeof e.nodeName?o(e):(i=[e],void 0===(a="function"==typeof(r=o)?r.apply(e,i):r)||(t.exports=a))},function(t,e,n){var r=n(34);"string"==typeof r&&(r=[[t.i,r,""]]);var i={transform:void 0};n(36)(r,i);r.locals&&(t.exports=r.locals)},function(t,e,n){(t.exports=n(35)(!1)).push([t.i,".ipyvolume-toolicon  {\n    text-align: center;\n    padding: 2px 2px; /* Some top and bottom padding */\n    color: #337ab7;\n    position: relative;\n    display: inline-block;\n}\n\n.fa-inactive {\n    opacity: 0.3;\n}\n.fa-disabled {\n  opacity: 0.3;\n  cursor: not-allowed;\n}\n\n\n.ipyvolume-toolicon-inactive {\n    opacity: 0.3;\n}\n\n.ipyvolume-toolicon:hover .ipyvolume-toolicon-dropdown-container {\n\tdisplay: block;\n}\n.ipyvolume-toolicon-dropdown-container  {\n\tdisplay: none;\n\tposition: absolute;\n\tz-index: 10;\n\tmin-width: 200px;\n\tbackground-color: #999;\n\tbox-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n\tbackground-color: #f9f9f9;\n\tpadding-left: 2px;\n\n}\n.ipyvolume-toolicon-dropdown  {\n\ttext-align: left;\n\tdisplay: block;\n}\n",""])},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var i=(o=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),a=r.sources.map(function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"});return[n].concat(a).concat([i]).join("\n")}var o;return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},i=0;i<this.length;i++){var a=this[i][0];"number"==typeof a&&(r[a]=!0)}for(i=0;i<t.length;i++){var o=t[i];"number"==typeof o[0]&&r[o[0]]||(n&&!o[2]?o[2]=n:n&&(o[2]="("+o[2]+") and ("+n+")"),e.push(o))}},e}},function(t,e,n){var r,i,a={},o=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=r.apply(this,arguments)),i}),s=function(t){var e={};return function(t){return void 0===e[t]&&(e[t]=function(t){return document.querySelector(t)}.call(this,t)),e[t]}}(),c=null,l=0,u=[],h=n(37);function f(t,e){for(var n=0;n<t.length;n++){var r=t[n],i=a[r.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](r.parts[o]);for(;o<r.parts.length;o++)i.parts.push(y(r.parts[o],e))}else{var s=[];for(o=0;o<r.parts.length;o++)s.push(y(r.parts[o],e));a[r.id]={id:r.id,refs:1,parts:s}}}}function d(t,e){for(var n=[],r={},i=0;i<t.length;i++){var a=t[i],o=e.base?a[0]+e.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};r[o]?r[o].parts.push(s):n.push(r[o]={id:o,parts:[s]})}return n}function p(t,e){var n=s(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=u[u.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),u.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function m(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=u.indexOf(t);e>=0&&u.splice(e,1)}function v(t){var e=document.createElement("style");return t.attrs.type="text/css",g(e,t.attrs),p(t,e),e}function g(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function y(t,e){var n,r,i,a;if(e.transform&&t.css){if(!(a=e.transform(t.css)))return function(){};t.css=a}if(e.singleton){var o=l++;n=c||(c=v(e)),r=b.bind(null,n,o,!1),i=b.bind(null,n,o,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",g(e,t.attrs),p(t,e),e}(e),r=function(t,e,n){var r=n.css,i=n.sourceMap,a=void 0===e.convertToAbsoluteUrls&&i;(e.convertToAbsoluteUrls||a)&&(r=h(r));i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var o=new Blob([r],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(o),s&&URL.revokeObjectURL(s)}.bind(null,n,e),i=function(){m(n),n.href&&URL.revokeObjectURL(n.href)}):(n=v(e),r=function(t,e){var n=e.css,r=e.media;r&&t.setAttribute("media",r);if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),i=function(){m(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else i()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||(e.singleton=o()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=d(t,e);return f(n,e),function(t){for(var r=[],i=0;i<n.length;i++){var o=n[i];(s=a[o.id]).refs--,r.push(s)}t&&f(d(t,e),e);for(i=0;i<r.length;i++){var s;if(0===(s=r[i]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete a[s.id]}}}};var _,x=(_=[],function(t,e){return _[t]=e,_.filter(Boolean).join("\n")});function b(t,e,n,r){var i=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=x(e,i);else{var a=document.createTextNode(i),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(a,o[e]):t.appendChild(a)}}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,r=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var i,a=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(a)?t:(i=0===a.indexOf("//")?a:0===a.indexOf("/")?n+a:r+a.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")})}},function(t,e){t.exports=i,i.strict=a,i.loose=o;var n=Object.prototype.toString,r={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0};function i(t){return a(t)||o(t)}function a(t){return t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array}function o(t){return r[n.call(t)]}},function(t){t.exports={demo:{"background-color":"white",box:{color:"pink",visible:!0},axes:{z:{color:"#00f",ticklabel:{color:"#0f0"},label:{color:"#f00"}},ticklabel:{color:"black"},label:{color:"black"},x:{color:"#f00",ticklabel:{color:"#00f"},label:{color:"#0f0"}},y:{color:"#0f0",ticklabel:{color:"#f00"},label:{color:"#00f"}},color:"black",visible:!0}},dark:{"background-color":"black",box:{visible:!0},axes:{color:"white",ticklabel:{color:"white"},visible:!0,label:{color:"white"}}},light:{"background-color":"white",box:{visible:!0},axes:{color:"black",ticklabel:{color:"black"},visible:!0,label:{color:"black"}}}}},function(t,e,n){"use strict";t.exports=function(t){for(var e=new Array(t),n=0;n<t;++n)e[n]=n;return e}},function(t,e){function n(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&(n(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&n(t.slice(0,0))}(t)||!!t._isBuffer)}},function(t,e,n){t.exports=n(43)({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},function(t,e,n){"use strict";var r=n(44);function i(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}t.exports=function(t){var e=new i;e.pre=t.pre,e.body=t.body,e.post=t.post;var n=t.args.slice(0);e.argTypes=n;for(var a=0;a<n.length;++a){var o=n[a];if("array"===o||"object"==typeof o&&o.blockIndices){if(e.argTypes[a]="array",e.arrayArgs.push(a),e.arrayBlockIndices.push(o.blockIndices?o.blockIndices:0),e.shimArgs.push("array"+a),a<e.pre.args.length&&e.pre.args[a].count>0)throw new Error("cwise: pre() block may not reference array args");if(a<e.post.args.length&&e.post.args[a].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===o)e.scalarArgs.push(a),e.shimArgs.push("scalar"+a);else if("index"===o){if(e.indexArgs.push(a),a<e.pre.args.length&&e.pre.args[a].count>0)throw new Error("cwise: pre() block may not reference array index");if(a<e.body.args.length&&e.body.args[a].lvalue)throw new Error("cwise: body() block may not write to array index");if(a<e.post.args.length&&e.post.args[a].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===o){if(e.shapeArgs.push(a),a<e.pre.args.length&&e.pre.args[a].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(a<e.body.args.length&&e.body.args[a].lvalue)throw new Error("cwise: body() block may not write to array shape");if(a<e.post.args.length&&e.post.args[a].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof o||!o.offset)throw new Error("cwise: Unknown argument type "+n[a]);e.argTypes[a]="offset",e.offsetArgs.push({array:o.array,offset:o.offset}),e.offsetArgIndex.push(a)}}if(e.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(e.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(e.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(e.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return e.debug=!!t.printCode||!!t.debug,e.funcName=t.funcName||"cwise",e.blockSize=t.blockSize||64,r(e)}},function(t,e,n){"use strict";var r=n(45);t.exports=function(t){var e=["'use strict'","var CACHED={}"],n=[],i=t.funcName+"_cwise_thunk";e.push(["return function ",i,"(",t.shimArgs.join(","),"){"].join(""));for(var a=[],o=[],s=[["array",t.arrayArgs[0],".shape.slice(",Math.max(0,t.arrayBlockIndices[0]),t.arrayBlockIndices[0]<0?","+t.arrayBlockIndices[0]+")":")"].join("")],c=[],l=[],u=0;u<t.arrayArgs.length;++u){var h=t.arrayArgs[u];n.push(["t",h,"=array",h,".dtype,","r",h,"=array",h,".order"].join("")),a.push("t"+h),a.push("r"+h),o.push("t"+h),o.push("r"+h+".join()"),s.push("array"+h+".data"),s.push("array"+h+".stride"),s.push("array"+h+".offset|0"),u>0&&(c.push("array"+t.arrayArgs[0]+".shape.length===array"+h+".shape.length+"+(Math.abs(t.arrayBlockIndices[0])-Math.abs(t.arrayBlockIndices[u]))),l.push("array"+t.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[0])+"]===array"+h+".shape[shapeIndex+"+Math.max(0,t.arrayBlockIndices[u])+"]"))}for(t.arrayArgs.length>1&&(e.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),e.push("for(var shapeIndex=array"+t.arrayArgs[0]+".shape.length-"+Math.abs(t.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),e.push("if (!("+l.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),e.push("}")),u=0;u<t.scalarArgs.length;++u)s.push("scalar"+t.scalarArgs[u]);return n.push(["type=[",o.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),e.push("var "+n.join(",")),e.push(["if(!proc){","CACHED[type]=proc=compile([",a.join(","),"])}","return proc(",s.join(","),")}"].join("")),t.debug&&console.log("-----Generated thunk:\n"+e.join("\n")+"\n----------"),new Function("compile",e.join("\n"))(r.bind(void 0,t))}},function(t,e,n){"use strict";var r=n(46);function i(t,e,n){var r,i,a=t.length,o=e.arrayArgs.length,s=e.indexArgs.length>0,c=[],l=[],u=0,h=0;for(r=0;r<a;++r)l.push(["i",r,"=0"].join(""));for(i=0;i<o;++i)for(r=0;r<a;++r)h=u,u=t[r],0===r?l.push(["d",i,"s",r,"=t",i,"p",u].join("")):l.push(["d",i,"s",r,"=(t",i,"p",u,"-s",h,"*t",i,"p",h,")"].join(""));for(l.length>0&&c.push("var "+l.join(",")),r=a-1;r>=0;--r)u=t[r],c.push(["for(i",r,"=0;i",r,"<s",u,";++i",r,"){"].join(""));for(c.push(n),r=0;r<a;++r){for(h=u,u=t[r],i=0;i<o;++i)c.push(["p",i,"+=d",i,"s",r].join(""));s&&(r>0&&c.push(["index[",h,"]-=s",h].join("")),c.push(["++index[",u,"]"].join(""))),c.push("}")}return c.join("\n")}function a(t,e,n){for(var r=t.body,i=[],a=[],o=0;o<t.args.length;++o){var s=t.args[o];if(!(s.count<=0)){var c=new RegExp(s.name,"g"),l="",u=e.arrayArgs.indexOf(o);switch(e.argTypes[o]){case"offset":var h=e.offsetArgIndex.indexOf(o);u=e.offsetArgs[h].array,l="+q"+h;case"array":l="p"+u+l;var f="l"+o,d="a"+u;if(0===e.arrayBlockIndices[u])1===s.count?"generic"===n[u]?s.lvalue?(i.push(["var ",f,"=",d,".get(",l,")"].join("")),r=r.replace(c,f),a.push([d,".set(",l,",",f,")"].join(""))):r=r.replace(c,[d,".get(",l,")"].join("")):r=r.replace(c,[d,"[",l,"]"].join("")):"generic"===n[u]?(i.push(["var ",f,"=",d,".get(",l,")"].join("")),r=r.replace(c,f),s.lvalue&&a.push([d,".set(",l,",",f,")"].join(""))):(i.push(["var ",f,"=",d,"[",l,"]"].join("")),r=r.replace(c,f),s.lvalue&&a.push([d,"[",l,"]=",f].join("")));else{for(var p=[s.name],m=[l],v=0;v<Math.abs(e.arrayBlockIndices[u]);v++)p.push("\\s*\\[([^\\]]+)\\]"),m.push("$"+(v+1)+"*t"+u+"b"+v);if(c=new RegExp(p.join(""),"g"),l=m.join("+"),"generic"===n[u])throw new Error("cwise: Generic arrays not supported in combination with blocks!");r=r.replace(c,[d,"[",l,"]"].join(""))}break;case"scalar":r=r.replace(c,"Y"+e.scalarArgs.indexOf(o));break;case"index":r=r.replace(c,"index");break;case"shape":r=r.replace(c,"shape")}}}return[i.join("\n"),r,a.join("\n")].join("\n").trim()}function o(t){for(var e=new Array(t.length),n=!0,r=0;r<t.length;++r){var i=t[r],a=i.match(/\d+/);a=a?a[0]:"",0===i.charAt(0)?e[r]="u"+i.charAt(1)+a:e[r]=i.charAt(0)+a,r>0&&(n=n&&e[r]===e[r-1])}return n?e[0]:e.join("")}t.exports=function(t,e){for(var n=e[1].length-Math.abs(t.arrayBlockIndices[0])|0,s=new Array(t.arrayArgs.length),c=new Array(t.arrayArgs.length),l=0;l<t.arrayArgs.length;++l)c[l]=e[2*l],s[l]=e[2*l+1];var u=[],h=[],f=[],d=[],p=[];for(l=0;l<t.arrayArgs.length;++l){t.arrayBlockIndices[l]<0?(f.push(0),d.push(n),u.push(n),h.push(n+t.arrayBlockIndices[l])):(f.push(t.arrayBlockIndices[l]),d.push(t.arrayBlockIndices[l]+n),u.push(0),h.push(t.arrayBlockIndices[l]));for(var m=[],v=0;v<s[l].length;v++)f[l]<=s[l][v]&&s[l][v]<d[l]&&m.push(s[l][v]-f[l]);p.push(m)}var g=["SS"],y=["'use strict'"],_=[];for(v=0;v<n;++v)_.push(["s",v,"=SS[",v,"]"].join(""));for(l=0;l<t.arrayArgs.length;++l){for(g.push("a"+l),g.push("t"+l),g.push("p"+l),v=0;v<n;++v)_.push(["t",l,"p",v,"=t",l,"[",f[l]+v,"]"].join(""));for(v=0;v<Math.abs(t.arrayBlockIndices[l]);++v)_.push(["t",l,"b",v,"=t",l,"[",u[l]+v,"]"].join(""))}for(l=0;l<t.scalarArgs.length;++l)g.push("Y"+l);if(t.shapeArgs.length>0&&_.push("shape=SS.slice(0)"),t.indexArgs.length>0){var x=new Array(n);for(l=0;l<n;++l)x[l]="0";_.push(["index=[",x.join(","),"]"].join(""))}for(l=0;l<t.offsetArgs.length;++l){var b=t.offsetArgs[l],w=[];for(v=0;v<b.offset.length;++v)0!==b.offset[v]&&(1===b.offset[v]?w.push(["t",b.array,"p",v].join("")):w.push([b.offset[v],"*t",b.array,"p",v].join("")));0===w.length?_.push("q"+l+"=0"):_.push(["q",l,"=",w.join("+")].join(""))}var M=r([].concat(t.pre.thisVars).concat(t.body.thisVars).concat(t.post.thisVars));for((_=_.concat(M)).length>0&&y.push("var "+_.join(",")),l=0;l<t.arrayArgs.length;++l)y.push("p"+l+"|=0");t.pre.body.length>3&&y.push(a(t.pre,t,c));var E=a(t.body,t,c),T=function(t){for(var e=0,n=t[0].length;e<n;){for(var r=1;r<t.length;++r)if(t[r][e]!==t[0][e])return e;++e}return e}(p);T<n?y.push(function(t,e,n,r){for(var a=e.length,o=n.arrayArgs.length,s=n.blockSize,c=n.indexArgs.length>0,l=[],u=0;u<o;++u)l.push(["var offset",u,"=p",u].join(""));for(u=t;u<a;++u)l.push(["for(var j"+u+"=SS[",e[u],"]|0;j",u,">0;){"].join("")),l.push(["if(j",u,"<",s,"){"].join("")),l.push(["s",e[u],"=j",u].join("")),l.push(["j",u,"=0"].join("")),l.push(["}else{s",e[u],"=",s].join("")),l.push(["j",u,"-=",s,"}"].join("")),c&&l.push(["index[",e[u],"]=j",u].join(""));for(u=0;u<o;++u){for(var h=["offset"+u],f=t;f<a;++f)h.push(["j",f,"*t",u,"p",e[f]].join(""));l.push(["p",u,"=(",h.join("+"),")"].join(""))}for(l.push(i(e,n,r)),u=t;u<a;++u)l.push("}");return l.join("\n")}(T,p[0],t,E)):y.push(i(p[0],t,E)),t.post.body.length>3&&y.push(a(t.post,t,c)),t.debug&&console.log("-----Generated cwise routine for ",e,":\n"+y.join("\n")+"\n----------");var S=[t.funcName||"unnamed","_cwise_loop_",s[0].join("s"),"m",T,o(c)].join("");return new Function(["function ",S,"(",g.join(","),"){",y.join("\n"),"} return ",S].join(""))()}},function(t,e,n){"use strict";t.exports=function(t,e,n){return 0===t.length?t:e?(n||t.sort(e),function(t,e){for(var n=1,r=t.length,i=t[0],a=t[0],o=1;o<r;++o)if(a=i,e(i=t[o],a)){if(o===n){n++;continue}t[n++]=i}return t.length=n,t}(t,e)):(n||t.sort(),function(t){for(var e=1,n=t.length,r=t[0],i=t[0],a=1;a<n;++a,i=r)if(i=r,(r=t[a])!==i){if(a===e){e++;continue}t[e++]=r}return t.length=e,t}(t))}},function(t){t.exports={normals:[[.6722792983055115,.7387584447860718,.04771288111805916],[.7488530874252319,.6626735329627991,.009104926139116287],[.992845356464386,.1163879781961441,-.026680562645196915],[.988349199295044,.1501944661140442,-.0246476661413908],[.9485647082328796,-.2816155254840851,-.14462943375110626],[.925125002861023,-.375169962644577,-.058234188705682755],[.988349199295044,.1501944661140442,-.0246476661413908],[.992845356464386,.1163879781961441,-.026680562645196915],[.9870246648788452,-.13484345376491547,.08717460930347443],[.9485647082328796,-.2816155254840851,-.14462943375110626],[.992845356464386,.1163879781961441,-.026680562645196915],[.9768072366714478,.1450829803943634,.1574755609035492],[.9768072366714478,.1450829803943634,.1574755609035492],[.992845356464386,.1163879781961441,-.026680562645196915],[.7488530874252319,.6626735329627991,.009104926139116287],[.7618468403816223,.646384596824646,.04214463010430336],[.4218263030052185,.893310010433197,-.15511257946491241],[.35690364241600037,.9336850047111511,-.029189903289079666],[.2723502814769745,.9614163041114807,-.03878369182348251],[.2525371015071869,.9163177609443665,-.3107839524745941],[.9953411221504211,.09576618671417236,.011168275028467178],[.6457383632659912,.7610315084457397,.06207112967967987],[.6722792983055115,.7387584447860718,.04771288111805916],[.988349199295044,.1501944661140442,-.0246476661413908],[.9291253089904785,-.3697633743286133,-.0010595708154141903],[.9953411221504211,.09576618671417236,.011168275028467178],[.988349199295044,.1501944661140442,-.0246476661413908],[.925125002861023,-.375169962644577,-.058234188705682755],[-.007396361790597439,-.9999653697013855,.003803872736170888],[-.009718821384012699,-.9997833967208862,-.018406139686703682],[-.007655521389096975,-.9999698996543884,.001327343052253127],[.5234197378158569,.8474974632263184,-.08820322155952454],[.8727967739105225,.48596683144569397,-.04540829733014107],[.6919021606445312,.6509979963302612,-.3122063875198364],[.5376883745193481,.8232352137565613,-.18213941156864166],[.6919021606445312,.6509979963302612,-.3122063875198364],[.8727967739105225,.48596683144569397,-.04540829733014107],[.9940851926803589,.10859742015600204,.0011142655275762081],[.8643118143081665,.35945847630500793,-.35178789496421814],[-.003276081522926688,-.9999516010284424,.00927703082561493],[-.0032760819885879755,-.9999516606330872,.00927703082561493],[-.003276081522926688,-.9999516010284424,.009277029894292355],[-.003276081755757332,-.9999516606330872,.009277029894292355],[.5376883745193481,.8232352137565613,-.18213941156864166],[.6919021606445312,.6509979963302612,-.3122063875198364],[.37462636828422546,.6200053691864014,-.6893826723098755],[.41769927740097046,.4760781228542328,-.7738713026046753],[.6919021606445312,.6509979963302612,-.3122063875198364],[.8643118143081665,.35945847630500793,-.35178789496421814],[.34577468037605286,.5889291763305664,-.7304808497428894],[.37462636828422546,.6200053691864014,-.6893826723098755],[.9940851926803589,.10859742015600204,.0011142655275762081],[.994776725769043,-.10139967501163483,.011717659421265125],[.9535025358200073,.03478159382939339,-.29937097430229187],[.8643118143081665,.35945847630500793,-.35178789496421814],[.5455085635185242,-.8378602266311646,.020260393619537354],[.9291253089904785,-.3697633743286133,-.0010595708154141903],[.925125002861023,-.375169962644577,-.058234188705682755],[.5313248038291931,-.8438926935195923,-.07442483305931091],[.9477870464324951,-.3114435374736786,.06857644021511078],[.7406501770019531,-.43752405047416687,-.5099119544029236],[.9485647082328796,-.2816155254840851,-.14462943375110626],[.9870246648788452,-.13484345376491547,.08717460930347443],[.7618468403816223,.646384596824646,.04214463010430336],[.8426366448402405,.4910145699977875,.22106125950813293],[.9381476044654846,.19051600992679596,.28910666704177856],[.9768072366714478,.1450829803943634,.1574755609035492],[.7488530874252319,.6626735329627991,.009104926139116287],[.35690364241600037,.9336850047111511,-.029189903289079666],[.4218263030052185,.893310010433197,-.15511257946491241],[.7618468403816223,.646384596824646,.04214463010430336],[.3756128251552582,.9234598278999329,.0783376395702362],[.35690364241600037,.9336850047111511,-.029189903289079666],[.7488530874252319,.6626735329627991,.009104926139116287],[.6722792983055115,.7387584447860718,.04771288111805916],[.6457383632659912,.7610315084457397,.06207112967967987],[.38265588879585266,.9199751615524292,.08497147262096405],[.3756128251552582,.9234598278999329,.0783376395702362],[.6722792983055115,.7387584447860718,.04771288111805916],[.5150745511054993,.8528239727020264,-.08596205711364746],[.426266610622406,.8994579315185547,-.09629113972187042],[.5234197378158569,.8474974632263184,-.08820322155952454],[.5376883745193481,.8232352137565613,-.18213941156864166],[.7433125972747803,-.6685736179351807,.02226567082107067],[.7520958781242371,-.6584120392799377,.02907477132976055],[.28822171688079834,-.9561523795127869,.05196940153837204],[.29988452792167664,-.9533481597900391,.034590303897857666],[.8036648631095886,.5537902116775513,-.217805415391922],[.6157482266426086,.7863949537277222,-.049367424100637436],[.5150745511054993,.8528239727020264,-.08596205711364746],[.5376883745193481,.8232352137565613,-.18213941156864166],[.7460655570030212,-.6658671498298645,.0026501123793423176],[.7433125972747803,-.6685736179351807,.02226567082107067],[.29988452792167664,-.9533481597900391,.034590303897857666],[.31369441747665405,-.9492788314819336,.02157321386039257],[.9991246461868286,-.034952837973833084,-.022984294220805168],[.812343418598175,.5824594497680664,-.0289674773812294],[.7433125972747803,-.6685736179351807,.02226567082107067],[.7460655570030212,-.6658671498298645,.0026501123793423176],[.9962080717086792,-.0641126036643982,-.05881289765238762],[.9991246461868286,-.034952837973833084,-.022984294220805168],[.7460655570030212,-.6658671498298645,.0026501123793423176],[.7457423210144043,-.6656472086906433,-.027963895350694656],[.7457423210144043,-.6656472086906433,-.027963895350694656],[.7460655570030212,-.6658671498298645,.0026501123793423176],[.31369441747665405,-.9492788314819336,.02157321386039257],[.34119275212287903,-.9399923086166382,.0014598877169191837],[.996460497379303,-.06455107778310776,-.053849659860134125],[.9962080717086792,-.0641126036643982,-.05881289765238762],[.7457423210144043,-.6656472086906433,-.027963895350694656],[.7923128604888916,-.6072733998298645,-.05881620571017265],[.7923128604888916,-.6072733998298645,-.05881620571017265],[.7457423210144043,-.6656472086906433,-.027963895350694656],[.34119275212287903,-.9399923086166382,.0014598877169191837],[.3986782729625702,-.9157551527023315,-.04947711527347565],[.9978228807449341,-.05201764032244682,-.040543824434280396],[.996460497379303,-.06455107778310776,-.053849659860134125],[.7923128604888916,-.6072733998298645,-.05881620571017265],[.8045254349708557,-.5899364948272705,-.06865765154361725],[.8045254349708557,-.5899364948272705,-.06865765154361725],[.7923128604888916,-.6072733998298645,-.05881620571017265],[.3986782729625702,-.9157551527023315,-.04947711527347565],[.42811119556427,-.9006050229072571,-.07504191249608994],[.9999374747276306,-.010656150989234447,-.0033726822584867477],[.9999375343322754,-.010656150989234447,-.003372682724148035],[.9999374747276306,-.010656150057911873,-.0033726817928254604],[.9999375343322754,-.010656151920557022,-.0033726824913173914],[.4665221869945526,-.8773672580718994,-.1121765673160553],[.4665221571922302,-.8773673176765442,-.1121765673160553],[.4665221869945526,-.877367377281189,-.1121765673160553],[.4665221869945526,-.877367377281189,-.1121765673160553],[.998106837272644,.010563117451965809,-.060587748885154724],[.9981068968772888,.010563117451965809,-.060587748885154724],[.9981070160865784,.010563119314610958,-.06058775633573532],[.9981069564819336,.010563118383288383,-.06058775261044502],[.511317789554596,-.8463999629020691,-.14886613190174103],[.511317789554596,-.8464000821113586,-.14886613190174103],[.5113177299499512,-.8463999629020691,-.14886613190174103],[.511317789554596,-.8463999629020691,-.14886611700057983],[.7703723907470703,.364370197057724,-.5232215523719788],[.7184544801712036,.4904933571815491,-.4931929409503937],[.7226928472518921,-.0716477632522583,-.6874456405639648],[.7748353481292725,.075252965092659,-.6276678442955017],[.7748353481292725,.075252965092659,-.6276678442955017],[.7226928472518921,-.0716477632522583,-.6874456405639648],[.3967260420322418,-.543319821357727,-.739872932434082],[.36102649569511414,.7485342025756836,.5561981797218323],[.36102646589279175,.7485341429710388,.5561981201171875],[.43389180302619934,.48191967606544495,.7612432837486267],[.4282975196838379,.5146201848983765,.7427835464477539],[.3756128251552582,.9234598278999329,.0783376395702362],[.30924931168556213,.946604311466217,.09113304316997528],[.2723502814769745,.9614163041114807,-.03878369182348251],[.35690364241600037,.9336850047111511,-.029189903289079666],[.38265588879585266,.9199751615524292,.08497147262096405],[.32308486104011536,.9413825273513794,.09703188389539719],[.30924931168556213,.946604311466217,.09113304316997528],[.3756128251552582,.9234598278999329,.0783376395702362],[.5150745511054993,.8528239727020264,-.08596205711364746],[.4702720046043396,.8819447159767151,-.031901802867650986],[.4184861183166504,.9036914706230164,-.09061478823423386],[.426266610622406,.8994579315185547,-.09629113972187042],[.6157482266426086,.7863949537277222,-.049367424100637436],[.49254393577575684,.8694345355033875,.03852318972349167],[.4702720046043396,.8819447159767151,-.031901802867650986],[.5150745511054993,.8528239727020264,-.08596205711364746],[.4887421131134033,.8688849806785583,-.07854924350976944],[.4874696135520935,.8697015643119812,-.0774112120270729],[.5186543464660645,.8537455201148987,-.04600219428539276],[.812343418598175,.5824594497680664,-.0289674773812294],[.4989731013774872,.8658507466316223,-.03644828870892525],[.4985501170158386,.8660682439804077,-.0370621494948864],[.4874696135520935,.8697015643119812,-.0774112120270729],[.4887421131134033,.8688849806785583,-.07854924350976944],[.5233396887779236,.852124035358429,-.0002806649135891348],[.5233396887779236,.8521241545677185,-.00028066494269296527],[.4985501170158386,.8660682439804077,-.0370621494948864],[.4989731013774872,.8658507466316223,-.03644828870892525],[.5939923524856567,.8027538657188416,.05252972990274429],[.5939922332763672,.8027538061141968,.05252972990274429],[.593992292881012,.8027538061141968,.05252972990274429],[.593992292881012,.802753746509552,.05252972990274429],[.6263990998268127,.7756832242012024,.0770687535405159],[.6263991594314575,.7756832838058472,.0770687684416771],[.6263991594314575,.7756832242012024,.0770687684416771],[.6263991594314575,.7756832838058472,.0770687609910965],[.6624122858047485,.7462863922119141,.06531935185194016],[.6624122858047485,.7462863922119141,.06531934440135956],[.6624122858047485,.7462863922119141,.06531935185194016],[.6624122262001038,.7462863326072693,.06531935185194016],[.7703723907470703,.364370197057724,-.5232215523719788],[.5710009336471558,.715075671672821,-.40326735377311707],[.7184544801712036,.4904933571815491,-.4931929409503937],[.37462636828422546,.6200053691864014,-.6893826723098755],[.016368180513381958,.41040074825286865,-.911758303642273],[.07877559959888458,-.25413259863853455,-.9639558792114258],[.41769927740097046,.4760781228542328,-.7738713026046753],[.37462636828422546,.6200053691864014,-.6893826723098755],[.34577468037605286,.5889291763305664,-.7304808497428894],[.0019773005042225122,.5299733281135559,-.8480120301246643],[.016368180513381958,.41040074825286865,-.911758303642273],[.9417835474014282,-.049175508320331573,.3326040506362915],[.9091628789901733,-.16485607624053955,.38242053985595703],[.9477870464324951,-.3114435374736786,.06857644021511078],[.9870246648788452,-.13484345376491547,.08717460930347443],[.14885027706623077,-.9885218143463135,.0258492399007082],[.5455085635185242,-.8378602266311646,.020260393619537354],[.5313248038291931,-.8438926935195923,-.07442483305931091],[.1343700885772705,-.9893593192100525,-.05579141527414322],[.994776725769043,-.10139967501163483,.011717659421265125],[.9454845190048218,-.18804335594177246,.26589235663414],[.9277397990226746,-.26224467158317566,.2655685245990753],[.9816802144050598,-.18131236732006073,.05856389179825783],[.07883576303720474,-.9942485690116882,-.07248955965042114],[.07883576303720474,-.9942484498023987,-.07248955219984055],[.07883577048778534,-.9942485690116882,-.07248955965042114],[.9535025358200073,.03478159382939339,-.29937097430229187],[.994776725769043,-.10139967501163483,.011717659421265125],[.9816802144050598,-.18131236732006073,.05856389179825783],[.9511677026748657,-.04723962023854256,-.3050382733345032],[-.19625768065452576,-.11801380664110184,-.9734246730804443],[-.2926790714263916,-.3033236265182495,-.9068261384963989],[-.32536008954048157,-.23565585911273956,-.9157549738883972],[-.3316536545753479,-.3071261942386627,-.8920086622238159],[-.05927730351686478,.1270371675491333,-.9901250600814819],[-.05927730351686478,.1270371526479721,-.9901250600814819],[-.2926790714263916,-.3033236265182495,-.9068261384963989],[-.19625768065452576,-.11801380664110184,-.9734246730804443],[.5783531069755554,.037188682705163956,-.8149384260177612],[.5758730173110962,.09083724021911621,-.8124769330024719],[.5564614534378052,.26213952898979187,-.7884374260902405],[.5564614534378052,.26213952898979187,-.7884373664855957],[.6000460982322693,-.09697715193033218,-.794065535068512],[.5758730173110962,.09083724021911621,-.8124769330024719],[.5783531069755554,.037188682705163956,-.8149384260177612],[.6286618709564209,-.02641300857067108,-.7772300839424133],[.9816802144050598,-.18131236732006073,.05856389179825783],[.9277397990226746,-.26224467158317566,.2655685245990753],[.880256712436676,-.2203819453716278,.42021414637565613],[.9598467946052551,-.14224128425121307,.24178816378116608],[-.4995267689228058,-.6674507260322571,.5522522330284119],[-.4995267689228058,-.6674506664276123,.5522521734237671],[-.7392453551292419,-.5592052340507507,.37524107098579407],[-.8281887769699097,-.48730725049972534,.2768303155899048],[.9511677026748657,-.04723962023854256,-.3050382733345032],[.9816802144050598,-.18131236732006073,.05856389179825783],[.9598467946052551,-.14224128425121307,.24178816378116608],[.9868009686470032,.016181373968720436,-.16112716495990753],[-.3316536545753479,-.3071261942386627,-.8920086622238159],[-.32536008954048157,-.23565585911273956,-.9157549738883972],[-.21552973985671997,.056692883372306824,-.9748501777648926],[-.21570317447185516,.05686187371611595,-.9748018980026245],[.6000460982322693,-.09697715193033218,-.794065535068512],[.6286618709564209,-.02641300857067108,-.7772300839424133],[.7030335664749146,.08082249015569687,-.7065488696098328],[.6975869536399841,.09133404493331909,-.7106549739837646],[.9598467946052551,-.14224128425121307,.24178816378116608],[.880256712436676,-.2203819453716278,.42021414637565613],[.5838391780853271,.21363331377506256,.7832577228546143],[.9488987326622009,.10196034610271454,.29865553975105286],[-.46847423911094666,-.1571734994649887,.8693839311599731],[-.4684741497039795,-.15717348456382751,.8693838119506836],[-.8334598541259766,-.12069139629602432,.539238452911377],[-.8397976756095886,-.11944134533405304,.5295974612236023],[.9868009686470032,.016181373968720436,-.16112716495990753],[.9598467946052551,-.14224128425121307,.24178816378116608],[.9488987326622009,.10196034610271454,.29865553975105286],[.994851291179657,.025057118386030197,-.09819892793893814],[-.21570317447185516,.05686187371611595,-.9748018980026245],[-.21552973985671997,.056692883372306824,-.9748501777648926],[-.14557555317878723,-.182363361120224,-.9723946452140808],[-.1493588238954544,-.2086780071258545,-.9665119051933289],[.6975869536399841,.09133404493331909,-.7106549739837646],[.7030335664749146,.08082249015569687,-.7065488696098328],[.7033784985542297,-.1011778935790062,-.7035778760910034],[.7059258818626404,-.09110114723443985,-.7024023532867432],[.9488987326622009,.10196034610271454,.29865553975105286],[.5838391780853271,.21363331377506256,.7832577228546143],[.5448250770568848,.30212247371673584,.7822324633598328],[.8804023265838623,.20492564141750336,.4276648163795471],[-.47070038318634033,.29190725088119507,.8326050043106079],[-.4707004427909851,.29190728068351746,.8326051235198975],[-.8098574280738831,.1927443891763687,.5540580153465271],[-.7826141715049744,.20474077761173248,.5878743529319763],[.994851291179657,.025057118386030197,-.09819892793893814],[.9488987326622009,.10196034610271454,.29865553975105286],[.8804023265838623,.20492564141750336,.4276648163795471],[.991542637348175,.02448795922100544,-.12745055556297302],[-.9741464257240295,-.09507003426551819,-.20493975281715393],[-.9741464853286743,-.09507003426551819,-.20493975281715393],[-.9741464257240295,-.09507003426551819,-.20493975281715393],[-.9741464853286743,-.09507004171609879,-.20493976771831512],[-.1493588238954544,-.2086780071258545,-.9665119051933289],[-.14557555317878723,-.182363361120224,-.9723946452140808],[-.15870679914951324,-.27659744024276733,-.9477900862693787],[-.15870678424835205,-.27659744024276733,-.9477900266647339],[.7059258818626404,-.09110114723443985,-.7024023532867432],[.7033784985542297,-.1011778935790062,-.7035778760910034],[.6870550513267517,-.1595001220703125,-.7088828682899475],[.6870550513267517,-.1595001220703125,-.7088829874992371],[-.7594459652900696,-.5591992139816284,-.3324725925922394],[-.7612725496292114,-.5448256731033325,-.35160934925079346],[-.7639512419700623,-.4725126326084137,-.4394431710243225],[-.7639512419700623,-.4725125730037689,-.4394431710243225],[-.6542017459869385,-.7388257384300232,.1617303341627121],[-.7013145685195923,-.7126237154006958,.01804005168378353],[-.7612725496292114,-.5448256731033325,-.35160934925079346],[-.7594459652900696,-.5591992139816284,-.3324725925922394],[-.9570808410644531,-.2858492136001587,-.047818198800086975],[-.9580674171447754,-.2737380564212799,-.08470072597265244],[-.907597541809082,-.15491488575935364,-.3902152180671692],[-.9075976014137268,-.15491488575935364,-.3902152478694916],[-.8281887769699097,-.48730725049972534,.2768303155899048],[-.7392453551292419,-.5592052340507507,.37524107098579407],[-.9580674171447754,-.2737380564212799,-.08470072597265244],[-.9570808410644531,-.2858492136001587,-.047818198800086975],[-.8397976756095886,-.11944134533405304,.5295974612236023],[-.8334598541259766,-.12069139629602432,.539238452911377],[-.9977579712867737,-.06672408431768417,-.005191626958549023],[-.9967944622039795,-.06933978199958801,.03990751504898071],[-.9967944622039795,-.06933978199958801,.03990751504898071],[-.9977579712867737,-.06672408431768417,-.005191626958549023],[-.968826413154602,-.05067602917551994,-.2425018846988678],[-.968826413154602,-.05067602917551994,-.2425018846988678],[-.007080026902258396,-.9999517202377319,.0068261693231761456],[-.0070800259709358215,-.9999516606330872,.006826168857514858],[-.007396361790597439,-.9999653697013855,.003803872736170888],[-.007655521389096975,-.9999698996543884,.001327343052253127],[-.8098574280738831,.1927443891763687,.5540580153465271],[-.9692126512527466,.07919885963201523,.23313987255096436],[-.9692126512527466,.07919885963201523,.23313987255096436],[-.7826141715049744,.20474077761173248,.5878743529319763],[.9766407608985901,-.049606338143348694,.20907409489154816],[.9454845190048218,-.18804335594177246,.26589235663414],[.994776725769043,-.10139967501163483,.011717659421265125],[.9940851926803589,.10859742015600204,.0011142655275762081],[.8727967739105225,.48596683144569397,-.04540829733014107],[.8970381617546082,.4411088824272156,.027302822098135948],[.9766407608985901,-.049606338143348694,.20907409489154816],[.9940851926803589,.10859742015600204,.0011142655275762081],[.5234197378158569,.8474974632263184,-.08820322155952454],[.5382925271987915,.8391603231430054,-.07778876274824142],[.8970381617546082,.4411088824272156,.027302822098135948],[.8727967739105225,.48596683144569397,-.04540829733014107],[.426266610622406,.8994579315185547,-.09629113972187042],[.4193996787071228,.9029867649078369,-.09337382763624191],[.5382925271987915,.8391603231430054,-.07778876274824142],[.5234197378158569,.8474974632263184,-.08820322155952454],[.426266610622406,.8994579315185547,-.09629113972187042],[.4184861183166504,.9036914706230164,-.09061478823423386],[.397386759519577,.9139290452003479,-.08256830275058746],[.4193996787071228,.9029867649078369,-.09337382763624191],[-.4563031494617462,-.7228989601135254,.5188493132591248],[-.45630308985710144,-.7228989005088806,.51884925365448],[-.7013145685195923,-.7126237154006958,.01804005168378353],[-.6542017459869385,-.7388257384300232,.1617303341627121],[.812343418598175,.5824594497680664,-.0289674773812294],[.8409687876701355,.5410745739936829,-.003117515239864588],[.7520958781242371,-.6584120392799377,.02907477132976055],[.7433125972747803,-.6685736179351807,.02226567082107067],[.812343418598175,.5824594497680664,-.0289674773812294],[.5186543464660645,.8537455201148987,-.04600219428539276],[.5403411984443665,.8414300680160522,.005176173057407141],[.8409687876701355,.5410745739936829,-.003117515239864588],[.9381476044654846,.19051600992679596,.28910666704177856],[.9417835474014282,-.049175508320331573,.3326040506362915],[.9870246648788452,-.13484345376491547,.08717460930347443],[.9768072366714478,.1450829803943634,.1574755609035492],[.3048708438873291,-.3601263463497162,.8816817402839661],[.3048708438873291,-.3601263463497162,.8816817998886108],[.3048708736896515,-.3601263761520386,.8816817998886108],[.009669899009168148,-.9999527335166931,-.0009911151137202978],[.01335916668176651,-.9997296333312988,-.019029799848794937],[.008899079635739326,-.9999565482139587,.002775831613689661],[.008292901329696178,-.9999492168426514,.005737709812819958],[.009669899009168148,-.9999527335166931,-.0009911151137202978],[.008899079635739326,-.9999565482139587,.002775831613689661],[.008292900398373604,-.9999490976333618,.00573770934715867],[-.000327377172652632,-.9999869465827942,.005087403580546379],[-.0003273772308602929,-.9999870657920837,.005087404511868954],[-.00032737720175646245,-.999987006187439,.005087404046207666],[-.000327377172652632,-.9999869465827942,.005087404046207666],[.1814485490322113,.09529119729995728,-.9787726402282715],[.7972792387008667,.2637723684310913,-.5429269671440125],[.6811290383338928,.1718948930501938,-.7116989493370056],[.08690784126520157,.012723428197205067,-.9961351156234741],[.6811290383338928,.1718948930501938,-.7116989493370056],[.7972792387008667,.2637723684310913,-.5429269671440125],[.8920365571975708,.3482467830181122,-.2880887985229492],[.892036497592926,.3482467532157898,-.2880887985229492],[.05003644526004791,.7857836484909058,.6164740920066833],[-.5313484072685242,.7057963013648987,.4685301184654236],[-.5509044528007507,.7043324112892151,.447683185338974],[.2159183919429779,.5571125745773315,.8018757700920105],[-.5313484072685242,.7057963013648987,.4685301184654236],[-.8174833655357361,.5758097767829895,.012800747528672218],[-.5509044528007507,.7043324112892151,.447683185338974],[-.8916581869125366,.42880943417549133,-.145148366689682],[-.6992805600166321,.27376049757003784,-.6603497862815857],[-.5561168193817139,.14663560688495636,-.8180659413337708],[-.8941298723220825,.40962284803390503,-.18094424903392792],[-.6992805600166321,.27376049757003784,-.6603497862815857],[.1814485490322113,.09529119729995728,-.9787726402282715],[.08690784126520157,.012723428197205067,-.9961351156234741],[-.5561168193817139,.14663560688495636,-.8180659413337708],[.6097199320793152,.38178151845932007,.6946110129356384],[.2159183919429779,.5571125745773315,.8018757700920105],[.5276976823806763,-.13558554649353027,.8385413885116577],[.5276976823806763,-.13558554649353027,.8385413885116577],[.08690784126520157,.012723428197205067,-.9961351156234741],[.6811290383338928,.1718948930501938,-.7116989493370056],[.35492509603500366,-.03222038596868515,-.9343393445014954],[.06122444570064545,-.05399129539728165,-.9966627359390259],[.9835129380226135,-.17904329299926758,.025407595559954643],[.9835130572319031,-.17904330790042877,.025407597422599792],[.9835129976272583,-.17904330790042877,.025407597422599792],[.9835131168365479,-.17904330790042877,.02540759928524494],[-.5027428865432739,-.15944384038448334,.8496041893959045],[-.5027428269386292,-.15944382548332214,.8496041297912598],[-.5027428269386292,-.15944382548332214,.8496041893959045],[-.5027428865432739,-.15944384038448334,.8496041297912598],[-.9903079867362976,-.13654690980911255,-.02539708837866783],[-.9903079867362976,-.13654690980911255,-.02539708837866783],[-.9903078675270081,-.13654689490795135,-.025397086516022682],[-.9903079867362976,-.13654692471027374,-.02539709024131298],[-.9545094966888428,-.051332514733076096,-.293728768825531],[-.9545094966888428,-.051332518458366394,-.293728768825531],[-.9545095562934875,-.05133252218365669,-.293728768825531],[-.9545095562934875,-.05133252218365669,-.2937287986278534],[-.5561168193817139,.14663560688495636,-.8180659413337708],[.08690784126520157,.012723428197205067,-.9961351156234741],[.06122444570064545,-.05399129539728165,-.9966627359390259],[-.21681351959705353,-.06985045969486237,-.9737108945846558],[.5794637203216553,.6613138914108276,.47632521390914917],[.05003644526004791,.7857836484909058,.6164740920066833],[.2159183919429779,.5571125745773315,.8018757700920105],[.6097199320793152,.38178151845932007,.6946110129356384],[-.8372636437416077,.5378450155258179,.09855113178491592],[-.8916581869125366,.42880943417549133,-.145148366689682],[-.8941298723220825,.40962284803390503,-.18094424903392792],[.8823044300079346,-.05031672492623329,-.4679820239543915],[.8823044300079346,-.05031672865152359,-.4679820239543915],[.8823044300079346,-.05031673237681389,-.4679820239543915],[.8823044300079346,-.05031672120094299,-.4679819941520691],[.9080635905265808,.41698211431503296,.03932438790798187],[.5794637203216553,.6613138914108276,.47632521390914917],[.6097199320793152,.38178151845932007,.6946110129356384],[.4252643287181854,-.326079785823822,-.8442878723144531],[.41716256737709045,-.5338594913482666,-.7355061769485474],[.4247870147228241,-.3042740523815155,-.8526272177696228],[.7406501770019531,-.43752405047416687,-.5099119544029236],[.9477870464324951,-.3114435374736786,.06857644021511078],[.9551147222518921,-.2813762128353119,.09264519810676575],[.9193760752677917,-.18071384727954865,-.34941378235816956],[.17346534132957458,-.4330552816390991,.8845183849334717],[.09481082111597061,-.5233485102653503,.8468276262283325],[.27656683325767517,-.2505062520503998,.9277701377868652],[.26483190059661865,-.24258455634117126,.9332828521728516],[-.8077946901321411,-.550134539604187,.21170684695243835],[-.8316102027893066,-.4946551024913788,-.25246918201446533],[-.8786116242408752,-.32081088423728943,-.3537260591983795],[-.9311760663986206,-.36401504278182983,-.020105909556150436],[.4247870147228241,-.3042740523815155,-.8526272177696228],[.37875980138778687,-.09532086551189423,-.9205731153488159],[.38566529750823975,-.1070541962981224,-.9164069294929504],[.4252643287181854,-.326079785823822,-.8442878723144531],[.9551147222518921,-.2813762128353119,.09264519810676575],[.9803988933563232,-.06604071706533432,.18562422692775726],[.9505224823951721,-.025599543005228043,-.309599369764328],[.9193760752677917,-.18071384727954865,-.34941378235816956],[-.012466281652450562,-.10213904082775116,.9946919083595276],[.01848628744482994,-.11704268306493759,.9929547905921936],[-.191960871219635,-.013161209411919117,.9813143610954285],[-.19196085631847382,-.013161208480596542,.9813142418861389],[-.9780387878417969,-.11297819763422012,-.17514568567276],[-.8510448932647705,-.09574438631534576,-.5162901282310486],[-.8051036596298218,-.04565700888633728,-.5913742184638977],[-.9590003490447998,-.05345573276281357,-.2783178687095642],[.36195024847984314,-.00780502799898386,-.9321647882461548],[.37022340297698975,-.006347283720970154,-.9289209842681885],[.39872634410858154,-.001279944204725325,-.9170689582824707],[.39872637391090393,-.001279944321140647,-.9170690774917603],[.9600644707679749,.017666827887296677,-.2792203724384308],[.9999285340309143,-.008907451294362545,.007981736212968826],[.9705500602722168,.041453126817941666,-.2373063713312149],[.970550000667572,.04145312309265137,-.23730634152889252],[.3728489577770233,-.427837997674942,.8233699798583984],[.3866685628890991,-.2683693468570709,.8823068141937256],[.3863925039768219,-.27374768257141113,.8807740807533264],[.3896631896495819,-.14819471538066864,.9089559316635132],[.3863925039768219,-.27374768257141113,.8807740807533264],[.3866685628890991,-.2683693468570709,.8823068141937256],[.4050523042678833,.8312997221946716,-.3806225061416626],[.4218263030052185,.893310010433197,-.15511257946491241],[.2525371015071869,.9163177609443665,-.3107839524745941],[.2435235232114792,.8133171796798706,-.5284045338630676],[.766213059425354,-.4164203405380249,.48939943313598633],[.9551147222518921,-.2813762128353119,.09264519810676575],[.9477870464324951,-.3114435374736786,.06857644021511078],[.9091628789901733,-.16485607624053955,.38242053985595703],[.766213059425354,-.4164203405380249,.48939943313598633],[.8380744457244873,-.08995909243822098,.5380879640579224],[.9803988933563232,-.06604071706533432,.18562422692775726],[.9551147222518921,-.2813762128353119,.09264519810676575],[-.9798529148101807,-.11036249250173569,.16645821928977966],[-.9780387878417969,-.11297819763422012,-.17514568567276],[-.9590003490447998,-.05345573276281357,-.2783178687095642],[-.9920427203178406,-.05442262068390846,.11353173851966858],[-.6722142696380615,-.5465120673179626,.49945202469825745],[-.8077946901321411,-.550134539604187,.21170684695243835],[-.9311760663986206,-.36401504278182983,-.020105909556150436],[-.8176161050796509,-.39186012744903564,.4218408763408661],[-.5182480812072754,-.6767961978912354,.5228439569473267],[-.8077946901321411,-.550134539604187,.21170684695243835],[-.6722142696380615,-.5465120673179626,.49945202469825745],[-.002707137493416667,-.9999943375587463,-.0020069817546755075],[-9738043445395306e-20,-1,-8159968274412677e-20],[-.0024870464112609625,-.9999951720237732,-.0018446068279445171],[-.0030398331582546234,-.999992847442627,-.002252432284876704],[-.002707137493416667,-.9999943375587463,-.0020069817546755075],[-.0024870464112609625,-.9999951720237732,-.0018446068279445171],[-.0030398338567465544,-.9999929666519165,-.0022524327505379915],[.002526939148083329,-.999995231628418,-.001767946989275515],[9873355338640977e-21,-.9999999403953552,-8601942681707442e-20],[.002916933037340641,-.9999936819076538,-.0020285448990762234],[.002916933037340641,-.9999936819076538,-.0020285448990762234],[.003246558364480734,-.9999921917915344,-.002248803386464715],[.0032465581316500902,-.9999921917915344,-.0022488031536340714],[.002526939148083329,-.999995231628418,-.001767946989275515],[-.13146741688251495,.2366977334022522,-.9626476764678955],[.697407603263855,.42583221197128296,-.5764456391334534],[.7435843348503113,.27636152505874634,-.608856737613678],[-.005266580265015364,.020573601126670837,-.9997743964195251],[.7435843348503113,.27636152505874634,-.608856737613678],[.697407603263855,.42583221197128296,-.5764456391334534],[.8141242861747742,.5578469038009644,-.16127179563045502],[.8141242265701294,.5578469038009644,-.16127179563045502],[-.3610418736934662,.7736912369728088,.5206252932548523],[-.6349890232086182,.7232478260993958,.2714802026748657],[-.5544269680976868,.7512640357017517,.35806867480278015],[-.3610419034957886,.7736911177635193,.5206252336502075],[-.5544269680976868,.7512640357017517,.35806867480278015],[-.6349890232086182,.7232478260993958,.2714802026748657],[-.8289161920547485,.35599374771118164,-.4314700663089752],[-.7784214615821838,.2177102118730545,-.5887802839279175],[-.8289161920547485,.35599374771118164,-.4314700663089752],[-.13146741688251495,.2366977334022522,-.9626476764678955],[-.005266580265015364,.020573601126670837,-.9997743964195251],[-.7784214615821838,.2177102118730545,-.5887802839279175],[.5507657527923584,-.1490505039691925,.8212436437606812],[.5507657527923584,-.1490505188703537,.8212436437606812],[.5507656931877136,-.1490504890680313,.8212435245513916],[.5507657527923584,-.1490504890680313,.8212435841560364],[-.005266580265015364,.020573601126670837,-.9997743964195251],[.7435843348503113,.27636152505874634,-.608856737613678],[.5358596444129944,-.11738801002502441,-.8361066579818726],[-.02385599911212921,-.09995710104703903,-.9947056770324707],[.9810167551040649,-.06483679264783859,-.18276314437389374],[.9810166358947754,-.06483679264783859,-.18276314437389374],[.9810167551040649,-.06483680009841919,-.18276314437389374],[.9810166954994202,-.064836785197258,-.18276312947273254],[-.5430971384048462,-.20497308671474457,.8142674565315247],[-.543097198009491,-.20497307181358337,.8142675161361694],[-.5430971384048462,-.20497310161590576,.8142674565315247],[-.5430971384048462,-.20497310161590576,.8142675757408142],[-.976665198802948,.012919560074806213,-.2143784761428833],[-.976665198802948,.012919561006128788,-.21437852084636688],[-.976665198802948,.012919559143483639,-.2143784761428833],[-.9766652584075928,.012919561006128788,-.2143784910440445],[-.7784214615821838,.2177102118730545,-.5887802839279175],[-.005266580265015364,.020573601126670837,-.9997743964195251],[-.02385599911212921,-.09995710104703903,-.9947056770324707],[-.5808340907096863,-.0479637086391449,-.8126077055931091],[.9485647082328796,-.2816155254840851,-.14462943375110626],[.7406501770019531,-.43752405047416687,-.5099119544029236],[.2705770432949066,-.6124230623245239,-.7427825927734375],[.9803988933563232,-.06604071706533432,.18562422692775726],[.9999285340309143,-.008907451294362545,.007981736212968826],[.9600644707679749,.017666827887296677,-.2792203724384308],[.9505224823951721,-.025599543005228043,-.309599369764328],[.38566529750823975,-.1070541962981224,-.9164069294929504],[.37875980138778687,-.09532086551189423,-.9205731153488159],[.37022340297698975,-.006347283720970154,-.9289209842681885],[.36195024847984314,-.00780502799898386,-.9321647882461548],[-.9311760663986206,-.36401504278182983,-.020105909556150436],[-.8786116242408752,-.32081088423728943,-.3537260591983795],[-.8510448932647705,-.09574438631534576,-.5162901282310486],[-.9780387878417969,-.11297819763422012,-.17514568567276],[-.8176161050796509,-.39186012744903564,.4218408763408661],[-.9311760663986206,-.36401504278182983,-.020105909556150436],[-.9780387878417969,-.11297819763422012,-.17514568567276],[-.9798529148101807,-.11036249250173569,.16645821928977966],[.26483190059661865,-.24258455634117126,.9332828521728516],[.27656683325767517,-.2505062520503998,.9277701377868652],[.01848628744482994,-.11704268306493759,.9929547905921936],[-.012466281652450562,-.10213904082775116,.9946919083595276],[.9803988933563232,-.06604071706533432,.18562422692775726],[.8380744457244873,-.08995909243822098,.5380879640579224],[.7823804020881653,-.0719861164689064,.6186265349388123],[.9999285340309143,-.008907451294362545,.007981736212968826],[.06757760047912598,-.5010526180267334,.8627743124961853],[.07932622730731964,-.4095267057418823,.9088428020477295],[.07932621240615845,-.40952667593955994,.9088428020477295],[.07088138908147812,-.4764057397842407,.8763636946678162],[.17346534132957458,-.4330552816390991,.8845183849334717],[.06757760047912598,-.5010526180267334,.8627743124961853],[.07088138908147812,-.4764057397842407,.8763636946678162],[.09481082111597061,-.5233485102653503,.8468276262283325],[.3956208825111389,.7391512393951416,-.5451050400733948],[.3956208825111389,.7391512393951416,-.54510498046875],[.38196152448654175,.7307950258255005,-.56572425365448],[.388986736536026,.7351351380348206,-.5552167296409607],[.8651763796806335,.20427031815052032,.4579775333404541],[.9119406938552856,.39943942427635193,.09387387335300446],[.9397345781326294,.2088989019393921,-.2706661522388458],[.9552299380302429,.09224513918161392,.2811165153980255],[.13695234060287476,-.32076290249824524,.9372060298919678],[.13695234060287476,-.3207629323005676,.9372060894966125],[.13695234060287476,-.32076290249824524,.9372060894966125],[.13695229589939117,-.32076284289360046,.9372059106826782],[.7926474213600159,.10113353282213211,.6012336015701294],[.8651763796806335,.20427031815052032,.4579775333404541],[.9552299380302429,.09224513918161392,.2811165153980255],[.8267838954925537,.01610807329416275,.5622889995574951],[.388986736536026,.7351351380348206,-.5552167296409607],[.38196152448654175,.7307950258255005,-.56572425365448],[.3725777566432953,.7248623967170715,-.5794482827186584],[.3725777566432953,.7248624563217163,-.5794482827186584],[.9552299380302429,.09224513918161392,.2811165153980255],[.9397345781326294,.2088989019393921,-.2706661522388458],[.9984315037727356,.05574440956115723,-.005208582151681185],[.9962441325187683,-.08337707817554474,-.023362543433904648],[.2921980917453766,-.5222808122634888,.8011509776115417],[.292198121547699,-.5222808122634888,.8011510372161865],[.3535509705543518,-.748909592628479,.5604783296585083],[.3495377004146576,-.7314228415489197,.5855288505554199],[.8267838954925537,.01610807329416275,.5622889995574951],[.9552299380302429,.09224513918161392,.2811165153980255],[.9962441325187683,-.08337707817554474,-.023362543433904648],[.9066129922866821,-.3023506999015808,.2943413257598877],[.9962441325187683,-.08337707817554474,-.023362543433904648],[.9984315037727356,.05574440956115723,-.005208582151681185],[.9873501062393188,.009570947848260403,.15826503932476044],[.9682334661483765,-.19593490660190582,.15534937381744385],[.3495377004146576,-.7314228415489197,.5855288505554199],[.3535509705543518,-.748909592628479,.5604783296585083],[.3966310918331146,-.874226450920105,.28002092242240906],[.3966022729873657,-.8742861151695251,.2798754870891571],[.9066129922866821,-.3023506999015808,.2943413257598877],[.9962441325187683,-.08337707817554474,-.023362543433904648],[.9682334661483765,-.19593490660190582,.15534937381744385],[.923740804195404,-.35312986373901367,.14833100140094757],[.34378063678741455,.7168905138969421,.606533408164978],[.34378060698509216,.7168905138969421,.6065334677696228],[.3437805771827698,.7168905138969421,.606533408164978],[.34378066658973694,.7168905735015869,.6065335273742676],[.7423210144042969,.22705449163913727,.6304013133049011],[.6109460592269897,.4342992603778839,.6619130969047546],[.6109461188316345,.4342992901802063,.6619130969047546],[.770629346370697,.16736017167568207,.6149153709411621],[.3966022729873657,-.8742861151695251,.2798754870891571],[.3966310918331146,-.874226450920105,.28002092242240906],[.4231787323951721,-.7899394631385803,.4437515139579773],[.4231787621974945,-.7899393439292908,.4437515437602997],[.8336090445518494,-.014377200976014137,.5521677136421204],[.7423210144042969,.22705449163913727,.6304013133049011],[.770629346370697,.16736017167568207,.6149153709411621],[.8336091041564941,-.014377201907336712,.5521677732467651],[.45546984672546387,.1650240272283554,.8748223781585693],[.45546987652778625,.1650240421295166,.8748224377632141],[.4282975196838379,.5146201848983765,.7427835464477539],[.43389180302619934,.48191967606544495,.7612432837486267],[.10482406616210938,.9720267653465271,.21018041670322418],[.10482407361268997,.9720268249511719,.21018043160438538],[.10482407361268997,.9720267653465271,.21018043160438538],[.10482405126094818,.9720266461372375,.210180401802063],[.4050523042678833,.8312997221946716,-.3806225061416626],[.7011295557022095,.7121444940567017,.035601671785116196],[.7618468403816223,.646384596824646,.04214463010430336],[.4218263030052185,.893310010433197,-.15511257946491241],[.7128168344497681,.5547977089881897,-.42905882000923157],[.8051605820655823,.5251745581626892,-.2755143642425537],[.8051605224609375,.5251745581626892,-.2755143642425537],[.6335839629173279,.5647056102752686,-.5288468599319458],[.552563488483429,.5657110810279846,-.6120822429656982],[.7128168344497681,.5547977089881897,-.42905882000923157],[.6335839629173279,.5647056102752686,-.5288468599319458],[.5525634288787842,.5657110214233398,-.6120821833610535],[.48474282026290894,.756238579750061,.43946269154548645],[.4847428798675537,.7562386393547058,.4394627809524536],[.4847429096698761,.7562386989593506,.4394627511501312],[.48474279046058655,.756238579750061,.43946269154548645],[.27773410081863403,.743943989276886,.6077921390533447],[.27773404121398926,.7439438700675964,.6077920198440552],[.27773404121398926,.743943989276886,.6077920794487],[.968436062335968,-.17695017158985138,.17555688321590424],[.968436062335968,-.17695018649101257,.17555688321590424],[.9684360027313232,-.17695015668869019,.17555686831474304],[.9684361219406128,-.17695017158985138,.17555689811706543],[.10337559878826141,.23609063029289246,-.9662166833877563],[.10337559878826141,.23609063029289246,-.9662166833877563],[.1213289424777031,.28933531045913696,-.9495073556900024],[.12569350004196167,.3023165762424469,-.9448839426040649],[-.5987306237220764,.7815070748329163,.1754090040922165],[-.5987306237220764,.7815070152282715,.17540901899337769],[-.5916424989700317,.79185950756073,.1513853222131729],[-.5941922068595886,.7882744669914246,.15987159311771393],[-.03073604218661785,.06645089387893677,.9973161220550537],[-.030736036598682404,.06645088642835617,.9973161220550537],[-.0025426747743040323,.05963180214166641,.9982172250747681],[-.010676821693778038,.06160430610179901,.9980434775352478],[.9105457663536072,-.3529585599899292,.215236097574234],[.9105458855628967,-.3529585897922516,.2152361124753952],[.9105457663536072,-.3529585599899292,.2152361124753952],[.910545825958252,-.3529585897922516,.2152361422777176],[.12569350004196167,.3023165762424469,-.9448839426040649],[.1213289424777031,.28933531045913696,-.9495073556900024],[.21081222593784332,.5589836835861206,-.8019322752952576],[.21081221103668213,.5589836239814758,-.8019322156906128],[-.5941922068595886,.7882744669914246,.15987159311771393],[-.5916424989700317,.79185950756073,.1513853222131729],[-.5729642510414124,.8142195343971252,.0935879647731781],[-.5729641914367676,.8142194747924805,.0935879647731781],[-.010676821693778038,.06160430610179901,.9980434775352478],[-.0025426747743040323,.05963180214166641,.9982172250747681],[.12312792986631393,.028629768639802933,.9919777512550354],[.12312791496515274,.028629764914512634,.9919776320457458],[-.6724090576171875,.7385257482528687,.04945340007543564],[-.9888207912445068,.14657975733280182,-.027346821501851082],[-.9914775490760803,.12642793357372284,-.03143296018242836],[-.7527928948402405,.6582412719726562,.004626768175512552],[-.9602015614509583,-.24244357645511627,-.13868680596351624],[-.9914775490760803,.12642793357372284,-.03143296018242836],[-.9888207912445068,.14657975733280182,-.027346821501851082],[-.927798330783844,-.3665548264980316,-.06948138028383255],[-.9889450073242188,-.10021429508924484,.10929232835769653],[-.9776735305786133,.1435503214597702,.15345264971256256],[-.9914775490760803,.12642793357372284,-.03143296018242836],[-.9602015614509583,-.24244357645511627,-.13868680596351624],[-.9776735305786133,.1435503214597702,.15345264971256256],[-.7619723081588745,.6466788649559021,.03470776230096817],[-.7527928948402405,.6582412719726562,.004626768175512552],[-.9914775490760803,.12642793357372284,-.03143296018242836],[-.42595726251602173,.8905650973320007,-.15954336524009705],[-.2557784914970398,.9142258763313293,-.3142741918563843],[-.27628374099731445,.9602630138397217,-.039524421095848083],[-.3624524176120758,.931523859500885,-.029859352856874466],[-.9968475699424744,.07736142724752426,.017608797177672386],[-.9888207912445068,.14657975733280182,-.027346821501851082],[-.6724090576171875,.7385257482528687,.04945340007543564],[-.6531815528869629,.7541465759277344,.06794661283493042],[-.9304522275924683,-.3664124310016632,.0007129135774448514],[-.927798330783844,-.3665548264980316,-.06948138028383255],[-.9888207912445068,.14657975733280182,-.027346821501851082],[-.9968475699424744,.07736142724752426,.017608797177672386],[.005796223413199186,-.9999817609786987,.0016803601756691933],[.005813247058540583,-.9999827742576599,.0006093024858273566],[.005953340791165829,-.9999483823776245,-.008220691233873367],[-.522422730922699,.8478277921676636,-.09089833498001099],[-.5374892950057983,.8233551383018494,-.18218517303466797],[-.6925307512283325,.65254807472229,-.3075423836708069],[-.8752921223640442,.48130813241004944,-.04696930944919586],[-.6925307512283325,.65254807472229,-.3075423836708069],[-.8652673363685608,.35965806245803833,-.34922564029693604],[-.9942461252212524,.10711942613124847,-.0001879819465102628],[-.8752921223640442,.48130813241004944,-.04696930944919586],[.005804457701742649,-.9999387860298157,.009420884773135185],[.0058044558390975,-.9999386668205261,.009420882910490036],[.0058044567704200745,-.9999387264251709,.00942088384181261],[.0058044558390975,-.9999386668205261,.00942088384181261],[-.5374892950057983,.8233551383018494,-.18218517303466797],[-.42644965648651123,.44377845525741577,-.7881631851196289],[-.3751875162124634,.6258243918418884,-.6837967038154602],[-.6925307512283325,.65254807472229,-.3075423836708069],[-.6925307512283325,.65254807472229,-.3075423836708069],[-.3751875162124634,.6258243918418884,-.6837967038154602],[-.34529393911361694,.6041271686553955,-.718193769454956],[-.8652673363685608,.35965806245803833,-.34922564029693604],[-.9942461252212524,.10711942613124847,-.0001879819465102628],[-.8652673363685608,.35965806245803833,-.34922564029693604],[-.9524434804916382,.03328288346529007,-.30289217829704285],[-.9950538277626038,-.0990152582526207,.007980860769748688],[-.5452626347541809,-.8380714058876038,.01802668161690235],[-.5241155624389648,-.8468071222305298,-.09066712856292725],[-.927798330783844,-.3665548264980316,-.06948138028383255],[-.9304522275924683,-.3664124310016632,.0007129135774448514],[-.9473277926445007,-.29350194334983826,.12816645205020905],[-.9889450073242188,-.10021429508924484,.10929232835769653],[-.9602015614509583,-.24244357645511627,-.13868680596351624],[-.8023288249969482,-.39257118105888367,-.4496179223060608],[-.7619723081588745,.6466788649559021,.03470776230096817],[-.9776735305786133,.1435503214597702,.15345264971256256],[-.9415944814682007,.18800051510334015,.2793843746185303],[-.8426296710968018,.49594929814338684,.20978452265262604],[-.7527928948402405,.6582412719726562,.004626768175512552],[-.7619723081588745,.6466788649559021,.03470776230096817],[-.42595726251602173,.8905650973320007,-.15954336524009705],[-.3624524176120758,.931523859500885,-.029859352856874466],[-.37878361344337463,.9222328662872314,.077520452439785],[-.6724090576171875,.7385257482528687,.04945340007543564],[-.7527928948402405,.6582412719726562,.004626768175512552],[-.3624524176120758,.931523859500885,-.029859352856874466],[-.6531815528869629,.7541465759277344,.06794661283493042],[-.6724090576171875,.7385257482528687,.04945340007543564],[-.37878361344337463,.9222328662872314,.077520452439785],[-.38555166125297546,.9189807176589966,.08260949701070786],[-.5132337212562561,.853890597820282,-.08638280630111694],[-.5374892950057983,.8233551383018494,-.18218517303466797],[-.522422730922699,.8478277921676636,-.09089833498001099],[-.42569205164909363,.8998918533325195,-.09476727247238159],[-.7427892088890076,-.6691581606864929,.02216845005750656],[-.3007699251174927,-.9530642628669739,.03472787141799927],[-.28909388184547424,-.9559243321418762,.051316678524017334],[-.7525398135185242,-.6579435467720032,.028177954256534576],[-.7857488393783569,.5784883499145508,-.21897518634796143],[-.5374892950057983,.8233551383018494,-.18218517303466797],[-.5132337212562561,.853890597820282,-.08638280630111694],[-.613581657409668,.7878734469413757,-.052658841013908386],[-.7459130883216858,-.6660369038581848,.002902149921283126],[-.3141822814941406,-.9491105079650879,.02188180387020111],[-.3007699251174927,-.9530642628669739,.03472787141799927],[-.7427892088890076,-.6691581606864929,.02216845005750656],[-.9991235136985779,-.03501037135720253,-.022945178672671318],[-.7459130883216858,-.6660369038581848,.002902149921283126],[-.7427892088890076,-.6691581606864929,.02216845005750656],[-.8112958073616028,.5839515328407288,-.02827322669327259],[-.996208131313324,-.0641126036643982,-.058812860399484634],[-.7457423210144043,-.6656471490859985,-.02796381339430809],[-.7459130883216858,-.6660369038581848,.002902149921283126],[-.9991235136985779,-.03501037135720253,-.022945178672671318],[-.7457423210144043,-.6656471490859985,-.02796381339430809],[-.34119269251823425,-.9399923086166382,.00145998306106776],[-.3141822814941406,-.9491105079650879,.02188180387020111],[-.7459130883216858,-.6660369038581848,.002902149921283126],[-.9964603781700134,-.06455106288194656,-.05384964123368263],[-.7923129200935364,-.6072733402252197,-.05881613865494728],[-.7457423210144043,-.6656471490859985,-.02796381339430809],[-.996208131313324,-.0641126036643982,-.058812860399484634],[-.7923129200935364,-.6072733402252197,-.05881613865494728],[-.39867833256721497,-.9157551527023315,-.04947701096534729],[-.34119269251823425,-.9399923086166382,.00145998306106776],[-.7457423210144043,-.6656471490859985,-.02796381339430809],[-.9978228807449341,-.052017636597156525,-.04054385796189308],[-.8045254349708557,-.5899363160133362,-.06865759193897247],[-.7923129200935364,-.6072733402252197,-.05881613865494728],[-.9964603781700134,-.06455106288194656,-.05384964123368263],[-.8045254349708557,-.5899363160133362,-.06865759193897247],[-.4281114637851715,-.9006050229072571,-.07504181563854218],[-.39867833256721497,-.9157551527023315,-.04947701096534729],[-.7923129200935364,-.6072733402252197,-.05881613865494728],[-.9999374747276306,-.010656140744686127,-.0033726776018738747],[-.9999374747276306,-.010656139813363552,-.0033726776018738747],[-.9999374747276306,-.010656139813363552,-.0033726771362125874],[-.9999374747276306,-.010656141676008701,-.003372677369043231],[-.46652281284332275,-.8773670196533203,-.11217646300792694],[-.46652284264564514,-.8773669600486755,-.11217647045850754],[-.46652284264564514,-.8773670196533203,-.11217647045850754],[-.46652284264564514,-.8773670196533203,-.11217647790908813],[-.998106837272644,.010563105344772339,-.060587745159864426],[-.9981069564819336,.010563106276094913,-.06058775261044502],[-.9981070160865784,.010563107207417488,-.06058775261044502],[-.9981068968772888,.010563105344772339,-.060587745159864426],[-.511318027973175,-.8463997840881348,-.14886631071567535],[-.511318027973175,-.8463997840881348,-.14886629581451416],[-.5113179683685303,-.8463996648788452,-.14886628091335297],[-.5113181471824646,-.8463999032974243,-.14886634051799774],[-.7703719735145569,.36437028646469116,-.5232220888137817],[-.7748350501060486,.07525312900543213,-.6276682615280151],[-.7226925492286682,-.07164765894412994,-.6874459385871887],[-.7184540033340454,.49049338698387146,-.4931935667991638],[-.7748350501060486,.07525312900543213,-.6276682615280151],[-.3967260420322418,-.543319821357727,-.739872932434082],[-.7226925492286682,-.07164765894412994,-.6874459385871887],[-.3866487145423889,.7524677515029907,.5331932306289673],[-.4746325612068176,.5189173817634583,.7109490036964417],[-.4824405908584595,.4865904748439789,.7283408641815186],[-.3866487443447113,.7524677515029907,.5331932306289673],[-.37878361344337463,.9222328662872314,.077520452439785],[-.3624524176120758,.931523859500885,-.029859352856874466],[-.27628374099731445,.9602630138397217,-.039524421095848083],[-.3125985860824585,.9456348419189453,.08975975215435028],[-.38555166125297546,.9189807176589966,.08260949701070786],[-.37878361344337463,.9222328662872314,.077520452439785],[-.3125985860824585,.9456348419189453,.08975975215435028],[-.32564088702201843,.9408991932868958,.09309463202953339],[-.5132337212562561,.853890597820282,-.08638280630111694],[-.42569205164909363,.8998918533325195,-.09476727247238159],[-.4223349988460541,.9020577669143677,-.08902166038751602],[-.47521063685417175,.8792427778244019,-.03327258676290512],[-.613581657409668,.7878734469413757,-.052658841013908386],[-.5132337212562561,.853890597820282,-.08638280630111694],[-.47521063685417175,.8792427778244019,-.03327258676290512],[-.49966830015182495,.8654713034629822,.03592948615550995],[-.48874396085739136,.8688843250274658,-.07854470610618591],[-.8112958073616028,.5839515328407288,-.02827322669327259],[-.5200663208961487,.8529512286186218,-.044778332114219666],[-.48747149109840393,.8697009682655334,-.07740731537342072],[-.4989730417728424,.8658506870269775,-.0364481545984745],[-.48874396085739136,.8688843250274658,-.07854470610618591],[-.48747149109840393,.8697009682655334,-.07740731537342072],[-.4985499382019043,.8660683035850525,-.037062011659145355],[-.5233396291732788,.8521240949630737,-.0002806649135891348],[-.4989730417728424,.8658506870269775,-.0364481545984745],[-.4985499382019043,.8660683035850525,-.037062011659145355],[-.5233396887779236,.8521241545677185,-.00028066494269296527],[-.593992292881012,.8027538061141968,.052529819309711456],[-.5939923524856567,.8027538061141968,.052529823035001755],[-.5939923524856567,.8027538657188416,.052529823035001755],[-.5939922332763672,.8027538061141968,.052529819309711456],[-.6263992786407471,.7756830453872681,.07706866413354874],[-.6263992786407471,.7756831049919128,.07706867158412933],[-.6263992786407471,.7756831645965576,.07706866413354874],[-.6263993382453918,.7756831049919128,.07706866413354874],[-.6624122858047485,.7462863922119141,.06531944870948792],[-.6624122262001038,.7462863326072693,.06531944870948792],[-.6624122262001038,.7462863326072693,.06531943380832672],[-.6624122858047485,.7462863922119141,.06531944870948792],[-.7703719735145569,.36437028646469116,-.5232220888137817],[-.7184540033340454,.49049338698387146,-.4931935667991638],[-.5710006952285767,.7150753736495972,-.40326809883117676],[-.3751875162124634,.6258243918418884,-.6837967038154602],[-.42644965648651123,.44377845525741577,-.7881631851196289],[-.08843350410461426,-.2680386006832123,-.9593408107757568],[-.01909593679010868,.41793292760849,-.908277153968811],[-.3751875162124634,.6258243918418884,-.6837967038154602],[-.01909593679010868,.41793292760849,-.908277153968811],[-.0025348279159516096,.5433701276779175,-.8394894003868103],[-.34529393911361694,.6041271686553955,-.718193769454956],[-.9440922141075134,-.05124950408935547,.3256736099720001],[-.9889450073242188,-.10021429508924484,.10929232835769653],[-.9473277926445007,-.29350194334983826,.12816645205020905],[-.9089924097061157,-.16209730505943298,.3840016722679138],[-.14601776003837585,-.9890109300613403,.023154597729444504],[-.1164323017001152,-.9908350110054016,-.06847979128360748],[-.5241155624389648,-.8468071222305298,-.09066712856292725],[-.5452626347541809,-.8380714058876038,.01802668161690235],[-.9950538277626038,-.0990152582526207,.007980860769748688],[-.9836636781692505,-.17351125180721283,.04795341566205025],[-.9323112368583679,-.2517188787460327,.25967937707901],[-.9480769634246826,-.18246516585350037,.2604924142360687],[-.07733840495347977,-.994351327419281,-.07269264757633209],[-.07733839005231857,-.9943512678146362,-.0726926326751709],[-.07733841240406036,-.994351327419281,-.07269264757633209],[-.9524434804916382,.03328288346529007,-.30289217829704285],[-.9473239183425903,-.03956227004528046,-.3178243041038513],[-.9836636781692505,-.17351125180721283,.04795341566205025],[-.9950538277626038,-.0990152582526207,.007980860769748688],[.19794845581054688,-.10567755252122879,-.9744991660118103],[.36142194271087646,-.31621846556663513,-.8771430850028992],[.3618732988834381,-.24133867025375366,-.9004461169242859],[.3067537546157837,-.2993679940700531,-.9034827351570129],[.05825778469443321,.1261458396911621,-.9902995228767395],[.19794845581054688,-.10567755252122879,-.9744991660118103],[.3067537546157837,-.2993679940700531,-.9034827351570129],[.05825778841972351,.1261458396911621,-.9902995228767395],[-.573340117931366,.03138911724090576,-.8187159895896912],[-.5588298439979553,.24200040102005005,-.7931865453720093],[-.5588299036026001,.24200041592121124,-.793186604976654],[-.5725812315940857,.07158352434635162,-.8167169094085693],[-.5824649333953857,-.08963058143854141,-.8078991174697876],[-.5974618196487427,-.026273036375641823,-.801466703414917],[-.573340117931366,.03138911724090576,-.8187159895896912],[-.5725812315940857,.07158352434635162,-.8167169094085693],[-.9836636781692505,-.17351125180721283,.04795341566205025],[-.9701706767082214,-.13367219269275665,.20223893225193024],[-.8858831524848938,-.2169192135334015,.4100697338581085],[-.9323112368583679,-.2517188787460327,.25967937707901],[.4892696440219879,-.6696873307228088,.5586896538734436],[.8253296613693237,-.4897189140319824,.2810806930065155],[.7361050248146057,-.5608598589897156,.37892648577690125],[.48926958441734314,-.6696872711181641,.5586895942687988],[-.9473239183425903,-.03956227004528046,-.3178243041038513],[-.9773173332214355,.023850541561841965,-.21043281257152557],[-.9701706767082214,-.13367219269275665,.20223893225193024],[-.9836636781692505,-.17351125180721283,.04795341566205025],[.36142194271087646,-.31621846556663513,-.8771430850028992],[.30721333622932434,.06397239118814468,-.9494879841804504],[.3064556419849396,.06269384920597076,-.9498180150985718],[.3618732988834381,-.24133867025375366,-.9004461169242859],[-.5824649333953857,-.08963058143854141,-.8078991174697876],[-.6289485692977905,.09341081976890564,-.7718148827552795],[-.6298378705978394,.08495340496301651,-.7720667123794556],[-.5974618196487427,-.026273036375641823,-.801466703414917],[-.9701706767082214,-.13367219269275665,.20223893225193024],[-.9699404239654541,.08530983328819275,.22789880633354187],[-.6252967715263367,.2084946185350418,.7520199418067932],[-.8858831524848938,-.2169192135334015,.4100697338581085],[.44077548384666443,-.15774056315422058,.8836487531661987],[.8349682092666626,-.11871185153722763,.5373412370681763],[.8264356851577759,-.12037667632102966,.5500122308731079],[.44077542424201965,-.1577405482530594,.8836486339569092],[-.9773173332214355,.023850541561841965,-.21043281257152557],[-.9860050678253174,.010643646121025085,-.1663745939731598],[-.9699404239654541,.08530983328819275,.22789880633354187],[-.9701706767082214,-.13367219269275665,.20223893225193024],[.30721333622932434,.06397239118814468,-.9494879841804504],[.27058839797973633,-.22081521153450012,-.9370286464691162],[.26844555139541626,-.19278335571289062,-.9438068270683289],[.3064556419849396,.06269384920597076,-.9498180150985718],[-.6289485692977905,.09341081976890564,-.7718148827552795],[-.6188177466392517,-.11514642834663391,-.7770494222640991],[-.6176766753196716,-.12217335402965546,-.7768841981887817],[-.6298378705978394,.08495340496301651,-.7720667123794556],[-.9699404239654541,.08530983328819275,.22789880633354187],[-.9185221791267395,.179682195186615,.3521808981895447],[-.5893592238426208,.2972886562347412,.751182496547699],[-.6252967715263367,.2084946185350418,.7520199418067932],[.45717763900756836,.2989414632320404,.8376291394233704],[.7812478542327881,.20770178735256195,.5886525511741638],[.8054727911949158,.19689813256263733,.5589675903320312],[.45717766880989075,.298941433429718,.8376291990280151],[-.9860050678253174,.010643646121025085,-.1663745939731598],[-.9825411438941956,-.002801100490614772,-.18602432310581207],[-.9185221791267395,.179682195186615,.3521808981895447],[-.9699404239654541,.08530983328819275,.22789880633354187],[.9796860218048096,-.0870121568441391,-.18067669868469238],[.9796860814094543,-.0870121568441391,-.18067671358585358],[.9796860218048096,-.0870121568441391,-.18067669868469238],[.9796860218048096,-.0870121568441391,-.18067669868469238],[.27058839797973633,-.22081521153450012,-.9370286464691162],[.2750524580478668,-.29193371534347534,-.9160352945327759],[.2750525176525116,-.2919337749481201,-.9160354137420654],[.26844555139541626,-.19278335571289062,-.9438068270683289],[-.6188177466392517,-.11514642834663391,-.7770494222640991],[-.6042844653129578,-.19331619143486023,-.7729612588882446],[-.604284405708313,-.19331616163253784,-.7729611992835999],[-.6176766753196716,-.12217335402965546,-.7768841981887817],[.7592925429344177,-.5591611266136169,-.3328869938850403],[.7637971043586731,-.47234907746315,-.43988677859306335],[.7637970447540283,-.47234907746315,-.43988680839538574],[.7611100077629089,-.5448593497276306,-.351908802986145],[.653254508972168,-.738763153553009,.16579394042491913],[.7592925429344177,-.5591611266136169,-.3328869938850403],[.7611100077629089,-.5448593497276306,-.351908802986145],[.7014369964599609,-.7124874591827393,.018645010888576508],[.957516610622406,-.28402209281921387,-.04993342235684395],[.9081516265869141,-.15485897660255432,-.38894644379615784],[.9081515669822693,-.15485896170139313,-.38894644379615784],[.958380937576294,-.272652268409729,-.08465664088726044],[.8253296613693237,-.4897189140319824,.2810806930065155],[.957516610622406,-.28402209281921387,-.04993342235684395],[.958380937576294,-.272652268409729,-.08465664088726044],[.7361050248146057,-.5608598589897156,.37892648577690125],[.8349682092666626,-.11871185153722763,.5373412370681763],[.9973436594009399,-.06475552171468735,.033351972699165344],[.9980437755584717,-.06244455277919769,-.0030331613961607218],[.8264356851577759,-.12037667632102966,.5500122308731079],[.9973436594009399,-.06475552171468735,.033351972699165344],[.9729381203651428,-.04641494154930115,-.22635598480701447],[.972938060760498,-.04641493782401085,-.22635596990585327],[.9980437755584717,-.06244455277919769,-.0030331613961607218],[.005773970857262611,-.9999786019325256,.0030797752551734447],[.005813247058540583,-.9999827742576599,.0006093024858273566],[.005796223413199186,-.9999817609786987,.0016803601756691933],[.005773970391601324,-.9999785423278809,.0030797747895121574],[.8054727911949158,.19689813256263733,.5589675903320312],[.7812478542327881,.20770178735256195,.5886525511741638],[.9732228517532349,.07332519441843033,.21785473823547363],[.9732228517532349,.07332518696784973,.21785475313663483],[-.976742684841156,-.052896250039339066,.20778752863407135],[-.9942461252212524,.10711942613124847,-.0001879819465102628],[-.9950538277626038,-.0990152582526207,.007980860769748688],[-.9480769634246826,-.18246516585350037,.2604924142360687],[-.8752921223640442,.48130813241004944,-.04696930944919586],[-.9942461252212524,.10711942613124847,-.0001879819465102628],[-.976742684841156,-.052896250039339066,.20778752863407135],[-.9018002152442932,.43143555521965027,.024890722706913948],[-.522422730922699,.8478277921676636,-.09089833498001099],[-.8752921223640442,.48130813241004944,-.04696930944919586],[-.9018002152442932,.43143555521965027,.024890722706913948],[-.5388258695602417,.838491678237915,-.08123032748699188],[-.42569205164909363,.8998918533325195,-.09476727247238159],[-.522422730922699,.8478277921676636,-.09089833498001099],[-.5388258695602417,.838491678237915,-.08123032748699188],[-.4188113212585449,.9034200310707092,-.09181131422519684],[-.42569205164909363,.8998918533325195,-.09476727247238159],[-.4188113212585449,.9034200310707092,-.09181131422519684],[-.4022566080093384,.9120044112205505,-.08023528009653091],[-.4223349988460541,.9020577669143677,-.08902166038751602],[.453835129737854,-.7205432653427124,.5242624878883362],[.653254508972168,-.738763153553009,.16579394042491913],[.7014369964599609,-.7124874591827393,.018645010888576508],[.45383507013320923,-.7205432653427124,.5242624282836914],[-.8112958073616028,.5839515328407288,-.02827322669327259],[-.7427892088890076,-.6691581606864929,.02216845005750656],[-.7525398135185242,-.6579435467720032,.028177954256534576],[-.8390973806381226,.5439773201942444,-.002080581383779645],[-.8112958073616028,.5839515328407288,-.02827322669327259],[-.8390973806381226,.5439773201942444,-.002080581383779645],[-.5433249473571777,.8394855856895447,.007872949354350567],[-.5200663208961487,.8529512286186218,-.044778332114219666],[-.9415944814682007,.18800051510334015,.2793843746185303],[-.9776735305786133,.1435503214597702,.15345264971256256],[-.9889450073242188,-.10021429508924484,.10929232835769653],[-.9440922141075134,-.05124950408935547,.3256736099720001],[-.3431074023246765,-.3458298444747925,.8733149170875549],[-.3431074023246765,-.3458298146724701,.8733147978782654],[-.3431074023246765,-.3458298444747925,.8733148574829102],[-.00481108482927084,-.9999883770942688,-.00021707858832087368],[-.004620146472007036,-.9999879598617554,.001657801796682179],[-.005666486918926239,-.9999467730522156,-.008618608117103577],[-.004471795167773962,-.9999850988388062,.0031143990345299244],[-.004471795167773962,-.9999850392341614,.0031143990345299244],[-.004620146472007036,-.9999879598617554,.001657801796682179],[-.00481108482927084,-.9999883770942688,-.00021707858832087368],[-.0010187785374000669,-.9999849796295166,.005365046672523022],[-.0010187787702307105,-.9999850988388062,.005365047138184309],[-.0010187787702307105,-.9999851584434509,.005365047603845596],[-.0010187785374000669,-.9999849796295166,.005365046672523022],[-.1169370636343956,.10038254410028458,-.9880532622337341],[-.062225598841905594,.01109904982149601,-.9980003833770752],[-.6522122621536255,.1848730444908142,-.7351468801498413],[-.7579457759857178,.27697327733039856,-.5905961990356445],[-.6522122621536255,.1848730444908142,-.7351468801498413],[-.8674748539924622,.37473905086517334,-.32719752192497253],[-.8674747943878174,.37473902106285095,-.32719749212265015],[-.7579457759857178,.27697327733039856,-.5905961990356445],[-.05369451642036438,.7826659679412842,.6201216578483582],[-.2027406543493271,.552531898021698,.8084582090377808],[.5579318404197693,.6933944225311279,.45597830414772034],[.5375236868858337,.6949065327644348,.4776747524738312],[.5375236868858337,.6949065327644348,.4776747524738312],[.5579318404197693,.6933944225311279,.45597830414772034],[.8256932497024536,.5639258027076721,.014774173498153687],[.8919774293899536,.4263274669647217,-.1504036784172058],[.8951589465141296,.40545105934143066,-.18520253896713257],[.577497124671936,.14261436462402344,-.8038396239280701],[.7394495010375977,.2839336097240448,-.6104065179824829],[.7394495010375977,.2839336097240448,-.6104065179824829],[.577497124671936,.14261436462402344,-.8038396239280701],[-.062225598841905594,.01109904982149601,-.9980003833770752],[-.1169370636343956,.10038254410028458,-.9880532622337341],[-.600369393825531,.3730711340904236,.7073715329170227],[-.5113011002540588,-.13511663675308228,.8487134575843811],[-.5113010406494141,-.13511662185192108,.8487133979797363],[-.2027406543493271,.552531898021698,.8084582090377808],[-.062225598841905594,.01109904982149601,-.9980003833770752],[-.07047327607870102,-.056778404861688614,-.9958964586257935],[-.34511494636535645,-.029002906754612923,-.9381122589111328],[-.6522122621536255,.1848730444908142,-.7351468801498413],[-.9913008809089661,-.13160249590873718,.0017998266266658902],[-.9913009405136108,-.13160249590873718,.001799826743081212],[-.9913008809089661,-.13160249590873718,.0017998265102505684],[-.9913009405136108,-.13160249590873718,.001799826743081212],[.4942286014556885,-.19463640451431274,.8472630977630615],[.4942286014556885,-.19463637471199036,.8472630977630615],[.4942285716533661,-.19463635981082916,.8472630381584167],[.4942286014556885,-.19463637471199036,.8472630977630615],[.9881885051727295,-.1460365206003189,-.04644080996513367],[.988188624382019,-.1460365206003189,-.046440813690423965],[.9881885051727295,-.14603650569915771,-.04644080623984337],[.9881885051727295,-.1460365206003189,-.04644080996513367],[.9552457928657532,-.07108645141124725,-.2871449589729309],[.9552457928657532,-.07108644396066666,-.2871449291706085],[.9552457332611084,-.07108644396066666,-.2871449291706085],[.9552457928657532,-.07108644396066666,-.2871449589729309],[.577497124671936,.14261436462402344,-.8038396239280701],[.23435240983963013,-.08183195441961288,-.9687013626098633],[-.07047327607870102,-.056778404861688614,-.9958964586257935],[-.062225598841905594,.01109904982149601,-.9980003833770752],[-.5763696432113647,.6622241139411926,.4788082242012024],[-.600369393825531,.3730711340904236,.7073715329170227],[-.2027406543493271,.552531898021698,.8084582090377808],[-.05369451642036438,.7826659679412842,.6201216578483582],[.8391563296318054,.5393615961074829,.07004023343324661],[.8951589465141296,.40545105934143066,-.18520253896713257],[.8919774293899536,.4263274669647217,-.1504036784172058],[-.882590115070343,-.03650842234492302,-.46872344613075256],[-.882590115070343,-.036508429795503616,-.4687235355377197],[-.882590115070343,-.03650842607021332,-.46872347593307495],[-.882590115070343,-.03650842607021332,-.4687235355377197],[-.889030396938324,.451751708984375,.07446818053722382],[-.600369393825531,.3730711340904236,.7073715329170227],[-.5763696432113647,.6622241139411926,.4788082242012024],[.7184011936187744,-.6829391717910767,-.13226424157619476],[.7996262311935425,-.5610377788543701,.21408973634243011],[.8230825662612915,-.48958125710487366,-.28782880306243896],[-.8023288249969482,-.39257118105888367,-.4496179223060608],[-.9208201766014099,-.29577285051345825,-.2541823387145996],[-.9269654154777527,-.3435562551021576,.15067937970161438],[-.9473277926445007,-.29350194334983826,.12816645205020905],[-.15191736817359924,-.44608259201049805,.8820042610168457],[-.25170090794563293,-.22472083568572998,.9413539171218872],[-.26237815618515015,-.23019830882549286,.9371053576469421],[-.06973143666982651,-.5524761080741882,.8306068181991577],[.7996262311935425,-.5610377788543701,.21408973634243011],[.9406462907791138,-.33650943636894226,-.04411286488175392],[.8721233010292053,-.2860887944698334,-.396930992603302],[.8230825662612915,-.48958125710487366,-.28782880306243896],[-.42734047770500183,-.3831574618816376,-.8188837766647339],[-.42732101678848267,-.3530570864677429,-.8323144912719727],[-.4079180657863617,-.11905945837497711,-.905222475528717],[-.4048710763454437,-.10387067496776581,-.9084548354148865],[-.9269654154777527,-.3435562551021576,.15067937970161438],[-.9208201766014099,-.29577285051345825,-.2541823387145996],[-.9601566791534424,-.03858241066336632,-.2767859101295471],[-.975777804851532,-.06980238854885101,.2073289453983307],[.017434529960155487,-.09912088513374329,.9949226379394531],[.192292720079422,-.014951392076909542,.9812236428260803],[.1922927349805832,-.014951393008232117,.9812237024307251],[-.01032331120222807,-.11210950464010239,.993642270565033],[.9751980304718018,-.11135800182819366,-.19128048419952393],[.9552814364433289,-.05336516350507736,-.29084277153015137],[.7979761958122253,-.04630596935749054,-.6009073853492737],[.8455327749252319,-.09537559002637863,-.5253358483314514],[-.41832828521728516,-.009852799586951733,-.908242404460907],[-.45054566860198975,.015090747736394405,-.8926258683204651],[-.4505457282066345,.01509074866771698,-.8926258683204651],[-.4249478876590729,-.004779197741299868,-.9052051901817322],[-.9693365097045898,.016211897134780884,-.24520176649093628],[-.9765109419822693,.04683363065123558,-.21031633019447327],[-.9765108227729797,.046833623200654984,-.21031630039215088],[-.9990457892417908,-.007293658331036568,.043061260133981705],[-.3569827079772949,-.42108333110809326,.8338177800178528],[-.3664427697658539,-.2725484073162079,.8896274566650391],[-.36669278144836426,-.26424306631088257,.892026960849762],[-.3673076629638672,-.1461908519268036,.9185385704040527],[-.36669278144836426,-.26424306631088257,.892026960849762],[-.3664427697658539,-.2725484073162079,.8896274566650391],[-.4056936502456665,.8296096324920654,-.3836149275302887],[-.24315686523914337,.8125669956207275,-.5297257900238037],[-.2557784914970398,.9142258763313293,-.3142741918563843],[-.42595726251602173,.8905650973320007,-.15954336524009705],[-.7374564409255981,-.445467084646225,.5076581835746765],[-.9089924097061157,-.16209730505943298,.3840016722679138],[-.9473277926445007,-.29350194334983826,.12816645205020905],[-.9269654154777527,-.3435562551021576,.15067937970161438],[-.7374564409255981,-.445467084646225,.5076581835746765],[-.9269654154777527,-.3435562551021576,.15067937970161438],[-.975777804851532,-.06980238854885101,.2073289453983307],[-.8294135928153992,-.08758260309696198,.5517268180847168],[.981040894985199,-.1073567122220993,.16134801506996155],[.9929326176643372,-.05349728837609291,.1059369444847107],[.9552814364433289,-.05336516350507736,-.29084277153015137],[.9751980304718018,-.11135800182819366,-.19128048419952393],[.6430631875991821,-.5529570579528809,.5298190712928772],[.8140770792961121,-.37448689341545105,.44388967752456665],[.9406462907791138,-.33650943636894226,-.04411286488175392],[.7996262311935425,-.5610377788543701,.21408973634243011],[.45072656869888306,-.7097382545471191,.5414029955863953],[.6430631875991821,-.5529570579528809,.5298190712928772],[.7996262311935425,-.5610377788543701,.21408973634243011],[.002940503880381584,-.9999933838844299,-.0021192675922065973],[.0027015653904527426,-.9999943971633911,-.00194975221529603],[6992677663220093e-20,-1,-827307885629125e-19],[.0033051983918994665,-.999991774559021,-.0023780008777976036],[.003305198159068823,-.9999916553497314,-.0023780004121363163],[.0027015653904527426,-.9999943971633911,-.00194975221529603],[.002940503880381584,-.9999933838844299,-.0021192675922065973],[-.0027710082940757275,-.9999944567680359,-.0018955926643684506],[-.003205943154171109,-.9999924898147583,-.002180637326091528],[-987338262348203e-20,-.9999999403953552,-8601825538789853e-20],[-.003205943154171109,-.9999924898147583,-.002180637326091528],[-.0027710082940757275,-.9999944567680359,-.0018955926643684506],[-.003571542212739587,-.999990701675415,-.0024202410131692886],[-.003571541979908943,-.9999906420707703,-.0024202410131692886],[.10659994184970856,.22384177148342133,-.9687782526016235],[.024921411648392677,.016289647668600082,-.9995567202568054],[-.7404559850692749,.273591011762619,-.6138997673988342],[-.702672004699707,.40140748023986816,-.5874725580215454],[.35547885298728943,.776340663433075,.5205093026161194],[.35547885298728943,.7763406038284302,.5205092430114746],[.5515531897544861,.7534278631210327,.3579602837562561],[.6331616640090942,.7248905301094055,.27136680483818054],[.5515531897544861,.7534278631210327,.3579602837562561],[.7814196944236755,.2204984575510025,-.583749532699585],[.8275907635688782,.36162346601486206,-.42932745814323425],[.6331616640090942,.7248905301094055,.27136680483818054],[.8275907635688782,.36162346601486206,-.42932745814323425],[.7814196944236755,.2204984575510025,-.583749532699585],[.024921411648392677,.016289647668600082,-.9995567202568054],[.10659994184970856,.22384177148342133,-.9687782526016235],[-.5469435453414917,-.15651975572109222,.8224075436592102],[-.5469436049461365,-.15651977062225342,.822407603263855],[-.5469436049461365,-.15651977062225342,.822407603263855],[-.5469436049461365,-.15651975572109222,.822407603263855],[.024921411648392677,.016289647668600082,-.9995567202568054],[.014822925440967083,-.09616053104400635,-.9952554702758789],[-.5146061778068542,-.10557375848293304,-.8509023189544678],[-.7404559850692749,.273591011762619,-.6138997673988342],[.5432253479957581,-.2052222639322281,.8141191601753235],[.5432253479957581,-.2052222341299057,.8141191005706787],[.5432254076004028,-.2052222490310669,.8141191601753235],[.5432254076004028,-.2052222341299057,.8141191005706787],[.9766983985900879,.013071822933852673,-.21421776711940765],[.9766983985900879,.013071823865175247,-.21421778202056885],[.9766984581947327,.013071823865175247,-.21421779692173004],[.9766984581947327,.013071822933852673,-.21421779692173004],[.7814196944236755,.2204984575510025,-.583749532699585],[.584661066532135,-.05284975841641426,-.8095544576644897],[.014822925440967083,-.09616053104400635,-.9952554702758789],[.024921411648392677,.016289647668600082,-.9995567202568054],[-.9812504649162292,-.06350800395011902,-.1819731593132019],[-.9812504649162292,-.06350800395011902,-.1819731742143631],[-.9812504649162292,-.06350800395011902,-.1819731444120407],[-.981250524520874,-.06350801140069962,-.1819731742143631],[-.7404559850692749,.273591011762619,-.6138997673988342],[-.8199886679649353,.5490710735321045,-.1616777777671814],[-.8199886083602905,.5490710139274597,-.1616777628660202],[-.702672004699707,.40140748023986816,-.5874725580215454],[-.08212380856275558,-.9820094108581543,-.17003856599330902],[-.4672388732433319,-.8609240055084229,-.20123977959156036],[-.5241155624389648,-.8468071222305298,-.09066712856292725],[-.1164323017001152,-.9908350110054016,-.06847979128360748],[-.9602015614509583,-.24244357645511627,-.13868680596351624],[-.927798330783844,-.3665548264980316,-.06948138028383255],[-.5241155624389648,-.8468071222305298,-.09066712856292725],[-.4672388732433319,-.8609240055084229,-.20123977959156036],[-.975777804851532,-.06980238854885101,.2073289453983307],[-.9601566791534424,-.03858241066336632,-.2767859101295471],[-.9693365097045898,.016211897134780884,-.24520176649093628],[-.9990457892417908,-.007293658331036568,.043061260133981705],[-.4079180657863617,-.11905945837497711,-.905222475528717],[-.41832828521728516,-.009852799586951733,-.908242404460907],[-.4249478876590729,-.004779197741299868,-.9052051901817322],[-.4048710763454437,-.10387067496776581,-.9084548354148865],[.9406462907791138,-.33650943636894226,-.04411286488175392],[.9751980304718018,-.11135800182819366,-.19128048419952393],[.8455327749252319,-.09537559002637863,-.5253358483314514],[.8721233010292053,-.2860887944698334,-.396930992603302],[.8140770792961121,-.37448689341545105,.44388967752456665],[.981040894985199,-.1073567122220993,.16134801506996155],[.9751980304718018,-.11135800182819366,-.19128048419952393],[.9406462907791138,-.33650943636894226,-.04411286488175392],[-.25170090794563293,-.22472083568572998,.9413539171218872],[.017434529960155487,-.09912088513374329,.9949226379394531],[-.01032331120222807,-.11210950464010239,.993642270565033],[-.26237815618515015,-.23019830882549286,.9371053576469421],[-.975777804851532,-.06980238854885101,.2073289453983307],[-.9990457892417908,-.007293658331036568,.043061260133981705],[-.7721172571182251,-.06749111413955688,.6318860650062561],[-.8294135928153992,-.08758260309696198,.5517268180847168],[-.04987340047955513,-.5272462964057922,.8482475280761719],[-.05676192045211792,-.4981537163257599,.8652287721633911],[-.07380927354097366,-.42228904366493225,.9034512639045715],[-.07380927354097366,-.42228904366493225,.9034512042999268],[-.15191736817359924,-.44608259201049805,.8820042610168457],[-.06973143666982651,-.5524761080741882,.8306068181991577],[-.05676192045211792,-.4981537163257599,.8652287721633911],[-.04987340047955513,-.5272462964057922,.8482475280761719],[-.3823562264442444,.7435925006866455,-.5485195517539978],[-.37371256947517395,.7407341003417969,-.5582579374313354],[-.36483970284461975,.7376870512962341,-.5680755376815796],[-.382356196641922,.7435925602912903,-.5485196113586426],[-.8538330793380737,.20588931441307068,.47809889912605286],[-.952582061290741,.091758131980896,.2901168465614319],[-.9451659917831421,.2027226686477661,-.2560560405254364],[-.9093189835548401,.4027748107910156,.1044585332274437],[-.12615735828876495,-.3186514675617218,.9394389390945435],[-.12615734338760376,-.3186514675617218,.9394389390945435],[-.12615735828876495,-.3186514973640442,.9394389390945435],[-.12615734338760376,-.3186514675617218,.9394388794898987],[-.7794650793075562,.1058986485004425,.617429792881012],[-.8184667229652405,.018256813287734985,.5742636919021606],[-.952582061290741,.091758131980896,.2901168465614319],[-.8538330793380737,.20588931441307068,.47809889912605286],[-.37371256947517395,.7407341003417969,-.5582579374313354],[-.3530687987804413,.7334728837013245,-.5808269381523132],[-.35306885838508606,.7334729433059692,-.580826997756958],[-.36483970284461975,.7376870512962341,-.5680755376815796],[-.952582061290741,.091758131980896,.2901168465614319],[-.9957332015037537,-.09205184876918793,-.006468675099313259],[-.9985544085502625,.053307000547647476,.006882904563099146],[-.9451659917831421,.2027226686477661,-.2560560405254364],[-.2771816551685333,-.5325545072555542,.7997224926948547],[-.3361224830150604,-.726291835308075,.5996015071868896],[-.3422775864601135,-.7490001320838928,.5673136711120605],[-.2771816551685333,-.5325545072555542,.7997224926948547],[-.8184667229652405,.018256813287734985,.5742636919021606],[-.9033880233764648,-.30862173438072205,.2977290153503418],[-.9957332015037537,-.09205184876918793,-.006468675099313259],[-.952582061290741,.091758131980896,.2901168465614319],[-.9957332015037537,-.09205184876918793,-.006468675099313259],[-.9655999541282654,-.2024228423833847,.16322247684001923],[-.9866953492164612,.01157301478087902,.16216762363910675],[-.9985544085502625,.053307000547647476,.006882904563099146],[-.3361224830150604,-.726291835308075,.5996015071868896],[-.40485987067222595,-.873597264289856,.2700302004814148],[-.4063848555088043,-.8713362812995911,.27499908208847046],[-.3422775864601135,-.7490001320838928,.5673136711120605],[-.9033880233764648,-.30862173438072205,.2977290153503418],[-.9148621559143066,-.37137898802757263,.15844525396823883],[-.9655999541282654,-.2024228423833847,.16322247684001923],[-.9957332015037537,-.09205184876918793,-.006468675099313259],[-.33072471618652344,.7130166292190552,.6182462573051453],[-.33072471618652344,.7130166888237,.61824631690979],[-.33072471618652344,.7130166888237,.6182462573051453],[-.33072471618652344,.7130166888237,.6182462573051453],[-.7358707785606384,.20594705641269684,.6450425386428833],[-.7616881728172302,.14306820929050446,.6319513916969299],[-.6089897155761719,.4303660988807678,.66627037525177],[-.6089898347854614,.4303662180900574,.6662704348564148],[-.40485987067222595,-.873597264289856,.2700302004814148],[-.4520634412765503,-.7724806070327759,.4459960162639618],[-.4520634114742279,-.7724805474281311,.4459960460662842],[-.4063848555088043,-.8713362812995911,.27499908208847046],[-.8172847032546997,-.05075358599424362,.5739944577217102],[-.8172847628593445,-.05075358971953392,.5739944577217102],[-.7616881728172302,.14306820929050446,.6319513916969299],[-.7358707785606384,.20594705641269684,.6450425386428833],[-.5218523144721985,.12872415781021118,.843267560005188],[-.4824405908584595,.4865904748439789,.7283408641815186],[-.4746325612068176,.5189173817634583,.7109490036964417],[-.5218522548675537,.12872417271137238,.8432676196098328],[-.0833234190940857,.9758344888687134,.20200049877166748],[-.0833234190940857,.9758344888687134,.20200049877166748],[-.08332342654466629,.9758344888687134,.20200051367282867],[-.08332342654466629,.9758344888687134,.20200049877166748],[-.4056936502456665,.8296096324920654,-.3836149275302887],[-.42595726251602173,.8905650973320007,-.15954336524009705],[-.7619723081588745,.6466788649559021,.03470776230096817],[-.7022985219955444,.7114459872245789,.024928009137511253],[-.7165502309799194,.5546915531158447,-.4229336977005005],[-.6365807056427002,.5654520392417908,-.5244320034980774],[-.8085176348686218,.5237716436386108,-.2682582139968872],[-.8085176348686218,.5237715840339661,-.2682582139968872],[-.5550318956375122,.5669994950294495,-.6086469292640686],[-.555031955242157,.5669995546340942,-.6086468696594238],[-.6365807056427002,.5654520392417908,-.5244320034980774],[-.7165502309799194,.5546915531158447,-.4229336977005005],[-.48476293683052063,.7562461495399475,.4394277036190033],[-.484762966632843,.7562462687492371,.4394277036190033],[-.48476290702819824,.7562460899353027,.43942761421203613],[-.48476290702819824,.7562460899353027,.43942761421203613],[-.2713889181613922,.7295088171958923,.6278254389762878],[-.2713889181613922,.7295088768005371,.6278254389762878],[-.2713888883590698,.7295088768005371,.6278254389762878],[-.9646292328834534,-.18377573788166046,.18898944556713104],[-.9646292328834534,-.18377572298049927,.18898946046829224],[-.9646291136741638,-.18377570807933807,.18898943066596985],[-.9646292328834534,-.18377573788166046,.18898946046829224],[-.10347545146942139,.23581929504871368,-.966272234916687],[-.12586091458797455,.3021451234817505,-.9449166059494019],[-.12141623347997665,.28894558548927307,-.9496148228645325],[-.10347545146942139,.23581930994987488,-.966272234916687],[.5906820893287659,.791027843952179,.15927840769290924],[.5870707631111145,.7962804436683655,.14589446783065796],[.5851361155509949,.7989506125450134,.1389012187719345],[.5906820297241211,.791027843952179,.15927839279174805],[.015503320842981339,.08264702558517456,.9964582324028015],[-.0007061606738716364,.07823371142148972,.9969347715377808],[-.007696251384913921,.07632371783256531,.9970533847808838],[.015503320842981339,.08264703303575516,.9964582324028015],[-.9076508283615112,-.3570781648159027,.22060135006904602],[-.907650887966156,-.3570781648159027,.2206013798713684],[-.907650887966156,-.3570782244205475,.2206013947725296],[-.9076509475708008,-.3570781648159027,.2206013798713684],[-.12586091458797455,.3021451234817505,-.9449166059494019],[-.21108824014663696,.5587577223777771,-.8020172119140625],[-.21108822524547577,.5587576627731323,-.8020172119140625],[-.12141623347997665,.28894558548927307,-.9496148228645325],[.5870707631111145,.7962804436683655,.14589446783065796],[.5699755549430847,.816970944404602,.08767196536064148],[.5699754953384399,.816970944404602,.08767195791006088],[.5851361155509949,.7989506125450134,.1389012187719345],[-.0007061606738716364,.07823371142148972,.9969347715377808],[-.10919831693172455,.04812295362353325,.9928544759750366],[-.10919830948114395,.04812295362353325,.9928543567657471],[-.007696251384913921,.07632371783256531,.9970533847808838],[-.8077946901321411,-.550134539604187,.21170684695243835],[-.7513380646705627,-.646805465221405,-.13089564442634583],[-.8316102027893066,-.4946551024913788,-.25246918201446533],[.7430096864700317,.0557236447930336,.6669567823410034],[.7430096864700317,.055723633617162704,.6669567227363586],[.7430097460746765,.0557236522436142,.6669568419456482],[.7430096864700317,.0557236447930336,.6669568419456482],[-.4017104208469391,.8051612377166748,.436284601688385],[-.4017103314399719,.80516117811203,.4362845718860626],[-.4017103910446167,.80516117811203,.4362845718860626],[-.4017103612422943,.80516117811203,.436284601688385],[-.722770631313324,.05587755888700485,.688825249671936],[-.7227705717086792,.055877555161714554,.688825249671936],[-.7227705717086792,.05587755888700485,.688825249671936],[-.7227706909179688,.05587756633758545,.6888251900672913],[.41099199652671814,.8038304448127747,.43004918098449707],[.41099199652671814,.8038303256034851,.43004921078681946],[.41099199652671814,.8038303852081299,.43004921078681946],[.4109920263290405,.8038303852081299,.43004924058914185],[.47810599207878113,-.8609418272972107,-.17376361787319183],[.11485107243061066,-.9807531833648682,-.15790025889873505],[.1343700885772705,-.9893593192100525,-.05579141527414322],[.5313248038291931,-.8438926935195923,-.07442483305931091],[.9485647082328796,-.2816155254840851,-.14462943375110626],[.47810599207878113,-.8609418272972107,-.17376361787319183],[.5313248038291931,-.8438926935195923,-.07442483305931091],[.925125002861023,-.375169962644577,-.058234188705682755],[-.8023288249969482,-.39257118105888367,-.4496179223060608],[-.16912665963172913,-.595000147819519,-.7857295274734497],[-.015343433246016502,-.6270102262496948,-.7788599729537964],[-.015343430452048779,-.6270101070404053,-.7788599133491516],[-.9602015614509583,-.24244357645511627,-.13868680596351624],[-.16912665963172913,-.595000147819519,-.7857295274734497],[-.8023288249969482,-.39257118105888367,-.4496179223060608],[.01625058241188526,-.6071835160255432,-.7943953275680542],[.2705770432949066,-.6124230623245239,-.7427825927734375],[.7406501770019531,-.43752405047416687,-.5099119544029236],[.01625058427453041,-.6071835160255432,-.7943953275680542],[-.40848779678344727,-.621504008769989,-.6684836149215698],[-.42732101678848267,-.3530570864677429,-.8323144912719727],[-.42734047770500183,-.3831574618816376,-.8188837766647339]],edges:[7,1,0,3,5,4,2,8,10,14,21,23,31,27,36,34,33,32,37,38,46,82,84,44,45,53,49,51,52,57,209,60,1481,59,64,67,492,74,71,80,76,79,88,83,96,86,95,91,98,94,99,101,106,102,107,109,110,115,117,122,118,123,125,130,126,131,133,138,134,139,141,145,142,495,17,494,150,151,160,155,158,159,168,163,166,167,170,171,174,175,178,179,182,183,186,187,190,137,129,105,93,85,193,194,199,220,207,1303,603,602,113,114,121,58,208,205,212,352,211,219,218,223,222,227,48,198,228,235,225,221,239,237,238,247,246,251,249,250,254,259,257,258,263,267,266,271,269,270,274,279,277,278,282,283,287,286,290,291,293,294,298,215,241,301,303,300,305,307,304,243,315,242,311,308,319,262,289,318,330,288,335,336,340,344,349,55,24,20,75,154,213,356,361,87,162,364,601,393,405,383,385,384,389,392,400,395,398,399,403,408,406,28,29,30,410,412,39,40,41,327,418,372,373,422,376,377,426,380,381,436,391,394,325,414,42,413,388,514,454,1460,458,448,449,452,455,457,470,459,474,462,478,482,471,473,475,476,479,480,484,487,210,332,18,16,19,69,65,15,204,11,62,496,451,598,466,483,506,504,477,508,587,512,515,516,517,521,518,520,523,524,525,526,530,531,532,472,538,539,540,543,544,547,549,550,552,554,556,536,562,567,535,576,578,467,583,463,461,460,591,510,595,456,501,202,201,499,609,611,610,615,614,617,619,618,622,625,627,626,631,630,633,635,634,638,675,652,643,642,645,647,646,650,653,655,146,147,659,148,149,661,663,368,666,370,671,369,673,676,683,687,693,63,613,629,641,657,696,698,697,700,701,704,705,709,712,714,688,716,689,720,690,691,731,729,730,727,733,734,728,738,736,740,749,747,761,751,764,758,759,760,763,762,770,806,812,772,771,779,775,781,780,783,939,788,1301,789,792,797,1222,798,801,808,804,809,816,813,824,810,825,821,822,818,829,827,830,826,837,835,834,845,843,846,842,853,851,854,850,861,859,862,858,869,867,1219,745,880,886,888,894,896,900,904,908,912,916,915,919,923,950,933,1332,838,782,935,936,1082,937,943,944,947,948,776,926,958,959,953,949,963,965,964,971,972,975,977,976,980,983,985,984,987,991,992,995,997,996,1e3,1003,1005,1004,1008,1007,1011,1012,1016,1015,1021,1020,1024,969,1027,1030,1031,1034,967,1039,968,1035,1038,1043,988,1017,1044,1056,1018,1059,1066,1070,1074,785,754,750,805,884,942,1086,817,892,1094,1334,1117,1135,1111,1109,1110,1113,1118,1124,1122,1126,1125,1129,1132,1134,757,756,755,1138,1136,769,768,767,1051,1146,1099,1098,1150,1102,1101,1154,1106,1105,1160,1119,1123,1053,1142,766,1143,1114,1239,1184,1176,1175,1177,1189,1178,1183,1181,1200,1187,1204,1192,1208,1212,1199,1197,1203,1202,1207,1206,1210,1214,938,1062,746,743,795,791,739,928,735,786,1226,1179,1329,1196,1211,1232,1234,1201,1238,1316,1244,1243,1242,1245,1248,1246,1250,1249,1255,1254,1258,1257,1256,1198,1262,1261,1260,1265,1264,1269,1275,1274,1272,1278,1276,1295,1282,1285,1297,1311,1309,1195,1312,1191,1185,1186,1320,1236,1324,1182,1229,930,931,1223,1340,1341,1344,1345,1350,1349,1353,1356,1357,1360,1361,1366,1365,1369,1404,1387,1372,1373,1378,1377,1381,1384,876,1388,874,873,1394,1097,1397,1096,1411,1412,1416,1425,793,1346,1362,1374,1390,1429,1427,1428,1433,1432,1437,1436,1440,1445,1443,1423,1449,1422,1453,1421,1420,1174,1466,1462,574,1478,575,1486,1300,1307,447,1489],indices:[3,2,1,-5,0,5,4,-2,144,0,1,-144,143,1,2,-143,141,21,41,-141,101,102,3,-5,100,101,4,-6,116,117,-119,6,7,10,-10,10,7,8,-12,120,121,119,-126,9,10,14,-14,10,11,71,-15,8,16,15,-12,65,100,5,-18,145,18,0,-145,142,194,19,-144,2,21,141,-143,22,21,2,-4,102,103,22,-4,12,23,6,-10,25,13,58,-58,13,105,12,-10,27,25,57,-57,26,24,25,-28,28,26,27,-30,29,27,56,-56,30,28,29,-32,31,29,55,-65,32,30,31,-34,33,31,64,-55,34,32,33,-36,35,33,54,-54,36,34,35,-38,37,35,53,-53,38,36,37,-40,39,37,-53,188,187,189,-191,22,42,41,-22,103,104,42,-23,12,44,43,-24,105,106,44,-13,26,46,45,-25,28,47,46,-27,30,48,47,-29,32,49,48,-31,34,50,49,-33,36,51,50,-35,38,51,-37,14,59,58,-14,14,71,72,-60,107,171,145,-145,66,65,17,-62,16,139,68,-68,94,65,-67,15,16,67,-70,60,73,74,-71,72,71,73,-61,15,73,71,-12,74,73,15,-70,67,68,76,-76,76,68,95,-97,69,67,75,-78,70,74,79,-79,74,69,77,-80,75,76,81,-81,81,76,96,-83,77,75,80,-84,78,79,85,-85,79,77,83,-86,80,81,87,-87,87,81,82,-89,83,80,86,-90,99,98,84,-91,84,85,91,-91,85,83,89,-92,93,92,60,-71,95,94,92,-94,97,93,70,-79,96,95,93,-98,82,96,97,-99,98,97,78,-85,120,125,116,-119,82,98,99,-89,100,139,16,-9,7,101,100,-9,6,102,101,-8,23,103,102,-7,23,43,104,-104,68,65,94,-96,24,105,13,-26,24,45,106,-106,19,107,144,-144,192,191,-194,118,117,-123,120,118,122,-124,121,120,123,-125,91,89,111,-113,111,89,86,-127,87,88,113,-111,88,114,-114,99,90,115,-115,90,91,112,-116,109,110,117,-117,112,111,119,-122,125,126,109,-117,110,113,122,-118,113,114,123,-123,114,115,124,-124,115,112,121,-125,86,87,110,-110,88,99,-115,111,126,125,-120,126,86,-110,129,18,-131,18,145,146,-131,128,127,169,-171,151,129,167,-169,130,166,167,-130,146,165,166,-131,132,131,135,-137,150,133,137,-150,133,134,138,-138,134,147,148,-139,68,139,-66,100,65,-140,20,141,140,-41,128,146,145,-172,128,170,165,-147,131,150,149,-136,127,151,168,-170,63,151,-128,152,153,-155,156,152,154,-156,154,153,-158,157,158,155,-155,137,138,159,-161,159,138,148,-165,136,135,161,-163,161,135,149,-164,149,137,160,-164,164,162,153,-153,160,159,156,-156,159,164,152,-157,162,161,157,-154,157,161,163,-159,163,160,155,-159,0,18,-368,165,147,134,-167,167,166,134,-134,168,167,133,-151,169,168,150,-132,170,169,131,-133,165,170,132,-148,171,107,108,-64,128,171,63,-128,20,40,172,-174,19,194,195,-175,108,107,175,-177,107,19,174,-176,173,172,177,-179,174,195,196,-180,176,175,180,-182,175,174,179,-181,179,196,197,-185,181,180,185,-187,180,179,184,-186,183,182,187,-189,184,197,188,-191,186,185,191,-193,185,184,190,-192,193,191,190,-190,178,177,182,-184,20,194,142,-142,195,194,20,-174,196,195,173,-179,203,202,204,-206,188,197,-184,197,196,198,-200,196,178,200,-199,178,183,201,-201,183,197,199,-202,199,198,202,-204,198,200,204,-203,200,201,205,-205,201,199,203,-206,209,210,207,-209,206,207,210,-212,316,315,207,-207,315,314,208,-208,313,140,41,-228,277,210,209,-279,276,211,210,-278,289,291,-291,212,215,216,-214,216,217,214,-214,293,298,292,-295,215,219,220,-217,216,220,250,-218,214,217,221,-223,245,223,211,-277,317,316,206,-225,314,315,225,-356,208,314,313,-228,228,209,208,-228,278,209,228,-280,218,215,212,-230,231,57,58,-220,219,215,218,-281,233,56,57,-232,232,233,231,-231,234,235,233,-233,235,55,56,-234,236,237,235,-235,237,64,55,-236,238,239,237,-237,239,54,64,-238,240,241,239,-239,241,53,54,-240,242,243,241,-241,243,52,53,-242,38,39,243,-243,39,52,-244,352,353,189,-188,228,227,41,-43,279,228,42,-105,218,229,43,-45,280,218,44,-107,232,230,45,-47,234,232,46,-48,236,234,47,-49,238,236,48,-50,240,238,49,-51,242,240,50,-245,38,242,-245,220,219,58,-60,220,59,72,-251,281,316,317,-343,66,61,223,-246,222,246,247,-313,94,66,-246,221,248,246,-223,60,249,252,-252,72,60,251,-251,221,217,250,-252,252,248,221,-252,246,253,254,-248,254,272,271,-248,248,255,253,-247,249,256,257,-253,252,257,255,-249,253,258,259,-255,259,260,272,-255,255,261,258,-254,256,262,263,-258,257,263,261,-256,258,264,265,-260,265,266,260,-260,261,267,264,-259,275,268,262,-275,262,268,269,-264,263,269,267,-262,270,249,60,-93,271,270,92,-95,273,256,249,-271,272,273,270,-272,260,274,273,-273,274,262,256,-274,293,291,289,-299,260,266,275,-275,276,214,222,-313,213,214,276,-278,212,213,277,-279,229,212,278,-280,229,279,104,-44,247,271,94,-246,230,231,219,-281,230,280,106,-46,225,315,316,-282,192,193,-355,291,295,-291,293,296,295,-292,294,297,296,-294,269,285,284,-268,284,299,264,-268,265,283,286,-267,266,286,-288,275,287,288,-269,268,288,285,-270,282,289,290,-284,285,294,292,-285,298,289,282,-300,283,290,295,-287,286,295,296,-288,287,296,297,-289,288,297,294,-286,264,282,283,-266,266,287,-276,284,292,298,-300,299,282,-265,62,151,-303,224,303,318,-318,301,341,340,-301,151,339,338,-303,303,302,338,-338,318,303,337,-337,305,309,308,-305,322,321,310,-307,306,310,311,-308,307,311,320,-320,247,245,-313,276,312,-246,226,40,140,-314,301,342,317,-319,301,318,336,-342,304,308,321,-323,300,340,339,-152,63,300,-152,323,325,-325,327,326,325,-324,325,328,-325,328,325,326,-330,310,331,330,-312,309,333,332,-309,332,334,321,-309,321,334,331,-311,335,323,324,-334,331,326,327,-331,333,324,328,-333,328,329,334,-333,334,329,326,-332,330,327,323,-336,330,335,320,-312,62,368,223,-62,206,211,223,-369,336,337,307,-320,338,306,307,-338,339,322,306,-339,340,304,322,-340,341,305,304,-341,336,319,305,-342,342,63,108,-282,301,300,63,-343,226,343,172,-41,225,344,356,-356,108,176,345,-282,281,345,344,-226,343,346,177,-173,344,347,357,-357,176,181,348,-346,345,348,347,-345,347,350,358,-358,181,186,351,-349,348,351,350,-348,349,352,187,-183,350,353,352,-359,186,192,354,-352,351,354,353,-351,193,189,353,-355,346,349,182,-178,226,313,314,-356,356,343,226,-356,357,346,343,-357,364,366,365,-364,352,349,-359,358,360,359,-358,357,359,361,-347,346,361,362,-350,349,362,360,-359,360,364,363,-360,359,363,365,-362,361,365,366,-363,362,366,364,-361,151,62,-130,136,148,147,-133,309,320,335,-334,309,305,319,-321,136,162,164,-149,367,62,61,-18,0,367,17,-6,224,368,62,-303,206,368,-225,62,367,18,-130,224,302,-304],vertices:[[.0157338739516657,-.3731179032440599,-.32995091819094924],[.11687308808801855,-.35310123346158495,-.30618964469864796],[.20075006391154804,-.3372663122765826,-.35346234278807576],[.21376653949833713,-.4586353926753043,-.3644821931439939],[.1462680608791268,-.4789949608683861,-.31827696717897946],[.02909283600772916,-.5189211101896504,-.3429796328397152],[.2266313792215815,-.7336079497801105,-.39612760920656453],[.18517119924079262,-.7556619933046275,-.3344087141160079],[.09432772032275161,-.7898673630747339,-.29925991060658697],[.22226867697366093,-.8420862070617336,-.4150355298249529],[.19372548486164387,-.8609811631868679,-.3710872863761998],[.12479181300360287,-.904793730260175,-.3345827036261946],[.24086914945346416,-.8390654904968264,-.4509747269824572],[.20488551963023072,-.9318172060262624,-.4513162548461153],[.18687376572179482,-.9250028362338856,-.4340865469444228],[.04034784009380665,-.9272736433976296,-.3350249887126051],[-.0078003602774770475,-.8265943526910275,-.3005164197585371],[-.04373171759553546,-.5172659428701358,-.40378309583825756],[-.09231542545243976,-.3607376308873834,-.38384447209790634],[.15854741538183958,-.13278122569164597,-.34811464995196056],[.2972139356461112,-.1430455393723507,-.44456236529564985],[.23242065243943788,-.32572418249098567,-.41988411557904415],[.24351925354214898,-.44110500646333844,-.42748771832946075],[.252313553282717,-.7308192054110468,-.4513450337412126],[.2433512022051315,-1.0189215634222721,-.4529352257357231],[.20102896114772306,-1.013305564646629,-.45336631327220467],[.2353650743605905,-1.1121492655025969,-.45227552889553296],[.19898175263022277,-1.1098628719296966,-.4533390681460935],[.2293866915720696,-1.2196178468059924,-.4572879533035819],[.19466017197241614,-1.2189368533761642,-.45971414784690423],[.23087171157634068,-1.3224632753063412,-.4639676934142127],[.19624807885840334,-1.325536119290168,-.4671454917588955],[.24046647291478918,-1.436182545573114,-.46933615431146397],[.2055254743763768,-1.446555466679321,-.4703311662145881],[.252759589885161,-1.554674573298902,-.47019247411768966],[.22173674930799536,-1.5634024649876934,-.4699648545095093],[.2687676611527293,-1.6862270170202698,-.4779183845814437],[.24120226749595863,-1.6983844161619797,-.47879375214034814],[.26825861566220754,-1.719871773499349,-.5010424340581925],[.26020185153787434,-1.7242664776298982,-.5010424340581925],[.3197018078010073,-.1407680582408563,-.5006491822967628],[.2552811060983087,-.3152468200074686,-.5018674102944807],[.2670241388944766,-.43296294716576134,-.5013808881294625],[.27804397888709087,-.7327584075746746,-.5010438432338127],[.2644026375247217,-.8445926343043153,-.5012655974254291],[.27245442726315416,-1.02588222161335,-.5010424340581925],[.261020220924998,-1.1187079104064535,-.5010424340581925],[.2536758717681,-1.2182037947072404,-.5010424340581925],[.25622632232590437,-1.3184962025504028,-.5010424340581925],[.26545098935332867,-1.4316689536195342,-.5010424340581925],[.27729740646980294,-1.5491772136269946,-.5010424340581925],[.2911469258821232,-1.6794230519850688,-.5011391413341425],[.22696242460328386,-1.6998574976400886,-.5010424340581925],[.20443881977633327,-1.5657790607582625,-.5010424340581925],[.19011830892563286,-1.4453513336655854,-.5010424340581925],[.1802932335199744,-1.2211875971834414,-.5010424340581925],[.18347766956084377,-1.1098716600114549,-.5010424340581925],[.1854752171257671,-1.0132325240803182,-.5010280889949845],[.19111136216430857,-.9315884257280386,-.5010019172437798],[.17386292777236012,-.9277026012751475,-.5010465165029092],[.08906378370924217,-.9548489029197704,-.501088208199981],[-.06665870366583032,-.5265560049363746,-.5014962457294326],[-.078245084759337,-.3738967988063995,-.5013970703273921],[-.01604988185546874,-.10566638703784598,-.5011546151739334],[.18099271508406745,-1.3273355204833734,-.5010424340581925],[-.05480312538865528,-.6709641919909357,-.3976845816302308],[-.06256868067170884,-.6769721620122628,-.5011454623726946],[-.11204301087094687,-.8565196364723835,-.32028962444107667],[-.12241249136023896,-.7232612892861385,-.3597764448083851],[-.10270766375722834,-.9002413380965681,-.33380131050760065],[-.08204717371623016,-.9101598490507312,-.413349793349582],[.13048358825780237,-.9546151482356457,-.41622589000772553],[.13346652021647087,-.958536249375217,-.5009846822849621],[.04798418570308527,-.9756241354622152,-.3987578468415579],[-.08720121785454632,-.9262443600483095,-.3680969861084156],[-.21179569784386576,-.8715243326505318,-.3265818080735104],[-.2193511682290395,-.8426875895905401,-.35474862571230337],[-.19416174854460033,-.909378787557864,-.3298906555784211],[-.1924488602128539,-.932054401327302,-.39099745248387646],[-.18823163802592574,-.9382437395312353,-.3582642004046108],[-.2750072921469279,-.8740381385655331,-.32588829577249834],[-.2801507449885968,-.8540190955864513,-.3531126330959411],[-.2821261772628692,-.8679019848375231,-.38047982856447427],[-.2675889697263625,-.9079510558978845,-.32710078160922584],[-.2765896650286004,-.9321858494747322,-.3837428909924891],[-.26883188222351695,-.9344988974654178,-.35078252710693714],[-.4267743033031933,-.8256152484594821,-.3125861453487443],[-.41525332502097906,-.8035847918147783,-.3492709045014004],[-.4280193610042675,-.8188384767338728,-.38258437724278593],[-.4226837621438738,-.8719605448408216,-.32197409659336446],[-.4306821186870878,-.8817829672406664,-.38352406982937093],[-.42711614724762226,-.8939579425458928,-.3496974477290955],[.008775288421379646,-.8553944303816083,-.5010269360786841],[-.09516815286015318,-.8814535385343818,-.42935742935838395],[-.05679333573437484,-.7560765047364248,-.5010469728121367],[-.12058950328722012,-.7788019867245188,-.41608177790285594],[-.2159641088691417,-.8602680849679791,-.3862440122234432],[-.21207272968532798,-.9019510759839108,-.3946854725540805],[-.28562601009646116,-.9074875674915717,-.39227286430224995],[-.4302202987727124,-.8450427955017354,-.38708264186980895],[.047167515897811096,-.6791209516351804,-.3398766109147567],[.1709339679007159,-.6310600310098489,-.3169962700755864],[.231705004121167,-.604650394463928,-.3798302877621651],[.2622930004641656,-.60038373931711,-.43731419796280585],[.28546111989100476,-.603102427751403,-.5010424340581925],[.2409513926336917,-.934164038387858,-.4528639521127373],[.27376094972001586,-.941379177870981,-.5010327615914043],[.049126511972002684,-.08819054030379636,-.36489817616495357],[.018218496802715256,-.08854790847755756,-.5010668748125175],[-.46377085281879393,-.7895889218239331,-.2971575278588029],[-.45636754682566677,-.7549061146403834,-.3498977496680369],[-.45828259990024145,-.877163130694887,-.3169331782810771],[-.4583390565893903,-.8942146208583772,-.3520752870961398],[-.4644544163480042,-.788427029637139,-.4077718797159925],[-.46387807156156546,-.8406193642926086,-.40818318888686617],[-.46217133385071935,-.8838545917022967,-.390958071928828],[-.49951540413434625,-.7913033024714498,-.3031468957495216],[-.49959904053125,-.7614625625238005,-.3510575484674311],[-.49896611178133565,-.7953574891604771,-.3519750117670216],[-.49996629788781516,-.8805045915173604,-.31976269188791984],[-.49952915429558187,-.8451740156564786,-.35314405463354825],[-.49990291025336314,-.889536542544342,-.35328441522238424],[-.49966809009205,-.7952897131525778,-.4044108633389465],[-.49965027767758863,-.8429828193937563,-.4015198538864043],[-.4997033879911181,-.8820197065563317,-.3935165022306816],[-.49965733022978676,-.8450465262911612,-.302257786449566],[-.463179983861855,-.8383702371607491,-.29531634182403005],[-.10272930233589711,-.16585560664736737,-.44868022412420827],[-.13205952520386238,-.19296169867262497,-.3831356739235531],[-.16003569950300478,-.3415203138292653,-.43662639584227586],[-.15760469638664498,-.30427682750690266,-.36785071255310703],[-.30677624915600726,-.232708306343606,-.415839509764528],[-.3094584587603607,-.23335704917151023,-.38487470887119096],[-.30205394026067023,-.3101054812798075,-.4024668836921931],[-.30504232331722175,-.2984135602987709,-.37090520312562025],[-.4234108463680647,-.24053069398557692,-.413733981753992],[-.41847725561324045,-.22793260570626633,-.38376743129626667],[-.42432253212569737,-.3068465952632886,-.39068407653542603],[-.4246738325849899,-.2931137252003436,-.3637795093189772],[-.051220282490342606,-.6930680519175892,-.34476092934090247],[.2719064157497424,-.20831020782295456,-.5016535894660049],[.2511784813265716,-.21130271547448226,-.42484384776810785],[.21959461292622018,-.21522704996488917,-.3620583303440626],[.12108154291979645,-.2197703431476189,-.3193187072196598],[.017971725808816563,-.23448179927691126,-.3169183587564141],[-.08431503770164961,-.23733875491264045,-.3216714052112969],[-.1516474961914186,-.2578748645795091,-.3571408700718523],[-.3083902922945819,-.26226681207120506,-.36120380338942204],[-.4237945736054485,-.256448086343494,-.3555723322009665],[-.42830959569497495,-.28334042486127,-.41496676412152544],[-.3020111190887069,-.27108235658489127,-.42389026317256434],[-.1076786919476086,-.22509585851325942,-.501982106565876],[-.5,-.21596079261187445,-.33077423087406194],[-.49999734926115896,-.185241741926996,-.38373594757883583],[-.4999942979158492,-.22088300964060242,-.38520442774998653],[-.4996264874179352,-.30819492328832554,-.3853031796734226],[-.4999790590012291,-.2835335968470868,-.3437950694118182],[-.4999947817526028,-.22138880105368064,-.43861549213281975],[-.49998963119053463,-.28295841275069156,-.42676496596632524],[-.45393069880587344,-.28608431685079405,-.3407934316895016],[-.45779052172912854,-.31559875780995467,-.3845846296300429],[-.45572155027331196,-.21269214436302508,-.4416028595855832],[-.45459817330568564,-.17278154777017896,-.38287177238820835],[-.4550752739117502,-.28277373867412203,-.42454726037207285],[-.45428692183454705,-.21439535336887278,-.3278947765054353],[-.22387354826437772,-.258915423203538,-.3567911707430216],[-.2216229702699638,-.3012862681565195,-.37382199647841524],[-.22169967944587665,-.3157089611842667,-.41712619685761],[-.22315190995641787,-.2634123716909581,-.4379340168093574],[-.21796864130093413,-.20472491918490737,-.4234266659515598],[-.22136836461827125,-.22076128227228675,-.38601531483165097],[-.02890937411386968,-.1216716394867371,-.36486806040364544],[.3824839467879616,-.0681177739569852,-.500636049440301],[.34634768622400336,-.07018745011747107,-.4531830796948856],[.2012077074144275,-.07321005280369897,-.39566503277100007],[.1407647319441383,-.061373252833299696,-.40000969250672597],[.09443549868393697,-.05275910876877471,-.5012453470437112],[.4385008380433101,.015364940330685029,-.49941540699516873],[.4366655383651865,.01783509600940625,-.47237079397524157],[.30078032161773516,.011838515259131266,-.3857192974173338],[.23099366693734358,.00789565118124369,-.4234622742639669],[.2013940810728465,.015051305299635609,-.5011811777894433],[.42289594075300685,.09580283300843684,-.5010181272020051],[.42208818338913834,.07572583843360992,-.46825062931155204],[.32322392173811354,.10887145674075316,-.40441861509030863],[.25354985399194485,.11311551988493806,-.4200373992079185],[.21850232068882236,.11390259209410225,-.5036258164432295],[.37841357261814845,.1460189270519252,-.5011937110923375],[.3790469777561918,.12570971156195965,-.4623441212176466],[.34349205709118114,.20098526945822714,-.5045958380484868],[.3353287582021377,.17853677785837951,-.46196078778581334],[.28469796618738064,.18731938779208046,-.45704552453404257],[.2517401724012108,.19016755534605145,-.504213288989222],[.2952965586006234,.20770433830738666,-.5034788011559114],[.21990634110934093,-.14534830696550788,-.39642938861788357],[.29191546850380656,-.06299651931239891,-.413714757825146],[.37619599138354365,.014600252858074758,-.3898211138513619],[.3884891912603471,.08487655292397467,-.39827697917450383],[.4472388443167665,.03054821696267429,-.3776938097443522],[.45035853043449303,.07633196735563008,-.3874609957340894],[.46825827775372786,.03383881468931116,-.4202576764152431],[.46514116173538356,.07918519220193365,-.4172287521135995],[.499099304526217,.06935808558869894,-.3669188960775318],[.4976656865095882,.0721331711231431,-.3679765748797028],[.5,.06954023101910223,-.36926747983749664],[.49912202088849766,.07276230657995475,-.37004048904318687],[.014025711286525078,-.3769411540676397,-.6762976767373217],[.1166960414031637,-.3541797839579317,-.6952468329421674],[.1997245942580851,-.3349985311975949,-.6496201591473352],[.2131222736177436,-.45565539094083046,-.6375479774540894],[.14562798177333314,-.4804601092373136,-.6833074155359549],[.02779211700108508,-.5221509297293871,-.6575783682510077],[.22611155589494125,-.733508234069406,-.6068996148655231],[.18478332150017285,-.7556419714013765,-.6679505431993294],[.09560634476535268,-.7898673838013418,-.7031108188862343],[.22231386097892714,-.8421591854482209,-.5880210534872538],[.19315857068180886,-.8606810004509666,-.6313146055716296],[.12489440971280819,-.9049104210627661,-.6673919818424863],[.24086143915531777,-.839423542648649,-.5506863856349979],[.20505381968654335,-.9317840020003741,-.5513094948305568],[.18648895551914713,-.9240108193256059,-.5691943915352168],[.04060605217527735,-.9273373155371607,-.666763229827921],[-.007180800513524488,-.8276637005734577,-.7007530843288725],[-.044430577361390944,-.5218498187511735,-.5994006037603241],[-.09172272737235188,-.3602500685259711,-.6433657393945322],[.15781937255203238,-.13131382330410718,-.6561658188313297],[.2976272242080412,-.14265525734521217,-.5587326776406795],[.23243192771414645,-.32559754291659293,-.581638175400213],[.24393950624434035,-.4369945159438957,-.5735269365686133],[.2523594834458682,-.7309077702066902,-.5505988053532309],[.24335252870803847,-1.018949627249396,-.5491405123098729],[.20114420108775977,-1.013432660206396,-.5487046628352217],[.2353650743605905,-1.1121492655025969,-.549809339220852],[.19898175263022277,-1.1098628719296966,-.5487457999702915],[.2293866915720696,-1.2196178468059924,-.544796914812803],[.19466017197241614,-1.2189368533761642,-.5423707202694806],[.23087171157634068,-1.3224632753063412,-.5381171747021722],[.19624807885840334,-1.325536119290168,-.5349393763574893],[.24046647291478918,-1.436182545573114,-.532748713804921],[.2055254743763768,-1.446555466679321,-.5317537019017968],[.252759589885161,-1.554674573298902,-.5318923939986953],[.22173674930799536,-1.5634024649876934,-.5321200136068756],[.2687676611527293,-1.6862270170202698,-.5241664835349412],[.24120226749595863,-1.6983844161619797,-.5232911159760367],[.2911469258821232,-1.6794230519850688,-.5009457267822424],[-.05484238158405624,-.672512334879628,-.6046755980191589],[-.11204118692944987,-.858167816334203,-.6822526591855005],[-.12278872074720759,-.7234529275029692,-.6435124526886958],[-.10295783391482594,-.9013768245848719,-.6674776241864128],[-.0820468835437193,-.9101596003314363,-.5887338726235435],[.13201420679949805,-.9545253191169193,-.5885892009002601],[.04599861811753991,-.9755767958897252,-.6012558942517867],[-.08862426530113582,-.9270451947251326,-.6322341933485318],[-.21114270606133784,-.8741242783480497,-.6765369446991532],[-.21932345675425013,-.8432597061489631,-.6477895851358175],[-.19589780922400163,-.9154613008245763,-.6696728310477678],[-.19382369756942086,-.9322362980384101,-.6112669806002257],[-.1909037330456141,-.940904828722118,-.6376876955180799],[-.2750377602605707,-.8769901464251846,-.6774817463945905],[-.27972848180543725,-.8543324404449898,-.6502125359650004],[-.2821780559624936,-.8677616242486872,-.6211630031847952],[-.2700695508888676,-.9143649047188103,-.6730120223066737],[-.2784561997048598,-.933285188758823,-.6178712447681147],[-.27270896004786566,-.9386388715846272,-.644430807232427],[-.42572666654255964,-.8270603075636829,-.6890976214511677],[-.4139749285710651,-.8031217179406238,-.6534145792592979],[-.4275875014016409,-.8185790832357507,-.6190361734029692],[-.4247734809342186,-.8747751767431777,-.6774742226359154],[-.4309104740898493,-.8802124707053322,-.6177584816577245],[-.42932257756716596,-.8942068276537992,-.6478504177300635],[-.09504026968928514,-.8814571864173757,-.5726744719114608],[-.12047770396409818,-.7789066353679084,-.5859783789152361],[-.21665867822715762,-.8602362488982136,-.6158060559182437],[-.21216902550572553,-.90201317290124,-.6074334493791174],[-.2855788985166584,-.9073714570340023,-.6098593848398407],[-.43029517364382436,-.8450573663071035,-.6150858166563185],[.047357951971382484,-.6792039409732931,-.662085897671771],[.17010888309262606,-.6312954749125191,-.6853874550004009],[.2292896910470028,-.6048164767731931,-.6279650613720673],[.2614418001300962,-.5997977877479002,-.5652052604867992],[.24063037893022265,-.9342026727850214,-.5488849532342162],[.047794868866341655,-.08709733609564996,-.6391417292435102],[-.46269711089548465,-.7894318141358975,-.7047319090715018],[-.4562206521736839,-.7544916653884097,-.6527699817529777],[-.45818819538281663,-.8776880113138599,-.6840246598030355],[-.4596655154522453,-.8945779997484353,-.647003124361587],[-.4650906221689427,-.7882718080704241,-.5939648850203716],[-.463919252740677,-.8408684981198102,-.5938237782736504],[-.4626553545530033,-.8834295718802838,-.6111947172817116],[-.49956175287782156,-.7910449867569396,-.701991851504443],[-.4994893809065426,-.7629113316908189,-.6509875556516588],[-.4992063691148421,-.7965032353197015,-.6498371460056525],[-.4999477326764771,-.8804072593665668,-.6821375850583272],[-.4994203452714323,-.8450264007548706,-.6487087272906495],[-.4997690715831771,-.8893797250288173,-.648749164902702],[-.49950178254285044,-.7969555313577374,-.5970185050753521],[-.4995649540052589,-.8423817477640687,-.6016025156793413],[-.4996591523900909,-.8819662319078974,-.6088373247133806],[-.4996434631575284,-.8445155313228518,-.6999270046436026],[-.46008564897644105,-.8361049640013197,-.7073144236917588],[-.10073992105449436,-.17157981904296205,-.555338224063406],[-.1309199763004063,-.19583428217072602,-.6189802841047122],[-.1603829738187088,-.33934092136975347,-.5731183684916371],[-.1550045641496558,-.30652694951594234,-.635000957149896],[-.3073782534830513,-.23318661427458193,-.5859535225306877],[-.30983226313420265,-.23310039158563362,-.6162887164368828],[-.30155925830943725,-.31064435235912646,-.6003238186936125],[-.3041533383769137,-.2944227348501558,-.6326613687377685],[-.42350301241183413,-.24037246706071363,-.5880192813622765],[-.4187311461969597,-.22861152647530247,-.617957208374464],[-.42394422489628475,-.30679386677273945,-.6121638105616315],[-.42450341841466954,-.29365396423578527,-.6381033676399208],[-.050511349593037935,-.6930275313991051,-.6577023859094986],[.25107791582494254,-.2106731033056884,-.5776820566565604],[.2192018022529154,-.21441363423705845,-.6407266204080451],[.12002829961172035,-.21854890341626987,-.6841317334595516],[.018076934070619832,-.23520737564037597,-.6855676521296596],[-.08445946070563803,-.23725284312281097,-.6836694057432822],[-.15250342219209378,-.25917744898086603,-.6452775202558816],[-.30830547901497224,-.26038023476508687,-.6396968292568307],[-.42320864794449853,-.2558019757947956,-.6466892406112426],[-.42830960605827895,-.28334042486127,-.5871181039948594],[-.30200867334897236,-.2710837038144061,-.5781968019642602],[-.4999985122181752,-.21595045003452223,-.6713120051984457],[-.49999734926115896,-.185241741926996,-.6183489205375491],[-.4999942979158492,-.22088300964060242,-.6168804403663984],[-.4995978163659697,-.30772459510139893,-.6161100012600903],[-.49998198436762503,-.2836024506385979,-.6582798913859809],[-.4999947817526028,-.22138880105368064,-.5634693759835652],[-.4999928085147582,-.28288149630869946,-.5752844441055601],[-.45392641357968594,-.286066927226749,-.661290731722214],[-.45751414795746775,-.31472307935193145,-.6155342989984971],[-.4557215088200961,-.21269243453553593,-.5604824956060879],[-.4545633785126395,-.17269791590722067,-.6192779389210551],[-.4550770201284675,-.2827709820352686,-.5775334054245562],[-.45481834169831864,-.21375772000281373,-.6741556647151941],[-.22337188144627562,-.25835456119321565,-.6445138380237555],[-.2199321557756524,-.30128678632171746,-.6291575149422399],[-.21785663471173305,-.31708638936682365,-.5861226827412289],[-.22315190995641787,-.2634123716909581,-.5641508616703315],[-.2178508312615154,-.20608462611769252,-.578587260167566],[-.22106061594387116,-.2214999371253491,-.6155040174243256],[-.029719618670688674,-.122189721778312,-.6385841005840235],[.34666016056500926,-.07014748921740083,-.5495322503812179],[.2019645602292438,-.07246750134834762,-.6066075769599266],[.14036450114519805,-.06075821146987381,-.6026488155737642],[.43659929612627335,.01781901216166004,-.529588631528358],[.29904542162837733,.012538991700404511,-.6157889979199253],[.22906095220199474,.010646362224773553,-.5769670094099192],[.4226667873758404,.07812415568927944,-.5327075403982874],[.3214059495042114,.11018668437294143,-.5972140813476878],[.2518522618968436,.11460327580145468,-.57895484137738],[.37855998537649727,.1268128230886919,-.538634003033968],[.3352456859575933,.1802060159538459,-.5380595858220658],[.2827380581424406,.18843995112268164,-.5398540903541502],[.21984714591712073,-.1446188547263621,-.6069750804449607],[.2922245436811136,-.06272404732467912,-.5887529100129183],[.37621986843586774,.014609579831638908,-.6122796722999058],[.3901393608765269,.08566321060098037,-.6027022591322865],[.44725144609438205,.030569150836673664,-.6243769020988232],[.45060832751314794,.07707485043670814,-.6142136202684257],[.4682288459704811,.03379727856703896,-.5817703593422244],[.46533209524754504,.07914506548900002,-.5846038006412682],[.499099304526217,.06935808558869894,-.6351659720388532],[.4976657694160199,.07213312966992724,-.6341083243265939],[.5,.06954023101910223,-.6328173882788882],[.4991221037949293,.07276230657995475,-.632044399799806],[-.07365745736226581,-.40672151740641727,-.3965094555042796],[-.07860183113486058,-.4044202110391185,-.6115684698390338]]}},function(t,e){t.exports="#include <fog_pars_vertex>\n\n // for animation, all between 0 and 1\nuniform float animation_time_x;\nuniform float animation_time_y;\nuniform float animation_time_z;\nuniform float animation_time_vx;\nuniform float animation_time_vy;\nuniform float animation_time_vz;\nuniform float animation_time_size;\nuniform float animation_time_color;\n\nuniform vec2 xlim;\nuniform vec2 ylim;\nuniform vec2 zlim;\n\nvarying vec4 vertex_color;\nvarying vec3 vertex_position;\nvarying vec2 vertex_uv;\n\n#ifdef AS_LINE\nattribute vec3 position_previous;\n#else\nattribute float x;\nattribute float x_previous;\nattribute float y;\nattribute float y_previous;\nattribute float z;\nattribute float z_previous;\n\nattribute vec3 v;\nattribute vec3 v_previous;\n\n\nattribute float size;\nattribute float size_previous;\n#endif\n\nattribute vec4 color;\nattribute vec4 color_previous;\n\n\n\nvoid main(void) {\n    vec3 origin = vec3(xlim.x, ylim.x, zlim.x);\n    vec3 size_viewport = vec3(xlim.y, ylim.y, zlim.y) - origin;\n    vec3 animation_time = vec3(animation_time_x, animation_time_y, animation_time_z);\n    vec3 animation_time_v = vec3(animation_time_vx, animation_time_vy, animation_time_vz);\n\n#ifdef AS_LINE\n    vec3 model_pos = (mix(position_previous, position, animation_time) - origin) / size_viewport - 0.5;\n    vec4 view_pos = modelViewMatrix * vec4(model_pos, 1.0);\n#else\n    vec3 vector = v;\n    vec3 vector_previous = v_previous;\n    vec3 position_offset = vec3(x, y, z);\n    vec3 position_offset_previous = vec3(x_previous, y_previous, z_previous);\n\n    // assume the vector points to the y axis\n    vec3 vector_current = mix(normalize(vector_previous), normalize(vector), animation_time_v)\n           * mix(length(vector_previous), length(vector), (animation_time_vx+ animation_time_vy+ animation_time_vz)/3.);\n    vec3 y_axis = normalize(vector_current);\n    // we may have bad luck, and alight with 1 vector, so take two vectors, and we'll always find a non-zero vector\n    vec3 some_z_vector_a = vec3(0., 1., 1.);\n    vec3 some_z_vector_b = normalize(vec3(0., 2., 1.));\n    vec3 x_axis = normalize(cross(y_axis, some_z_vector_a)  + cross(y_axis, some_z_vector_b));\n    vec3 z_axis = -normalize(cross(y_axis, x_axis)); // - to keep it right handed\n    //float vector_length = length(vector_current);\n    // the following matrix should point it to the direction of 'vector'\n    mat3 move_to_vector = mat3(x_axis, y_axis, z_axis);\n\n    float s = mix(size_previous/100., size/100., animation_time_size);\n    vec3 model_pos = (mix(position_offset_previous, position_offset, animation_time) - origin) / size_viewport - 0.5;\n    //vec3 pos = (pos_object ) / size;// - 0.5;\n    #ifdef USE_SPRITE\n        // if we are a sprite, we add the position in view coordinates, and need to \n        vec4 view_pos = modelViewMatrix * vec4(model_pos, 1.0);\n        view_pos += vec4((position.xy)*(s*0.5),0,0);\n    #else\n        model_pos += move_to_vector * (position)*s;\n        vec4 view_pos = modelViewMatrix * vec4(model_pos, 1.0);\n    #endif\n#endif\n    vec4 mvPosition = view_pos;\n    gl_Position = projectionMatrix * view_pos;\n    vec3 positionEye = ( modelViewMatrix * vec4( model_pos, 1.0 ) ).xyz;\n    vertex_position = positionEye;\n    vertex_uv = position.xy / 2. - 0.5;\n#ifdef USE_RGB\n    vertex_color = vec4(model_pos + vec3(0.5, 0.5, 0.5), 1.0);\n#else\n    vertex_color = mix(color_previous, color, animation_time_color);\n#endif\n\n    #include <fog_vertex>\n}\n"},function(t,e){t.exports="#include <fog_pars_fragment>\n\nvarying vec4 vertex_color;\nvarying vec3 vertex_position;\nvarying vec2 vertex_uv;\n\n#ifdef USE_TEXTURE\nuniform sampler2D texture;\nuniform sampler2D texture_previous;\nuniform float animation_time_texture;\n#endif\n\n\nvoid main(void) {\n#ifdef USE_RGB\n    gl_FragColor = vertex_color;\n#else\n #ifdef AS_LINE\n    gl_FragColor = vertex_color;\n #else\n  #ifdef USE_SPRITE\n   #ifdef USE_TEXTURE\n    gl_FragColor = mix(texture2D(texture_previous, vertex_uv), texture2D(texture, vertex_uv), animation_time_texture);\n   #else\n    gl_FragColor = vertex_color;\n   #endif\n  #else\n    vec3 fdx = dFdx( vertex_position );\n    vec3 fdy = dFdy( vertex_position );\n    vec3 normal = normalize( cross( fdx, fdy ) );\n    float diffuse = dot( normal, vec3( 0.0, 0.0, 1.0 ) );\n\n    gl_FragColor = vec4(clamp(diffuse, 0.2, 1.) * vertex_color.rgb, vertex_color.a);\n  #endif\n #endif\n#endif\n\t#include <fog_fragment>\n}\n"},function(t,e){t.exports=" // for animation, all between 0 and 1\nuniform float animation_time_x;\nuniform float animation_time_y;\nuniform float animation_time_z;\nuniform float animation_time_u;\nuniform float animation_time_v;\nuniform float animation_time_color;\n\nuniform vec2 xlim;\nuniform vec2 ylim;\nuniform vec2 zlim;\n\nvarying vec4 vertex_color;\nvarying vec3 vertex_position;\n\nattribute vec3 position_previous;\n\n#ifdef USE_TEXTURE\n    attribute float u;\n    attribute float v;\n    attribute float u_previous;\n    attribute float v_previous;\n    varying vec2 vertex_uv;\n#endif\n\nattribute vec4 color;\nattribute vec4 color_previous;\n\n\n\nvoid main(void) {\n    vec3 origin = vec3(xlim.x, ylim.x, zlim.x);\n    vec3 size_viewport = vec3(xlim.y, ylim.y, zlim.y) - origin;\n\n    vec3 pos = (mix(position_previous, position, vec3(animation_time_x, animation_time_y, animation_time_z))\n                - origin) / size_viewport - 0.5;\n    gl_Position = projectionMatrix *\n                modelViewMatrix *\n                vec4(pos,1.0);\n    vec3 positionEye = ( modelViewMatrix * vec4( pos, 1.0 ) ).xyz;\n    vertex_position = positionEye;\n#ifdef USE_TEXTURE\n    vertex_uv = vec2(mix(u_previous, u, animation_time_u), mix(v_previous, v, animation_time_v));\n#endif\n\n#ifdef USE_RGB\n    vertex_color = vec4(pos + vec3(0.5, 0.5, 0.5), 1.0);\n#else\n    vertex_color = mix(color_previous, color, animation_time_color);\n#endif\n}\n"},function(t,e){t.exports="varying vec4 vertex_color;\nvarying vec3 vertex_position;\nvarying vec2 vertex_uv;\n\n#ifdef USE_TEXTURE\n    uniform sampler2D texture;\n    uniform sampler2D texture_previous;\n    uniform float animation_time_texture;\n#endif\n\n\nvoid main(void) {\n#ifdef USE_RGB\n    gl_FragColor = vec4(vertex_color.rgb, 1.0);\n#else\n#ifdef AS_LINE\n    gl_FragColor = vec4(vertex_color.rgb, vertex_color.a);\n#else\n    vec3 fdx = dFdx( vertex_position );\n    vec3 fdy = dFdy( vertex_position );\n    vec3 normal = normalize( cross( fdx, fdy ) );\n    float diffuse = dot( normal, vec3( 0.0, 0.0, 1.0 ) );\n\n#ifdef USE_TEXTURE\n    vec4 sample = mix(texture2D(texture_previous, vertex_uv), texture2D(texture, vertex_uv), animation_time_texture);\n    gl_FragColor = vec4(clamp(diffuse, 0.2, 1.) * sample.rgb, 1.0);\n#else\n    gl_FragColor = vec4(clamp(diffuse, 0.2, 1.) * vertex_color.rgb, vertex_color.a);\n#endif // USE_TEXTURE\n#endif // AS_LINE\n#endif // USE_RGB\n}\n"},function(t,e){t.exports="varying vec4 vertex_color;\n\nvoid main(void) {\n    gl_FragColor = vertex_color;\n}\n"},function(t,e){t.exports="varying vec4 vertex_color;\nuniform vec3 scale;\nuniform vec3 offset;\n\nvoid main(void) {\n    vec3 pos = position;\n    gl_Position = projectionMatrix *\n                modelViewMatrix *\n                vec4(pos,1.0);\n    //vertex_color = vec4((pos + vec3(0.5, 0.5, 0.5))*scale + offset, 1);\n    vertex_color = vec4((pos + vec3(0.5, 0.5, 0.5)), 1);\n}\n"},function(t,e){THREE.OrbitControls=function(t,e){var n,r,i,a,o;this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return p.phi},this.getAzimuthalAngle=function(){return p.theta},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(c),s.update(),f=h.NONE},this.update=(n=new THREE.Vector3,r=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),i=r.clone().inverse(),a=new THREE.Vector3,o=new THREE.Quaternion,function(){var t=s.object.position;return n.copy(t).sub(s.target),n.applyQuaternion(r),p.setFromVector3(n),s.autoRotate&&f===h.NONE&&L(2*Math.PI/60/60*s.autoRotateSpeed),p.theta+=m.theta,p.phi+=m.phi,p.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,p.theta)),p.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,p.phi)),p.makeSafe(),p.radius*=v,p.radius=Math.max(s.minDistance,Math.min(s.maxDistance,p.radius)),s.target.add(g),n.setFromSpherical(p),n.applyQuaternion(i),t.copy(s.target).add(n),s.object.lookAt(s.target),!0===s.enableDamping?(m.theta*=1-s.dampingFactor,m.phi*=1-s.dampingFactor):m.set(0,0,0),v=1,g.set(0,0,0),!!(y||a.distanceToSquared(s.object.position)>d||8*(1-o.dot(s.object.quaternion))>d)&&(s.dispatchEvent(c),a.copy(s.object.position),o.copy(s.object.quaternion),y=!1,!0)}),this.dispose=function(){s.domElement.removeEventListener("contextmenu",W,!1),s.domElement.removeEventListener("mousedown",D,!1),s.domElement.removeEventListener("wheel",B,!1),s.domElement.removeEventListener("touchstart",H,!1),s.domElement.removeEventListener("touchend",V,!1),s.domElement.removeEventListener("touchmove",G,!1),document.removeEventListener("mousemove",k,!1),document.removeEventListener("mouseup",F,!1),window.removeEventListener("keydown",j,!1)};var s=this,c={type:"change"},l={type:"start"},u={type:"end"},h={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},f=h.NONE,d=1e-6,p=new THREE.Spherical,m=new THREE.Spherical,v=1,g=new THREE.Vector3,y=!1,_=new THREE.Vector2,x=new THREE.Vector2,b=new THREE.Vector2,w=new THREE.Vector2,M=new THREE.Vector2,E=new THREE.Vector2,T=new THREE.Vector2,S=new THREE.Vector2,A=new THREE.Vector2;function R(){return Math.pow(.95,s.zoomSpeed)}function L(t){m.theta-=t}function C(t){m.phi-=t}var P,O=(P=new THREE.Vector3,function(t,e){P.setFromMatrixColumn(e,0),P.multiplyScalar(-t),g.add(P)}),N=function(){var t=new THREE.Vector3;return function(e,n){t.setFromMatrixColumn(n,1),t.multiplyScalar(e),g.add(t)}}(),I=function(){var t=new THREE.Vector3;return function(e,n){var r=s.domElement===document?s.domElement.body:s.domElement;if(s.object instanceof THREE.PerspectiveCamera){var i=s.object.position;t.copy(i).sub(s.target);var a=t.length();a*=Math.tan(s.object.fov/2*Math.PI/180),O(2*e*a/r.clientHeight,s.object.matrix),N(2*n*a/r.clientHeight,s.object.matrix)}else s.object instanceof THREE.OrthographicCamera?(O(e*(s.object.right-s.object.left)/s.object.zoom/r.clientWidth,s.object.matrix),N(n*(s.object.top-s.object.bottom)/s.object.zoom/r.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)}}();function z(t){s.object instanceof THREE.PerspectiveCamera?v/=t:s.object instanceof THREE.OrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*t)),s.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function U(t){s.object instanceof THREE.PerspectiveCamera?v*=t:s.object instanceof THREE.OrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/t)),s.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function D(t){if(!1!==s.enabled){if(t.preventDefault(),t.button===s.mouseButtons.ORBIT){if(!1===s.enableRotate)return;!function(t){_.set(t.clientX,t.clientY)}(t),f=h.ROTATE}else if(t.button===s.mouseButtons.ZOOM){if(!1===s.enableZoom)return;!function(t){T.set(t.clientX,t.clientY)}(t),f=h.DOLLY}else if(t.button===s.mouseButtons.PAN){if(!1===s.enablePan)return;!function(t){w.set(t.clientX,t.clientY)}(t),f=h.PAN}f!==h.NONE&&(document.addEventListener("mousemove",k,!1),document.addEventListener("mouseup",F,!1),s.dispatchEvent(l))}}function k(t){if(!1!==s.enabled)if(t.preventDefault(),f===h.ROTATE){if(!1===s.enableRotate)return;!function(t){x.set(t.clientX,t.clientY),b.subVectors(x,_);var e=s.domElement===document?s.domElement.body:s.domElement;L(2*Math.PI*b.x/e.clientWidth*s.rotateSpeed),C(2*Math.PI*b.y/e.clientHeight*s.rotateSpeed),_.copy(x),s.update()}(t)}else if(f===h.DOLLY){if(!1===s.enableZoom)return;!function(t){S.set(t.clientX,t.clientY),A.subVectors(S,T),A.y>0?z(R()):A.y<0&&U(R()),T.copy(S),s.update()}(t)}else if(f===h.PAN){if(!1===s.enablePan)return;!function(t){M.set(t.clientX,t.clientY),E.subVectors(M,w),I(E.x,E.y),w.copy(M),s.update()}(t)}}function F(t){!1!==s.enabled&&(document.removeEventListener("mousemove",k,!1),document.removeEventListener("mouseup",F,!1),s.dispatchEvent(u),f=h.NONE)}function B(t){!1===s.enabled||!1===s.enableZoom||f!==h.NONE&&f!==h.ROTATE||(t.preventDefault(),t.stopPropagation(),function(t){t.deltaY<0?U(R()):t.deltaY>0&&z(R()),s.update()}(t),s.dispatchEvent(l),s.dispatchEvent(u))}function j(t){!1!==s.enabled&&!1!==s.enableKeys&&!1!==s.enablePan&&function(t){switch(t.keyCode){case s.keys.UP:I(0,s.keyPanSpeed),s.update();break;case s.keys.BOTTOM:I(0,-s.keyPanSpeed),s.update();break;case s.keys.LEFT:I(s.keyPanSpeed,0),s.update();break;case s.keys.RIGHT:I(-s.keyPanSpeed,0),s.update()}}(t)}function H(t){if(!1!==s.enabled){switch(t.touches.length){case 1:if(!1===s.enableRotate)return;!function(t){_.set(t.touches[0].pageX,t.touches[0].pageY)}(t),f=h.TOUCH_ROTATE;break;case 2:if(!1===s.enableZoom)return;!function(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);T.set(0,r)}(t),f=h.TOUCH_DOLLY;break;case 3:if(!1===s.enablePan)return;!function(t){w.set(t.touches[0].pageX,t.touches[0].pageY)}(t),f=h.TOUCH_PAN;break;default:f=h.NONE}f!==h.NONE&&s.dispatchEvent(l)}}function G(t){if(!1!==s.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(!1===s.enableRotate)return;if(f!==h.TOUCH_ROTATE)return;!function(t){x.set(t.touches[0].pageX,t.touches[0].pageY),b.subVectors(x,_);var e=s.domElement===document?s.domElement.body:s.domElement;L(2*Math.PI*b.x/e.clientWidth*s.rotateSpeed),C(2*Math.PI*b.y/e.clientHeight*s.rotateSpeed),_.copy(x),s.update()}(t);break;case 2:if(!1===s.enableZoom)return;if(f!==h.TOUCH_DOLLY)return;!function(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);S.set(0,r),A.subVectors(S,T),A.y>0?U(R()):A.y<0&&z(R()),T.copy(S),s.update()}(t);break;case 3:if(!1===s.enablePan)return;if(f!==h.TOUCH_PAN)return;!function(t){M.set(t.touches[0].pageX,t.touches[0].pageY),E.subVectors(M,w),I(E.x,E.y),w.copy(M),s.update()}(t);break;default:f=h.NONE}}function V(t){!1!==s.enabled&&(s.dispatchEvent(u),f=h.NONE)}function W(t){t.preventDefault()}s.domElement.addEventListener("contextmenu",W,!1),s.domElement.addEventListener("mousedown",D,!1),s.domElement.addEventListener("wheel",B,!1),s.domElement.addEventListener("touchstart",H,!1),s.domElement.addEventListener("touchend",V,!1),s.domElement.addEventListener("touchmove",G,!1),window.addEventListener("keydown",j,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(t){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!t}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(t){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!t}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(t){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!t}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(t){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!t}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(t){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!t}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(t){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=t}}})},function(t,e){THREE.TrackballControls=function(t,e){var n=this,r={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new THREE.Vector3;var i=new THREE.Vector3,a=r.NONE,o=r.NONE,s=new THREE.Vector3,c=new THREE.Vector2,l=new THREE.Vector2,u=new THREE.Vector3,h=0,f=new THREE.Vector2,d=new THREE.Vector2,p=0,m=0,v=new THREE.Vector2,g=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var y={type:"change"},_={type:"start"},x={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var t=this.domElement.getBoundingClientRect(),e=this.domElement.ownerDocument.documentElement;this.screen.left=t.left+window.pageXOffset-e.clientLeft,this.screen.top=t.top+window.pageYOffset-e.clientTop,this.screen.width=t.width,this.screen.height=t.height}},this.handleEvent=function(t){"function"==typeof this[t.type]&&this[t.type](t)};var b,w,M,E,T,S,A,R,L,C,P,O=(b=new THREE.Vector2,function(t,e){var r=n.domElement===document?n.domElement.body:n.domElement;return b.set(t/r.clientWidth,e/r.clientHeight),b}),N=function(){new THREE.Vector2;return function(t,e){return O(2*t*Math.PI,2*-e*Math.PI)}}();function I(t){!1!==n.enabled&&(window.removeEventListener("keydown",I),o=a,a===r.NONE&&(t.keyCode!==n.keys[r.ROTATE]||n.noRotate?t.keyCode!==n.keys[r.ZOOM]||n.noZoom?t.keyCode!==n.keys[r.PAN]||n.noPan||(a=r.PAN):a=r.ZOOM:a=r.ROTATE))}function z(t){!1!==n.enabled&&(a=o,window.addEventListener("keydown",I,!1))}function U(t){!1!==n.enabled&&(t.preventDefault(),t.stopPropagation(),a===r.NONE&&(a=t.button),a!==r.ROTATE||n.noRotate?a!==r.ZOOM||n.noZoom?a!==r.PAN||n.noPan||(v.copy(O(t.pageX,t.pageY)),g.copy(v)):(f.copy(O(t.pageX,t.pageY)),d.copy(f)):(l.copy(N(t.pageX,t.pageY)),c.copy(l)),document.addEventListener("mousemove",D,!1),document.addEventListener("mouseup",k,!1),n.dispatchEvent(_))}function D(t){!1!==n.enabled&&(t.preventDefault(),t.stopPropagation(),a!==r.ROTATE||n.noRotate?a!==r.ZOOM||n.noZoom?a!==r.PAN||n.noPan||g.copy(O(t.pageX,t.pageY)):d.copy(O(t.pageX,t.pageY)):(c.copy(l),l.copy(N(t.pageX,t.pageY))),n.update())}function k(t){!1!==n.enabled&&(t.preventDefault(),t.stopPropagation(),a=r.NONE,document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",k),n.dispatchEvent(x))}function F(t){if(!1!==n.enabled){switch(t.preventDefault(),t.stopPropagation(),t.deltaMode){case 2:f.y-=.025*t.deltaY;break;case 1:f.y-=.01*t.deltaY;break;default:f.y-=25e-5*t.deltaY}n.dispatchEvent(_),n.dispatchEvent(x),n.update()}}function B(t){if(!1!==n.enabled){switch(t.touches.length){case 1:a=r.TOUCH_ROTATE,l.copy(N(t.touches[0].pageX,t.touches[0].pageY)),c.copy(l);break;default:a=r.TOUCH_ZOOM_PAN;var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY;m=p=Math.sqrt(e*e+i*i);var o=(t.touches[0].pageX+t.touches[1].pageX)/2,s=(t.touches[0].pageY+t.touches[1].pageY)/2;v.copy(O(o,s)),g.copy(v)}n.dispatchEvent(_)}}function j(t){if(!1!==n.enabled){switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:c.copy(l),l.copy(N(t.touches[0].pageX,t.touches[0].pageY));break;default:var e=t.touches[0].pageX-t.touches[1].pageX,r=t.touches[0].pageY-t.touches[1].pageY;m=Math.sqrt(e*e+r*r);var i=(t.touches[0].pageX+t.touches[1].pageX)/2,a=(t.touches[0].pageY+t.touches[1].pageY)/2;g.copy(O(i,a))}n.update()}}function H(t){if(!1!==n.enabled){switch(t.touches.length){case 0:a=r.NONE;break;case 1:a=r.TOUCH_ROTATE,l.copy(N(t.touches[0].pageX,t.touches[0].pageY)),c.copy(l)}n.dispatchEvent(x),n.update()}}function G(t){t.preventDefault()}this.rotateCamera=(M=new THREE.Vector3,E=new THREE.Quaternion,T=new THREE.Vector3,S=new THREE.Vector3,A=new THREE.Vector3,R=new THREE.Vector3,function(){R.set(l.x-c.x,l.y-c.y,0),(w=R.length())?(s.copy(n.object.position).sub(n.target),T.copy(s).normalize(),S.copy(n.object.up).normalize(),A.crossVectors(S,T).normalize(),S.setLength(l.y-c.y),A.setLength(l.x-c.x),R.copy(S.add(A)),M.crossVectors(R,s).normalize(),w*=n.rotateSpeed,E.setFromAxisAngle(M,w),s.applyQuaternion(E),n.object.up.applyQuaternion(E),u.copy(M),h=w):!n.staticMoving&&h&&(h*=Math.sqrt(1-n.dynamicDampingFactor),s.copy(n.object.position).sub(n.target),E.setFromAxisAngle(u,h),s.applyQuaternion(E),n.object.up.applyQuaternion(E)),c.copy(l)}),this.zoomCamera=function(){var t;a===r.TOUCH_ZOOM_PAN?(t=p/m,p=m,s.multiplyScalar(t)):(1!==(t=1+(d.y-f.y)*n.zoomSpeed)&&t>0&&s.multiplyScalar(t),n.staticMoving?f.copy(d):f.y+=(d.y-f.y)*this.dynamicDampingFactor)},this.panCamera=(L=new THREE.Vector2,C=new THREE.Vector3,P=new THREE.Vector3,function(){L.copy(g).sub(v),L.lengthSq()&&(L.multiplyScalar(s.length()*n.panSpeed),P.copy(s).cross(n.object.up).setLength(L.x),P.add(C.copy(n.object.up).setLength(L.y)),n.object.position.add(P),n.target.add(P),n.staticMoving?v.copy(g):v.add(L.subVectors(g,v).multiplyScalar(n.dynamicDampingFactor)))}),this.checkDistances=function(){n.noZoom&&n.noPan||(s.lengthSq()>n.maxDistance*n.maxDistance&&(n.object.position.addVectors(n.target,s.setLength(n.maxDistance)),f.copy(d)),s.lengthSq()<n.minDistance*n.minDistance&&(n.object.position.addVectors(n.target,s.setLength(n.minDistance)),f.copy(d)))},this.update=function(){s.subVectors(n.object.position,n.target),n.noRotate||n.rotateCamera(),n.noZoom||n.zoomCamera(),n.noPan||n.panCamera(),n.object.position.addVectors(n.target,s),n.checkDistances(),n.object.lookAt(n.target),i.distanceToSquared(n.object.position)>1e-6&&(n.dispatchEvent(y),i.copy(n.object.position))},this.reset=function(){a=r.NONE,o=r.NONE,n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.up.copy(n.up0),s.subVectors(n.object.position,n.target),n.object.lookAt(n.target),i.copy(n.object.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",G,!1),this.domElement.removeEventListener("mousedown",U,!1),this.domElement.removeEventListener("wheel",F,!1),this.domElement.removeEventListener("touchstart",B,!1),this.domElement.removeEventListener("touchend",H,!1),this.domElement.removeEventListener("touchmove",j,!1),document.removeEventListener("mousemove",D,!1),document.removeEventListener("mouseup",k,!1),window.removeEventListener("keydown",I,!1),window.removeEventListener("keyup",z,!1)},this.domElement.addEventListener("contextmenu",G,!1),this.domElement.addEventListener("mousedown",U,!1),this.domElement.addEventListener("wheel",F,!1),this.domElement.addEventListener("touchstart",B,!1),this.domElement.addEventListener("touchend",H,!1),this.domElement.addEventListener("touchmove",j,!1),window.addEventListener("keydown",I,!1),window.addEventListener("keyup",z,!1),this.handleResize(),this.update()},THREE.TrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.TrackballControls.prototype.constructor=THREE.TrackballControls},function(t,e){THREE.DeviceOrientationControls=function(t){var e=this;this.object=t,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alpha=0,this.alphaOffsetAngle=0;var n,r,i,a,o=function(t){e.deviceOrientation=t},s=function(){e.screenOrientation=window.orientation||0},c=(n=new THREE.Vector3(0,0,1),r=new THREE.Euler,i=new THREE.Quaternion,a=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(t,e,o,s,c){r.set(o,e,-s,"YXZ"),t.setFromEuler(r),t.multiply(a),t.multiply(i.setFromAxisAngle(n,-c))});this.connect=function(){s(),window.addEventListener("orientationchange",s,!1),window.addEventListener("deviceorientation",o,!1),e.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",s,!1),window.removeEventListener("deviceorientation",o,!1),e.enabled=!1},this.update=function(){if(!1!==e.enabled){var t=e.deviceOrientation.alpha?THREE.Math.degToRad(e.deviceOrientation.alpha)+this.alphaOffsetAngle:0,n=e.deviceOrientation.beta?THREE.Math.degToRad(e.deviceOrientation.beta):0,r=e.deviceOrientation.gamma?THREE.Math.degToRad(e.deviceOrientation.gamma):0,i=e.screenOrientation?THREE.Math.degToRad(e.screenOrientation):0;c(e.object.quaternion,t,n,r,i),this.alpha=t}},this.updateAlphaOffsetAngle=function(t){this.alphaOffsetAngle=t,this.update()},this.dispose=function(){this.disconnect()},this.connect()}},function(t,e){THREE.StereoEffect=function(t){var e=new THREE.StereoCamera;e.aspect=.5,this.setEyeSeparation=function(t){e.eyeSep=t},this.setSize=function(e,n){t.setSize(e,n)},this.render=function(n,r){n.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),e.update(r);var i=t.getSize();t.autoClear&&t.clear(),t.setScissorTest(!0),t.setScissor(0,0,i.width/2,i.height),t.setViewport(0,0,i.width/2,i.height),t.render(n,e.cameraL),t.setScissor(i.width/2,0,i.width/2,i.height),t.setViewport(i.width/2,0,i.width/2,i.height),t.render(n,e.cameraR),t.setScissorTest(!1)}}},function(t,e){var n=n||{};window.THREEx=n,n.FullScreen=n.FullScreen||{},n.FullScreen.available=function(){return this._hasWebkitFullScreen||this._hasMozFullScreen},n.FullScreen.activated=function(){return this._hasWebkitFullScreen?document.webkitIsFullScreen:this._hasMozFullScreen?document.mozFullScreen:void console.assert(!1)},n.FullScreen.request=function(t){t=t||document.body,this._hasWebkitFullScreen?t.webkitRequestFullScreen():this._hasMozFullScreen?t.mozRequestFullScreen():console.assert(!1)},n.FullScreen.cancel=function(){this._hasWebkitFullScreen?document.webkitCancelFullScreen():this._hasMozFullScreen?document.mozCancelFullScreen():console.assert(!1)},n.FullScreen.element=function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement},n.FullScreen.addFullScreenChangeListener=function(t){document.addEventListener("webkitfullscreenchange",t,!1),document.addEventListener("mozfullscreenchange",t,!1),document.addEventListener("fullscreenchange",t,!1),document.addEventListener("MSFullscreenChange",t,!1)},n.FullScreen.removeFullScreenChangeListener=function(t){document.removeEventListener("webkitfullscreenchange",t,!1),document.removeEventListener("mozfullscreenchange",t,!1),document.removeEventListener("fullscreenchange",t,!1),document.removeEventListener("MSFullscreenChange",t,!1)},n.FullScreen._hasWebkitFullScreen="webkitCancelFullScreen"in document,n.FullScreen._hasMozFullScreen="mozCancelFullScreen"in document},function(t,e){THREE.CombinedCamera=function(t,e,n,r,i,a,o){THREE.Camera.call(this),this.fov=n,this.far=i,this.near=r,this.left=-t/2,this.right=t/2,this.top=e/2,this.bottom=-e/2,this.aspect=t/e,this.zoom=1,this.view=null,this.cameraO=new THREE.OrthographicCamera(t/-2,t/2,e/2,e/-2,a,o),this.cameraP=new THREE.PerspectiveCamera(n,t/e,r,i),this.toPerspective()},THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype),THREE.CombinedCamera.prototype.constructor=THREE.CombinedCamera,THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near,this.far=this.cameraP.far,this.cameraP.aspect=this.aspect,this.cameraP.fov=this.fov/this.zoom,this.cameraP.view=this.view,this.cameraP.updateProjectionMatrix(),this.projectionMatrix=this.cameraP.projectionMatrix,this.inPerspectiveMode=!0,this.inOrthographicMode=!1},THREE.CombinedCamera.prototype.toOrthographic=function(){var t=this.fov,e=this.cameraP.aspect,n=(this.cameraP.near+this.cameraP.far)/2,r=Math.tan(t*Math.PI/180/2)*n,i=r*e;r/=this.zoom,i/=this.zoom,this.cameraO.left=-i,this.cameraO.right=i,this.cameraO.top=r,this.cameraO.bottom=-r,this.cameraO.view=this.view,this.cameraO.updateProjectionMatrix(),this.near=this.cameraO.near,this.far=this.cameraO.far,this.projectionMatrix=this.cameraO.projectionMatrix,this.inPerspectiveMode=!1,this.inOrthographicMode=!0},THREE.CombinedCamera.prototype.copy=function(t){return THREE.Camera.prototype.copy.call(this,t),this.fov=t.fov,this.far=t.far,this.near=t.near,this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this.aspect=t.aspect,this.cameraO.copy(t.cameraO),this.cameraP.copy(t.cameraP),this.inOrthographicMode=t.inOrthographicMode,this.inPerspectiveMode=t.inPerspectiveMode,this},THREE.CombinedCamera.prototype.setViewOffset=function(t,e,n,r,i,a){this.view={fullWidth:t,fullHeight:e,offsetX:n,offsetY:r,width:i,height:a},this.inPerspectiveMode?(this.aspect=t/e,this.toPerspective()):this.toOrthographic()},THREE.CombinedCamera.prototype.clearViewOffset=function(){this.view=null,this.updateProjectionMatrix()},THREE.CombinedCamera.prototype.setSize=function(t,e){this.cameraP.aspect=t/e,this.left=-t/2,this.right=t/2,this.top=e/2,this.bottom=-e/2},THREE.CombinedCamera.prototype.setFov=function(t){this.fov=t,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())},THREE.CombinedCamera.prototype.setLens=function(t,e){void 0===e&&(e=35);var n=.5*e/(t*Math.max(this.cameraP.aspect,1)),r=2*THREE.Math.RAD2DEG*Math.atan(n);return this.setFov(r),r},THREE.CombinedCamera.prototype.setZoom=function(t){this.zoom=t,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0,this.rotation.y=0,this.rotation.z=0},THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0,this.rotation.y=Math.PI,this.rotation.z=0},THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0,this.rotation.y=-Math.PI/2,this.rotation.z=0},THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0,this.rotation.y=Math.PI/2,this.rotation.z=0},THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2,this.rotation.y=0,this.rotation.z=0},THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2,this.rotation.y=0,this.rotation.z=0}},function(t,e){t.exports="varying  vec2 tex_uv;\n\n#if defined(PANORAMA_360) || defined(PANORAMA_180)\nuniform samplerCube tex;\n#else\nuniform sampler2D tex;\n#endif\n\n\nvoid main(void) {\n\tconst float PI = 3.141592653589793238462643383;\n#if defined(PANORAMA_360)\n\tfloat phi   = (1.-tex_uv.x)* PI * 2.0;\n\tfloat theta = (1.-tex_uv.y) * PI;\n    vec3 uvw = vec3(sin(phi) * sin(theta),\n                               cos(theta),\n                    cos(phi) * sin(theta)\n                    );\n    gl_FragColor = textureCube(tex, uvw);\n#elif defined(PANORAMA_180)\n\tfloat x = (tex_uv.x-0.5)*2.;\n\tfloat y = (tex_uv.y-0.5)*2.;\n\tfloat r = sqrt(x*x + y*y);\n\tif(r > 1.)\n\t\tdiscard;\n\tfloat theta = r * PI/2.;\n\tfloat phi = atan(y, x);\n\tvec3 uvw = vec3(cos(phi) * sin(theta),\n\t\t\t\t\tsin(phi) * sin(theta),\n\t\t\t\t\t          -cos(theta));\n    gl_FragColor = textureCube(tex, uvw);\n#else\n    gl_FragColor = texture2D(tex, tex_uv);\n#endif\n}\n"},function(t,e){t.exports="varying vec2 tex_uv;\n\nvoid main(void) {\n    gl_Position = projectionMatrix *\n                modelViewMatrix *\n                vec4(position,1.0);\n    tex_uv = vec2(position.x+0.5, position.y+0.5);\n}\n"},function(t,e){t.exports="precision highp float;\nuniform sampler2D back_tex;\nuniform sampler2D geometry_depth_tex;\n\n// samplers in structs has bad support\n\nstruct Volume\n{\n    float opacity_scale;\n    float brightness;\n    vec2 data_range;\n    vec2 show_range;\n    float rows;\n    float columns;\n    float slices;\n    vec2 size;\n    vec2 slice_size;\n    bool clamp_min;\n    bool clamp_max;\n    vec3 scale;\n    vec3 offset;\n    bool lighting;\n};\n\n#if (VOLUME_COUNT > 0)\nuniform sampler2D data[VOLUME_COUNT];\nuniform sampler2D transfer_function[VOLUME_COUNT];\nuniform Volume volumes[VOLUME_COUNT];\n#endif\n\n#if (VOLUME_COUNT_MAX_INT > 0)\nuniform Volume volumes_max_int[VOLUME_COUNT_MAX_INT];\nuniform sampler2D data_max_int[VOLUME_COUNT_MAX_INT];\nuniform sampler2D transfer_function_max_int[VOLUME_COUNT_MAX_INT];\nfloat max_values[VOLUME_COUNT_MAX_INT];\nfloat max_depth[VOLUME_COUNT_MAX_INT];\nbool  has_values[VOLUME_COUNT_MAX_INT];\n// for MAX_INT, we cannot add the coordinate directly, we do it after we found the max\nvec4  max_weighted_coordinate[VOLUME_COUNT_MAX_INT];\nvec4  max_colors[VOLUME_COUNT_MAX_INT];\n#endif\n\nstruct Layer {\n    float depth;\n    vec4 color;\n    bool skip;\n};\n\nLayer layers[VOLUME_COUNT_MAX_INT+1];\n\n\n//uniform float brightness;\n\n//uniform sampler2D colormap;\n//uniform int colormap_index;\n//uniform int surfaces;\n//uniform float opacity[4];\n//uniform float level[4];\n//uniform float width[4];\nuniform vec2 render_size;\n\nvarying vec3 front;\n\n// for lighting\nuniform mat3 mvMatrix;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\nvec3 light_dir;\nvec3 eye;\n//uniform float color_index;\n\nuniform int steps;\n\n\n\nvec2 compute_slice_offset(float slice, float columns, vec2 uv_slice_spacing) {\n    return uv_slice_spacing * vec2(mod(slice, columns), floor(slice / columns));\n}\nvec4 sample_as_3d_texture(sampler2D tex, vec2 tex_size, vec3 texCoord, vec2 slice_size, float slices, float rows, float columns) {\n  float slice   = texCoord.z*slices*(slices-1.)/slices ;\n  float slice_z  = floor(slice);\n  float slice_z_offset = fract(slice);\n\n  vec2 pixel = 1./tex_size;\n  vec2 uv_slice_spacing = slice_size/tex_size;\n\n  vec2 coord = vec2(texCoord.x, texCoord.y);\n  vec2 uv = pixel * 0.5 + coord * (uv_slice_spacing - pixel);\n\n  vec2 slice0_offset = compute_slice_offset(slice_z, columns, uv_slice_spacing);\n  vec2 slice1_offset = compute_slice_offset(slice_z + 1.0, columns, uv_slice_spacing);\n\n  vec4 slice0_color = texture2D(tex, slice0_offset + uv);\n  vec4 slice1_color = texture2D(tex, slice1_offset + uv);\n  return mix(slice0_color, slice1_color, slice_z_offset);\n}\n\nuniform float ambient_coefficient;\nuniform float diffuse_coefficient;\nuniform float specular_coefficient;\nuniform float specular_exponent;\n\nmat3 transpose3(mat3 m) {\n    vec3 v0 = m[0];\n    vec3 v1 = m[1];\n    vec3 v2 = m[2];\n    return mat3(\n        vec3(v0.x, v1.x, v2.x),\n        vec3(v0.y, v1.y, v2.y),\n        vec3(v0.z, v1.z, v2.z)\n        );\n}\n\nvec2 sample(sampler2D data, Volume volume, vec3 ray_pos, inout vec3 normal) {\n    vec3 pos_relative = (ray_pos+volume.offset)*volume.scale;\n    if(any(lessThan(pos_relative, vec3(0.))) || any(greaterThan(pos_relative, vec3(1.))))\n        return vec2(0.0);\n    vec4 sample = sample_as_3d_texture(data, volume.size, pos_relative, volume.slice_size, volume.slices, volume.rows, volume.columns);\n    normal = (-sample.xyz)*2.+1.;\n    float raw_data_value = sample.a; //(sample.a - data_min) * data_scale;\n    float scaled_data_value = (raw_data_value*(volume.data_range[1] - volume.data_range[0])) + volume.data_range[0];\n    float data_value = (scaled_data_value - volume.show_range[0])/(volume.show_range[1] - volume.show_range[0]);\n    // TODO: how do we deal with this with multivolume rendering\n    // if(((data_value < 0.) && !volume.clamp_min) || ((data_value > 1.) && !volume.clamp_max)) {\n    //     ray_pos += ray_delta;\n    //     continue;\n    // }\n    data_value = clamp(data_value, 0., 1.);\n    return vec2(data_value, 1);\n}\n\nvec4 apply_lighting(vec4 color, vec3 normal) {\n    float cosangle_light = max((dot(light_dir, normal)), 0.);\n    float cosangle_eye = max((dot(eye, normal)), 0.);\n    vec4 result = vec4(color.rgb * (ambient_coefficient + diffuse_coefficient*cosangle_light + specular_coefficient * pow(cosangle_eye, specular_exponent)), color.a);\n    return result;\n}\n\nvec4 add_sample(sampler2D data, sampler2D transfer_function, Volume volume, vec3 ray_pos, vec4 color_in) {\n    vec4 color;\n    vec3 pos_relative = (ray_pos+volume.offset)*volume.scale;\n    /*vec4 sample_x = sample_as_3d_texture(volume, size, pos + vec3(delta, 0, 0), slice_size, slices, rows, columns);\n    vec4 sample_y = sample_as_3d_texture(volume, size, pos + vec3(0, delta, 0), slice_size, slices, rows, columns);\n    vec4 sample_z = sample_as_3d_texture(volume, size, pos + vec3(0, 0, delta), slice_size, slices, rows, columns);\n\n    vec3 normal = normalize(vec3((sample_x[0]-sample[0])/delta, (sample_y[0]-sample[0])/delta, (sample_z[0]-sample[0])/delta));\n    normal = -vec3(normal.x, normal.y, normal.z);\n    float cosangle_light = max((dot(light_dir, normal)), 0.);\n    float cosangle_eye = max((dot(eye, normal)), 0.);*/\n\n    vec3 normal;\n    vec2 sample = sample(data, volume, ray_pos, normal);\n    float data_value = sample[0];\n    if(sample[1] == 0.0)\n        return color_in;\n    if(((data_value < 0.) && !volume.clamp_min) || ((data_value > 1.) && !volume.clamp_max))\n        return color_in;\n\n    vec4 color_sample = texture2D(transfer_function, vec2(data_value, 0.5));\n    if(volume.lighting) {\n        color_sample = apply_lighting(color_sample, normal);\n    }\n\n    // float intensity = color_sample.a;\n    //float alpha_sample = intensity * sign(data_value) * sign(1.-data_value) * 100. / float(steps) * ray_length;//clamp(1.-chisq, 0., 1.) * 0.5;//1./128.* length(color_sample) * 100.;\n    // float alpha_sample = intensity * 100. / float(steps);//clamp(1.-chisq, 0., 1.) * 0.5;//1./128.* length(color_sample) * 100.;\n    // alpha_sample = clamp(alpha_sample * volume.opacity_scale, 0., 1.);\n\n    //float intensity = texture2D(transfer_function, vec2(data_value, 0.5)).a;\n    //color_sample = texture2D(transfer_function, data_value);\n    //vec4 color_sample = texture2D(colormap, vec2(sample.a, colormap_index_scaled));\n    //color_sample = texture2D(volume, ray_pos.yz);\n    //float alpha_sample = opacity*intensity;//1./128.* length(color_sample) * 100.;\n    // float alpha_total = color_in.a + alpha_sample;\n    // color.rgb = color_in.rgb + (1.0 - alpha_total) * color_sample.rgb * alpha_sample;\n    // color.a = alpha_total;\n    vec4 dst = color_in;\n    vec4 src = color_sample;\n    src.a *= clamp(100./float(steps) * volume.opacity_scale, 0.0, 1.0);\n    #ifdef COORDINATE\n        color.a   = src.a  + dst.a;\n        color.rgb = dst.xyz + ray_pos * src.a;\n    #else\n        color.rgb = (1.0-dst.a) * src.rgb * src.a * volume.brightness + dst.rgb;\n        color.a   = src.a  + dst.a;\n    #endif\n    return color;\n}\n\nvec4 blend_pre_multiplied(vec4 dst, vec4 src) {\n    return dst * (1.0-src.a) + src;\n}\n\nconst int MAX_STEPS = 1000;\nvec2 pixel;\n\nvec4 cast_ray(vec3 ray_begin, vec3 ray_end, vec4 color) {\n    vec3 ray_direction = ray_end - ray_begin;\n    vec3 ray_delta = normalize(ray_direction) * (1./float(steps));\n    vec3 ray_pos = ray_begin;\n\n    float ray_length = length(ray_direction);\n    float ray_length_delta = length(ray_delta);\n    float ray_length_traveled = 0.;\n\n    vec2 pixel = vec2(gl_FragCoord.x, gl_FragCoord.y) / render_size;\n    vec4 voxel_view_space_coord;\n    float voxel_frag_depth;\n    vec4 geometry_depth;\n\n    for(int i = 0; i < MAX_STEPS; i++) {\n        geometry_depth = texture2D(geometry_depth_tex, pixel); \n        voxel_view_space_coord = projectionMatrix * modelViewMatrix * vec4(ray_pos+vec3(-0.5, -0.5, -0.5),1.0);\n        voxel_frag_depth = ((voxel_view_space_coord.z / voxel_view_space_coord.w)+1.0)/2.0;\n        if(geometry_depth.x > 0.0 && voxel_frag_depth > geometry_depth.x){\n            break;\n        }\n\n        {{#volumes}}\n            color = add_sample(data[{{.}}], transfer_function[{{.}}], volumes[{{.}}], ray_pos, color);\n        {{/volumes}}\n        if(color.a >= 1.)\n            break;\n        ray_pos += ray_delta;\n        ray_length_traveled += ray_length_delta;\n        if(ray_length_traveled >= ray_length)\n            break;\n    }\n    return color;\n}\n\nvoid cast_ray_max(vec3 ray_begin, vec3 ray_end);\n\nvoid main(void) {\n#ifdef METHOD_MAX_INTENSITY\n    float max_value = 0.;\n    float max_cosangle_light = 0.;\n    float max_cosangle_eye = 0.;\n#endif\n\n\n    pixel = vec2(gl_FragCoord.x, gl_FragCoord.y) / render_size;\n    vec4 color = vec4(0, 0, 0, 0);\n    // float color_index;\n\n    //mat3 rotation = mat3(mvMatrix);\n    mat3 rotation = (mat3(viewMatrix));\n    light_dir = normalize(vec3(-1,-1,1) * rotation);\n    eye = vec3(0, 0, 1) * rotation;\n\n    float delta = 1.0/256./2.;\n\n#ifdef COORDINATE\n    // contains the weighted coordinate, where the last component is the weight\n    // diving by w gives it the average value\n    vec4 weighted_coordinate = vec4(0., 0., 0., 0.);\n#endif \n    vec3 ray_begin = front;\n    vec3 ray_end = texture2D(back_tex, pixel).rgb;\n    vec3 ray_begin0 = ray_begin;\n    vec3 ray_end0 = ray_end;\n    cast_ray_max(ray_begin, ray_end);\n    #if (VOLUME_COUNT_MAX_INT > 1)\n        // TODO: horrible sort, fix!!\n        for(int i = 0; i < VOLUME_COUNT_MAX_INT-1; i++) {\n            for(int j = 1; j < VOLUME_COUNT_MAX_INT; j++) {\n                if(has_values[i] && has_values[j] && (i < j)) {\n                    if(max_depth[j] < max_depth[i]) {\n                        float depth = max_depth[i];\n                        max_depth[i] = max_depth[j];\n                        max_depth[j] = depth;\n                        vec4 color = max_colors[i];\n                        max_colors[i] = max_colors[j];\n                        max_colors[j] = color;\n                    }\n                }\n            }\n        }\n    #endif\n    #if (VOLUME_COUNT_MAX_INT > 0)\n        for(int i = 0; i < VOLUME_COUNT_MAX_INT; i++) {\n            layers[i].depth = 0.0;\n            layers[i].color = vec4(0.0);\n            if(has_values[i]) {\n                layers[i].depth = max_depth[i];\n                layers[i].color = max_colors[i];\n            }\n        }\n    #endif\n    // last layer is the absolute end of the volume, its color is fully transparant\n    layers[VOLUME_COUNT_MAX_INT].depth = 1.0;\n    layers[VOLUME_COUNT_MAX_INT].color = vec4(0.0);\n    float depth = -100.0;\n    ray_begin = ray_begin0;\n    for(int i = 0; i < VOLUME_COUNT_MAX_INT+1; i++) {\n        // TODO: debug this, it seems that > makes more sense, but gives artifacts in the situation of\n        // having 2 max int volr, 1 normal, the 2nd will have holes when it's the only volume in the los.\n        if(layers[i].depth >= depth)\n        {\n            ray_end = ray_begin0 + (ray_end0 - ray_begin0) * layers[i].depth;\n            color = cast_ray(ray_begin, ray_end, color);\n            #ifdef COORDINATE\n                // color += layers[i].color;\n                color = blend_pre_multiplied(layers[i].color, color);\n            #else\n                color = blend_pre_multiplied(layers[i].color, color);\n            #endif\n            ray_begin = ray_end;\n            depth = layers[i].depth;\n        }\n    }\n\n    #ifdef COORDINATE\n        vec3 average_coordinate = color.xyz/color.a;\n        gl_FragColor = vec4(average_coordinate, color.a);\n    #else\n        gl_FragColor = color;\n    #endif\n    //gl_FragColor = vec4(ray_begin.xyz, 0.1) * brightness;\n    //gl_FragColor = vec4(rotation[0], 1) * brightness;\n    //gl_FragColor = vec4(alpha_total, 0., 0., 1.);\n    //gl_FragColor = texture2D(volume, vec2(ray_begin.x, ray_begin.y));\n    // gl_FragColor = vec4(ray_pos.x, ray_pos.y, ray_pos.z, 1);\n    //gl_FragColor = texture2D(transfer_function, vec2(pixel.x, 0.5));\n    //gl_FragColor = vec4(texture2D(volume, vec2(pixel.x, pixel.y)).rgb, 1.0);\n    // gl_FragColor = vec4(pixel.x, pixel.y, 0, 1);\n    // gl_FragColor = vec4(ray_end, 1.);\n    // gl_FragColor = vec4(ray_begin, 1);\n    //float tintensity = texture2D(transfer_function, vec2(pixel.x / 1., 0.5)).a;\n    //gl_FragColor = vec4(0, tintensity, 0., 1.);\n    //gl_FragColor = vec4(ray_e, 1);\n}\n\n\n\n\nvoid cast_ray_max(vec3 ray_begin, vec3 ray_end) {\n    vec3 ray_direction = ray_end - ray_begin;\n    vec3 ray_delta = normalize(ray_direction) * (1./float(steps));\n    vec3 ray_pos = ray_begin;\n\n    float ray_length = length(ray_direction);\n    float ray_length_delta = length(ray_delta);\n    float ray_length_traveled = 0.;\n\n    vec4 voxel_view_space_coord;\n    float voxel_frag_depth;\n    vec4 geometry_depth;\n    for(int i = 0; i < MAX_STEPS; i++) {\n\n        {{#volumes_max_int}}\n        {\n            vec3 normal;\n            vec2 sample = sample(data_max_int[{{.}}], volumes_max_int[{{.}}], ray_pos, normal);\n            if(sample.x > max_values[{{.}}] && sample.y > 0.0) {\n                max_values[{{.}}] = sample.x;\n                has_values[{{.}}] = true;\n                // the weight of the coordinate equals its opacity\n                max_colors[{{.}}] = texture2D(transfer_function_max_int[{{.}}], vec2(max_values[{{.}}], 0.5));\n                if(volumes_max_int[{{.}}].lighting)\n                    max_colors[{{.}}] = apply_lighting(max_colors[{{.}}], normal);\n                float alpha = clamp(max_colors[{{.}}].a * volumes_max_int[{{.}}].opacity_scale * 10., 0., 1.);\n                max_colors[{{.}}].a = alpha;\n                #ifdef COORDINATE\n                    max_colors[{{.}}].rgb = ray_pos * alpha; // no need to use brightness for the coordinates\n                #else\n                    max_colors[{{.}}].rgb *= alpha * volumes_max_int[{{.}}].brightness; // pre-blend\n                #endif\n                max_weighted_coordinate[{{.}}].xyz = ray_pos * alpha;\n                max_weighted_coordinate[{{.}}].a = alpha;\n                max_depth[{{.}}] = ray_length_traveled/ray_length;\n            }\n        }\n        {{/volumes_max_int}}\n\n        ray_pos += ray_delta;\n        ray_length_traveled += ray_length_delta;\n        if(ray_length_traveled >= ray_length)\n            break;\n    }\n}"},function(t,e){t.exports="//attribute vec3 aVertexPosition;\n\n//uniform mat4 uMVMatrix;\n//uniform mat4 uPMatrix;\nvarying vec3 front;\n\nvoid main(void) {\n    //gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n    gl_Position = projectionMatrix *\n                modelViewMatrix *\n                vec4(position,1.0);\n    //vertex_color = vec4(aVertexPosition, 1);\n    front = position+vec3(0.5, 0.5, 0.5);\n}\n"},function(t,e,n){var r=n(4),i=n(3),a=n(5),o=n(0).semver_range,s=n(14),c=r.DOMWidgetView.extend({render:function(){this.img=document.createElement("img"),this.img.setAttribute("src",this.model.get("rgba")),this.img.setAttribute("style",this.model.get("style")),this.model.on("change:rgba",function(){this.img.setAttribute("src",this.model.get("rgba"))},this),this.model.on("change:style",function(){this.img.setAttribute("style",this.model.get("style"))},this),this.el.appendChild(this.img)}}),l=r.DOMWidgetModel.extend({defaults:function(){return i.extend(r.DOMWidgetModel.prototype.defaults(),{_model_name:"TransferFunctionModel",_view_name:"TransferFunctionView",_model_module:"ipyvolume",_view_module:"ipyvolume",_model_module_version:o,_view_module_version:o,rgba:null})},get_data_array:function(){for(var t=[],e=this.get("rgba"),n=0;n<e.shape[0];n++)for(var r=0;r<4;r++)t.push(255*e.get(n,r));return new Uint8Array(t)}},{serializers:i.extend({rgba:a.ndarray},r.WidgetModel.serializers)}),u=l.extend({defaults:function(){return i.extend(l.prototype.defaults(),{_model_name:"TransferFunctionJsBumpsModel",levels:[.1,.5,.8],opacities:[.01,.05,.1],widths:[.1,.1,.1]})},constructor:function(){l.prototype.constructor.apply(this,arguments),this.on("change:levels",this.recalculate_rgba,this),this.on("change:opacities",this.recalculate_rgba,this),this.on("change:widths",this.recalculate_rgba,this),this.recalculate_rgba()},recalculate_rgba:function(){var t=[],e=[[1,0,0],[0,1,0],[0,0,1]],n=this.get("levels"),r=this.get("widths"),i=this.get("opacities");window.rgba=t,window.tfjs=this;for(var a=0;a<256;a++){for(var o=a/255,s=[0,0,0,0],c=0;c<n.length;c++){for(var l=e[c],u=Math.exp(-Math.pow(o-n[c],2)/Math.pow(r[c],2)),h=0;h<3;h++)s[h]+=l[h]*u*i[c];s[3]+=u*i[c]}var f=s[0];for(h=1;h<3;h++)f=Math.max(f,s[h]);for(h=0;h<3;h++)s[h]=Math.min(1,s[h]/f);s[3]=Math.min(1,s[3]),t.push(s)}this.set("rgba",t),this.save_changes()}}),h=l.extend({defaults:function(){return i.extend(l.prototype.defaults(),{_model_name:"TransferFunctionWidgetJs3Model",level1:.1,level2:.5,level3:.8,opacity1:.01,opacity2:.05,opacity3:.1,width1:.1,width2:.1,width3:.1})},constructor:function(){l.prototype.constructor.apply(this,arguments),this.on("change:level1",this.recalculate_rgba,this),this.on("change:level2",this.recalculate_rgba,this),this.on("change:level3",this.recalculate_rgba,this),this.on("change:opacity1",this.recalculate_rgba,this),this.on("change:opacity2",this.recalculate_rgba,this),this.on("change:opacity3",this.recalculate_rgba,this),this.on("change:width1",this.recalculate_rgba,this),this.on("change:width2",this.recalculate_rgba,this),this.on("change:width3",this.recalculate_rgba,this),this.recalculate_rgba()},recalculate_rgba:function(){for(var t=[],e=[[1,0,0],[0,1,0],[0,0,1]],n=[this.get("level1"),this.get("level2"),this.get("level3")],r=[this.get("width1"),this.get("width2"),this.get("width3")],i=[this.get("opacity1"),this.get("opacity2"),this.get("opacity3")],a=0;a<256;a++){for(var o=a/255,c=[0,0,0,0],l=0;l<3;l++){for(var u=e[l],h=Math.exp(-Math.pow(o-n[l],2)/Math.pow(r[l],2)),f=0;f<3;f++)c[f]+=u[f]*h*i[l];c[3]+=h*i[l]}var d=c[0];for(f=1;f<3;f++)d=Math.max(d,c[f]);for(f=0;f<3;f++)c[f]=Math.min(1,c[f]/d);c[3]=Math.min(1,c[3]),t.push(c)}t=s(t),this.set("rgba",t),this.save_changes()}});t.exports={TransferFunctionModel:l,TransferFunctionView:c,TransferFunctionWidgetJs3Model:h,TransferFunctionJsBumpsModel:u}}])});
//# sourceMappingURL=index.js.map